<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p94.html#dhcp-trouble-1">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p96.html#dhcp-trouble-5">Troubleshooting DHCP Client Configuration Problems</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p98.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p100.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="dhcp-trouble-38"></A><h3>Problems With Inaccurate DHCP Configuration Information</h3>
<A NAME="indexterm-1566"></A><p>If a DHCP client receives inaccurate information in its network configuration
information, look at the DHCP server data. You must examine the option values in 
the macros that the DHCP server processes for this client. Examples of inaccurate
information might be the wrong NIS domain name or router IP address.</p>
<p>Use the following general guidelines to help you determine the source of the
inaccurate information:</p><ul><li><p>Look at the macros defined on the server as described in <A HREF="p83.html#dhcp-admin-13">How to View Macros Defined on a DHCP Server (DHCP Manager)</A>. Review the information
in <A HREF="p67.html#dhcp-overview-10">Order of Macro Processing</A>, and determine
which macros are processed automatically for this client.</p>
</li>
<li><p>Look at the network table to determine what macro (if any) is assigned
to the client's IP address as the configuration macro. See <A HREF="p80.html#dhcp-admin-124">Working With IP Addresses in the DHCP Service (Task Map)</A> for more information.</p>
</li>
<li><p>Take note of any options that occur in more than one macro. Make sure
the value that you want for an option is set in the last processed macro.</p>
</li>
<li><p>Edit the appropriate macro or macros to assure that the correct value
is passed to the client. See <A HREF="p83.html#dhcp-admin-18">Modifying DHCP Macros</A>.</p>
</li>
</ul>
<A NAME="dhcp-trouble-2-1121"></A><h3>Problems With the DHCP Client-Supplied Host
Name</h3>
<p>This section describes problems that you might experience with DHCP clients
that supply their own host names to be registered with DNS.</p>
<A NAME="dhcp-trouble-3-1121"></A><h4>DHCP Client Does Not Request a Host Name</h4>
<p>If your client is not a Solaris DHCP client, consult the client's documentation
to determine how to configure the client to request a host name. For Solaris DHCP
clients, see <A HREF="p92.html#dhcp-admin-1058sm">How to Enable a Solaris Client to Request a Specific Host Name</A>.</p>
<A NAME="dhcp-trouble-4"></A><h4>DHCP Client Does Not Get Requested Host Name</h4>
<p>The following list includes describes possible problems a client might have
in getting its requested hostname, and suggested solutions.</p>
<p><b>Problem: </b>Client accepted an offer from a DHCP server that does not issue DNS
updates.</p>
<p><b>Solution: </b>If two DHCP servers are available to the client, the servers should
both be configured to provide DNS updates. See <A HREF="p76.html#dhcp-admin-202">Enabling Dynamic DNS Updates by a DHCP Server</A> for information about configuring
the DHCP server and the DNS server.</p>
<p>To determine whether the DHCP server
is configured to provide DNS updates:</p>
<ol Type="1"><li><p>Determine the IP address of the client's DHCP server. On the client
system, use <tt>snoop</tt> or another application for capturing network
packets. See <A HREF="p96.html#dhcp-trouble-proc-21">How to Use <tt>snoop</tt> to Monitor DHCP Network Traffic</A>, and perform the procedure on the client instead of the server.
In the <tt>snoop</tt> output, look for the DHCP Server Identifier to get
the IP address of the server.</p>
</li>
<li><p>Log in to the DHCP server system to verify that the system is configured
to make DNS updates. Type the following command as superuser:</p>
<p><tt><b>dhcpconfig -P</b></tt></p>
<p>If <tt>UPDATE_TIMEOUT</tt> is listed
as a server parameter, the DHCP server is configured to make DNS updates.</p>
</li>
<li><p>On the DNS server, look at the <tt>/etc/named.conf</tt> file.
Find the <tt>allow-update</tt> keyword in the <tt>zone</tt> section
of the appropriate domain. If the server allows DNS updates by the DHCP server, the
DHCP server's IP address is listed in the <tt>allow-update</tt> keyword.</p>
</li>
</ol>
<p><b>Problem: </b>Client is using <tt>FQDN</tt> option to specify host name.
Solaris DHCP does not currently support the <tt>FQDN</tt> option because
the option is not officially in the DHCP protocol.</p>
<p><b>Solution: </b>On the server, use <tt>snoop</tt> or another application for
capturing network packets. See <A HREF="p96.html#dhcp-trouble-proc-21">How to Use <tt>snoop</tt> to Monitor DHCP Network Traffic</A>. In the <tt>snoop</tt> output,
look for the <tt>FQDN</tt> option in a packet from the client.</p>
<p>Configure the client to specify host name using <tt>Hostname</tt> option. <tt>Hostname</tt> is option code 12. Refer to client documentation for instructions.</p>
<p>For a Solaris client, see <A HREF="p92.html#dhcp-admin-1058sm">How to Enable a Solaris Client to Request a Specific Host Name</A></p>
<p><b>Problem: </b>DHCP server that makes an address offer to the client  does not know
the client's DNS domain.</p>
<p><b>Solution: </b>On the DHCP server look for the <tt>DNSdmain</tt> option with
a valid value. Set the <tt>DNSdmain</tt> option to the correct DNS domain
name in a macro that is processed for this client. <tt>DNSdmain</tt> is
usually contained in the network macro. See <A HREF="p83.html#dhcp-admin-18">Modifying DHCP Macros</A> for information about changing values of options in a macro.</p>
<p><b>Problem: </b>The host name requested by client corresponds to an IP address that
is not managed by the DHCP server. The Solaris DHCP server does not perform DNS updates
for IP addresses that the server does not manage.</p>
<p><b>Solution: </b>Check <tt>syslog</tt> for one of the following messages from
the DHCP server:</p>
<ul><li><p><tt>There is no</tt> <i>n.n.n.n</i> <tt>dhcp-network table for DHCP client's network.</tt></p>
</li>
<li><p><tt>DHCP network record for</tt> <i>n.n.n.n</i> <tt>is unavailable, ignoring request.</tt></p>
</li>
</ul>
<p>Configure the client to request a different name. See <A HREF="p92.html#dhcp-admin-1058sm">How to Enable a Solaris Client to Request a Specific Host Name</A>. Choose a name
that is mapped to an address managed by the DHCP server. You can see address mappings
in DHCP Manager's Addresses tab. Alternatively, choose an address that is not mapped
to any IP address.</p>
<p><b>Problem: </b>The host name requested by client corresponds to an IP address that
is currently not available for use. The address might be in use, leased to another
client, or under offer to another client.</p>
<p><b>Solution: </b>Check <tt>syslog</tt> for the following message from the DHCP
server: <tt>ICMP ECHO reply to OFFER candidate:</tt> <i>n.n.n.n</i>.</p>
<p>Configure the client to choose a name corresponding to
a different IP address. Alternatively, reclaim the address from the client that uses
the address.</p>
<p><b>Problem: </b>DNS server is not configured to accept updates from the DHCP server.</p>
<p><b>Solution: </b>Examine the <tt>/etc/named.conf</tt> file on the DNS server.
Look for the DHCP server's IP address with the <tt>allow-update</tt> keyword
in the appropriate <tt>zone</tt> section for the DHCP server's domain. If
the IP address is not present, the DNS server is not configured to accept updates
from the DHCP server.</p>
<p>See <A HREF="p76.html#dhcp-admin-303">How to Enable Dynamic DNS Updating for DHCP Clients</A> for information about configuring the
DNS server.</p>
<p>If the DHCP server has multiple interfaces, you might need
to configure the DNS server to accept updates from all of the DHCP server's addresses.
Enable debugging on the DNS server to see whether the updates are reaching the DNS
server. If the DNS server received update requests, examine the debugging mode output
to determine why the updates did not occur. See the <tt>in.named</tt>.1M
man page for information about DNS debugging mode.</p>
<p><b>Problem: </b>DNS updates might not have completed in the allotted time. DHCP servers
do not return host names to clients if the DNS updates have not completed by the configured
time  limit. However, attempts to complete the DNS updates continue.</p>
<p><b>Solution: </b>Use the <tt>nslookup</tt> command to determine whether the
updates completed successfully. See the <tt>nslookup</tt>(1M) man
page.</p>
<p>For example, suppose the DNS domain is <tt>hills.example.org</tt>, and the DNS server's IP address is <tt>10.76.178.11</tt>. The
host name that the client wants to register is <tt>cathedral</tt>. You could
use the following command to determine if <tt>cathedral</tt> has been registered
with that DNS server:</p>
<p><tt>nslookup cathedral.hills.example.org 10.76.178.11</tt></p>
<p>If the updates completed successfully, but not in the allotted
time, you need to increase the time out value. See <A HREF="p76.html#dhcp-admin-303">How to Enable Dynamic DNS Updating for DHCP Clients</A>. In this procedure, you
should increase the number of seconds to wait for a response from the DNS server before
timing out.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p98.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p100.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

