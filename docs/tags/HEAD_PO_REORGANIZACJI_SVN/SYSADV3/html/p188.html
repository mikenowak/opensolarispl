<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p187.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p189.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ipqos-reference-1"></A><b>Chapter&nbsp;37</b><h1>IPQoS in Detail (Reference)</h1>
<p>This chapter contains reference materials that provide in-depth details
about the following IPQoS topics:</p>
<ul><li><p><A HREF="p188.html#ipqos-reference-2">IPQoS Architecture and the Diffserv Model</A></p>
</li>
<li><p><A HREF="p191.html#ipqos-reference-22">IPQoS Configuration File</A></p>
</li>
<li><p><A HREF="p192.html#ipqos-reference-30"><tt>ipqosconf</tt> Configuration Utility</A></p>
</li>
</ul>
<p>For an overview, refer to <A HREF="p168.html#ipqos-intro-1">Chapter&nbsp;32, Introducing IPQoS (Overview)</A>. For planning information, refer to <A HREF="p173.html#ipqos-config-planning-1">Chapter&nbsp;33, Planning for an IPQoS-Enabled Network (Tasks)</A>. For procedures for configuring IPQoS, refer to <A HREF="p178.html#ipqos-policy-planning-1">Chapter&nbsp;34, Creating the IPQoS Configuration File (Tasks)</A>.</p>
<A NAME="ipqos-reference-2"></A><h2>IPQoS Architecture and the Diffserv Model</h2>
<p>This section describes the IPQoS architecture and how IPQoS implements
the differentiated services (Diffserv) model that is defined in<A  HREF="http://www.ietf.org/rfc/rfc2475.txt?number=2475">RFC
2475, An Architecture for Differentiated Services</A>. The following elements
of the Diffserv model are included in IPQoS:</p>
<ul><li><p>Classifier</p>
</li>
<li><p>Meter</p>
</li>
<li><p>Marker</p>
</li>
</ul>
<p>In addition, IPQoS includes the flow-accounting module and the <tt>dlcosmk</tt> marker for use with virtual local area network (VLAN) devices.</p>
<A NAME="ipqos-reference-3"></A><h3>Classifier Module</h3>
<p>In the Diffserv model, the <b>classifier</b> is responsible
for organizing selected traffic flows into groups on which to apply different
service levels. The classifiers that are defined in RFC 2475 were originally
designed for boundary routers. In contrast, the IPQoS classifier <tt>ipgpc</tt> is
designed to handle traffic flows on hosts that are internal to the local network.
Therefore, a network with both IPQoS systems and a Diffserv router can provide
a greater degree of differentiated services. For a technical description of <tt>ipgpc</tt>, refer to the <tt>ipgpc</tt>(7ipp) man page. </p>
<p><A NAME="indexterm-3143"></A>The <tt>ipgpc</tt> classifier does the following:</p>
<ol Type="1"><li><p>Selects traffic flows that meet the criteria specified in
the IPQoS configuration file on the IPQoS-enabled system</p>
<p>The QoS
policy defines various criteria that must be present in packet headers. These
criteria are called <b>selectors</b>. The <tt>ipgpc</tt> classifier
compares these selectors against the headers of packets that are received
by the IPQoS system. <tt>ipgpc</tt> then selects all matching packets.</p>
</li>
<li><p>Separates the packet flows into <b>classes</b>,
network traffic with the same characteristics, as defined in the IPQoS configuration
file</p>
</li>
<li><p>Examines the value in the packet's differentiated service
(DS) field for the presence of a differentiated services codepoint (DSCP)</p>
<p>The presence of the  DSCP indicates whether the incoming traffic has
been marked by the sender with a forwarding behavior.</p>
</li>
<li><p>Determines what further action is specified  in the IPQoS
configuration file for packets of a particular class</p>
</li>
<li><p>Passes the packets to the next IPQoS module specified in the
IPQoS configuration file, or returns the packets to the network stream</p>
</li>
</ol>
<p>For an overview of the classifier, refer to <A HREF="p170.html#ipqos-intro-17">Classifier <tt>(ipgpc)</tt> Overview</A>. For information
on invoking the classifier in the IPQoS configuration file, refer to <A HREF="p191.html#ipqos-reference-22">IPQoS Configuration File</A>. </p>
<A NAME="ipqos-reference-40"></A><h4>IPQoS Selectors</h4>
<p>The <tt>ipgpc</tt> classifier supports a variety of selectors
that you can use in the <tt>filter</tt> clause of the IPQoS configuration
file. When you define a filter, always use the minimum number of selectors
that are needed to successfully retrieve traffic of a particular class. The
number of filters you define can impact IPQoS performance.</p>
<p><A NAME="indexterm-3144"></A><A NAME="indexterm-3145"></A><A NAME="indexterm-3146"></A>The next table lists the selectors that are available for <tt>ipgpc</tt>.</p>
<A NAME="ipqos-reference-tbl-32"></A><p><b>Table 37-1 </b>Filter
Selectors for the IPQoS Classifier</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Selector</p></th><th scope="col"><p>Argument</p></th><th scope="col"><p>Information Selected</p></th></tr>
<tr><td><p><tt>saddr</tt></p></td><td><p>IP address number.</p></td><td><p>Source address.</p></td></tr>
<tr><td><p><tt>daddr</tt></p></td><td><p>IP address number.</p></td><td><p>Destination address.</p></td></tr>
<tr><td><p><tt>sport</tt></p></td><td><p>Either a port number or service name, as defined in <tt>/etc/services</tt>.</p></td><td><p>Source port from which a traffic class originated.</p></td></tr>
<tr><td><p><tt>dport</tt></p></td><td><p>Either a port number or service name, as defined in <tt>/etc/services</tt>.</p></td><td><p>Destination port to which a traffic class is bound.</p></td></tr>
<tr><td><p><tt>protocol</tt></p></td><td><p>Either a protocol number or protocol name,  as defined in <tt>/etc/protocols</tt>.</p></td><td><p>Protocol to be used by this traffic class.</p></td></tr>
<tr><td><p><tt>dsfield</tt></p></td><td><p>DS codepoint (DSCP) with a value of 0-63.</p></td><td><p>DSCP, which defines any forwarding behavior to be applied to the packet.
If this parameter is specified, the <tt>dsfield_mask</tt> parameter
must also be specified.</p></td></tr>
<tr><td><p><tt>dsfield_mask</tt></p></td><td><p>Bit mask with a value of 0-255.</p></td><td><p>Used in tandem with the <tt>dsfield</tt> selector. <tt>dsfield_mask</tt> is applied to the <tt>dsfield</tt> selector to determine
which of its bits to match against.</p></td></tr>
<tr><td><p><tt>if_name</tt></p></td><td><p>Interface name.</p></td><td><p>Interface to be used for either incoming or outgoing traffic of a particular
class.</p></td></tr>
<tr><td><p><tt>if_groupname</tt></p></td><td><p>Interface group name.</p></td><td><p>Interface group to be used for either incoming or outgoing traffic of
a particular class.</p></td></tr>
<tr><td><p><tt>user</tt></p></td><td><p>Number of the UNIX user ID or user name to be selected. If no user ID
or user name is on the packet, the default -1 is used.</p></td><td><p>User ID that is supplied to an application.</p></td></tr>
<tr><td><p><tt>projid</tt></p></td><td><p>Number of the project ID to be selected.</p></td><td><p>Project ID that is supplied to an application.</p></td></tr>
<tr><td><p><tt>priority</tt></p></td><td><p>Priority number. Lowest priority is 0.</p></td><td><p>Priority that is given to packets of this class. Priority is used to
order the importance of filters for the same class.</p></td></tr>
<tr><td><p><tt>direction</tt></p></td><td><p>Argument can be one of the following:</p></td><td><p>Direction of packet flow on the IPQoS machine. </p></td></tr>
<tr><td>&nbsp;</td><td><p><tt>LOCAL_IN</tt></p></td><td><p>Input traffic local to the IPQoS system.</p></td></tr>
<tr><td>&nbsp;</td><td><p><tt>LOCAL_OUT</tt></p></td><td><p>Output traffic local to the IPQoS system.</p></td></tr>
<tr><td>&nbsp;</td><td><p><tt>FWD_IN</tt></p></td><td><p>Input traffic to be forwarded.</p></td></tr>
<tr><td>&nbsp;</td><td><p><tt>FWD_OUT</tt></p></td><td><p>Output traffic to be forwarded.</p></td></tr>
<tr><td><p><tt>precedence</tt></p></td><td><p>Precedence value. Highest precedence is 0.</p></td><td><p>Precedence is used to order filters with the same priority.</p></td></tr>
<tr><td><p><tt>ip_version</tt></p></td><td><p><tt>V4</tt> or <tt>V6</tt></p></td><td><p>Addressing scheme that is used by the packets, either IPv4 or IPv6.</p></td></tr>
</table><A NAME="ipqos-reference-8"></A><h3>Meter Module</h3>
<p><A NAME="indexterm-3147"></A><A NAME="indexterm-3148"></A>The <b>meter</b> tracks the transmission rate of flows on a per-packet basis. 
The meter then determines whether the packet conforms to the configured parameters.
The meter module determines the next action for a packet from a set of actions
that depend on packet size, configured parameters, and flow rate.</p>
<p>The meter consists of two metering modules, <tt>tokenmt</tt> and <tt>tswtclmt</tt>, which you configure in the IPQoS configuration file. You
can configure either module or both modules for a class. </p>
<p><A NAME="indexterm-3149"></A>When you configure a metering module, you can define two parameters
for rate:</p>
<ul><li><p><tt>committed-rate</tt> - Defines the acceptable
transmission rate in bits per second for packets of a particular class </p>
</li>
<li><p><tt>peak-rate</tt> - Defines the maximum transmission
rate in bits per second that is allowable for packets of a particular class</p>
</li>
</ul>
<p><A NAME="indexterm-3150"></A><A NAME="indexterm-3151"></A>A metering action on a packet can result in one of three outcomes:</p>
<ul><li><p><tt>green</tt> - The packet causes the flow
to remain within its committed rate.</p>
</li>
<li><p><tt>yellow</tt> - The packet causes the flow
to exceed its committed rate but not its peak rate.</p>
</li>
<li><p><tt>red</tt> - The packet causes the flow
to exceed its peak rate.</p>
</li>
</ul>
<p>You can configure each outcome with different actions in the IPQoS configuration
file. Committed rate and peak rate are explained in the next section.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p187.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p189.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

