<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p188.html#ipqos-reference-1">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p188.html#ipqos-reference-2">IPQoS Architecture and the Diffserv Model</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p190.html#ipqos-reference-300"><tt>flowacct</tt> Module</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p190.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p192.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ipqos-reference-4"></A><h4><tt>flowacct</tt> Records</h4>
<p><A NAME="indexterm-3189"></A>A <tt>flowacct</tt> record contains the attributes described
in the following table.</p>
<A NAME="ipqos-reference-tbl-6"></A><p><b>Table 37-4 </b>Attributes
of a <tt>flowacct</tt> Record</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Attribute Name</p></th><th scope="col"><p>Attribute Contents</p></th><th scope="col"><p>Type</p></th></tr>
<tr><td><p><tt>src-addr-</tt><i>address-type</i><tt></tt></p></td><td><p>Source address of the originator. <i>address-type</i> is
either <tt>v4</tt> for IPv4 or <tt>v6</tt> for IPv6, as
specified in the IPQoS configuration file.</p></td><td><p>Basic </p></td></tr>
<tr><td><p><tt>dest-addr-</tt><i>address-type</i></p></td><td><p>Destination address for the packets. <i>address-type</i> is
either <tt>v4</tt> for IPv4 or <tt>v6</tt> for IPv6, as
specified in the IPQoS configuration file.</p></td><td><p>Basic</p></td></tr>
<tr><td><p><tt>src-port</tt></p></td><td><p>Source port from which the flow originated. </p></td><td><p>Basic</p></td></tr>
<tr><td><p><tt>dest-port</tt></p></td><td><p>Destination port number to which this flow is bound. </p></td><td><p>Basic</p></td></tr>
<tr><td><p><tt>protocol</tt></p></td><td><p>Protocol number for the flow. </p></td><td><p>Basic</p></td></tr>
<tr><td><p><tt>total-packets</tt></p></td><td><p>Number of packets in the flow.</p></td><td><p>Basic</p></td></tr>
<tr><td><p><tt>total-bytes</tt></p></td><td><p>Number of bytes in the flow.</p></td><td><p>Basic </p></td></tr>
<tr><td><p><tt></tt><i>action-name</i><tt></tt></p></td><td><p>Name of the <tt>flowacct</tt> action that recorded this flow.</p></td><td><p>Basic</p></td></tr>
<tr><td><p><tt>creation-time</tt></p></td><td><p>First time that a packet is seen for the flow by <tt>flowacct</tt>.</p></td><td><p>Extended only</p></td></tr>
<tr><td><p><tt>last-seen</tt></p></td><td><p>Last time that a packet of the flow was seen.</p></td><td><p>Extended only</p></td></tr>
<tr><td><p><tt>diffserv-field</tt></p></td><td><p>DSCP in the outgoing packet headers of the flow.</p></td><td><p>Extended only</p></td></tr>
<tr><td><p><tt>user</tt></p></td><td><p>Either a UNIX User ID or user name, which is obtained from the application.</p></td><td><p>Extended only</p></td></tr>
<tr><td><p><tt>projid</tt></p></td><td><p>Project ID, which is obtained from the application.</p></td><td><p>Extended only</p></td></tr>
</table><A NAME="ipqos-reference-7"></A><h4>Using <tt>acctadm</tt> with
the <tt>flowacct</tt> Module</h4>
<p><A NAME="indexterm-3190"></A><A NAME="indexterm-3191"></A>You use the <tt>acctadm</tt> command to create a file
in which to store the various flow records that are generated by <tt>flowacct</tt>. <tt>acctadm</tt> works in conjunction with the extended
accounting facility. For technical information about <tt>acctadm</tt>,
refer to the <tt>acctadm</tt>(1M) man
page.</p>
<p>The <tt>flowacct</tt> module observes flows and fills the
flow  table with flow records. <tt>flowacct</tt> then evaluates
its parameters and attributes in the interval that is specified by <tt>timer</tt>. When a packet is not seen for at least the <tt>last_seen</tt> plus <tt>timeout</tt> values, the packet times out. All timed-out entries are
deleted from the flow table. These entries are then written to the accounting
file each time the interval that is specified in the <tt>timer</tt> parameter
elapses.</p>
<p>To invoke <tt>acctadm</tt> for use with the <tt>flowacct</tt> module,
use the following syntax:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>acctadm -e <i>file-type</i> -f <i>filename</i> flow</pre>
</td></table><br><table border="0" cellspacing="5"><tr><td valign="top"><p><tt>acctadm -e</tt></p></td><td valign="top"><p>Invokes <tt>acctadm</tt> with the <tt>-e</tt> option.
The -e indicates that a resource list follows.</p>
</td></tr><tr><td valign="top"><p><i>file-type</i></p></td><td valign="top"><p>Specifies the attributes to be gathered. <i>file-type</i> must
be replaced by either <tt>basic</tt> or <tt>extended</tt>.
For a list of attributes in each file type, refer to <A HREF="p191.html#ipqos-reference-tbl-6">Table 37-4</A>.</p>
</td></tr><tr><td valign="top"><p><tt>-f</tt><i>file-name</i></p></td><td valign="top"><p>Creates the file<i>file-name</i> to hold
the flow records.</p>
</td></tr><tr><td valign="top"><p><tt>flow</tt></p></td><td valign="top"><p>Indicates that <tt>acctadm</tt> is to be run with
IPQoS. </p>
</td></tr></table>
<A NAME="ipqos-reference-22"></A><h2>IPQoS Configuration File</h2>
<p><A NAME="indexterm-3192"></A>This section contains full details about the parts of the IPQoS
configuration file. The IPQoS boot-time activated policy is stored in the
file <tt>/etc/inet/ipqosinit.conf</tt>. Although you can edit
this file, the best practice for a new IPQoS system is to create a configuration
file with a different name. Tasks for applying and debugging an IPQoS configuration
are in <A HREF="p178.html#ipqos-policy-planning-1">Chapter&nbsp;34, Creating the IPQoS Configuration File (Tasks)</A>.</p>
<p>The syntax of the IPQoS configuration file is shown in <A HREF="p191.html#ipqos-reference-ex-23">Example 37-3</A>. The example
uses the following conventions:</p>
<ul><li><p><tt>computer-style type</tt>  -
Syntactical information that is provided to explain the parts of the configuration
file. You do not type any text that appears in computer-style type.</p>
</li>
<li><p><tt><b>bold type</b></tt> - Literal text that
you must type in the IPQoS configuration file. For example, you must always
begin the IPQoS configuration file with <tt><b>fmt_version</b></tt>.</p>
</li>
<li><p><A NAME="indexterm-3193"></A><i>italic type</i> - Variable text that
you replace with descriptive information about your configuration. For example,
you must always replace <i>action-name</i> or <i>module-name</i> with information that pertains to your configuration.</p>
</li>
</ul>
<A NAME="ipqos-reference-ex-23"></A><p><b>Example 37-3 </b>Syntax of the IPQoS Configuration
File</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>file_format_version ::= fmt_version <i>version</i>

action_clause ::= action {
     name <i>action-name</i>
     module <i>module-name</i>
     <i>params-clause</i> |  ""
     <i>cf-clauses</i>
}
action_name ::= <i>string</i>
module_name ::= ipgpc | dlcosmk | dscpmk | tswtclmt | tokenmt | flowacct 

params_clause ::= params { 
     <i>parameters</i>
     <i>params-stats</i> |   ""
     }
parameters ::=    <i>prm-name-value parameters</i> |  ""
prm_name_value ::= <i>param-name param-value</i>

params_stats ::= global-stats <i>boolean</i>

cf_clauses ::= <i>class-clause cf-clauses</i> |
               <i>filter-clause cf-clauses</i> | ""

class_clause ::= class {
     name <i>class-name</i>
     next_action <i>next-action-name</i>
     <i>class-stats</i> | ""
                 }
class_name  ::= <i>string</i>
next_action_name  ::= <i>string</i>
class_stats ::= enable_stats <i>boolean</i>
boolean ::= TRUE | FALSE

filter_clause ::= filter {
                name <i>filter-name</i>
                class <i>class-name</i>
                <i>parameters</i>
                }
filter_name ::= <i>string</i></pre>
</td></table><br><p>The remaining text describes each major part of the IPQoS configuration
file.</p>
<A NAME="ipqos-reference-240"></A><h3><tt>action</tt> Statement</h3>
<p><A NAME="indexterm-3194"></A><A NAME="indexterm-3195"></A>You use <tt>action</tt> statements to invoke the various
IPQoS modules that are described in <A HREF="p188.html#ipqos-reference-2">IPQoS Architecture and the Diffserv Model</A>. </p>
<p>When you create the IPQoS configuration file, you must always begin
with the version number. Then, you must add the following <tt>action</tt> statement
to invoke the classifier:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>fmt_version 1.0

action {
    module ipgpc
    name ipgpc.classify
}</pre>
</td></table><br><p>Follow the classifier <tt>action</tt> statement with a <tt>params</tt> clause or a <tt>class</tt> clause.</p>
<p><A NAME="indexterm-3196"></A>Use the following syntax for all other <tt>action</tt> statements:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>action {
name <i>action-name</i>
module <i>module-name</i>
<i>params-clause</i> | ""
<i>cf-clauses</i>
}</pre>
</td></table><br>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p190.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p192.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

