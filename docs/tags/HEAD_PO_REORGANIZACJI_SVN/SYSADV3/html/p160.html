<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p159.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p161.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="deploynetmult-56"></A><b>Chapter&nbsp;31</b><h1>Administering IPMP (Tasks)</h1>
<p>This chapter provides tasks for administering interface groups with
IP network multipathing (IPMP). The following major topics are discussed:</p>
<ul><li><p><A HREF="p160.html#deploynetmult-58">Configuring IPMP (Task Maps)</A></p>
</li>
<li><p><A HREF="p160.html#deploynetmult-57">Configuring IPMP Groups</A></p>
</li>
<li><p><A HREF="p163.html#enflg">Maintaining IPMP Groups</A></p>
</li>
<li><p><A HREF="p164.html#deploynetmult-92">Replacing a Failed Physical Interface on Systems That Support Dynamic Reconfiguration</A></p>
</li>
<li><p><A HREF="p165.html#deploynetmult-116">Recovering a Physical Interface That Was Not Present at System Boot</A></p>
</li>
<li><p><A HREF="p166.html#deploynetmult-47">Modifying IPMP Configurations</A></p>
</li>
</ul>
<p>For an overview of IPMP concepts, refer to <A HREF="p156.html#mpoverview">Chapter&nbsp;30, Introducing IPMP (Overview)</A>.</p>
<A NAME="deploynetmult-58"></A><h2>Configuring IPMP (Task Maps)</h2>
<p>This section contains links to the tasks that are described in this
chapter.</p>
<A NAME="espyw"></A><h3>Configuring and Administering IPMP Groups (Task Map)</h3>
<A NAME="indexterm-2917"></A>
<table cellspacing="5" border="1">
<tr><th scope="col"><p>Task</p></th><th scope="col"><p>Description</p></th><th scope="col"><p>For Instructions</p></th></tr>
<tr><td><p>Plan for an IPMP group.</p></td><td><p>Lists all ancillary information and required tasks before you can configure
an IPMP group.</p></td><td><p><A HREF="p160.html#emyil">How to Plan for an IPMP Group</A>&nbsp;</p></td></tr>
<tr><td><p>Configure an IPMP interface group with multiple interfaces.</p></td><td><p>Configures multiple interfaces as members of an IPMP group.</p></td><td><p><A HREF="p161.html#emqul">How to Configure an IPMP Group With Multiple Interfaces</A>&nbsp;</p></td></tr>
<tr><td><p>Configure an IPMP group where one of the interfaces is a standby interface.</p></td><td><p>Configures one of the interfaces in a multiple interface IPMP group
as a standby interface.</p></td><td><p><A HREF="p162.html#enfiu">How to Configure a Standby Interface for an IPMP Group</A>&nbsp;</p></td></tr>
<tr><td><p>Configure an IPMP group that consists of a single interface.</p></td><td><p>Creates a single interface IPMP group. </p></td><td><p><A HREF="p163.html#enfoy">How to Configure a Single Interface IPMP Group</A>&nbsp;</p></td></tr>
<tr><td><p>Display the IPMP group to which a physical interface belongs.</p></td><td><p>Explains how to obtain the name of an interface's IPMP group from the
output of the <tt>ifconfig</tt> command.</p></td><td><p><A HREF="p163.html#deploynetmult-6">How to Display the IPMP Group Membership of an Interface</A>&nbsp;</p></td></tr>
<tr><td><p>Add an interface to an IPMP group.</p></td><td><p>Configures a new interface as a member of an existing IPMP group.</p></td><td><p><A HREF="p163.html#deploynetmult-103">How to Add an Interface to an IPMP Group</A>&nbsp;</p></td></tr>
<tr><td><p>Remove an interface from an IPMP group.</p></td><td><p>Explains how to remove an interface from an IPMP group.</p></td><td><p><A HREF="p163.html#deploynetmult-7">How to Remove an Interface From an IPMP Group</A>&nbsp;</p></td></tr>
<tr><td><p>Move an interface from an existing IPMP group to a different group.</p></td><td><p>Moves interfaces among IPMP groups.</p></td><td><p><A HREF="p164.html#deploynetmult-8">How to Move an Interface From One IPMP Group to Another Group</A>&nbsp;</p></td></tr>
<tr><td><p>Change three default settings for the <tt>in.mpathd</tt> daemon.</p></td><td><p>Customizes failure detection time and other parameters of the <tt>in.mpathd</tt> daemon.</p></td><td><p><A HREF="p166.html#deploynetmult-48">How to Configure the <tt>/etc/default/mpathd</tt> File</A>&nbsp;</p></td></tr>
</table><A NAME="espyy"></A><h3>Administering IPMP on Interfaces That Support Dynamic
Reconfiguration (Task Map)</h3>
<A NAME="indexterm-2918"></A>
<table cellspacing="5" border="1">
<tr><th scope="col"><p>Task</p></th><th scope="col"><p>Description</p></th><th scope="col"><p>For Instructions</p></th></tr>
<tr><td><p>Remove an interface that has failed.</p></td><td><p>Removes a failed interface on a system.</p></td><td><p><A HREF="p164.html#deploynetmult-93">How to Remove a Physical Interface That Has Failed (DR-Detach)</A>&nbsp;</p></td></tr>
<tr><td><p>Replace an interface that has failed.</p></td><td><p>Replaces a failed interface.</p></td><td><p><A HREF="p164.html#deploynetmult-97">How to Replace a Physical Interface That Has Failed (DR-Attach)</A>&nbsp;</p></td></tr>
<tr><td><p>Recover an interface that was not configured at boot time.</p></td><td><p>Recovers a failed interface.</p></td><td><p><A HREF="p165.html#deploynetmult-107">How to Recover a Physical Interface That Was Not Present at System Boot</A>&nbsp;</p></td></tr>
</table><A NAME="deploynetmult-57"></A><h2>Configuring IPMP Groups</h2>
<p>This section provides procedures for configuring IPMP groups. It also
describes how to configure an interface as a standby.</p>
<A NAME="eoxzz"></A><h3>Planning for an IPMP Group</h3>
<p>Before you configure interfaces on a system as part of an IPMP group,
you need to do some preconfiguration planning. </p>
<A NAME="emyil"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Plan for an IPMP Group</h4>
<A NAME="indexterm-2919"></A><A NAME="indexterm-2920"></A><p>The following procedure includes the planning tasks and information
to be gathered prior to configuring the IPMP group. The tasks do not have
to be performed in sequence.</p>
<ol><li><p><b>Decide which interfaces on the system are to be part of the IPMP
group.</b></p><p>An IPMP group usually consists of at least two physical
interfaces that are connected to the same IP link. However, you can configure
a single interface IPMP group, if required. For an introduction to IPMP groups,
refer to <A HREF="p157.html#eobra">IPMP Interface Configurations</A>. For
example, you can configure the same Ethernet switch or the same IP subnet
 under the same IPMP group. You can configure any number of interfaces into
the same IPMP group.</p>
<p>You cannot use the <tt>group</tt> parameter
of the <tt>ifconfig</tt> command with logical interfaces. For example,
you can use the <tt>group</tt> parameter with <tt>hme0</tt>,
but not with <tt>hme0:1</tt>.</p>
</li>
<li><p><b>Verify that each interface in the group has a unique MAC address.</b></p><p>For instructions, refer to <A HREF="p161.html#mac11">SPARC: How to Ensure That the MAC Address of an Interface Is Unique, in Solaris 10 3/05 ONLY</A> or <A HREF="p27.html#eyprp">SPARC: How to Ensure That the MAC Address of an Interface Is Unique</A>.</p>
</li>
<li><p><b>Choose a name for the IPMP group.</b></p><p>Any non-null name
is appropriate for the group. You might want to use a name that identifies
the IP link to which the interfaces are attached.</p>
</li>
<li><p><b>Ensure that the same set of <tt>STREAMS</tt> modules
is pushed and configured on all interfaces in the IPMP group.</b></p><p>All
interfaces in the same group must have the same <tt>STREAMS</tt> modules
configured in the same order.</p>
<ol Type="a"><li><p><b>Check the order of STREAMS modules on all interfaces in the prospective
IPMP group.<A NAME="indexterm-2921"></A><A NAME="indexterm-2922"></A></b></p><p>You can print out a list of <tt>STREAMS</tt> modules
by using the <tt>ifconfig <i>interface</i> modlist</tt> command.
For example, here is the <tt>ifconfig</tt> output for an <tt>hme0</tt> interface:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig hme0 modlist</b></tt>
	0 arp
	1 ip
	2 hme</pre>
</td></table><br><p>Interfaces normally exist as network drivers directly below the IP module,
as shown in the output from <tt>ifconfig hme0 modlist</tt>. They
should not require additional configuration.</p>
<p>However, certain
technologies, such as NCA or IP Filter, insert themselves as STREAMS modules
between the IP module and the network driver. Problems can result in the way
interfaces of the same IPMP group behave.</p>
<p>If a STREAMS module
is stateful, then unexpected behavior can occur on failover, even if you push
the same module onto all of the interfaces in a group.  However, you can use
stateless STREAMS modules, provided that you push them in the same order on
all interfaces in the IPMP group.</p>
</li>
<li><p><b>Push the modules of an interface in the standard order for the
IPMP group.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre><tt><b>ifconfig</b></tt> <i>interface</i> <tt><b>modinsert</b></tt> <i>module-name</i></pre>
</td></table><br><table cellpadding="4" border="1" cols="1" width="100%"><td><pre>ifconfig hme0 modinsert ip</pre>
</td></table><br></li>
</ol>
</li>
<li><p><b>Use the same IP addressing format on all interfaces of the IPMP
group.</b></p><p>If one interface is configured for IPv4, then all interfaces
of the group must be configured for IPv4. Suppose you have an IPMP group that
is composed of interfaces from several NICs. If you add IPv6 addressing to
the interfaces of one NIC, then all interfaces in the IPMP group must be configured
for IPv6 support.<A NAME="indexterm-2923"></A><A NAME="indexterm-2924"></A><A NAME="indexterm-2925"></A><A NAME="indexterm-2926"></A><A NAME="indexterm-2927"></A><A NAME="indexterm-2928"></A></p>
</li>
<li><p><b>Check that all interfaces in the IPMP group are connected to the
same IP link.</b></p></li>
<li><p><b>Verify that the IPMP group does not contain interfaces with different
network media types.</b></p><p>The interfaces that are grouped together
should be of the same interface type, as defined in <tt>/usr/include/net/if_types.h</tt>. For example, you cannot combine Ethernet and Token ring interfaces
in an IPMP group. As another example, you cannot combine a Token bus interface
with asynchronous transfer mode (ATM) interfaces in the same IPMP group.</p>
</li>
<li><p><b>For IPMP with ATM interfaces, configure the ATM interfaces 	
in LAN emulation mode. </b></p><p>IPMP is not supported for interfaces using
Classical IP over ATM.</p>
</li>
</ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p159.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p161.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

