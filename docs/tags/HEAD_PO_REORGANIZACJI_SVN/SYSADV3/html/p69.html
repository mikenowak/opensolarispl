<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p68.html#chap2-26">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p68.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p70.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="chapter2-29"></A><h2>Making Decisions for Your DHCP Server Configuration
(Task Map)</h2>
<p>This section discusses some of the decisions to make before you configure
the first DHCP server on your network. Use this task map to identify the decisions
that you must make.</p>
<A NAME="indexterm-1376"></A>
<table cellspacing="5" border="1">
<tr><th scope="col"><p>Task</p></th><th scope="col"><p>Description</p></th><th scope="col"><p>For Instructions</p></th></tr>
<tr><td><p>Select a server for DHCP.</p></td><td><p>Determine if a server meets the system requirements to run the DHCP
service.</p></td><td><p><A HREF="p69.html#chapter2-38">Selecting a Host to Run the DHCP Service</A>&nbsp;</p></td></tr>
<tr><td><p>Choose a data store.</p></td><td><p>Compare the data store types to determine the best data store for your
site.</p></td><td><p><A HREF="p69.html#chapter2-39">Choosing the DHCP Data Store</A>&nbsp;</p></td></tr>
<tr><td><p>Set a lease policy.</p></td><td><p>Learn about IP address leases to help you determine appropriate lease
policy for your site.</p></td><td><p><A HREF="p69.html#chapter2-40">Setting a Lease Policy</A>&nbsp;</p></td></tr>
<tr><td><p>Select a router address or router discovery.</p></td><td><p>Determine whether DHCP clients use router discovery or a specific router.</p></td><td><p><A HREF="p69.html#chapter2-41">Determining Routers for DHCP Clients</A>&nbsp;</p></td></tr>
</table><A NAME="chapter2-38"></A><h3>Selecting a Host to Run the DHCP Service</h3>
<p><A NAME="indexterm-1377"></A>With your network topology in mind, you can use the following
system requirements to select a host on which to set up a DHCP server.</p>
<p>The host must meet the following requirements:</p><ul><li><p>The host must run the Solaris 2.6 release or later. If you
need to support a large number of clients, you must install the Solaris 8
7/01 release or a later version.</p>
</li>
<li><p>The host must be accessible to all the networks that have
clients that plan to use DHCP, either directly on the network or through a
BOOTP relay agent.</p>
</li>
<li><p>The host must be configured to use routing.</p>
</li>
<li><p>The host must have a correctly configured <tt>netmasks</tt> table
that reflects your network topology.</p>
</li>
</ul>
<A NAME="chapter2-39"></A><h3>Choosing the DHCP Data Store</h3>
<p><A NAME="indexterm-1378"></A>You can choose to store the DHCP data in text files, binary files,
or the NIS+ directory service. The following table summarizes the features
of each type of data store, and indicates the environment in which to use
each data store type.</p>
<A NAME="dhcp-plan-tbl-1"></A><p><b>Table 13-3 </b>Comparison of
DHCP Data Stores</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Data Store Type</p></th><th scope="col"><p>Performance</p></th><th scope="col"><p>Maintenance</p></th><th scope="col"><p>Sharing</p></th><th scope="col"><p>Environment</p></th></tr>
<tr><td><p>Binary files</p></td><td><p>High performance, high capacity</p></td><td><p>Low maintenance, no database servers required. Contents must be viewed
with DHCP Manager or <tt>dhtadm</tt> and <tt>pntadm</tt>.
Regular file backups suggested.</p></td><td><p>Data stores cannot be shared among DHCP servers.</p></td><td><p>Midsize to large environments with many networks with thousands of clients
per network. Useful for small to medium ISPs.</p></td></tr>
<tr><td><p>NIS+ </p></td><td><p>Moderate performance and capacity, dependent upon NIS+ service's performance
and capacity</p></td><td><p>DHCP server system must be configured as an NIS+ client. Requires NIS+
service maintenance. Contents must be viewed with DHCP Manager or <tt>dhtadm</tt> and <tt>pntadm</tt>. Regular backup with <tt>nisbackup</tt> is
suggested.</p></td><td><p>DHCP data is distributed in NIS+, and multiple servers can access the
same containers.</p></td><td><p>Small to midsize environments with up to 5000 clients per network.</p></td></tr>
<tr><td><p>Text files</p></td><td><p>Moderate performance, low capacity</p></td><td><p>Low maintenance, no database servers required. ASCII format is readable
without DHCP Manager, <tt>dhtadm</tt>, or <tt>pntadm</tt>.
Regular file backups suggested.</p></td><td><p>Data store can be shared among DHCP servers if DHCP data is stored on
one file system that is exported through an NFS mount point.</p></td><td><p>Small environments with less than 10,000 clients, with a few hundred
to a thousand clients per network.</p></td></tr>
</table><p>Traditional NIS is not offered as a data store option because NIS does
not support fast incremental updates. If your network uses NIS, you should
use text files or binary files for your data store.</p>
<A NAME="chapter2-40"></A><h3>Setting a Lease Policy</h3>
<p><A NAME="indexterm-1379"></A>A <b>lease</b> specifies the amount of time the
DHCP server permits a DHCP client to use a particular IP address. During the
initial server configuration, you must specify a site-wide lease policy. The <b>lease policy</b> indicates the lease time and specifies whether clients
can renew their leases. The server uses the information that you supply to
set option values in the default macros that the server creates during configuration.
You can set different lease policies for specific clients or type of clients,
by setting options in configuration macros you create.</p>
<p><A NAME="indexterm-1380"></A>The <b>lease time</b> is specified as a number of
hours, days, or weeks for which the lease is valid. When a client is assigned
an IP address, or renegotiates a lease on an IP address, the lease expiration
date and time is calculated. The number of hours in the lease time is added
to the timestamp on the client's DHCP acknowledgement. For example, suppose
the timestamp of the DHCP acknowledgment is September 16, 2005 9:15 A.M.,
and the lease time is 24 hours. The lease expiration time in this example
is September 17, 2005 9:15 A.M. The lease expiration time is stored in the
client's DHCP network record, viewable in DHCP Manager or with the <tt>pntadm</tt>utility.</p>
<p>The lease time value should be relatively small so that expired addresses
are reclaimed quickly. The lease time value also should be large enough to
outlast DHCP service disruptions. Clients should be able to function while
the system that runs the DHCP service is repaired. A general guideline is
to specify a time that is two times the predicted downtime of a system. For
example, if you need four hours to obtain and replace a defective part and
reboot the system, specify a lease time of eight hours.</p>
<p><A NAME="indexterm-1381"></A>The lease negotiation option determines whether a client can renegotiate
its lease with the server before the lease expires. If lease negotiation is
allowed, the client tracks the time that remains in its lease. When half of
the lease time has passed, the client requests the DHCP server to extend its
lease to the original lease time. You should disable lease negotiation in
environments where there are more systems than IP addresses. The time limit
is then enforced on the use of IP addresses. If there are enough IP addresses,
you should enable lease negotiation to avoid forcing clients to take down
their network interfaces when leases expire. If you make clients obtain new
leases, the clients' TCP connections such as NFS and telnet sessions might
be interrupted. You can enable lease negotiation for all clients during the
server configuration. You can enable lease negotiation for particular clients
or particular types of clients through the use of the <tt>LeaseNeg</tt> option
in configuration macros.</p>
<p><hr size="1" noshade><p><b>Note - </b>Systems that provide services on the network should retain their
IP addresses. Such systems should not be subject to short-term leases. You
can use DHCP with such systems if you assign reserved manual IP addresses
to those systems, rather than IP addresses with permanent leases. You can
then detect when the system's IP address is no longer in use.</p>
<hr size="1" noshade></p><A NAME="chapter2-41"></A><h3>Determining Routers for DHCP Clients</h3>
<p><A NAME="indexterm-1382"></A>Host systems use routers for any network communication beyond
their local network. The hosts must know the IP addresses of these routers.</p>
<p>When you configure a DHCP server, you must provide DHCP clients with
router addresses in one of two ways. One way is to provide specific IP addresses
for routers. However, the preferred method is to specify that clients should
find routers with the router discovery protocol.</p>
<p>If clients on your network can perform router discovery, you should
use the router discovery protocol, even if there is only one router. Router
discovery enables a client to adapt easily to router changes in the network.
For example, suppose that a router fails and is replaced by a router with
a new address. Clients can discover the new address automatically without
having to obtain a new network configuration to get the new router address.</p>
<A NAME="chapter2-30"></A><h2>Making Decisions for IP Address Management
(Task Map)</h2>
<p><A NAME="indexterm-1383"></A>As part of the DHCP service setup, you determine several aspects
of the IP addresses that the server is to manage. If your network needs more
than one DHCP server, you can assign responsibility for some IP addresses
to each server. You must decide how to divide responsibility for the addresses.
The following task map can help you make IP address management decisions.</p>
<A NAME="indexterm-1384"></A>
<table cellspacing="5" border="1">
<tr><th scope="col"><p>Task</p></th><th scope="col"><p>Description</p></th><th scope="col"><p>For Information</p></th></tr>
<tr><td><p>Specify which addresses that the server should manage.</p></td><td><p>Determine how many addresses you want the DHCP server to manage, and
what those addresses are.</p></td><td><p><A HREF="p69.html#chapter2-31">Number and Ranges of IP Addresses</A>&nbsp;</p></td></tr>
<tr><td><p>Decide if the server should automatically generate host names for clients.</p></td><td><p>Learn how client host names are generated so that you can decide whether
to generate host names.</p></td><td><p><A HREF="p69.html#chapter2-32">Client Host Name Generation</A>&nbsp;</p></td></tr>
<tr><td><p>Determine what configuration macro to assign to clients.</p></td><td><p>Learn about client configuration macros so that you can select an appropriate
macro for clients.</p></td><td><p><A HREF="p69.html#chapter2-33">Default Client Configuration Macros</A>&nbsp;</p></td></tr>
<tr><td><p>Determine lease types to use.</p></td><td><p>Learn about lease types to help you determine what type is best for
your DHCP clients.</p></td><td><p><A HREF="p69.html#chapter2-22">Dynamic and Permanent Lease Types</A>&nbsp;</p></td></tr>
</table><A NAME="chapter2-31"></A><h3>Number and Ranges of IP Addresses</h3>
<p>During the initial server configuration, DHCP Manager allows you to
add one block, or range, of IP addresses under DHCP management by specifying
the total number of addresses and the first address in the block. DHCP Manager
adds a list of contiguous addresses from this information. If you have several
blocks of noncontiguous addresses, you can add the others by running DHCP
Manager's Address Wizard again, after the initial configuration.</p>
<p>Before you configure your IP addresses, know how many addresses are
in the initial block of addresses you want to add and the IP address of the
first address in the range.</p>
<A NAME="chapter2-32"></A><h3>Client Host Name Generation</h3>
<p><A NAME="indexterm-1385"></A>The dynamic nature of DHCP means that an IP address is not permanently
associated with the host name of the system that is using it. The DHCP management
tools can generate a client name to associate with each IP address if you
select this option. The client names consist of a prefix, or root name, plus
a dash and a number assigned by the server. For example, if the root name
is <tt>charlie</tt>, the client names are <tt>charlie-1</tt>, <tt>charlie-2</tt>, <tt>charlie-3</tt>, and so on.</p>
<p>By default, generated client names begin with the name of the DHCP server
that manages them. This strategy is useful in environments that have more
than one DHCP server because you can quickly see in the DHCP network tables
which clients any given DHCP server manages. However, you can change the root
name to any name you choose.</p>
<p>Before you configure your IP addresses, decide if you want the DHCP
management tools to generate client names, and if so, what root name to use
for the names.</p>
<p>The generated client names can be mapped to IP addresses in <tt>/etc/inet/hosts</tt>, DNS, or NIS+ if you specify to register host names during DHCP
configuration. See <A HREF="p77.html#dhcp-overview-5sm">Client Host Name Registration</A> for more information.</p>
<A NAME="chapter2-33"></A><h3>Default Client Configuration Macros</h3>
<p><A NAME="indexterm-1386"></A>In Solaris DHCP, a <b>macro</b> is a collection
of network configuration options and their assigned values. The DHCP server
uses macros to determine what network configuration information to send to
a DHCP client.</p>
<p>When you configure the DHCP server, the management tools gather information
from system files and directly from you through prompts or command-line options
you specify. With this information, the management tools create the following
macros:</p><ul><li><p><b>Network address macro</b> --
The network address macro is named to match the IP address of the client network.
For example, if the network is <tt>192.68.0.0</tt>, the network
address macro is also named <tt>192.68.0.0</tt>. The macro contains
information needed by any client that is part of the network, such as subnet
mask, network broadcast address, default router or router discovery token,
and NIS/NIS+ domain and server if the server uses NIS/NIS+. Other options
that are applicable to your network might be included. The network address
macro is automatically processed for all clients located on that network,
as described in <A HREF="p67.html#dhcp-overview-10">Order of Macro Processing</A>.</p>
</li>
<li><p><b>Locale macro</b> -- The
locale macro is named <tt>Locale</tt>. The macro contains the offset
(in seconds) from Coordinated Universal Time (UTC) to specify the time zone.
The locale macro is not automatically processed, but is included in the server
macro.</p>
</li>
<li><p><b>Server macro</b> -- The
server macro is named to match the server's host name. For example, if the
server is named <tt>pineola</tt>, the server macro is also named <tt>pineola</tt>. The server macro contains information about the lease policy,
time server, DNS domain, and DNS server, and possibly other information that
the configuration program was able to obtain from system files. The server
macro includes the locale macro, so the DHCP server processes the locale macro
as part of the server macro.</p>
<p>When you configure IP addresses for
the first network, you must select a client configuration macro to be used
for all DHCP clients that use the addresses you are configuring. The macro
that you select is mapped to the IP addresses. By default, the server macro
is selected because the macro contains information needed by all clients that
use this server.</p>
</li>
</ul>
<p>Clients receive the options contained in the network address macro before
the options in the macro that is mapped to IP addresses. This processing order
causes the options in the server macro to take precedence over any conflicting
options in the network address macro. See <A HREF="p67.html#dhcp-overview-10">Order of Macro Processing</A> for more information about the order in which
macros are processed.</p>
<A NAME="chapter2-22"></A><h3>Dynamic and Permanent Lease Types</h3>
<p><A NAME="indexterm-1387"></A>The <b>lease type</b> determines whether the lease
policy applies to the IP addresses you are configuring. During initial server
configuration, DHCP Manager allows you to select either dynamic or permanent
leases for the addresses you are adding. If you configure the DHCP server
with the <tt>dhcpconfig</tt> command, leases are dynamic.</p>
<p>When an IP address has a <b>dynamic lease</b>, the DHCP
server can manage the address. The DHCP server can allocate the IP address
to a client, extend the lease time, detect when the address is no longer in
use, and reclaim the address. When an IP address has a <b>permanent
lease</b>, the DHCP server can only allocate the address. The client
then owns the address until explicitly releasing the address. When the address
is released, the server can assign the address to another client. The address
is not subject to the lease policy as long as the address is configured with
a permanent lease type.</p>
<p>When you configure a range of IP addresses, the lease type you select
applies to all the addresses in the range. To get the most benefit from DHCP,
you should use dynamic leases for most of the addresses. You can later modify
individual addresses to make them permanent, if necessary. However, the total
number of permanent leases should be kept to a minimum.</p>
<A NAME="dhcp-plan-4"></A><h3>Reserved IP Addresses and Lease Type</h3>
<p><A NAME="indexterm-1388"></A>IP addresses can be reserved by manually assigning them to particular
clients. A reserved address can be associated with a permanent lease or a
dynamic lease. When a reserved address is assigned a permanent lease, the
following statements are true:</p><ul><li><p>The address can be allocated only to the client that is bound
to the address.</p>
</li>
<li><p>The DHCP server cannot allocate the address to another client.</p>
</li>
<li><p>The address cannot be reclaimed by the DHCP server.</p>
</li>
</ul>
<p>If a reserved address is assigned a dynamic lease, the address can be
allocated only to the client that is bound to the address. However, the client
must track lease time and negotiate for a lease extension as if the address
were not reserved. This strategy enables you to track when the client is using
the address by looking at the network table.</p>
<p>You cannot create reserved addresses for all the IP addresses during
the initial configuration. Reserved addresses are intended to be used sparingly
for individual addresses.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p68.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p70.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

