<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Resource Controls - Solaris Containers: Resource Management and Solaris Zones Developer's Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >Solaris Containers: Resource Management and Solaris Zones Developer's Guide<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p13.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p15.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="resource-ctrls-8"></a>Chapter&nbsp;5<h3>Resource Controls</h3><p>This chapter describes resource controls and their properties.</p>
<ul><li><p><a href="p14.html#resource-ctrls-9">Overview of Resource Controls</a></p>
</li>
<li><p><a href="p14.html#resource-ctrls-1">Resource Controls Flags and Actions</a></p>
</li>
<li><p><a href="p17.html#resource-ctrls-13">Resource Controls API Functions</a></p>
</li>
<li><p><a href="p18.html">Resource Control Code Examples</a></p>
</li>
<li><p><a href="p18.html#resource-ctrls-19">Programming Issues Associated With Resource Controls</a></p>
</li>
</ul>
<a name="resource-ctrls-9"></a><h3>Overview of Resource Controls</h3>
<p>Use the extended accounting facility to determine the resource consumption
of workloads on your system. After the resource consumption has been determined,
use the resource control facility to place bounds on resource usage. Bounds
that are placed on resources prevent workloads from over-consuming resources.</p>
<p>For an overview of resource controls and example commands for administering
resource controls, see Chapter
6, Resource Controls (Overview), in <i>System Administration Guide: Solaris Containers-Resource Management
and Solaris Zones</i> and Chapter 7, Administering
Resource Controls (Tasks), in <i>System Administration
Guide: Solaris Containers-Resource Management and Solaris Zones</i>.</p>
<p>The resource control facility adds the following benefits.</p>
<ul><li><p><tt><b>Dynamically set</b></tt></p>
<p>Resource
controls can be adjusted while the system is running.</p>
</li>
<li><p><tt><b>Containment level granularity</b></tt></p>
<p>Resource controls are arranged in a containment level of zone, project,
task, or process. The containment level simplifies the configuration and aligns
the collected values closer to the particular zone, project, task, or process.</p>
</li>
</ul>
<a name="resource-ctrls-1"></a><h3>Resource Controls Flags and Actions</h3>
<p>This section describes flags, actions, and signals associated with resource
controls.</p>
<a name="faayq"></a><h4><tt>rlimit</tt>, Resource Limit</h4>
<p><tt>rlimit</tt> is process-based. <tt>rlimit</tt> establishes
a restricting boundary on the consumption of a variety of system resources
by a process. Each process that the process creates inherits from the original
process. A resource limit is defined by a pair of values. The values specify
the current (soft) limit and the maximum (hard) limit. </p>
<p>A process might irreversibly lower its hard limit to any value that
is greater than or equal to the soft limit. Only a process with superuser
ID can raise the hard limit. See <tt>setrlimit()</tt> and <tt>getrlimit()</tt>.</p>
<p>The <tt>rlimit</tt> structure contains two members that
define the soft limit and hard limit.</p>
<pre>rlim_t     rlim_cur;       /* current (soft) limit */
rlim_t     rlim_max        /* hard limit */</pre><a name="resource-ctrls-6"></a><h4><tt>rctl</tt>, Resource Control</h4>
<p><tt>rctl</tt> extends the process-based limits of <tt>rlimit</tt> by controlling resource consumption by processes, tasks, and projects
defined in the project database.</p>
<hr>
<p><b>Note - </b>The <tt>rctl</tt> mechanism is preferred to the use
of <tt>rlimit</tt> to set resource limits. The only reason to use
the <tt>rlimit</tt> facility is when portability is required across
UNIX platforms.</p>
<hr>
<p>Applications fall into the following broad categories depending on how
an application deals with resource controls. Based on the action that is taken,
resource controls can be further classified. Most report an error and terminate
operation. Other resource controls allow applications to resume operation
and adapt to the reduced resource usage. A progressive chain of actions at
increasing values can be specified for each resource control.</p>
<p>The list of attributes for a resource control consists of a privilege
level, a threshold value, and an action that is taken when the threshold is
exceeded.</p>
<a name="resource-ctrls-4"></a><h4>Resource Control Values and Privilege
Levels</h4>
<p><a name="indexterm-25"></a>Each threshold value on a resource control must
be associated with one of the following privilege levels:</p>
<dl><dt>RCPRIV_BASIC</dt>
<dd><p>Privilege level can be modified by the owner of the calling
process. RCPRIV_BASIC is associated with a resource's soft limit.</p>
</dd>
<dt>RCPRIV_PRIVILEGED</dt>
<dd><p>Privilege level can be modified only by privileged (superuser)
callers. RCPRIV_PRIVILEGED is associated with a resource's hard limit.</p>
</dd>
<dt>RCPRIV_SYSTEM</dt>
<dd><p>Privilege level remains fixed for the duration of the operating
system instance.</p>
</dd>
</dl>
<p><a href="p17.html#resource-ctrls-fig-25">Figure 5-2</a> shows
the timeline for setting privilege levels for signals that are defined by
the <tt>/etc/project</tt> file <tt>process.max-cpu-time</tt> resource
control.</p>
<a name="resource-ctrls-2"></a><h4>Local Actions and Local Flags</h4>
<p><a name="indexterm-26"></a><a name="indexterm-27"></a>The local action and local flags are applied to
the current resource control value represented by this resource control block.
Local actions and local flags are value-specific. For each threshold value
that is placed on a resource control, the following local actions and local
flags are available:</p>
<dl><dt>RCTL_LOCAL_NOACTION</dt>
<dd><p>No local action is taken when this resource control value
is exceeded.</p>
</dd>
<dt>RCTL_LOCAL_SIGNAL</dt>
<dd><p>The specified signal, set by <tt>rctlblk_set_local_action()</tt>,
is sent to the process that placed this resource control  value in the value
sequence.</p>
</dd>
<dt>RCTL_LOCAL_DENY</dt>
<dd><p>When this resource control value is encountered, the request
for the resource is denied. Set on all values if RCTL_GLOBAL_DENY_ALWAYS is
set for this control. Cleared on all values if RCTL_GLOBAL_DENY_NEVER is set
for this control.</p>
</dd>
<dt>RCTL_LOCAL_MAXIMAL</dt>
<dd><p>This resource control value represents a request for the maximum
amount of resource for this control. If RCTL_GLOBAL_INFINITE is set for this
resource control, RCTL_LOCAL_MAXIMAL indicates an unlimited resource control
value that is never exceeded.</p>
</dd>
</dl>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p13.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p15.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

