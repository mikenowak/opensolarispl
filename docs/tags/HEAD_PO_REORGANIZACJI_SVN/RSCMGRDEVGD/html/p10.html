<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Using the Perl Interface
to Extended Accounting - Solaris Containers: Resource Management and Solaris Zones Developer's Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >Solaris Containers: Resource Management and Solaris Zones Developer's Guide<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p9.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p11.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="extacctg-perl-1"></a>Chapter&nbsp;4<h3>Using the Perl Interface
to Extended Accounting</h3><p>The Perl interface provides a Perl binding to the extended accounting
tasks and projects. The interface allows the accounting files produced by
the <tt>exacct</tt> framework to be read by Perl scripts. The interface
also allows the writing of <tt>exacct</tt> files by Perl scripts.</p>
<p>This chapter includes the following topics:</p>
<ul><li><p><a href="p10.html#extacctg-perl-66">Extended Accounting Overview</a></p>
</li>
<li><p><a href="p13.html#extacctg-perl-20">Perl Code Examples</a></p>
</li>
<li><p><a href="p13.html#extacctg-perl-21">Output From <tt>dump</tt> Method</a></p>
</li>
</ul>
<a name="extacctg-perl-66"></a><h3>Extended Accounting Overview</h3>
<p>The <tt>exacct</tt> is a new accounting framework for the
Solaris operating system provides additional functionality to that provided
by the traditional SVR4 accounting mechanism. Traditional SVR4 accounting
has these drawbacks:</p>
<ul><li><p>The data collected by SVR4 accounting cannot be modified.</p>
<p>The type or quantity of statistics SVR4 accounting gathers cannot be
customized for each application. Changes to the data SVR4 accounting collects
would not work with all of the existing applications that use the accounting
files.</p>
</li>
<li><p>The SVR4 accounting mechanism is not open.</p>
<p>Applications
cannot embed their own data in the system accounting data stream.</p>
</li>
<li><p>The SVR4 accounting mechanism has no aggregation facilities.</p>
<p>The Solaris Operating system writes an individual record for each process
that exists. No facilities are provided for grouping sets of accounting records
into higher-level aggregates. </p>
</li>
</ul>
<p>The <tt>exacct</tt> framework addresses the limitations of
SVR4 accounting and provides a configurable, open, and extensible framework
for the collection of accounting data. </p>
<ul><li><p>The data that is collected can be configured using the <tt>exacct</tt> API.</p>
</li>
<li><p>Applications can either embed their own data inside the system
accounting files, or create and manipulate their own custom accounting files.</p>
</li>
<li><p>The lack of data aggregation facilities in the traditional
accounting mechanism are addressed by <b>tasks</b> and <b>projects</b>. Tasks identify a set of processes that are to be considered as
a unit of work. Projects allow the processes executed by a set of users to
be aggregated into a higher-level entity. See the<tt>project</tt>(4) man page for more details
about tasks and projects.</p>
</li>
</ul>
<p>For a more extensive overview of extended accounting, see Chapter 4, Extended Accounting (Overview), in <i>System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</i>.</p>
<a name="feaem"></a><h3>Perl Interface to <tt>libexacct</tt></h3>
<a name="extacctg-perl-6"></a><h4>Object Model</h4>
<p>The <tt>Sun::Solaris::Exacct</tt> module is the parent of
all the classes provided by <tt>libexacct</tt>(3LIB) library. <tt>libexacct</tt>(3LIB) provides operations on types of entities: <tt>exacct</tt> format files, <tt>catalog</tt> tags and <tt>exacct</tt> objects. <tt>exacct</tt> objects are subdivided into two types.</p>
<ul><li><p>Items</p>
<p>Single data values</p>
</li>
<li><p>Groups</p>
<p>Lists of items</p>
</li>
</ul>
<a name="extacctg-perl-3"></a><h4>Benefits of Using the Perl Interface to <tt>libexacct</tt></h4>
<p><a name="indexterm-19"></a>The Perl extensions to extended accounting provide a Perl interface
to the underlying <tt>libexacct</tt>(3LIB) API and offer the following
enhancements. </p>
<ul><li><p>Full equivalence to C API provide a Perl interface that is
functionally equivalent to the underlying C API.</p>
<p>The interface
provides a mechanism for accessing <tt>exacct</tt> files that does
not require C coding. All the functionality that is available from C is also
available by using the Perl interface.</p>
</li>
<li><p>Ease of use.</p>
<p>Data obtained from the underlying
C API is presented as Perl data types. Perl data types ease access to the
data and remove the need for buffer pack and unpack operations.</p>
</li>
<li><p>Automated memory management.</p>
<p>The C API requires
that the programmer take responsibility for managing memory when accessing <tt>exacct</tt> files. Memory management takes the form of passing the appropriate
flags to functions, such as <tt>ea_unpack_object</tt>(3EXACCT),
and explicitly allocating buffers to pass to the API. The Perl API removes
these requirements, as all memory management is performed by the Perl library.</p>
</li>
<li><p>Prevent incorrect use of API.</p>
<p>The <tt>ea_object_t</tt> structure provides the in-memory representation of <tt>exacct</tt> records.
The <tt>ea_object_t</tt> structure is a union type that is
used for manipulating both Group and Item records. As a result, an incorrectly
typed structure can be passed to some of the API functions. The addition of
a class hierarchy prevents this type of programming error.</p>
</li>
</ul>
<a name="extacctg-perl-64"></a><h4>Perl Double-Typed Scalars</h4>
<p>The modules described in this document make extensive use of the Perl
double-typed scalar facility. The <b>double-typed scalar</b> facility
allows a scalar value to behave either as an integer or as a string, depending
upon the context. This behavior is the same as exhibited by the <tt>$!</tt> Perl
variable (<tt>errno</tt>). The double-typed scalar facility avoids
the need to map from an integer value into the corresponding string in order
to display a value. The following example illustrates the use of double-typed
scalars.</p>
<pre># Assume $obj is a Sun::Solaris::Item
my $type = $obj->type();

# prints out "2 EO_ITEM"
printf("%d %s\n", $type, $type);

# Behaves as an integer, $i == 2
my $i = 0 + $type;

# Behaves as a string, $s = "abc EO_ITEM xyx"
my $s = "abc $type xyz";</pre>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p9.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p11.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

