<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Managing Label Encodings (Task Map)</title><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="Solaris Trusted Extensions Label Administration"><link rel="up" href="ch03.html" title="Chapter 3. Making a Label Encodings File (Tasks)"><link rel="prev" href="ch03.html" title="Chapter 3. Making a Label Encodings File (Tasks)"><link rel="next" href="ch04.html" title="Chapter 4. Labeling Printer Output (Tasks)"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Managing Label Encodings (Task Map)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch03.html">Prev</a> </td><th width="60%" align="center">Chapter 3. Making a Label Encodings File (Tasks)</th><td width="20%" align="right"> <a accesskey="n" href="ch04.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="modifyenc-30"></a>Managing Label Encodings (Task Map)</h2></div></div></div>

<a class="indexterm" name="indexterm-188"></a>
<a class="indexterm" name="indexterm-189"></a>
<div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Caution</h3>

<p>The safest time to modify a <code class="filename">label_encodings</code> file
is when the first host is installed. Proceed with caution when modifying a
file that is in use. For details, see the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">label_encodings</span>
(
4
)
</span>
</span> man page.</p>
</div>
<div class="informaltable">
<table border="1"><colgroup><col><col></colgroup><thead><tr><th>
<p>Task</p>
</th><th>
<p>For Instructions</p>
</th></tr></thead><tbody><tr><td>
<p>Create or change the <code class="filename">label_encodings</code> file</p>
</td><td>
<p>
<span class="olink">How to Create a <code class="filename">label_encodings</code> File</span>
</p>
</td></tr><tr><td>
<p>Test the <code class="filename">label_encodings</code> file</p>
</td><td>
<p>
<span class="olink">How to Analyze and Verify the <code class="filename">label_encodings</code> File</span>
</p>
</td></tr><tr><td>
<p>Distribute the <code class="filename">label_encodings</code> file</p>
</td><td>
<p>
<span class="olink">How to Distribute the <code class="filename">label_encodings</code> File</span>
</p>
</td></tr><tr><td>
<p>Debug a <code class="filename">label_encodings</code> file</p>
</td><td>
<p>
<span class="olink">How to Debug a <code class="filename">label_encodings</code> File</span>
</p>
</td></tr><tr><td>
<p>Change a classification definition</p>
</td><td>
<p>
<span class="olink">How to Add or Rename a Classification</span>
</p>
</td></tr><tr><td>
<p>Create default or inverse words</p>
</td><td>
<p>
<span class="olink">How to Specify Default and Inverse Words</span>
</p>
</td></tr><tr><td>
<p>Customize a single-label file</p>
</td><td>
<p>
<span class="olink">How to Create a Single-Label Encodings File</span>
</p>
</td></tr><tr><td>
<p>Specify a label name</p>
</td><td>
<p>
<span class="olink">Example 3&#8211;9</span>
</p>
</td></tr><tr><td>
<p>Add a <code class="literal">LOCAL DEFINITIONS</code> section</p>
</td><td>
<p>
<span class="olink">How to Add Sun Extensions to an Encodings File</span>
</p>
</td></tr><tr><td>
<p>Prevent specific users from seeing labels</p>
</td><td>
<p>
<span class="olink">
<em class="citetitle">How to Hide Labels From a User</em> in <em class="citetitle">Solaris Trusted Extensions Administrator&#8217;s Procedures</em>
</span>
</p>
</td></tr><tr><td>
<p>Prevent all users of a particular system from seeing labels</p>
</td><td>
<p>
<span class="olink">
<em class="citetitle">How to Modify policy.conf Defaults</em> in <em class="citetitle">Solaris Trusted Extensions Administrator&#8217;s Procedures</em>
</span>
</p>
</td></tr></tbody></table>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1626452"></a></h3></div></div></div>

<div class="task"><a name="modifyenc-22"></a><p class="title"><b>How to Create a <code class="filename">label_encodings</code> File</b></p><div class="tasksummary">
<p>For sample files, see the <code class="filename">/etc/security/tsol</code> directory
on an installed system. The files are described in.<span class="olink">Labels Files in Solaris Trusted Extensions Packages</span>.</p>
</div><div class="taskprerequisites">

<p>You can create this file before you install Trusted Extensions on your first
system. On that first system, you check the file. You can also create this
file on the first system that you install with Trusted Extensions. This procedure
must be completed before a second computer is configured with Trusted Extensions.</p>
<p>On a system that is configured with Trusted Extensions, you must be in the
global zone in the Security Administrator role. On other systems, you can
create and edit the file in any editor.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Create a backup copy of the original file.</p>
</li><li>
<p>Open a new or existing version of the file.</p>
<ul>
<li>
<p>On a system that is not configured with Trusted Extensions, use any
editor to create the file.</p>
</li>
<li>
<p>On a system that is configured with Trusted Extensions, use the Edit
Encodings action to create the file.</p>
<p>In CDE, the Trusted_Extensions
folder in the Application Manager contains two actions for the encodings file.</p>
<div class="variablelist"><dl><dt><span class="term">Edit Encodings</span></dt><dd>
<p>Edits and checks the syntax of the specified <code class="filename">label_encodings</code> file.</p>
</dd><dt><span class="term">Check Encodings</span></dt><dd>
<p>Checks the syntax of a specified <code class="filename">label_encodings</code> file.</p>
</dd></dl></div>
</li>
</ul>
</li><li>
<p>Modify the file.</p>
<p>For details, see <span class="olink">How to Plan the Encodings File</span>.</p>
</li><li>
<p>Continue with <span class="olink">How to Analyze and Verify the <code class="filename">label_encodings</code> File</span>.</p>
</li></ol></div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1626664"></a></h3></div></div></div>

<div class="task"><a name="modifyenc-24"></a><p class="title"><b>How to Analyze and Verify the <code class="filename">label_encodings</code> File</b></p><div class="taskprerequisites">

<p>You must be in the global zone in the Security Administrator role.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Check the syntax and relationships of the labels.</p>
<p>In
a terminal, use the <span><strong class="command">chk_encodings -a</strong></span> command to analyze
and report on label relationships.</p>
<pre class="screen">$ chk_encodings -a <em class="replaceable"><code>encodings-file</code></em>
</pre>
</li><li>
<p>Verify the file.</p>
<p>The Check Encodings action runs the <span><strong class="command">chk_encodings</strong></span> command on the specified file.</p>
<ul>
<li>
<p>If the file passes, install it.</p>
<pre class="screen">Do you want to install this label_encodings file? <strong class="userinput"><code>yes</code></strong>
</pre>
</li>
<li>
<p>If the file does not pass, see <span class="olink">How to Debug a <code class="filename">label_encodings</code> File</span> for assistance.</p>
</li>
</ul>
</li><li>
<p>Test the encodings file.</p>
<p>Where possible, test the
file on a few systems before approving the file for all systems at your site.</p>
</li><li>
<p>Create a master copy.</p>
<p>For copying instructions, see <span class="olink">
<em class="citetitle">How to Copy Files to Portable Media</em> in <em class="citetitle">Solaris Trusted Extensions Installation and Configuration</em>
</span>.</p>
</li><li>
<p>Save a labeled copy of the file in a protected location.</p>
</li></ol></div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1626889"></a></h3></div></div></div>

<div class="task"><a name="modifyenc-48"></a><p class="title"><b>How to Distribute the <code class="filename">label_encodings</code> File</b></p><div class="procedure"><ol type="1"><li>
<p>Create a master copy.</p>
<p>For copying instructions, see <span class="olink">
<em class="citetitle">How to Copy Files to Portable Media</em> in <em class="citetitle">Solaris Trusted Extensions Installation and Configuration</em>
</span>.</p>
</li><li>
<p>Immediately after installing a system with Trusted Extensions, copy
the master file onto the system.</p>
<p>For copying instructions, see <span class="olink">
<em class="citetitle">How to Copy Files From Portable Media</em> in <em class="citetitle">Solaris Trusted Extensions Installation and Configuration</em>
</span>.</p>
</li></ol></div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1626982"></a></h3></div></div></div>

<div class="task"><a name="modifyenc-71"></a><p class="title"><b>How to Add or Rename a Classification</b></p><div class="taskprerequisites">

<p>You must be in the Security Administrator role in the global zone.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Edit the <code class="filename">label_encodings</code> file.</p>
<p>Use
the Edit Encodings action. For details, see <span class="olink">How to Create a <code class="filename">label_encodings</code> File</span>.</p>
</li><li>
<p>Specify a version number.</p>
<p>In the <code class="literal">VERSION=</code> section
put your site's name, a title for the file, a version number and the date.</p>
<pre class="screen">VERSION= Sun Microsystems, Inc. Example Version - 5.10 04/05/28</pre>
<p>Sun uses SCCS keywords for the version number and the date. For details,
see the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">sccs</span>
(
1
)
</span>
</span> man
page.</p>
<pre class="screen">VERSION= Sun Microsystems, Inc. Example Version - %I% %E%</pre>
</li><li>
<p>Specify the classification.</p>
<p>In the <code class="literal">CLASSIFICATIONS</code> section, supply the long name, short name, and numeric value for
the new classification.</p>
<pre class="screen">name= NEW_CLASS; sname= N; value= 2; </pre>
</li><li>
<p>Include the new classification in the accreditation range.</p>
<p>Add the new classification to the <code class="literal">ACCREDITATION RANGE</code> section.</p>
<p>The following example shows three new classifications added to
the <code class="literal">ACCREDITATION RANGE</code> section. Each classification is
specified with <code class="literal">all compartment combinations valid</code>.</p>
<pre class="screen">ACCREDITATION RANGE:

classification= UNCLASSIFIED;        all compartment combinations valid;

* i is new in this file
classification= INTERNAL_USE_ONLY;   all compartment combinations valid;

* n is new in this file
classification= NEED_TO_KNOW;        all compartment combinations valid;

classification= CONFIDENTIAL;        all compartment combinations valid except:
c
c a
c b

classification= SECRET;               only valid compartment combinations:
. . .
* r is new in this file
classification= REGISTERED;           all compartment combinations valid;</pre>
</li><li>
<p>
<a class="indexterm" name="indexterm-190"></a>Adjust the  <code class="literal">ACCREDITATION RANGE</code> section if
necessary.</p>
<p>You might need to make the new classification a minimum
classification.</p>
<pre class="screen">minimum clearance= u; 
minimum sensitivity label= u; 
minimum protect as classification= u;</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>Make sure that you set a minimum clearance that is dominated by
all the clearances that you plan to assign to users. Similarly, make sure
that the minimum sensitivity label is dominated by all the minimum labels
that you plan to assign to users.</p>
</div>
</li><li>
<p>Save your changes.</p>
</li></ol></div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1627268"></a></h3></div></div></div>

<div class="task"><a name="modifyenc-26"></a><p class="title"><b>How to Specify Default and Inverse Words</b></p><div class="taskprerequisites">

<p>You must be in the Security Administrator role in the global zone.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Edit the <code class="filename">label_encodings</code> file.</p>
<p>Use
the Edit Encodings action. For details, see <span class="olink">How to Create a <code class="filename">label_encodings</code> File</span>.</p>
</li><li>
<p>Specify initial compartments.</p>
<p>In the <code class="literal">CLASSIFICATIONS</code> section, specify compartments as part of the classification definition.</p>
<pre class="screen">CLASSIFICATIONS:
name= PUBLIC;  sname= P;  value= 1;
name= WEB COMPANY;  sname= WEBCO;  value= 2; initial compartments= 4-5 ;</pre>
</li><li>
<p>Specify a default word.</p>
<p>Assign an initial compartment
bit to the word.</p>
<pre class="screen">name= DIVISION ONLY;  sname= DO;  minclass=  IUO; compartments= 4-5;
name= WEBC AMERICA;  sname= WEBCA; minclass= IUO; compartments= 4;
name= WEBC WORLD;  sname= WEBCW; minclass= IUO; compartments= 5;</pre>
</li><li>
<p>Specify an inverse word.</p>
<p>Inverse words are created
by preceding an initial compartment with a tilde (~).</p>
<pre class="screen">name= DIVISION ONLY;  sname= DO;  minclass=  IUO; compartments= 4-5;
name= WEBC AMERICA;  sname= WEBCA; minclass= IUO; compartments= <strong class="userinput"><code>~4</code></strong>;
name= WEBC WORLD;  sname= WEBCW; minclass= IUO; compartments= <strong class="userinput"><code>~5</code></strong>;</pre>
</li><li>
<p>Save your changes.</p>
</li></ol></div><div class="taskrelated">

<div class="itemizedlist"><p>For any compartment bits that are not reserved for later assignment,
you need to assign a word to the bit in the following sections:</p><ul type="disc"><li>
<p>
<code class="literal">SENSITIVITY LABELS: WORDS:</code>
</p>
</li><li>
<p>
<code class="literal">INFORMATION LABELS: WORDS:</code>
</p>
</li><li>
<p>
<code class="literal">COMPARTMENTS: WORDS:</code>
</p>
</li></ul></div>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1627500"></a></h3></div></div></div>

<div class="task"><a name="modifyenc-16"></a><p class="title"><b>How to Create a Single-Label Encodings File</b></p><div class="tasksummary">
<div class="itemizedlist"><p>Certain labels must always be present in a <code class="filename">label_encodings</code> file:</p><ul type="disc"><li>
<p>One sensitivity label in the user accreditation range must
be defined</p>
</li><li>
<p>One clearance in the user accreditation range must be defined</p>
</li><li>
<p>One information label in the user accreditation range must
be defined</p>
</li></ul></div>
</div><div class="taskprerequisites">

<p>You must be in the Security Administrator role in the global zone.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Edit an encodings file.</p>
<p>Use the Edit Encodings action.
For details, see <span class="olink">How to Create a <code class="filename">label_encodings</code> File</span>. Provide a name that is different from the installed <code class="filename">label_encodings</code> file.</p>
</li><li>
<p>Create an encodings file with only one classification and only
the desired compartments.</p>
<p>For example, you could set up an encodings
file with the <code class="literal">INTERNAL_USE_ONLY</code> classification, and specify
no words.</p>
<pre class="screen">VERSION= Single-Label Encodings

. . .
CLASSIFICATIONS:

name= INTERNAL_USE_ONLY;       sname= INTERNAL;  value= 5;

INFORMATION LABELS:

WORDS:

SENSITIVITY LABELS:

WORDS:

CLEARANCES:

WORDS:

CHANNELS:

WORDS:

PRINTER BANNERS:

WORDS:</pre>
</li><li>
<p>In the <code class="literal">ACCREDITATION RANGE</code>  section, include
only one classification and one valid compartment combination.</p>
<p>The
following example encodes the <code class="literal">INTERNAL</code> classification.</p>
<pre class="screen">ACCREDITATION RANGE:

classification= INTERNAL;
only valid compartment combinations:

INTERNAL

minimum clearance= INTERNAL;
minimum sensitivity label= INTERNAL;
minimum protect as classification= INTERNAL;</pre>
</li><li>
<p>Encode the <code class="literal">LOCAL DEFINITIONS</code> section. </p>
<p>For details, see <span class="olink">Chapter 5, Customizing <code class="literal">LOCAL DEFINITIONS</code>
</span>.</p>
</li><li>
<p>Ensure that the file is syntactically correct.</p>
<ul>
<li>
<p>If the file does not pass <span><strong class="command">chk_encodings</strong></span>, see <span class="olink">How to Debug a <code class="filename">label_encodings</code> File</span>
</p>
</li>
<li>
<p>Otherwise, continue with <span class="olink">How to Analyze and Verify the <code class="filename">label_encodings</code> File</span>.</p>
</li>
</ul>
</li><li>

<p>Configure labels so that they are not visible
to users.</p>
<p>For the steps, see <span class="olink">
<em class="citetitle">How to Hide Labels From a User</em> in <em class="citetitle">Solaris Trusted Extensions Administrator&#8217;s Procedures</em>
</span>.</p>
</li></ol></div><div class="example"><a name="modifyenc-37"></a><p class="title"><b>Example 3.8. Defining the Accreditation Range in a Single-Label Encodings File</b></p>


<p>
<a class="indexterm" name="indexterm-191"></a>The following example shows the settings in the <code class="literal">ACCREDITATION
RANGE:</code> section. A single <code class="literal">ANY_CLASS</code> classification
is defined. Compartments words <code class="literal">A</code>, <code class="literal">B</code>,
and <code class="literal">REL CNTRY 1</code> are specified for all types of labels.</p>
<pre class="screen">ACCREDITATION RANGE:

classification= ANY_CLASS;      only valid compartment combinations:

ANY_CLASS A B REL CNTRY1

minimum clearance= ANY_CLASS A B REL CNTRY1;
minimum sensitivity label= ANY_CLASS A B REL CNTRY1;
minimum protect as classification= ANY_CLASS;</pre>
</div><div class="example"><a name="modifyenc-41"></a><p class="title"><b>Example 3.9. Changing the Single Label Name</b></p>


<p>In this example, the <code class="filename">label_encodings.example</code> file
is changed to handle a single-label company. The <code class="literal">name=</code> value
is changed from <code class="literal">SECRET</code> to <code class="literal">INTERNAL_USE_ONLY</code>.
The <code class="literal">sname=</code> value is changed from <code class="literal">s</code> to <code class="literal">INTERNAL</code>. Neither the <code class="literal">value=</code> nor the <code class="literal">initial
compartments=</code> definition is changed.</p>
<pre class="screen">CLASSIFICATIONS:
name= INTERNAL_USE_ONLY;  sname= INTERNAL;  value= 5; initial compartments= 4-5
190-239;</pre>
<p>In the <code class="literal">ACCREDITATION RANGE</code> section, the short name
of the classification is replaced. Also, the minimums are replaced with the
new <code class="literal">sname</code>.</p>
<pre class="screen">ACCREDITATION RANGE:

classification= INTERNAL;      only valid compartment combinations:

INTERNAL

minimum clearance= INTERNAL;
minimum sensitivity label= INTERNAL;
minimum protect as classification= INTERNAL;</pre>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1627981"></a></h3></div></div></div>

<div class="task"><a name="modifyenc-38"></a><p class="title"><b>How to Add Sun Extensions to an Encodings File</b></p><div class="taskprerequisites">

<p>You must be in the Security Administrator role in the global zone. You
must have an encodings file that does not have a <code class="literal">LOCAL DEFINITIONS</code> section.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Add the <code class="literal">LOCAL DEFINITIONS</code> section to your file.</p>
<p>Append the section from a Sun-supplied <code class="filename">label_encodings</code> file.
Sun-supplied files are in the <code class="filename">/etc/security/tsol</code> directory.</p>
</li><li>
<p>Customize the extensions for your site.</p>
<p>For details,
see <span class="olink">Modifying Sun Extensions (Task Map)</span>.</p>
</li></ol></div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1628076"></a></h3></div></div></div>

<div class="task"><a name="modifyenc-12"></a><p class="title"><b>How to Debug a <code class="filename">label_encodings</code> File</b></p><a class="indexterm" name="indexterm-192"></a><a class="indexterm" name="indexterm-193"></a><div class="taskprerequisites">

<p>You must be in the Security Administrator role in the global zone.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Edit the <code class="filename">label_encodings</code> file.</p>
<p>Use
the Edit Encodings action. For details, see <span class="olink">How to Create a <code class="filename">label_encodings</code> File</span>.</p>
</li><li>
<p>Check the entries in the <code class="literal">INFORMATION LABELS: WORDS:</code> section.</p>
<p>The entries must exactly match the entries in the <code class="literal">SENSITIVITY
LABELS: WORDS:</code> section.</p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3>

<p>Encode the sensitivity label words, then copy the words to the <code class="literal">INFORMATION LABELS</code> section.</p>
</div>
</li><li>
<p>Check that no label in the user accreditation range has a value
of 0 with no compartment bits.</p>
<p>This step ensures that no label
is indistinguishable from the label <code class="constant">ADMIN_HIGH</code>.</p>
</li><li>
<p>Check that no label in the user accreditation range has a value
of 255 with all compartment bits from 0 to 239.</p>
<p>This step ensures
that no label is indistinguishable from the label <code class="constant">ADMIN_HIGH</code>.</p>
</li><li>
<p>
<a class="indexterm" name="indexterm-194"></a>Check that no compartment has a value higher than 239.</p>
<p>This
step ensures that all labels can be mapped to CIPSO labels.</p>
</li><li>
<p>For labels that cannot be resolved, do the following:</p>
<ol type="a">
<li>
<p>Reset any objects with the new labels to a low system label, <code class="constant">ADMIN_LOW</code>.</p>
</li>
<li>
<p>Restore a known, usable <code class="filename">label_encodings</code> file
from the backup.</p>
</li>
<li>
<p>Use the <span><strong class="command">chk_encodings -a</strong></span> command to analyze
the label problems in the faulty file.</p>
</li>
</ol>
</li></ol></div></div>
</div>
</div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch03.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 3. Making a Label Encodings File (Tasks) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 4. Labeling Printer Output (Tasks)</td></tr></table></div></body></html>
