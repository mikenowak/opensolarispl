<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>NIS Troubleshooting - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p28.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p30.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="abtrbl-18694"></a>Chapter&nbsp;7<h3>NIS Troubleshooting</h3><p>This chapter explains how to resolve problems encountered on networks running NIS. It covers problems seen on an NIS client and those seen on an NIS server.</p>
<p>Before trying to debug an NIS server or client, review <a href="p13.html">Chapter&nbsp;4, Network Information Service (NIS) (Overview)</a> which explains the NIS environment. Then look for the subheading in this section that best describes your problem.</p>
<hr>
<p><b>Note - </b>The NIS service is managed by the Service Management Facility. Administrative actions on this service, such as enabling, disabling, or restarting, can be performed by using the <tt>svcadm</tt> command. See <a href="p16.html#cnis1-55">NIS and the Service Management Facility</a> for more information about using SMF with NIS. For an overview of SMF, refer to Chapter 14, Managing Services (Overview), in <i>System Administration Guide: Basic Administration</i>.
Also refer to the <tt>svcadm</tt>(1M) and <tt>svcs</tt>(1) man pages for more details.</p>
<p>NIS services can also be started and stopped by using the <tt>ypstart</tt> and <tt>ypstop</tt> commands. See the <tt>ypstart</tt>(1M) and <tt>ypstop</tt>(1M) man pages for more information.</p>
<hr>
<a name="abtrbl-30969"></a><h3>NIS Binding Problems</h3>
<a name="indexterm-416"></a><a name="abtrbl-54"></a><h4>Symptoms</h4>
<p>Common symptoms of NIS binding problems include the following.</p>
<ul><li><p><a name="indexterm-417"></a><a name="indexterm-418"></a>Messages saying that <tt>ypbind</tt> can't find or communicate with a server</p>
</li>
<li><p><a name="indexterm-419"></a><a name="indexterm-420"></a>Messages saying that server not responding</p>
</li>
<li><p><a name="indexterm-421"></a><a name="indexterm-422"></a>Messages saying that NIS is unavailable</p>
</li>
<li><p>Commands on a client limp along in background mode or function much slower than normal</p>
</li>
<li><p><a name="indexterm-423"></a>Commands on a client hang. Sometimes commands hang even though the system as a whole seems fine and you can run new commands</p>
</li>
<li><p>Commands on a client crash with obscure messages, or no message at all</p>
</li>
</ul>
<a name="abtrbl-28251"></a><h4>NIS Problems Affecting One Client</h4>
<a name="indexterm-424"></a><p>If only one or two clients are experiencing symptoms that indicate NIS binding difficulty, the problems probably are on those clients. If many NIS clients are failing to bind properly, the problem probably exists on one or more of the NIS servers. See <a href="p30.html#abtrbl-22854">NIS Problems Affecting Many Clients</a>.</p>
<a name="abtrbl-42724"></a><h5><tt>ypbind</tt> Not Running on Client</h5>
<p><a name="indexterm-425"></a>One client has problems, but other clients on the same subnet are operating normally. On the problem client, run <tt>ls</tt> <tt>-l</tt> on a directory, such as <tt>/usr</tt>, that contains files owned by many users, including some not in the client <tt>/etc/passwd</tt> file. If the resulting display lists file owners who are not in the local <tt>/etc/passwd</tt> as numbers, rather
than names, this indicates that NIS service is not working on the client.</p>
<p>These symptoms usually mean that the client <tt>ypbind</tt> process is not running. Verify whether the NIS client service is running.</p>
<pre>client# <tt><b>svcs network/nis/client</b></tt>
STATE          STIME    FMRI
disabled       Sep_01   svc:/network/nis/client:default</pre><p>If the client is disabled, log in as superuser, or assume an equivalent role, and start the NIS client service.</p>
<pre>client# <tt><b>svcadm enable network/nis/client</b></tt></pre><a name="abtrbl-28007"></a><h5>Missing or Incorrect Domain Name</h5>
<a name="indexterm-426"></a><a name="indexterm-427"></a><p>One client has problems, the other clients are operating normally, but <tt>ypbind</tt> is running on the problem client. The client might have an incorrectly set domain.</p>
<p>On the client, run the <tt>domainname</tt> command to see which domain name is set.</p>
<pre>client7# <tt><b>domainname neverland.com</b></tt></pre><p><a name="indexterm-428"></a>Compare the output with the actual domain name in <tt>/var/yp</tt> on the NIS master server. The actual NIS domain is shown as a subdirectory in the <tt>/var/yp</tt> directory.</p>
<pre>Client7# <tt><b>ls /var/yp...</b></tt>
-rwxr-xr-x 1 root Makefile
drwxr-xr-x 2 root binding
drwx------ 2 root doc.com ...</pre><p><a name="indexterm-429"></a>If the domain name returned by running <tt>domainname</tt> on a machine is not the same as the server domain name listed as a directory in <tt>/var/yp</tt>, the domain name specified in the machine's <tt>/etc/defaultdomain</tt> file is incorrect. Log in as superuser or assume an equivalent role, and correct the client's domain name in the machine's <tt>/etc/defaultdomain</tt>
 file. This assures that the domain name is correct every time the machine boots. Now reboot the machine.</p>
<hr>
<p><b>Note - </b>The domain name is case-sensitive.</p>
<hr>
<a name="abtrbl-55"></a><h5>Client Not Bound to Server</h5>
<a name="indexterm-430"></a><p><a name="indexterm-431"></a>If your domain name is set correctly, <tt>ypbind</tt> is running, and commands still hang, then make sure that the client is bound to a server by running the <tt>ypwhich</tt> command. If you have just started <tt>ypbind</tt>, then run <tt>ypwhich</tt>
several times (typically, the first one reports that the domain is not bound and the second succeeds normally).</p>
<a name="abtrbl-56"></a><h5>No Server Available</h5>
<a name="indexterm-432"></a><a name="indexterm-433"></a><p>If your domain name is set correctly, <tt>ypbind</tt> is running, and you get messages indicating that the client cannot communicate with a server, this might indicate a number of different problems:</p>
<ul><li><p><a name="indexterm-434"></a>Does the client have a <tt>/var/yp/binding/</tt><i>domainname</i><tt>/ypservers</tt> file containing a list of servers to bind to? If not, run <tt>ypinit</tt> <tt>-c</tt> and specify in order of preference the servers that this client should bind to.</p>
</li>
<li><p>If the client does have a <tt>/var/yp/binding/</tt><i>domainname</i><tt>/ypservers</tt> file, are there enough servers listed in it if one or two become unavailable? If not, add additional servers to the list by running <tt>yppinit</tt> <tt>-c</tt>.</p>
</li>
<li><p>If none of the servers listed in the client's <tt>ypservers</tt> file are available, the client searches for an operating server using broadcast mode. If there is a functioning server on the client's subnet, the client will find it (though performance might be slowed during the search). If there are no functioning servers on the client's subnet can solve the problem in several ways:</p>
<ul><li><p>If the client has no server on the subnet and no route to one, you can install a new slave server on that subnet.</p>
</li>
<li><p><a name="indexterm-435"></a>You can make sure your routers are configured to pass broadcast packets so that the client can use broadcast to find a server on another subnet. You can use the <tt>netstat</tt> <tt>-r</tt> command to verify the route.</p>
</li>
<li><p>If there should be a route, but it is not working, make sure that the route daemon <tt>in.routed/in.rdisc</tt> is running. If it is not running, start it.</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><b>Note - </b>For reasons of security and administrative control it is preferable to specify the servers a client is to bind to in the client's <tt>ypservers</tt> file rather than have the client search for servers through broadcasting. Broadcasting slows down the network, slows the client, and prevents you from balancing server load by listing different servers for different clients.</p>
<hr>
<ul><li><p>Do the servers listed in a clients <tt>ypservers</tt> file have entries in the <tt>/etc/hosts</tt> file? If not, add the servers to the NIS maps hosts input file and rebuild your maps by running <tt>yppinit</tt> <tt>-c</tt> or <tt>ypinit</tt> <tt>-s</tt> as described <a href="p22.html#anis2-11278">Working With NIS Maps</a>.</p>
</li>
<li><p>Is the <tt>/etc/nsswitch.conf</tt> file set up to consult the machine's local <tt>hosts</tt> file in addition to NIS? See <a href="p6.html">Chapter&nbsp;2, The Name Service Switch (Overview)</a> for more information on the switch.</p>
</li>
<li><p>Is the <tt>/etc/nsswitch.conf</tt> file set up to consult <tt>files</tt> first for <tt>services</tt> and <tt>rpc</tt>? See <a href="p6.html">Chapter&nbsp;2, The Name Service Switch (Overview)</a> for more information on the switch.</p>
</li>
</ul>
<a name="abtrbl-57"></a><h5><tt>ypwhich</tt> Displays Are Inconsistent</h5>
<a name="indexterm-436"></a><a name="indexterm-437"></a><p>When you use <tt>ypwhich</tt> several times on the same client, the resulting display varies because the NIS server changes. This is normal. The binding of the NIS client to the NIS server changes over time when the network or the NIS servers are busy. Whenever
possible, the network becomes stable at a point where all clients get acceptable response time from the NIS servers. As long as your client machine gets NIS service, it does not matter where the service comes from. For example, an NIS server machine can get its own NIS services from another NIS server on the network.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p28.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p30.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

