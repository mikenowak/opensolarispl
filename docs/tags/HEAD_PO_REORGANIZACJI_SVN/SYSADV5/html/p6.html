<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>The Name Service Switch (Overview) - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p5.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p7.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="a12swit-86415"></a>Chapter&nbsp;2<h3>The Name Service Switch (Overview)</h3><p>This chapter describes the name service switch. You use the name service switch to coordinate usage of different naming services.</p>
<a name="a12swit-89620"></a><h3>About the Name Service Switch</h3>
<p><a name="indexterm-16"></a><a name="indexterm-17"></a>The name service switch is a file which is named,  <tt>nsswitch.conf</tt>. The name service switch controls how a client machine or application obtains network information. The name service switch is used by client applications that call any of the <tt>getXbyY()</tt>
interfaces such as the following.</p>
<ul><li><p><a name="indexterm-18"></a><tt>gethostbyname()</tt></p>
</li>
<li><p><a name="indexterm-19"></a><tt>getpwuid()</tt></p>
</li>
<li><p><a name="indexterm-20"></a><tt>getpwnam()</tt></p>
</li>
<li><p><a name="indexterm-21"></a><tt>getaddrinfo()</tt></p>
</li>
</ul>
<p>Each machine has a switch file in its <tt>/etc</tt> directory. Each line of that file identifies a particular type of network information, such as host, password, and group, followed by one or more locations of that information.</p>
<p>A client can obtain naming information from one or more of the switch's sources. For example, an NIS+ client could obtain its hosts information from an NIS+ table and its password information from a local <tt>/etc</tt> file. In addition, the client could specify the conditions under which the switch must use each source. See <a href="p6.html#a12swit-tbl-1">Table 2-1</a>.</p>
<p><a name="indexterm-22"></a>The Solaris system automatically loads an <tt>nsswitch.conf</tt> file into every machine's <tt>/etc</tt> directory as part of the installation process. Four alternate (template) versions of the switch file are also loaded into <tt>/etc</tt> for LDAP, NIS, NIS+, or files. See <a href="p7.html#a12swit-22067">The <tt>nsswitch.conf</tt> Template Files</a>.</p>
<p>These four files are alternate default switch files. Each file is designed for a different primary naming service: <tt>/etc</tt> files, NIS, NIS+, or LDAP. When  the Solaris software is first installed on a machine, the installer selects the machine's default naming service: NIS+, NIS, local files, or LDAP. During installation, the corresponding template file is copied to <tt>nsswitch.conf</tt>. For example, for a machine client using LDAP, the installation process copies 
<tt>nsswitch.ldap</tt> to <tt>nsswitch.conf</tt>. Unless you have an unusual namespace, the default template file as copied to <tt>nsswitch.conf</tt> should be sufficient for normal operation.</p>
<p><a name="indexterm-23"></a><a name="indexterm-24"></a>No default file is provided for DNS, but you can edit any of these files to use DNS. For more information see <a href="p8.html#a12swit-66520">DNS and Internet Access</a>.</p>
<p>If you later change a machine's primary naming service, you copy the appropriate alternate switch file to <tt>nsswitch.conf</tt>. See <a href="p7.html#a12swit-22067">The <tt>nsswitch.conf</tt> Template Files</a>. You can also change the sources of particular types of network information used by the client by editing the appropriate lines of the <tt>/etc/nsswitch.conf</tt> file. The syntax is described below, and additional instructions are provided in <a href="p8.html#c8switch-2">How to Modify the Name Service Switch</a>.</p>
<a name="a12swit-84565"></a><h4>Format of the <tt>nsswitch.conf</tt> File</h4>
<p><a name="indexterm-25"></a>The <tt>nsswitch.conf</tt> file is essentially a list of 16 types of information and the sources that <tt>getXXbyYY()</tt> routines search for that information. The 16 types of information, not necessarily in this order, are the following.</p>
<ul><li><p><tt>aliases</tt></p>
</li>
<li><p><tt>bootparams</tt></p>
</li>
<li><p><tt>ethers</tt></p>
</li>
<li><p><tt>group</tt></p>
</li>
<li><p><tt>hosts</tt></p>
</li>
<li><p><tt>ipnodes</tt></p>
</li>
<li><p><tt>netgroup</tt></p>
</li>
<li><p><tt>netmasks</tt></p>
</li>
<li><p><tt>networks</tt></p>
</li>
<li><p><tt>passwd</tt>, which includes shadow information</p>
</li>
<li><p><tt>protocols</tt></p>
</li>
<li><p><tt>publickey</tt></p>
</li>
<li><p><tt>rpc</tt></p>
</li>
<li><p><tt>services</tt></p>
</li>
<li><p><tt>automount</tt></p>
</li>
<li><p><tt>sendmailvars</tt></p>
</li>
</ul>
<p>The following table provides a description of the kind of sources that can be listed in the switch file for the information types above.</p>
<a name="a12swit-tbl-1"></a>Table 2-1 Switch File Information Sources<table><tr><th><p>Information Sources</p>
</th><th><p>Description</p>
</th></tr>
<tr><td valign="top"><p><tt>files</tt></p>
</td><td valign="top"><p>A file stored in the client's <tt>/etc</tt> directory. For example, <tt>/etc/passwd</tt></p>
</td></tr>
<tr><td valign="top"><p><tt>nisplus</tt></p>
</td><td valign="top"><p>An NIS+ table. For example, the <tt>hosts</tt> table.</p>
</td></tr>
<tr><td valign="top"><p><tt>nis</tt></p>
</td><td valign="top"><p>An NIS map. For example, the <tt>hosts</tt> map.</p>
</td></tr>
<tr><td valign="top"><p><tt>compat</tt></p>
</td><td valign="top"><p><tt>compat</tt> can be used for password and group information to support old-style + or - syntax in <tt>/etc/passwd</tt>, <tt>/etc/shadow</tt>, and <tt>/etc/group</tt> files.</p>
</td></tr>
<tr><td valign="top"><p><tt>dns</tt></p>
</td><td valign="top"><p>Can be used to specify that host information be obtained from DNS.</p>
</td></tr>
<tr><td><p><tt>ldap</tt></p>
</td><td><p>Can be used to specify entries be obtained from the LDAP directory.</p>
</td></tr>
</table><a name="a12swit-39858"></a><h5>Search Criteria</h5>
<a name="indexterm-26"></a><p><b>Single Source.</b> If an information type has only one source, such as <tt>nisplus</tt> a routine using the switch searches for the information in that source <b>only</b>. If the routine finds the information, the routine returns a <tt>success</tt> status message. If the routine does not find the information, the routine
stops searching and returns a different status message. What the routine does with the status message varies from routine to routine.</p>
<p><b>Multiple Sources.</b>  If a table contains multiple sources for a given information type, the switch directs the routine to  search in the first listed source. If the routine finds the information, the routine returns a <tt>success</tt> status message. If the routine does not find the information in the first source, the routine tries the next source. The routine searches  all sources until the routine has found the information, or until the routine is halted
by a <tt>return</tt> specification. If all of the listed sources are searched without finding the information, the routine stops searching and returns a <tt>non-success</tt> status message.</p>
<a name="a12swit-2"></a><h5>Switch Status Messages</h5>
<a name="indexterm-27"></a><a name="indexterm-28"></a><p>If a routine finds the information, the routine returns a <tt>success</tt> status message. If the routine does not find the information, the routine returns one of three error status messages. Possible status messages are listed in the following table.</p>
<a name="a12swit-tbl-3111"></a>Table 2-2 Switch Search Status Messages<table><tr><th><p>Status Message</p>
</th><th><p>Meaning of Message</p>
</th></tr>
<tr><td valign="top"><p><tt>SUCCESS</tt></p>
</td><td valign="top"><p>The requested entry was found in the specified source.</p>
</td></tr>
<tr><td valign="top"><p><tt>UNAVAIL</tt></p>
</td><td valign="top"><p>The source is either unresponsive or  unavailable. In other words, neither the NIS+ table, the NIS map, nor the <tt>/etc</tt> file could be found or be accessed.</p>
</td></tr>
<tr><td valign="top"><p><tt>NOTFOUND</tt></p>
</td><td valign="top"><p>The source responded with &ldquo;No such entry.&rdquo; In other words, the table, map, or file was accessed but the needed information was not found.</p>
</td></tr>
<tr><td valign="top"><p><tt>TRYAGAIN</tt></p>
</td><td valign="top"><p>The source is busy. The source might respond next time. In other words, the table, map, or file was found, but could not respond to the query.</p>
</td></tr>
</table><a name="a12swit-3"></a><h5>Switch Action Options</h5>
<a name="indexterm-29"></a><a name="indexterm-30"></a><p>You can instruct the switch to respond to status messages with either of the two <b>actions</b> shown in the following table.</p>
<a name="a12swit-32878"></a>Table 2-3 Responses to Switch Status Messages<table><tr><th><p>Action</p>
</th><th><p>Meaning</p>
</th></tr>
<tr><td valign="top"><p><tt>return</tt></p>
</td><td valign="top"><p>Stop looking for the information.</p>
</td></tr>
<tr><td valign="top"><p><tt>continue</tt></p>
</td><td valign="top"><p>Try the next source.</p>
</td></tr>
</table><a name="a12swit-4"></a><h5>Default Search Criteria</h5>
<a name="indexterm-31"></a><p>The combination of <tt>nsswitch.conf</tt> file status message and action option determines what the routine does at each step. The combination of status and action make up the search <b>criteria</b>.</p>
<p><a name="indexterm-32"></a>The switch's default search criteria are the same for every source. As described in terms of the status messages listed above, see the following.</p>
<ul><li><p><a name="indexterm-33"></a><tt>SUCCESS=return</tt>. Stop looking for the information. Proceed using the information that has been found.</p>
</li>
<li><p><a name="indexterm-34"></a><tt>UNAVAIL=continue</tt>. Go to the next <tt>nsswitch.conf</tt> file source and continue searching. If this source is the last or only source, return with a <tt>NOTFOUND</tt> status.</p>
</li>
<li><p><a name="indexterm-35"></a><tt>NOTFOUND=continue</tt>. Go to the next <tt>nsswitch.conf</tt> file source and continue searching. If this source is the last or only source, return with a <tt>NOTFOUND</tt> status.</p>
</li>
<li><p><a name="indexterm-36"></a><tt>TRYAGAIN=continue</tt>. Go to the next <tt>nsswitch.conf</tt> file source and continue searching. If this source is the last or only source, return with a <tt>NOTFOUND</tt> status.</p>
</li>
</ul>
<p><a name="indexterm-37"></a>You can change default search criteria by explicitly specifying some other criteria by using the <i>STATUS=action</i> syntax shown above. For example, the default action for a <tt>NOTFOUND</tt> condition is to continue the search to the next source. For example, to specify for  <tt>networks</tt>, the search should stop in  a 
<tt>NOTFOUND</tt> condition, edit the <tt>networks</tt> line of the switch file. The line would read as follows.</p>
<pre>networks: nis [NOTFOUND=return] files</pre><p>The <tt>networks: nis [NOTFOUND=return] files</tt> line specifies a nondefault criterion for the <tt>NOTFOUND</tt> status. Nondefault criteria are delimited by square brackets.</p>
<p>In this example, the search routine behaves as follows:</p>
<ul><li><p>If the <tt>networks</tt> map is available, and contains the needed information, the routine returns with a <tt>SUCCESS</tt> status message.</p>
</li>
<li><p>If the <tt>networks</tt> map is not available, the routine returns with an <tt>UNAVAIL</tt> status message. By default, the routine continues to search the appropriate <tt>/etc</tt> file.</p>
</li>
<li><p>If the <tt>networks</tt> map is available and found, but the map does not contain the needed information, the routine returns with a <tt>NOTFOUND</tt> message. But, instead of continuing on to search the appropriate <tt>/etc</tt> file, which would be the default behavior, the routine stops searching.</p>
</li>
<li><p>If the <tt>networks</tt> map is busy, the routine returns with an <tt>TRYAGAIN</tt> status message and by default continues on to search the appropriate <tt>/etc</tt> file.</p>
</li>
</ul>
<hr>
<p><b>Note - </b>Lookups in the <tt>nsswitch.conf</tt> file are done in the order in which items are listed. However, password updates are done in reverse order, unless otherwise specified by using the <tt>passwd</tt> <tt>-r</tt> <i>repository</i> command. See <a href="p9.html">The Switch File and Password Information</a> for more information.</p>
<hr>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p5.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p7.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

