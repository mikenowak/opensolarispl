<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Planning Your NIS Domain - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p16.html">5.&nbsp;&nbsp;Setting Up and Configuring NIS Service</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p16.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p18.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="cnis1-32365"></a><h3>Planning Your NIS Domain</h3>
<p>Before you configure machines as NIS servers or clients, you must plan
the NIS domain.</p>
<p>Decide which machines will be in your NIS domain. An NIS domain does
not have to be congruent with your network. A network can have more than one
NIS domain, and there can be machines on your network that are outside of
your NIS domain.</p>
<p><a name="indexterm-201"></a><a name="indexterm-202"></a>Choose an NIS domain name, which can be 256 characters long. A
good practice is to limit domain names to no more than 32 characters. Domain
names are case-sensitive. For convenience, you can use your Internet domain
name as the basis for your NIS domain name. For example, if your Internet
domain name is <tt>doc.com</tt>, you can name your NIS domain <tt>doc.com.</tt> If you wanted to divide <tt>doc.com</tt> into
two NIS domains, one for the sales department and the other for the manufacturing
department, you could name one <tt>sales.doc.com</tt> and the other <tt>manf.doc.com.</tt></p>
<p><a name="indexterm-203"></a><a name="indexterm-204"></a><a name="indexterm-205"></a><a name="indexterm-206"></a>Before a machine can use NIS services, the correct NIS domain
name and machine name must be set. A machine's name is set by the machine's <tt>/etc/nodename</tt> file and the machine's domain name is set by the
machine's <tt>/etc/defaultdomain</tt> file. These files are read
at boot time and the contents are used by the <tt>uname <tt>-S</tt></tt> and <tt>domainname</tt> commands, respectively. Diskless machines read these
files from their boot server.</p>
<a name="cnis1-4"></a><h4>Identify Your NIS Servers and Clients</h4>
<p>Select one machine to be the master server. Decide which machines, if
any, will be slave servers.</p>
<p>Decide which machines will be NIS clients. Typically all machines in
your domain are set to be NIS clients, although this is not necessary.</p>
<a name="cnis1-21774"></a><h3>Preparing the Master Server</h3>
<p>The following sections describe how to prepare the source files and
the <tt>passwd</tt> files for the master server.</p>
<a name="cnis1-39121"></a><h4>Source Files Directory</h4>
<a name="indexterm-207"></a><a name="indexterm-208"></a><a name="indexterm-209"></a><a name="indexterm-210"></a><a name="indexterm-211"></a><a name="indexterm-212"></a><a name="indexterm-213"></a><a name="indexterm-214"></a><a name="indexterm-215"></a><p>The source files should be located in the <tt>/etc</tt> directory,
on the master server or in some other directory. Having them in <tt>/etc</tt> is
undesirable because the contents of the maps are then the same as the contents
of the local files on the master server. This is a special problem for <tt>passwd</tt> and <tt>shadow</tt> files because all users
have access to the master server maps and the root password would be passed
to all NIS clients through the <tt>passwd</tt> map. See <a href="p17.html#cnis1-17550"><tt>Passwd</tt> Files and Namespace Security</a> for additional
information.</p>
<p>However, if you put the source files in some other directory, you must
modify the <tt>Makefile</tt> in <tt>/var/yp</tt> by
changing the <tt>DIR=/etc</tt> line to <tt>DIR=/</tt><i>your-choice</i>, where <i>your-choice</i> is
the name of the directory you will be using to store the source files. This
allows you to treat the local files on the server as if they were those of
a client. (It is good practice to first save a copy of the original <tt>Makefile</tt>.)</p>
<p>In addition, if <tt>audit_user</tt>, <tt>auth_attr</tt>, <tt>exec_attr</tt> and <tt>prof_attr</tt> are to be taken from
a directory other than the default, you must amend the <tt>RBACDIR</tt> <i>=/etc/security</i> to <i>RBACDIR=/your-choice</i>.</p>
<a name="cnis1-17550"></a><h4><tt>Passwd</tt> Files and Namespace
Security</h4>
<a name="indexterm-216"></a><a name="indexterm-217"></a><a name="indexterm-218"></a><p><a name="indexterm-219"></a>The <tt>passwd</tt> map is a special case. In addition
to the old Solaris 1 <tt>passwd</tt> file format, this implementation
of NIS accepts the <tt>/etc/passwd</tt>  and <tt>/etc/shadow</tt> file
formats as input for building the NIS password maps.</p>
<p>For security reasons, the files used to build the NIS password maps
should not contain an entry for <tt>root</tt>, to prevent unauthorized
root access. Therefore, the password maps should not be built from the files
located in the master server's <tt>/etc</tt> directory. The password
files used to build the password maps should have the <tt>root</tt> entry
removed from them and be located in a directory that can be protected from
unauthorized access.</p>
<p>For example, the master server password input files should be stored
in a directory such as <tt>/var/yp</tt>, or any directory of your
choice, as long as the file itself is not a link to another file and its location
is specified in the <tt>Makefile</tt>. The correct directory option
is set automatically according to the configuration specified in your <tt>Makefile</tt>.</p>
<hr>
<p><b>Caution - </b>Be sure that the <tt>passwd</tt> file in the directory
specified by <tt>PWDDIR</tt> does not contain
an entry for root.</p>
<hr>
<p><a name="indexterm-220"></a>If your source files are in a directory other than <tt>/etc</tt>,
you must alter the <tt>PWDIR</tt> password macro
in the <tt>Makefile</tt> to refer to the directory where the <tt>passwd</tt> and <tt>shadow</tt> files reside, changing the
line <tt>PWDIR=/etc</tt> to <tt>PWDIR/</tt><i>your-choice</i>, where <i>your-choice</i> is the name of
the directory you will be using to store the <tt>passwd</tt> map
source files.</p>
<a name="cnis1-6"></a><h4>Preparing Source Files for Conversion to NIS Maps</h4>
<a name="indexterm-221"></a><p>Prepare the source files for conversion to NIS maps.</p>
<a name="cnis1-proc-7"></a><h4><img src="graphics/procedure.gif"> How to Prepare Source Files for Conversion</h4>
<ol><li><a name="cnis1-step-50"></a><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Chapter 8, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i>.</p></li><li><a name="cnis1-step-8"></a><b>Check the source files on the master server
to make sure they reflect an up-to-date picture of your system.</b><p>Check
the following files:</p><ul><li><p><tt>auto.home</tt> or <tt>auto_home</tt></p>
</li>
<li><p><tt>auto.master</tt> or <tt>auto_master</tt></p>
</li>
<li><p><tt>bootparams</tt></p>
</li>
<li><p><tt>ethers</tt></p>
</li>
<li><p><tt>group</tt></p>
</li>
<li><p><tt>hosts</tt></p>
</li>
<li><p><tt>ipnodes</tt></p>
</li>
<li><p><tt>netgroup</tt></p>
</li>
<li><p><tt>netmasks</tt></p>
</li>
<li><p><tt>networks</tt></p>
</li>
<li><p><tt>passwd</tt></p>
</li>
<li><p><tt>protocols</tt></p>
</li>
<li><p><tt>rpc</tt></p>
</li>
<li><p><tt>service</tt></p>
</li>
<li><p><tt>shadow</tt></p>
</li>
<li><p><tt>user_attr</tt></p>
</li>
</ul>
</li><li><a name="cnis1-step-9"></a><b><a name="indexterm-222"></a>Copy all of these source files, except <tt>passwd</tt>,
to the <tt>DIR</tt> directory that you have selected.</b></li><li><a name="cnis1-step-9a"></a><b>Copy the <tt>passwd</tt> file to
the <tt>PWDIR</tt> directory that you have selected.</b></li><li><a name="cnis1-step-1"></a><b>Copy <tt>audit_user</tt>, <tt>auth_attr</tt>, <tt>exec_attr</tt>, and <tt>prof_attr</tt> to
the selected <tt>RBACDIR</tt> directory.</b></li><li><a name="cnis1-step-10"></a><b><a name="indexterm-223"></a><a name="indexterm-224"></a>Check the <tt>/etc/mail/aliases</tt> file.</b><p><a name="indexterm-225"></a>Unlike other source files, the <tt>/etc/mail/aliases</tt> file
cannot be moved to another directory. This file must reside in the <tt>/etc/mail</tt> directory. Make sure that the <tt>/etc/mail/aliases</tt> source
file contains all the mail aliases that you want to have available throughout
the domain. Refer to <tt>aliases</tt>(4) for
more information. </p></li><li><a name="cnis1-step-11"></a><b>Clean all comments and other extraneous lines
and information from the source files.</b><p><a name="indexterm-226"></a>These operations can be done through a <tt>sed</tt> or <tt>awk</tt> script or with a text editor. The <tt>Makefile</tt> performs
some file cleaning automatically for you, but it is good practice to examine
and clean these files by hand before running. </p></li><li><a name="cnis1-step-12"></a><b>Make sure that the data in all the source files
is correctly formatted.</b><p>Source file data needs to be in the correct
format for that particular file. Check the man pages for the different files
to make sure that each file is in the correct format.</p></li></ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p16.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p18.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

