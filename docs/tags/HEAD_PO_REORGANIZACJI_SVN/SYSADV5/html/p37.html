<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Authentication and Services - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p34.html">9.&nbsp;&nbsp;LDAP Basic Components and Concepts (Overview)</a> > <a href="p36.html#ldapsecure-66">LDAP Naming Services Security Model</a> > <a href="p36.html#ldapsecure-75">Choosing Authentication Methods</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p36.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p38.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="ldapsecure-95"></a><h5>Authentication and Services</h5>
<p>The authentication method can be specified for a given service in the <tt>serviceAuthenticationMethod</tt> attribute. The following services currently
support this.</p>
<ul><li><p><tt>passwd-cmd</tt></p>
<p>This service is
used by <tt>passwd</tt>(1) to
change the login password and password attributes.</p>
</li>
<li><p><tt>keyserv</tt></p>
<p>This service is used
by the <tt>chkey</tt>(1) and <tt>newkey</tt>(1M) utilities
to create and change a user's Diffie-Hellman key pair.</p>
</li>
<li><p><tt>pam_ldap</tt></p>
<p>This service is used
for authenticating users with <tt>pam_ldap</tt>(5).</p>
<p><tt>pam_ldap</tt> supports
account management.</p>
</li>
</ul>
<hr>
<p><b>Note - </b>If the service does not have a <tt>serviceAuthenticationMethod</tt> set,
it will default to the value of the <tt>authenticationMethod</tt> attribute. </p>
<hr>
<hr>
<p><b>Note - </b>In per-user
mode, pam_krb5 (pam Kerberos) is used as the authentication service. <tt>ServiceAuthenticationMethod</tt> is not needed in this mode of operation.</p>
<hr>
<p>The following example shows a section of a client profile in which the
users will use <tt>sasl/digest-MD5</tt> to authenticate to the directory
server, but will use an SSL session to change their password.</p>
<pre>serviceAuthenticationMethod=pam_ldap:sasl/digest-MD5
serviceAuthenticationMethod=passwd-cmd:tls:simple</pre><a name="ldapsecure-83"></a><h4>Pluggable Authentication Methods</h4>
<a name="indexterm-485"></a><a name="indexterm-486"></a><p>By using the PAM framework, you can choose among several authentication
services, including <tt>pam_unix</tt>, <tt>pam_krb5</tt>, and <tt>pam_ldap</tt>.</p>
<p>If the per-user
authentication method is used, <tt>pam_krb5</tt>, the strongest
authentication service of the three methods listed above, must be enabled.
 See <tt>pam_krb5</tt>(5) and
the <i>System Administration Guide: Security Services</i>.</p>
<p>The pam_krb5 authentication
system may be used even if per-user authentication is not enabled.  If proxy
or anonymous credential levels are used to access directory server data then
restricting access to directory data on a per-user basis is not possible.</p>
<p>Because of its increased flexibility, support of stronger authentication
methods, and ability to use account management, the use of <tt>pam_ldap</tt> is
recommended over the use
of <tt>pam_unix</tt> when anonymous or proxy authentication methods
are used.</p>
<a name="ldapsecure-108"></a><h5><tt>pam_unix</tt></h5>
<p>If you have not changed the <tt>pam.conf</tt>(4) file, <tt>pam_unix</tt> functionality
is enabled by default.</p>
<hr>
<p><b>Note - </b>The <tt>pam_unix</tt> module has been removed and is
no longer supported with Solaris. A set of other service modules provides
equivalent or greater functionality. Therefore, in this guide, <tt>pam_unix</tt> refers
to the equivalent functionality, not to the <tt>pam_unix</tt> module
itself.</p>
<hr>
<p>Following is a list of the modules that provide the equivalent <tt>pam_unix</tt> functionality.</p>
<table><tr><td><p><tt>pam_authtok_check</tt>(5)</p>
</td></tr>
<tr><td><p><tt>pam_authtok_get</tt>(5)</p>
</td></tr>
<tr><td><p><tt>pam_authtok_store</tt>(5)</p>
</td></tr>
<tr><td><p><tt>pam_dhkeys</tt>(5)</p>
</td></tr>
<tr><td><p><tt>pam_passwd_auth</tt>(5)</p>
</td></tr>
<tr><td><p><tt>pam_unix_account</tt>(5)</p>
</td></tr>
<tr><td><p><tt>pam_unix_auth</tt>(5)</p>
</td></tr>
<tr><td><p><tt>pam_unix_cred</tt>(5)</p>
</td></tr>
<tr><td><p><tt>pam_unix_session</tt>(5)</p>
</td></tr>
</table><p><tt>pam_unix</tt> follows the traditional model of UNIX authentication,
as described in the following list.</p>
<ol><li><p>The client retrieves the user's encrypted password from the
name service.</p>
</li>
<li><p>The user is prompted for his password.</p>
</li>
<li><p>The user's password is encrypted.</p>
</li>
<li><p>The client compares the two encrypted passwords to determine
whether the user should be authenticated.</p>
</li>
</ol>
<p>Additionally, there are two restrictions when using <tt>pam_unix</tt>.</p>
<ul><li><p>The password must be stored in UNIX <tt>crypt</tt> format
and not in any other encryption methods, including clear.</p>
</li>
<li><p>The <tt>userPassword</tt> attribute must be readable
by the name service.</p>
<p>For example, if you set the credential level
to <tt>anonymous</tt>, then anyone must be able to read the <tt>userPassword</tt> attribute. Similarly, If you set the credential level to <tt>proxy</tt>, then the proxy user must be able to read the <tt>userPassword</tt> attribute.</p>
</li>
</ul>
<hr>
<p><b>Note - </b><tt>pam_unix</tt> is not compatible with the <tt>sasl</tt> authentication
method <tt>digest-MD5</tt>, since Sun Java System Directory Server requires passwords
to be stored in the clear in order to use <tt>digest-MD5. pam_unix</tt> requires
the password be stored in <tt>crypt</tt> format.</p>
<hr>
<a name="geeix"></a><h5><tt>pam_krb5 </tt></h5>
<p>Refer to <tt>pam_krb5</tt>(5) and
the <i>System Administration Guide: Security Services</i>.</p>
<a name="ldapsecure-107"></a><h5><tt>pam_ldap</tt></h5>
<p>When implementing <tt>pam_ldap</tt>, the user binds to the
LDAP server by using the authentication method defined in <tt>pam_ldap</tt>'s <tt>serviceAuthenticationMethod</tt> parameter, if one exists. Otherwise, <tt>authenticationMethod</tt> is used.</p>
<p>If <tt>pam_ldap</tt> is able to bind to the server with the
user's identity and supplied password, it authenticates the user.</p>
<hr>
<p><b>Note - </b>After you enable <tt>pam_ldap</tt> account management,
all users must provide a password any time they log in to the system. A login
password is required for authentication. Therefore, nonpassword-based logins
using tools such as <tt>rsh</tt>, <tt>rlogin</tt>, or <tt>ssh</tt> will fail.</p>
<hr>
<p><tt>pam_ldap</tt> does not read the <tt>userPassword</tt> attribute.
Therefore, there is no need to grant access to read the <tt>userPassword</tt> attribute
unless there are other clients using <tt>pam_unix</tt>. Also, <tt>pam_ldap</tt> does not support the <tt>none</tt> authentication
method. Thus, you must define the <tt>serviceAuthenticationMethod</tt> or
the <tt>authenticationMethod</tt> attributes so clients can use <tt>pam_ldap</tt>. See the <tt>pam_ldap</tt>(5) man page for more information.</p>
<hr>
<p><b>Caution - </b>If the <tt>simple</tt> authentication method is used,
the <tt>userPassword</tt> attribute can be read on the wire by third
parties.</p>
<hr>
<p>See <a href="p52.html#schemas-111">Example <tt>pam.conf</tt> File for <tt>pam_ldap</tt></a>.</p>
<p>The following table summarizes the main differences between <tt>pam_unix</tt>, <tt>pam_ldap</tt>, and <tt>pam_krb5</tt>.</p>
<a name="ldapsecure-tbl-4"></a>Table 9-5 <tt>pam_unix</tt> versus <tt>pam_ldap</tt> versus <tt>pam_krb5</tt><table><tr><th><p></p>
</th><th><p><tt>pam_unix</tt></p>
</th><th><p><tt>pam_ldap</tt></p>
</th><th><p><tt>pam_krb5</tt></p>
</th></tr>
<tr><td><p>Password Sent </p>
</td><td><p>Uses <tt>passwd</tt> service authentication method </p>
</td><td><p>Uses <tt>passwd</tt> service authentication method</p>
</td><td><p>Uses Kerberos
single sign on technology, not passwords</p>
</td></tr>
<tr><td><p>New Password Sent</p>
</td><td><p>Encrypted</p>
</td><td><p>No encryption (unless TLS is used)</p>
</td><td><p>Uses Kerberos,
no passwords are sent over the wire</p>
</td></tr>
<tr><td><p>New Password Stored</p>
</td><td><p><tt>crypt</tt> format</p>
</td><td><p>Password storage scheme defined on Sun Java System Directory Server</p>
</td><td><p>Passwords
are managed via Kerberos</p>
</td></tr>
<tr><td><p>Requires password read?</p>
</td><td><p>Yes</p>
</td><td><p>No</p>
</td><td><p>No</p>
</td></tr>
<tr><td><p><tt>sasl/digest-MD5</tt> compatibility after changing password</p>
</td><td><p>No. Password is not stored in <tt>clear</tt>. User cannot
authenticate. </p>
</td><td><p>Yes. As long as default storage scheme is set to <tt>clear</tt>,
user can authenticate. </p>
</td><td><p>No. sasl/GSSAPI
is used. There are no passwords over the wire and there are no passwords to
be stored in the directory server, except when using a Kerberos kdc that manages
its password database in the LDAP directory server.</p>
</td></tr>
</table><a name="ldapsecure-96"></a><h5>PAM and Changing Passwords</h5>
<p>Use <tt>passwd</tt>(1) to
change a password. In order to change the password, the <tt>userPassword</tt> attribute
must be writable by the user. Remember that the <tt>serviceAuthenticationMethod</tt> for <tt>passwd-cmd</tt> overrides the <tt>authenticationMethod</tt> for this operation. Depending on the authentication used, the current
password might be unencrypted on the wire.</p>
<p>In the case of <tt>pam_unix</tt>, the new <tt>userPassword</tt> attribute
is encrypted using UNIX <tt>crypt</tt> format and tagged before
being written to LDAP. Therefore, the new password is encrypted on the wire,
regardless of the authentication method used to bind to the server. See the <tt>pam_authtok_store</tt>(5) man page for more information.</p>
<p>As of the Solaris 10 software release, <tt>pam_ldap</tt> no
longer supports password update. The previously recommended use of <tt>pam_authtok_store</tt> with the <tt>server_policy</tt> option now replaces the <tt>pam_ldap</tt> password update capability. When you use <tt>pam_authtok_store</tt>, the new password is sent to the LDAP server in the clear. Therefore,
to ensure privacy, use TLS. If TLS is not used, the new <tt>userPassword</tt> is
subject to snooping.  If you set an untagged password with Sun Java System Directory Server, the
software encrypts the password by using the <tt>passwordStorageScheme</tt> attribute.
For more information about the <tt>passwordStorageScheme</tt>, see
the section on user account management in the <i>Administration Guide</i> for
the version of Sun Java System Directory Server that you are using.</p>
<hr>
<p><b>Note - </b>You need to consider the following configuration issues when setting
the <tt>passwordStorageScheme</tt> attribute. If a NIS, NIS+, or
another client using <tt>pam_unix</tt> is using LDAP as a repository,
then <tt>passwordStorageScheme</tt> needs to be <tt>crypt</tt>.
Also, if using <tt>pam_ldap</tt> with <tt>sasl/digest-MD5</tt> with Sun Java System Directory Server, <tt>passwordStorageScheme</tt> must be set to clear.</p>
<hr>
<a name="ldapsecure-76"></a><h4>Account Management</h4>
<p>If you select <tt>pam_krb5</tt> as your account and password management system, the Kerberos environment
will manage all your account, password, account lockout, and other account
management details. Refer to <tt>pam_krb5</tt>(5) and the <i>System Administration Guide: Security Services</i>.</p>
<p>If you do not use <tt>pam_krb5</tt>, then LDAP naming services can be configured to take
advantage of the password and account lockout policy support in Sun Java System Directory Server.
You can configure <tt>pam_ldap</tt>(5) to
support user account management. <tt>passwd</tt>(1) enforces password syntax rules
set by the Sun Java System Directory Server password policy, when used with the proper PAM configuration.</p>
<p><a name="indexterm-487"></a><a name="indexterm-488"></a><a name="indexterm-489"></a>The following account management features are supported through <tt>pam_ldap</tt>(5). These features
depend on Sun Java System Directory Server's password and account lockout policy configuration.
You can enable as many or as few of the features as you want.</p>
<ul><li><p>Password aging and expiration notification</p>
<p>Users
must change their passwords according to a schedule. A password expires if
it is not changed within the time configured. An expired password causes user
authentication to fail.</p>
<p>Users see a warning message whenever they
log in within the expiration warning period. The message specifies the number
of hours or days until the password expires.</p>
</li>
<li><p>Password syntax checking</p>
<p>New passwords must meet
the minimum password length requirements. In addition, a password cannot match
the value of the <tt>uid</tt>, <tt>cn</tt>, <tt>sn</tt>,
or <tt>mail</tt> attributes in the user's directory entry.</p>
</li>
<li><p>Password in history checking</p>
<p>Users cannot reuse
passwords. If a user attempts to change the password to one that was previously
used, <tt>passwd</tt>(1) fails.
LDAP administrators can configure the number of passwords kept in the server's
history list.</p>
</li>
<li><p>User account lockout</p>
<p>A user account can be locked
out after a given number of repeated authentication failures. A user can also
be locked out if his account is inactivated by an administrator. Authentication
will continue to fail until the account lockout time is passed or the administrator
reactivates the account.</p>
</li>
</ul>
<hr>
<p><b>Note - </b>The preceding account management features only work with the Sun Java System Directory Server.
  For information about configuring the password and account lockout policy
on the server, see the &ldquo;User Account Management&rdquo; chapter in the
Administration Guide for the version of Sun Java System Directory Server that you are using.  
Also see <a href="p52.html#schemas-250">Example <tt>pam_conf</tt> file for <tt>pam_ldap</tt> Configured for Account Management</a>. Do not enable account management
for <tt>proxy</tt> accounts.</p>
<hr>
<p>Before configuring the password and account lockout policy on Sun Java System Directory Server,
make sure all hosts use the &ldquo;newest&rdquo; LDAP client with <tt>pam_ldap</tt> account management.</p>
<p>In addition, make sure the clients have a properly configured <tt>pam.conf</tt>(4) file. Otherwise,
LDAP naming services will not work when <tt>proxy</tt> or user passwords
expire.</p>
<hr>
<p><b>Note - </b>After you enable <tt>pam_ldap</tt> account
management, all users must provide a password any time they log in to the
system. A login password is required for authentication. Therefore, nonpassword-based
logins using tools such as <tt>rsh</tt>, <tt>rlogin</tt>,
or <tt>ssh</tt> will fail.</p>
<hr>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p36.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p38.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

