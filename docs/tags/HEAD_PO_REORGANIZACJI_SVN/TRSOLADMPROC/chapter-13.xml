<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML//EN" "docbook.dtd"[
	<!ENTITY % xinclude SYSTEM "xinclude.mod">
	%xinclude;
]>

<chapter xmlns="http://docbook.org/ns/docbook" version="5.0" xml:id="managetnet-1">



<title>Managing Networks in Trusted Extensions</title>
<indexterm xml:id="indexterm-622">
<primary>administering</primary>
<secondary>trusted networking</secondary>
</indexterm>
<indexterm xml:id="indexterm-623">
<primary>administering</primary>
<secondary>network in Trusted Extensions</secondary>
</indexterm>
<indexterm xml:id="indexterm-624">
<primary>configuring</primary>
<secondary>trusted network</secondary>
</indexterm>
<toc>
<para>This chapter provides implementation details and procedures for securing
a Trusted Extensions network.</para>
<itemizedlist remap="jumplist">
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-6">Managing the Trusted Network
(Task Map)</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-3">Configuring Trusted Network
Databases (Tasks)</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-14">Configuring Routes and Checking
Network Information in Trusted Extensions (Tasks)</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-2">Troubleshooting the Trusted
Network (Tasks)</olink>
</para>
</listitem>
</itemizedlist>
</toc>
<sect1 xml:id="managetnet-6">
<title>Managing the Trusted Network (Task
Map)</title>
<indexterm xml:id="indexterm-625">
<primary>Managing Trusted Networking (Task Map)</primary>
</indexterm>
<indexterm xml:id="indexterm-626">
<primary>tasks and task maps</primary>
<secondary>Managing Trusted Networking (Task Map)</secondary>
</indexterm>
<para>The following table points to the task maps for common networking procedures.</para>
<informaltable frame="all" pgwide="1">
<tgroup cols="3" colsep="1" rowsep="1">
<colspec colwidth="33*"/>
<colspec colwidth="33*"/>
<colspec colwidth="33*"/>
<thead>
<row>
<entry>
<para>Task</para>
</entry>
<entry>
<para>Description</para>
</entry>
<entry>
<para>For Instructions</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>Configure network databases</para>
</entry>
<entry>
<para>Create remote host templates, and assign hosts to the templates.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-3">Configuring Trusted Network Databases
(Tasks)</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Configure routing, and check network databases and network information
in the kernel</para>
</entry>
<entry>
<para>Configure static routes that enable labeled packets to reach their destination
through labeled and unlabeled gateways.</para>
<para>Display the state of your network.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-14">Configuring Routes and Checking Network
Information in Trusted Extensions (Tasks)</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Troubleshoot networking problems</para>
</entry>
<entry>
<para>Steps to take when diagnosing network problems with labeled packets.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-2">Troubleshooting the Trusted Network
(Tasks)</olink>
</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1>
<sect1 xml:id="managetnet-3">
<title>Configuring Trusted Network Databases (Tasks)</title>
<indexterm xml:id="indexterm-627">
<primary>Configuring Trusted Network Databases (Tasks)</primary>
</indexterm>
<indexterm xml:id="indexterm-628">
<primary>tasks and task maps</primary>
<secondary>Configuring Trusted Network Databases (Tasks)</secondary>
</indexterm>
<indexterm xml:id="indexterm-629">
<primary>administering</primary>
<secondary>trusted network databases</secondary>
</indexterm>
<indexterm xml:id="indexterm-630">
<primary>trusted network</primary>
<secondary>using templates</secondary>
</indexterm>
<indexterm xml:id="indexterm-631">
<primary>IP addresses</primary>
<secondary>in <filename>tnrhdb</filename> file</secondary>
</indexterm>
<indexterm xml:id="indexterm-632">
<primary>Computers and Networks tool</primary>
<secondary>modifying <filename>tnrhdb</filename>
</secondary>
</indexterm>
<indexterm xml:id="indexterm-633">
<primary>Security Templates tool</primary>
<secondary>modifying <filename>tnrhdb</filename>
</secondary>
</indexterm>
<indexterm xml:id="indexterm-634">
<primary>trusted network</primary>
<secondary>editing local files</secondary>
</indexterm>
<indexterm xml:id="indexterm-635">
<primary>IP addresses</primary>
<secondary>in <filename>tnrhdb</filename> database</secondary>
</indexterm>
<indexterm xml:id="indexterm-636">
<primary>
<filename>tnrhdb</filename> database</primary>
<secondary>configuring</secondary>
</indexterm>
<indexterm xml:id="indexterm-637">
<primary>hosts</primary>
<secondary>assigning a template</secondary>
</indexterm>
<indexterm xml:id="indexterm-638">
<primary>remote host templates</primary>
<secondary>assigning</secondary>
</indexterm>
<indexterm xml:id="indexterm-639">
<primary>Security Templates tool</primary>
<secondary>modifying <filename>tnrhdb</filename>
</secondary>
</indexterm>
<indexterm xml:id="indexterm-640">
<primary>hosts</primary>
<secondary>assigning a template</secondary>
</indexterm>
<indexterm xml:id="indexterm-641">
<primary>fallback mechanism</primary>
<secondary>for remote hosts</secondary>
</indexterm>
<indexterm xml:id="indexterm-642">
<primary>fallback mechanism</primary>
<secondary>using for network configuration</secondary>
</indexterm>
<indexterm xml:id="indexterm-643">
<primary>
<filename>tnrhdb</filename> database</primary>
<secondary>fallback mechanism</secondary>
</indexterm>
<indexterm xml:id="indexterm-644">
<primary>
<filename>tnrhdb</filename> database</primary>
<secondary>wildcard address</secondary>
</indexterm>
<indexterm xml:id="indexterm-645">
<primary>Solaris Management Console</primary>
<secondary>administering trusted network</secondary>
</indexterm>
<indexterm xml:id="indexterm-646">
<primary>trusted network</primary>
<secondary>administering with Solaris Management Console</secondary>
</indexterm>
<para>Trusted Extensions software includes the <filename>tnrhtp</filename> and <filename>tnrhdb</filename> databases. These databases provide labels for remote hosts
that contact the system. The Solaris Management Console provides the GUI to administer these databases.</para>
<informaltable frame="all" pgwide="1">
<tgroup cols="3" colsep="1" rowsep="1">
<colspec colwidth="33*"/>
<colspec colwidth="33*"/>
<colspec colwidth="33*"/>
<thead>
<row>
<entry>
<para>Task</para>
</entry>
<entry>
<para>Description</para>
</entry>
<entry>
<para>For Instructions</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>Determine if your site requires customized security templates</para>
</entry>
<entry>
<para>Evaluate the existing templates for the security requirements of your
site.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-22">How to Determine If You Need Site-Specific
Security Templates</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Access the Security Templates tool in the Solaris Management Console</para>
</entry>
<entry>
<para>Access the tool for modifying trusted network databases.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-15">How to Open the Trusted Networking
Tools</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Work with security templates</para>
</entry>
<entry>
<para>Modify the definitions of security attributes in your trusted network
by modifying the trusted network databases.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-20">How to Construct a Remote Host Template</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Create an unlabeled security template</para>
</entry>
<entry>
<para>Create security templates for unlabeled computers and networks.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-48">Example 13–1</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Restrict a security template to a single label</para>
</entry>
<entry>
<para>Create a security template for hosts that restrict communication between
other hosts to a single label.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-48">Example 13–1</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Create a template for a single-label gateway</para>
</entry>
<entry>
<para>Create a security template for hosts that operate as single-label gateways.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-23">Example 13–2</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Create a CIPSO template with a restricted label range</para>
</entry>
<entry>
<para>Create security templates for labeled computers and networks.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-24">Example 13–3</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Add hosts to the known network</para>
</entry>
<entry>
<para>Add computers and networks that you plan to add to the trusted network.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="txconf-9">How to Add Hosts to the System's Known Network</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Provide remote host access by using wildcard entries</para>
</entry>
<entry>
<para>Allow hosts within a range of IP addresses to communicate with this
system by indirectly assigning each host to the same security template.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-26">Example 13–7</olink>
</para>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-27">Example 13–8</olink>
</para>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-28">Example 13–9</olink>
</para>
</entry>
</row>
<row>
<entry morerows="1" rowsep="1">
<para>Change the <literal>admin_low</literal> wildcard entry in the <filename>tnrhdb</filename> file</para>
</entry>
<entry>
<para>Increase security by replacing the wildcard entry with specific addresses
for the host to contact at boot time.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-8">How to Limit the Hosts That Can Be Contacted
on the Trusted Network</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Increase security by replacing the wildcard entry with a network of
labeled hosts as the default.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-43">Example 13–10</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Assign security templates</para>
</entry>
<entry>
<para>Associate a template with an IP address or list of contiguous IP addresses.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-16">How to Assign a Template to a Group
of Hosts</olink>
</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<sect2>
<title/>
<task id="managetnet-22">

<title>How to Determine If You Need Site-Specific
Security Templates</title>
<taskprerequisites>

<para>You must be in the global zone in a role. The Security Administrator
role is responsible for creating security templates.</para>
</taskprerequisites>
<procedure>
<step>
<para>Familiarize yourself with the Trusted Extensions templates.</para>
<para>Read
the <filename>tnrhtp</filename> file on a local host. The comments in the
file are helpful. You can also see the security attribute values in the Security
Templates tool in the Solaris Management Console.</para>
<itemizedlist>
<listitem>
<para>The default templates match any installation. The label range
for each template is <constant>ADMIN_LOW</constant> to <constant>ADMIN_HIGH</constant>.</para>
</listitem>
<listitem>
<para>The <literal>cipso</literal> template defines a CIPSO host
type whose DOI is <literal>1</literal>. The label range for the template is <constant>ADMIN_LOW</constant> to <constant>ADMIN_HIGH</constant>.</para>
</listitem>
<listitem>
<para>The <literal>admin_low</literal> template defines an unlabeled
host whose DOI is <literal>1</literal>. Its default label is <constant>ADMIN_LOW</constant>.
The label range for the template is <constant>ADMIN_LOW</constant> to <constant>ADMIN_HIGH</constant>. In the default configuration, the address <literal>0.0.0.0</literal> is
assigned to this template. Therefore, all non-CIPSO hosts are treated as hosts
that operate at the <constant>ADMIN_LOW</constant> security label.</para>
</listitem>
</itemizedlist>
</step>
<step>
<para>Keep the default templates.</para>
<para>For support purposes,
do not delete or modify the default templates.</para>
</step>
<step>
<para>Create new templates if you want to do any of the following:</para>
<itemizedlist>
<listitem>
<para>Limit the label range of a host or a group of hosts.</para>
</listitem>
<listitem>
<para>Create a single-label host.</para>
</listitem>
<listitem>
<para>Create a host that recognizes a few discrete labels.</para>
</listitem>
<listitem>
<para>Use a different DOI than <literal>1</literal>.</para>
</listitem>
<listitem>
<para>Require a default label for unlabeled hosts that is not <constant>ADMIN_LOW</constant>.</para>
</listitem>
</itemizedlist>
<para>For details, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-20">How to Construct a
Remote Host Template</olink>.</para>
</step>
</procedure>
</task>
</sect2>
<sect2>
<title/>
<task id="managetnet-15">

<title>How to Open the Trusted Networking
Tools</title>
<indexterm xml:id="indexterm-647">
<primary>Solaris Management Console</primary>
<secondary>Security Templates tool</secondary>
</indexterm>
<indexterm xml:id="indexterm-648">
<primary>Security Templates tool</primary>
<secondary>using</secondary>
</indexterm>
<indexterm xml:id="indexterm-649">
<primary>Trusted Network tools</primary>
<secondary>using</secondary>
</indexterm>
<taskprerequisites>

<para>You must be in the global zone in a role that can modify network security.
For example, roles that are assigned the Information Security or Network Security
rights profiles can modify security settings. The Security Administrator role
includes these profiles.</para>
<para>To use the LDAP toolbox, you must have completed <olink remap="external" targetdoc="819-7314" targetptr="confsys-10">
<citetitle remap="section">Configuring the Solaris Management Console for LDAP (Tasks)</citetitle> in <citetitle remap="book">Solaris Trusted Extensions Installation and Configuration</citetitle>
</olink>.</para>
</taskprerequisites>
<procedure>
<step>
<para>Use the Security Templates tool.</para>
<substeps>
<step>
<para>Launch the Solaris Management Console.</para>
<screen># <userinput>/usr/sbin/smc &amp;</userinput>
</screen>
</step>
<step>
<para>Open the Trusted Extensions toolbox for your computer.</para>
<para>Use
the Console -&gt; Open Toolbox menu item.</para>
<substeps>
<step>
<para>Select a toolbox whose <literal>Policy=TSOL</literal>.</para>
</step>
<step>
<para>Click Open.</para>
</step>
</substeps>
</step>
<step>
<para>Open System Configuration.</para>
</step>
<step>
<para>Click the Computers and Networks tool.</para>
<para>Provide a password
when prompted.</para>
</step>
</substeps>
</step>
<step>
<para>Use the appropriate tool.</para>
<itemizedlist>
<listitem>
<para>To modify a template, use the Security Templates tool.</para>
<para>All currently-defined templates display in the right-hand pane. When
you select or create a template, online help is available in the left-hand
pane.</para>
</listitem>
<listitem>
<para>To assign a host to a template, use the Security Templates
tool.</para>
</listitem>
<listitem>
<para>To create a host that can be assigned to a template, use the
Computers and Networks tool.</para>
</listitem>
<listitem>
<para>To assign a label to a zone, use the Trusted Network Zones
tool. For more on zones in Trusted Extensions, see <olink remap="external" targetdoc="chapter-10.xml" targetptr="managezones-1">Chapter 10, Managing Zones in Trusted Extensions</olink>.</para>
</listitem>
</itemizedlist>
</step>
</procedure>
</task>
</sect2>
<sect2>
<title/>
<task id="managetnet-20">

<title>How to Construct a Remote Host Template</title>
<indexterm xml:id="indexterm-650">
<primary>security attributes</primary>
<secondary>setting for remote hosts</secondary>
</indexterm>
<indexterm xml:id="indexterm-651">
<primary>
<filename>tnrhtp</filename> database</primary>
<secondary>adding to</secondary>
</indexterm>
<indexterm xml:id="indexterm-652">
<primary>administering</primary>
<secondary>remote host templates</secondary>
</indexterm>
<indexterm xml:id="indexterm-653">
<primary>remote host templates</primary>
<secondary>creating</secondary>
</indexterm>
<taskprerequisites>

<para>You must be in the global zone in a role that can modify network security.
For example, roles that are assigned the Information Security or Network Security
rights profiles can modify security settings. The Security Administrator role
includes these profiles.</para>
</taskprerequisites>
<procedure>
<step>
<para>Open the Security Templates tool.</para>
<para>See <olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-15">How to Open the Trusted Networking Tools</olink> for
the steps in detail.</para>
</step>
<step>
<para>Double-click Security Templates under Computers and Networks in
the Solaris Management Console.</para>
<para>The existing templates are displayed in the View pane.
These templates describe the security attributes for hosts that this machine
can contact. These machines include CIPSO hosts that are running Trusted Extensions and
unlabeled hosts.</para>
</step>
<step>
<para>Examine the <filename>cipso</filename> template.</para>
<substeps>
<step>
<para>Examine the General tab.</para>
<para>Look at the values for Host
Type, Default Label, DOI, and Minimum/Maximum Label.</para>
</step>
<step>
<para>Examine the Hosts tab.</para>
<para>See what computers and network
are already assigned this template.</para>
</step>
</substeps>
</step>
<step>
<para>Examine the <filename>admin_low</filename> template.</para>
<para>Look
at the tabs as you did for the <filename>cipso</filename> template.</para>
</step>
<step performance="optional">

<para>Modify an existing template.</para>
<para>Double-click
the template, and use the online help for assistance. You can change the assigned
computers or change the assigned networks.</para>
<note>

<para>Do not modify the definition of the default templates. Retain
them for support purposes.</para>
</note>
</step>
<step performance="optional">

<para>Create a template.</para>
<para>If the provided
templates do not sufficiently describe the computers that can be in communication
with this computer, choose Add Template from the Action menu.</para>
<para>Use
the online help for assistance. Before continuing, create all the templates
that your site requires.</para>
</step>
</procedure>
<example xml:id="managetnet-48">

<title>Creating a Security Template That Has a Single Label</title>
<para>In this example, the security administrator wants to create a gateway
that can only pass packets at a single label, <literal>PUBLIC</literal>. In
the Solaris Management Console, the administrator creates a template. Still in the Security Templates
tool, she assigns the gateway host to the template.</para>
<orderedlist>
<listitem>
<para>The gateway host and IP address are added to the Computers
and Networks tool.</para>
<screen>gateway-1
192.168.131.75</screen>
</listitem>
<listitem>
<para>The template is created in the Security Templates tool.</para>
<para>The values in the template are the following:</para>
<screen>template: <userinput>CIPSO_PUBLIC</userinput>
host_type: <userinput>CIPSO</userinput>
doi: <userinput>1</userinput>
min_sl: <userinput>PUBLIC</userinput>
max_sl: <userinput>PUBLIC</userinput>
</screen>
<para>The tool supplied the hexadecimal value for <literal>PUBLIC</literal>, <literal>0X0002-08-08</literal>.</para>
</listitem>
<listitem>
<para>The <literal>gateway-1</literal> host is assigned to the template
by its name and IP address.</para>
<screen>gateway-1
192.168.131.75</screen>
</listitem>
</orderedlist>
<para>On a local host, the <filename>tnrhtp</filename> entry would appear
similar to the following:</para>
<screen>cipso_public:host_type=cipso;doi=1;min_sl=0X0002-08-08;max_sl=0X0002-08-08;</screen>
<para>On a local host, the <filename>tnrhdb</filename> entry would appear
similar to the following:</para>
<screen># gateway-1
192.168.131.75:cipso_public</screen>
</example>
<example xml:id="managetnet-23">

<title>Creating a Security Template For an Unlabeled Router</title>
<para>Any IP router can forward messages with CIPSO labels even though the
router does not explicitly support labels. Such an unlabeled  router needs
a default label to define the level at which connections to the router, perhaps
for router management, should  be handled. In this example, the security administrator
creates a router that can forward traffic at any label, but all direct communication
with the router is handled at the default label, <literal>PUBLIC</literal>.</para>
<para>In the Solaris Management Console, the administrator creates a template. Still in the Security
Templates tool, she assigns the gateway host to the template.</para>
<orderedlist>
<listitem>
<para>The router and its IP address are added to the Computers and
Networks tool.</para>
<screen>router-1
192.168.131.82</screen>
</listitem>
<listitem>
<para>The template is created in the Security Templates tool.</para>
<para>The values in the template are the following:</para>
<screen>Template Name: <userinput>UNL_PUBLIC</userinput>
Host Type: <userinput>UNLABELED</userinput>
DOI: <userinput>1</userinput>
Default Label: <userinput>PUBLIC</userinput>
Minimum Label: <userinput>ADMIN_LOW</userinput>
Maximum Label: <userinput>ADMIN_HIGH</userinput>
</screen>
<para>The tool supplies the hexadecimal value for the labels.</para>
</listitem>
<listitem>
<para>The <literal>router-1</literal> router is assigned to the
template by its name and IP address.</para>
<screen>router-1
192.168.131.82</screen>
</listitem>
</orderedlist>
</example>
<example xml:id="managetnet-24">

<title>Creating a Security Template That Has a Limited Label Range</title>
<para>In this example, the security administrator wants to create a gateway
that restricts packets to a narrow label range. In the Solaris Management Console, the administrator
creates a template. Still in the Security Templates tool, she assigns the
gateway host to the template.</para>
<orderedlist>
<listitem>
<para>The host and its IP address are added to the Computers and
Networks tool.</para>
<screen>gateway-ir
192.168.131.78</screen>
</listitem>
<listitem>
<para>The template is created in the Security Templates tool.</para>
<para>The values in the template are the following:</para>
<screen>Template Name: <userinput>CIPSO_IUO_RSTRCT</userinput>
Host Type: <userinput>CIPSO</userinput>
DOI: <userinput>1</userinput>
Minimum Label: <userinput>CONFIDENTIAL : INTERNAL USE ONLY</userinput>
Maximum Label: <userinput>CONFIDENTIAL : RESTRICTED</userinput>
</screen>
<para>The tool supplies the hexadecimal value for the labels.</para>
</listitem>
<listitem>
<para>The <literal>gateway-ir</literal> gateway is assigned to the
template by its name and IP address.</para>
<screen>gateway-ir
192.168.131.78</screen>
</listitem>
</orderedlist>
</example>
<example xml:id="managetnet-25">

<title>Creating a Security Template That Has a Sensitivity Label Set</title>
<para>In this example, the security administrator wants to create a security
template that recognizes two labels only. In the Solaris Management Console, the administrator
creates a template. Still in the Security Templates tool, she assigns the
gateway host to the template.</para>
<orderedlist>
<listitem>
<para>Each host and IP address that is going to use this template
is added to the Computers and Networks tool.</para>
<screen>host-slset1
192.168.132.21

host-slset2
192.168.132.22

host-slset3
192.168.132.23

host-slset4
192.168.132.24</screen>
</listitem>
<listitem>
<para>The template is created in the Security Templates tool.</para>
<para>The values in the template are the following:</para>
<screen>Template Name: <userinput>CIPSO_PUB_RSTRCT</userinput>
Host Type: <userinput>CIPSO</userinput>
DOI: <userinput>1</userinput>
Minimum Label: <userinput>PUBLIC</userinput>
Maximum Label: <userinput>CONFIDENTIAL : RESTRICTED</userinput>
SL Set: <userinput>PUBLIC, CONFIDENTIAL : RESTRICTED</userinput>
</screen>
<para>The tool supplies the hexadecimal value for the labels.</para>
</listitem>
<listitem>
<para>The range of IP addresses are assigned to the template by
using the Wildcard button and a prefix.</para>
<screen>192.168.132.0/17</screen>
</listitem>
</orderedlist>
</example>
<example xml:id="txconf-49">

<title>Creating an Unlabeled Template at the Label <constant>PUBLIC</constant>
</title>
<para>In this example, the security administrator allows a subnetwork of Solaris computers
to be treated as <constant>PUBLIC</constant> in the trusted network. The template
has the following values:</para>
<screen>Template Name: public
Host Type: Unlabeled
Default Label: Public
Minimum Label: Public
Maximum Label: Public
DOI: 1

Wildcard Entry: 10.10.0.0
Prefix: 16</screen>
<para>All machines on the <literal>10.10.0.0</literal> subnetwork are treated
as being labeled <constant>PUBLIC</constant>.</para>
</example>
<example xml:id="txconf-51">

<title>Creating a Labeled Template for Developers</title>
<para>In this example, the security administrator creates a <constant>SANDBOX</constant> template.
This template is assigned to machines that are used by developers of trusted
software. The two machines that are assigned this template can create and
test labeled programs. However, their tests do not affect the other labeled
systems. The label <constant>SANDBOX</constant> is disjoint from the other
labels on the network.</para>
<screen>Template Name: cipso_sandbox
Host Type: CIPSO
Minimum Label: SANDBOX
Maximum Label: SANDBOX
DOI: 1

Hostname: DevMachine1
IP Address: 196.168.129.129

Hostname: DevMachine2
IP Address: 196.168.129.102</screen>
<para>The users of these machines can communicate with each other at the label <constant>SANDBOX</constant>.</para>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="txconf-9">

<title>How to Add Hosts to the System's Known Network</title>
<indexterm xml:id="indexterm-654">
<primary>Solaris Management Console</primary>
<secondary>Computers and Networks tool</secondary>
</indexterm>
<indexterm xml:id="indexterm-655">
<primary>Computers and Networks tool</primary>
<secondary>adding known hosts</secondary>
</indexterm>
<indexterm xml:id="indexterm-656">
<primary>hosts</primary>
<secondary>entering in network files</secondary>
</indexterm>
<indexterm xml:id="indexterm-657">
<primary>
<filename>/etc/hosts</filename> file</primary>
</indexterm>
<tasksummary>
<para>This tool is identical to the tool in the Solaris OS. This procedure is
provided for convenience. After the hosts are known, you then assign the hosts
to a security template.</para>
</tasksummary>
<taskprerequisites>

<para>You must be in an administrator who can manage networks. For example,
roles that include the Network Management or System Administrator rights profiles
can manage networks.</para>
</taskprerequisites>
<procedure>
<step>
<para>Open the Solaris Management Console.</para>
<para>For details, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-15">How to Open the Trusted Networking Tools</olink>.</para>
</step>
<step>
<para>Navigate from System Configuration to the Computers tool.</para>
<para>When prompted, confirm that you want to see all computers on the network.</para>
</step>
<step>
<para>Add a host that this computer can contact.</para>
<para>You should
add every host that his system might contact, including any static routers,
and any audit servers.</para>
<substeps>
<step>
<para>Choose Add Computer from the Action menu.</para>
</step>
<step>
<para>Click Apply to add the host.</para>
</step>
<step>
<para>Click OK when the entries are complete.</para>
</step>
</substeps>
</step>
<step>
<para>Add a group of hosts that this computer can contact.</para>
<para>Follow
the online help to add groups of computers by using a wildcard.</para>
</step>
</procedure>
</task>
</sect2>
<sect2>
<title/>
<task id="managetnet-16">

<title>How to Assign a Template to a Group of Hosts</title>
<indexterm xml:id="indexterm-658">
<primary>Security Templates tool</primary>
<secondary>assigning templates</secondary>
</indexterm>
<indexterm xml:id="indexterm-659">
<primary>Computers and Networks tool</primary>
<secondary>adding known hosts</secondary>
</indexterm>
<indexterm xml:id="indexterm-660">
<primary>hosts</primary>
<secondary>assigning to security template</secondary>
</indexterm>
<indexterm xml:id="indexterm-661">
<primary>interfaces</primary>
<secondary>assigning to security template</secondary>
</indexterm>
<indexterm xml:id="indexterm-662">
<primary>
<filename>/etc/hosts</filename> file</primary>
</indexterm>
<indexterm xml:id="indexterm-663">
<primary>
<filename>tnrhdb</filename> database</primary>
<secondary>adding to</secondary>
</indexterm>
<indexterm xml:id="indexterm-664">
<primary>administering</primary>
<secondary>remote host database</secondary>
</indexterm>
<indexterm xml:id="indexterm-665">
<primary>remote host templates</primary>
<secondary>assigning to hosts</secondary>
</indexterm>
<taskprerequisites>

<para>You must be in the global zone in a role. The Security Administrator
role modifies security templates and host assignments.</para>
<para>All hosts that you want to assign to a template must exist in the Computers
and Networks tool. For details, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="txconf-9">How to Add
Hosts to the System's Known Network</olink>.</para>
</taskprerequisites>
<procedure>
<step>
<para>In the Security Administrator role, open the Security Templates
tool.</para>
<para>For details, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-15">How to
Open the Trusted Networking Tools</olink>.</para>
</step>
<step>
<para>Double-click the template name.</para>
</step>
<step>
<para>Click the Hosts Assigned to Template tab.</para>
</step>
<step>
<para>To add a single host, do the following:</para>
<substeps>
<step>
<para>Type its name in the Hostname field.</para>
</step>
<step>
<para>Type its address in the IP Address field.</para>
</step>
<step>
<para>Click the Add button.</para>
</step>
<step>
<para>Click OK to save the changes.</para>
</step>
</substeps>
</step>
<step>
<para>To add a group of hosts with contiguous addresses, do the following:</para>
<substeps>
<step>
<para>Click Wildcard.</para>
</step>
<step>
<para>Type an IP address in the IP Address field.</para>
</step>
<step>
<para>Type a prefix that describes the group of contiguous addresses
in the Prefix field.</para>
</step>
<step>
<para>Click the Add button.</para>
</step>
<step>
<para>Click OK to save the changes.</para>
</step>
</substeps>
</step>
</procedure>
<example xml:id="managetnet-26">

<title>Adding an IPv4 Network as a Wildcard Entry</title>
<para>In the following example, a security administrator wanted several IPv4
subnetworks to be assigned to the same security template. In the Hosts Assigned
to Template tab, the administrator added the following wildcard entries:</para>
<screen>IP Address: 192.168.113.0
IP address: 192.168.75.0</screen>
</example>
<example xml:id="managetnet-27">

<title>Adding a List of IPv4 Hosts as a Wildcard Entry</title>
<para>In the following example, a security administrator wanted contiguous
IPv4 addresses that were not along octet boundaries to be assigned to the
same security template. In the Hosts Assigned to Template tab, the administrator
added the following wildcard entries:</para>
<screen>IP Address: 192.168.113.100
Prefix Length: 25</screen>
<para>This wildcard entry covers the address range of <literal>192.168.113.0</literal> to <literal>192.168.113.127</literal>. The address includes <literal>192.168.113.100</literal>.</para>
</example>
<example xml:id="managetnet-28">

<title>Adding a List of IPv6 Hosts as a Wildcard Entry</title>
<para>In the following example, a security administrator wanted contiguous
IPv6 addresses to be assigned to the same security template. In the Hosts
Assigned to Template tab, the administrator added the following wildcard entries:</para>
<screen>IP Address: 2001:a08:3903:200::0
Prefix Length: 56</screen>
<para>This wildcard entry covers the address range of <literal>2001:a08:3903:200::0</literal> to <literal>2001:a08:3903:2ff:ffff:ffff:ffff:ffff</literal>. The
address includes <literal>2001:a08:3903:201:20e:cff:fe08:58c</literal>.</para>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="managetnet-8">

<title>How to Limit the Hosts That Can Be Contacted
on the Trusted Network</title>
<indexterm xml:id="indexterm-666">
<primary>trusted network</primary>
<secondary>0.0.0.0 <filename>tnrhdb</filename> entry</secondary>
</indexterm>
<indexterm xml:id="indexterm-667">
<primary>protecting</primary>
<secondary>labeled hosts from contact by arbitrary unlabeled hosts</secondary>
</indexterm>
<indexterm xml:id="indexterm-668">
<primary>limiting</primary>
<secondary>defined hosts on the network</secondary>
</indexterm>
<indexterm xml:id="indexterm-669">
<primary>protecting</primary>
<secondary>from access by arbitrary hosts</secondary>
</indexterm>
<tasksummary>
<para>This procedure protects labeled hosts from being contacted by arbitrary
unlabeled hosts. The default template when Trusted Extensions is installed defines
every host on the network. Use this procedure to enumerate specific unlabeled
hosts.</para>
<para>The local <filename>tnrhdb</filename> file on each computer is used
to contact the network at boot time. By default, every host that is not provided
with a CIPSO template is defined by the <literal>admin_low</literal> template.
This template assigns every computer that is not otherwise defined, that is, <literal>0.0.0.0</literal>, to be an unlabeled computer with the default label of <literal>admin_low</literal>.</para>
<caution>

<para>
<emphasis role="strong">Security Issue –</emphasis> The
default <constant>admin_low</constant> template can be a security risk on
a Trusted Extensions network. If site security requires strong protection, the
Security Administrator role can remove the <literal>0.0.0.0</literal> entry
after the computer is installed. The entry must be replaced with entries for
every computer that the host contacts during boot.</para>
<para>For example,
DNS servers, home directory servers, audit servers, broadcast and multicast
addresses, and routers would need to be in the local <filename>tnrhdb</filename> file
after the <literal>0.0.0.0</literal> wildcard entry is removed.</para>
</caution>
</tasksummary>
<taskprerequisites>

<para>You must be in the Security Administrator role in the global zone.</para>
<para>All hosts that are to be contacted at boot must exist in the Computers
and Networks tool.</para>
</taskprerequisites>
<procedure>
<step>
<para>Open the Security Templates tool in the Files scope.</para>
<para>The
Files scope protects the system during boot. To access the Security Templates
tool, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-15">How to Open the Trusted Networking
Tools</olink>.</para>
</step>
<step>
<para>Open the <literal>admin_low</literal> template.</para>
<para>Click
the Hosts Assigned to Template tab. Every host that is added can be contacted
during boot at the label <constant>ADMIN_LOW</constant>.</para>
<substeps>
<step>
<para>Add every individual unlabeled host that should be contacted at
boot time.</para>
<para>Include every on-link router that is not running Trusted Extensions,
through which this host must communicate.</para>
</step>
<step>
<para>Add ranges of hosts that should be contacted at boot time.</para>
</step>
<step>
<para>Remove the <literal>0.0.0.0</literal> entry.</para>
</step>
</substeps>
</step>
<step>
<para>Open the <literal>cipso</literal> template.</para>
<para>Click
the Hosts Assigned to Template tab. Every labeled host that is added can be
contacted during boot.</para>
<substeps>
<step>
<para>Add every individual labeled host that should be contacted at
boot time.</para>
<itemizedlist>
<listitem>
<para>Include the LDAP server.</para>
</listitem>
<listitem>
<para>Include every on-link router that is running Trusted Extensions,
through which this host must communicate</para>
</listitem>
<listitem>
<para>Make sure that all network interfaces are assigned to the
template.</para>
</listitem>
<listitem>
<para>Include broadcast addresses.</para>
</listitem>
</itemizedlist>
</step>
<step>
<para>Add groups of hosts that should be contacted at boot time.</para>
</step>
</substeps>
</step>
<step>
<para>Verify that the host assignments allow the computer to boot.</para>
</step>
</procedure>
<example xml:id="managetnet-43">

<title>Changing the Label of the <literal>0.0.0.0</literal> <filename>tnrhdb</filename> Entry</title>
<para>In this example, the security administrator creates a public gateway
system. She removed the <literal>0.0.0.0</literal> entry from the <literal>admin_low</literal> template, and assigns the entry to an unlabeled template that is
named <literal>public</literal>. The system then recognizes any computer that
is not listed in its <filename>tnrhdb</filename> file as an unlabeled system
with the security attributes of the <literal>public</literal> security template.</para>
<para>The following describes an unlabeled template that was created specifically
for public gateways.</para>
<screen>Template Name: public
Host Type: Unlabeled
Default Label: Public
Minimum Label: Public
Maximum Label: Public
DOI: 1</screen>
</example>
<example xml:id="managetnet-45">

<title>Enumerating Computers to Contact During Boot in the <filename>tnrhdb</filename>
</title>
<para>The following example shows the local <filename>tnrhdb</filename> file
with entries for an LDAP client with two network interfaces. The client communicates
with another network and routers.</para>
<screen>127.0.0.1:cipso      <lineannotation>Loopback address</lineannotation>
192.168.112.111:cipso <lineannotation>Interface 1 of this host</lineannotation>
192.168.113.111:cipso <lineannotation>Interface 2 of this host</lineannotation>
10.6.6.2:cipso        <lineannotation>LDAP server</lineannotation>
192.168.113.6:cipso   <lineannotation>Audit server</lineannotation>
192.168.112.255:cipso <lineannotation>Subnet broadcast address</lineannotation>
192.168.113.255:cipso <lineannotation>Subnet broadcast address</lineannotation>
192.168.113.1:cipso   <lineannotation>Router</lineannotation>
192.168.117.0:cipso   <lineannotation>Another Trusted Extensions network</lineannotation>
192.168.112.12:public <lineannotation>Specific network router</lineannotation>
192.168.113.12:public <lineannotation>Specific network router</lineannotation>
224.0.0.2:public      <lineannotation>Multicast address</lineannotation>
255.255.255.255:admin_low <lineannotation>Broadcast address</lineannotation>
</screen>
</example>
</task>
</sect2>
</sect1>
<sect1 xml:id="managetnet-14">
<title>Configuring Routes and Checking Network Information
in Trusted Extensions (Tasks)</title>
<indexterm xml:id="indexterm-670">
<primary>Configuring Routes and Checking Network Information in Trusted Extensions (Tasks)</primary>
</indexterm>
<indexterm xml:id="indexterm-671">
<primary>tasks and task maps</primary>
<secondary>Configuring Routes and Checking Network Information in Trusted Extensions (Tasks)</secondary>
</indexterm>
<informaltable frame="all" pgwide="1">
<tgroup cols="3" colsep="1" rowsep="1">
<colspec colwidth="33*"/>
<colspec colwidth="33*"/>
<colspec colwidth="33*"/>
<thead>
<row>
<entry>
<para>Task</para>
</entry>
<entry>
<para>Description</para>
</entry>
<entry>
<para>For Instructions</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>Configure static routes</para>
</entry>
<entry>
<para>Manually describe the best route from one host to another.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-4">How to Configure Routes With Security
Attributes</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Check database accuracy</para>
</entry>
<entry>
<para>Use the <command>tnchkdb</command> command to check the syntactic validity
of the local network databases.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-32">How to Check the Syntax of Trusted
Network Databases</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Compare the network database entries with the entries in the kernel
cache</para>
</entry>
<entry>
<para>Use the <command>tninfo</command> command to see if the kernel cache
has been updated with the latest database information.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-34">How to Compare Network Database Information
With Kernel Cache</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Synchronize the kernel cache with the network databases</para>
</entry>
<entry>
<para>Use the <command>tnctl</command> command to update the kernel cache
with up-to-date network database information on a running system.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-36">How to Synchronize Kernel Cache With
Network Databases</olink>
</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<sect2>
<title/>
<task id="managetnet-4">

<title>How to Configure Routes With Security Attributes</title>
<indexterm xml:id="indexterm-672">
<primary>routing</primary>
<secondary>static with security attributes</secondary>
</indexterm>
<indexterm xml:id="indexterm-673">
<primary>routing</primary>
<secondary>using <command>route</command> command</secondary>
</indexterm>
<indexterm xml:id="indexterm-674">
<primary>security attributes</primary>
<secondary>using in routing</secondary>
</indexterm>
<indexterm xml:id="indexterm-675">
<primary>administering</primary>
<secondary>routes with security attributes</secondary>
</indexterm>
<indexterm xml:id="indexterm-676">
<primary>configuring</primary>
<secondary>routes with security attributes</secondary>
</indexterm>
<taskprerequisites>

<para>You must be in the Security Administrator role in the global zone.</para>
</taskprerequisites>
<procedure>
<step>
<para>Add every destination host and gateway that you are using in routing.</para>
<para>The addresses are added to the local <filename>/etc/hosts</filename> file,
or to its equivalent on the LDAP server. Use the Computers and Networks tool
in the Solaris Management Console. For details, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-15">How to Open
the Trusted Networking Tools</olink>.</para>
</step>
<step>
<para>Assign each destination host, network, and gateway to a security
template.</para>
<para>The addresses are added to the local <filename>/etc/security/tsol/tnrhdb</filename> file, or to its equivalent on the LDAP server. Use the Security
Templates tool in the Solaris Management Console. For details, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="txconf-9">How
to Add Hosts to the System's Known Network</olink> and <olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-16">How to Assign a Template to a Group of Hosts</olink>.</para>
</step>
<step>
<para>Set up the routes.</para>
<para>In a terminal, use the <command>route
add</command> command to specify routes. Use the <option>
secattr</option> flag
to specify security attributes.</para>
<para>The first entry sets up a default
route. The entry specifies a gateway's address, 192.168.113.1, to use when
no specific route is defined for either the host or the packet's destination.</para>
<screen>route add default <replaceable>gateway-address</replaceable> -interface|-static</screen>
<screen>
<userinput>route add default 192.168.113.1  -static</userinput>
</screen>
<para>For details, see the <olink remap="external" targetdoc="819-2240" targetptr="route-1m">
<citerefentry>
<refentrytitle>route</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man
page.</para>
</step>
<step>
<para>Set up one or more network entries.</para>
<para>In the following
list of commands, the second line shows a network entry. The third line shows
a network entry with a label range of <literal>PUBLIC</literal> to <literal>INTERNAL</literal>.</para>
<screen>default 192.168.113.36  1
<userinput>net 192.168.102.0 gateway-101</userinput>
<userinput>net 192.168.101.0 gateway-102 -secattr min_sl=“PUBLIC”,
max_sl=”CONFIDENTIAL: INTERNAL USE ONLY”,doi=1</userinput>
</screen>
</step>
<step>
<para>Set up one or more host entries.</para>
<para>The new fourth line
shows a host entry for the gateway <literal>gateway-pub</literal>. <literal>gateway-pub</literal> has a label range of <literal>PUBLIC</literal> to <literal>PUBLIC</literal>.</para>
<screen>default 192.168.113.36
net 192.168.102.0 gateway-101
net 192.168.101.0 gateway-102 -secattr min_sl="PUBLIC",
max_sl="CONFIDENTIAL : INTERNAL USE ONLY",doi=1
<userinput>host 192.168.101.3 gateway-pub -secattr min_sl="PUBLIC",
max_sl="PUBLIC",doi=1</userinput>
</screen>
</step>
</procedure>
<example xml:id="managetnet-46">

<title>Adding a Route With a Label Range of <literal>C</literal> to <literal>TS</literal>
</title>
<para>The following <command>route</command> command adds to the routing table
the hosts at 192.168.115.0 and 192.168.118.39 with a label range from <literal>C</literal> to <literal>TS</literal>, and a DOI of 1.</para>
<screen>$ <userinput>route add net 192.168.115.0 192.168.118.39 \</userinput>
<userinput>-secattr min_sl=c,max_sl=ts,doi=1</userinput>

add net 192.168.115.0: gateway 192.168.118.39</screen>
<para>The result of the added hosts is shown with the <command>netstat -rR</command> command.
In the following excerpt, the other routes are replaced by ellipses (...).</para>
<screen>$ <userinput>netstat -rRn</userinput>
...
192.168.115.0        192.168.118.39        UG       0      0  
        min_sl=C,max_sl=TS,DOI=1,CIPSO
...</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="managetnet-32">

<title>How to Check the Syntax of Trusted Network
Databases</title>
<tasksummary>
<para>
<indexterm xml:id="indexterm-677">
<primary>trusted network</primary>
<secondary>checking syntax of files</secondary>
</indexterm>
<indexterm xml:id="indexterm-678">
<primary>verifying</primary>
<secondary>syntax of network databases</secondary>
</indexterm>This command checks that the syntax of each network database is
accurate. The Solaris Management Console runs this command automatically when you use the Security
Templates tool or the Trusted Network Zones tool.</para>
</tasksummary>
<taskprerequisites>

<para>You must be in the global zone in a role that can check network settings.
The Security Administrator role and the System Administrator role can check
these settings.</para>
</taskprerequisites>
<procedure role="single-step">
<step>
<para>Run the <command>tnchkdb</command> command.</para>
<screen>$ <userinput>tnchkdb</userinput>
checking /etc/security/tsol/tnrhtp ...
checking /etc/security/tsol/tnrhdb ...
checking /etc/security/tsol/tnzonecfg ...</screen>
</step>
</procedure>
<example xml:id="managetnet-41">

<title>Testing the Syntax of a Trial Network Database</title>
<para>In this example, the security administrator is testing a network database
file for possible use. Initially, the administrator uses the wrong option.
The results of the check are printed on the line for the <filename>tnrhdb</filename> file:</para>
<screen>$ <userinput>tnchkdb -h /opt/secfiles/trial.tnrhtp</userinput>
checking /etc/security/tsol/tnrhtp ...
checking /opt/secfiles/trial.tnrhtp ...
line 12: Illegal name: min_sl=ADMIN_LOW;max_sl=ADMIN_HIGH
line 14: Illegal name: min_sl=ADMIN_LOW;max_sl=ADMIN_HIGH
checking /etc/security/tsol/tnzonecfg ...</screen>
<para>When the security administrator checks the file by using the <option>
t</option> option,
the command confirms that the syntax of the alternate file is accurate:</para>
<screen>$ <userinput>tnchkdb -t /opt/secfiles/trial.tnrhtp</userinput>
checking /opt/secfiles/trial.tnrhtp ...
checking /etc/security/tsol/tnrhdb ...
checking /etc/security/tsol/tnzonecfg ...</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="managetnet-34">

<title>How to Compare Network Database Information
With Kernel Cache</title>
<tasksummary>
<para>The databases might contain information that is not cached in the kernel.
This procedure checks that the information is identical. The Solaris Management Console runs this
command automatically when you use the Security Templates tool or the Trusted
Network Zones tool.</para>
</tasksummary>
<taskprerequisites>

<para>You must be in the global zone in a role that can check network settings.
The Security Administrator role and the System Administrator role can check
these settings.</para>
</taskprerequisites>
<procedure role="single-step">
<step>
<para>Run the <command>tninfo</command> command.</para>
<itemizedlist>
<listitem>
<para>
<command>tninfo -h <replaceable>hostname</replaceable>
</command> displays
the IP address and template for the specified host.</para>
</listitem>
<listitem>
<para>
<command>tninfo -t <replaceable>templatename</replaceable>
</command> displays
the following information:</para>
<screen>template: <replaceable>template-name</replaceable>
host_type: one of CIPSO or UNLABELED
doi: 1
min_sl: <replaceable>minimum-label</replaceable>
hex: <replaceable>minimum-hex-label</replaceable>
max_sl: <replaceable>maximum-label</replaceable>
hex:<replaceable>maximum-hex-label</replaceable>
</screen>
</listitem>
<listitem>
<para>
<command>tninfo -m <replaceable>zone-name</replaceable>
</command> displays
the multilevel port (MLP) configuration of a zone.</para>
</listitem>
</itemizedlist>
</step>
</procedure>
<example xml:id="managetnet-33">

<title>Displaying Multilevel Ports on a Host</title>
<indexterm xml:id="indexterm-679">
<primary>administering</primary>
<secondary>multilevel ports</secondary>
</indexterm>
<indexterm xml:id="indexterm-680">
<primary>multilevel ports (MLPs)</primary>
<secondary>administering</secondary>
</indexterm>
<para>In this example, a system is configured with several labeled zones.
All zones share the same IP address. Some zones are also configured with zone-specific
addresses. In this configuration, the TCP port for web browsing, port <literal>8080</literal>, is an MLP on a shared interface in the public zone. The administrator
has also set up <command>telnet</command>, TCP port <literal>23</literal>,
to be an MLP in the public zone. Because these two MLPs are on a shared interface,
no other zone, including the global zone, can receive packets on the shared
interface on ports <literal>8080</literal> and <literal>23</literal>.</para>
<para>In addition, the TCP port for <command>ssh</command>, port <literal>22</literal>,
is a per-zone MLP in the public zone. The public zone's <command>ssh</command> service
can receive any packets on its zone-specific address within the address's
label range.</para>
<para>The following are the MLPs for the public zone.</para>
<screen>$ <userinput>tninfo -m public</userinput>
private: 22/tcp
shared:  23/tcp;8080/tcp</screen>
<para>The following are the MLPs for the global zone. Note that ports <literal>23</literal> and <literal>8080</literal> cannot be MLPs in the global zone,
because the global zone shares the same address with the public zone.</para>
<screen>$ <userinput>tninfo -m global</userinput>
private: 111/tcp;111/udp;514/tcp;515/tcp;631/tcp;2049/tcp;
         6000-6003/tcp;38672/tcp;60770/tcp;
shared:  6000-6003/tcp</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="managetnet-36">

<title>How to Synchronize Kernel Cache With Network
Databases</title>
<tasksummary>
<para>When the kernel has not been updated with trusted network database information,
you have several ways to update the kernel cache. The Solaris Management Console runs this command
automatically when you use the Security Templates tool or the Trusted Network
Zones tool.</para>
</tasksummary>
<taskprerequisites>

<para>You must be in the Security Administrator role in the global zone.</para>
</taskprerequisites>
<procedure role="single-step">
<step>
<para>
<indexterm xml:id="indexterm-681">
<primary>
<command>tnctl</command> command</primary>
<secondary>updating kernel cache</secondary>
</indexterm>Run one of the following commands:</para>
<stepalternatives>
<step>
<para>Restart the <command>tnctl</command> service.</para>
<caution>

<para>Do not use this method on systems that get their trusted network
databases information from an LDAP server.</para>
</caution>
<screen>$ <userinput>svcadm restart  svc:/network/tnctl</userinput>
</screen>
<para>This command reads all information from the local trusted network databases
into the kernel.</para>
</step>
<step>
<para>Update the kernel cache for a single host.</para>
<screen>$ tnctl -h <replaceable>hostname</replaceable>
</screen>
<para>This command reads only the information from the chosen option into
the kernel. For details on the options, see the <olink remap="external" targetdoc="819-7307" targetptr="tnctl-1m">
<citerefentry>
<refentrytitle>tnctl</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man page.</para>
</step>
<step>
<para>Change the <command>tnd</command> polling interval.</para>
<para>This
does not update the kernel cache. However, you can shorten the polling interval
to update the kernel cache more frequently. For details, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-17">How to Change the tnd Polling Interval</olink>.</para>
</step>
<step>
<para>Refresh the <command>tnd</command>.</para>
<para>This triggers
an immediate update of recent trusted network database entry changes in the
kernel.</para>
<screen>$ <userinput>svcadm refresh svc:/network/tnd</userinput>
</screen>
</step>
<step>
<para>Restart the <command>tnd</command>.</para>
<para>This is rarely
a good idea. This can interrupt communications that are currently succeeding.
If you plan to restart the <command>tnd</command>, use the <command>svcadm</command> command.</para>
<screen>$ <userinput>svcadm restart svc:/network/tnd</userinput>
</screen>
</step>
</stepalternatives>
</step>
</procedure>
<example xml:id="managetnet-44">

<title>Updating Network Information in the Kernel</title>
<para>
<indexterm xml:id="indexterm-682">
<primary>
<command>tnctl</command> command</primary>
<secondary>using</secondary>
</indexterm>In this example, the administrator updates the trusted network
with a public print server, and then checks that the kernel settings are correct.</para>
<screen>$ <userinput>tnctl -h public-print-server</userinput>
$ <userinput>tninfo -h public-print-server</userinput>
IP Address: 192.168.103.55
Template: PublicOnly
$ <userinput>tninfo -t PublicOnly</userinput>
==================================
Remote Host Template Table Entries
----------------------------------
template: PublicOnly
host_type: CIPSO
doi: 1
min_sl: PUBLIC
hex: 0x0002-08-08
max_sl: PUBLIC
hex: 0x0002-08-08</screen>
</example>
</task>
</sect2>
</sect1>
<sect1 xml:id="managetnet-2">
<title>Troubleshooting the Trusted Network (Tasks)</title>
<indexterm xml:id="indexterm-683">
<primary>troubleshooting</primary>
<secondary>network</secondary>
</indexterm>
<indexterm xml:id="indexterm-684">
<primary>Troubleshooting the Trusted Network (Tasks)</primary>
</indexterm>
<indexterm xml:id="indexterm-685">
<primary>tasks and task maps</primary>
<secondary>Troubleshooting the Trusted Network (Tasks)</secondary>
</indexterm>
<informaltable frame="all" pgwide="1">
<tgroup cols="3" colsep="1" rowsep="1">
<colspec colwidth="33*"/>
<colspec colwidth="33*"/>
<colspec colwidth="33*"/>
<thead>
<row>
<entry>
<para>Task</para>
</entry>
<entry>
<para>Description</para>
</entry>
<entry>
<para>For Instructions</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>Modify the network polling interval</para>
</entry>
<entry>
<para>Change the time to lapse between polls of the system's network traffic.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-17">How to Change the tnd Polling Interval</olink>
</para>
</entry>
</row>
<row>
<entry morerows="1" rowsep="1">
<para>Determine why two hosts cannot communicate</para>
</entry>
<entry>
<para>Check that the interfaces on a single system are up.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="txconf-10">How to Verify That a Host's Interfaces
Are Up</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Use debugging tools when two machines cannot reach each other.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-19">How to Debug the Trusted Extensions
Network</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Determine why an LDAP client cannot reach the LDAP server</para>
</entry>
<entry>
<para>Troubleshoot loss of connection between an LDAP server and a client</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-13.xml" targetptr="manageldap-4">How to Debug a Client Connection to
the LDAP Server</olink>
</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<sect2>
<title/>
<task id="managetnet-17">

<title>How to Change the <command>tnd</command> Polling
Interval</title>
<indexterm xml:id="indexterm-686">
<primary>
<command>tnd</command> command</primary>
<secondary>changing polling interval</secondary>
</indexterm>
<indexterm xml:id="indexterm-687">
<primary>polling trusted network databases</primary>
<secondary>changing</secondary>
</indexterm>
<tasksummary>
<para>By default, the <command>tnd</command> polls the local trusted network
databases and the LDAP service every thirty minutes for changes. When you
are setting up the network, or debugging, you might want to shorten the polling
interval. Because <command>tnd</command> is a service, you use the Service
Management Facility (SMF) to change the interval. For more information, see
the <olink remap="external" targetdoc="819-2252" targetptr="smf-5">
<citerefentry>
<refentrytitle>smf</refentrytitle>
<manvolnum>
5
</manvolnum>
</citerefentry>
</olink> man page.</para>
</tasksummary>
<taskprerequisites>

<para>You must be in the Security Administrator role in the global zone.</para>
</taskprerequisites>
<procedure>
<step>
<para>Change the polling interval for the trusted network daemon.</para>
<screen>$ svccfg -s tnd
  listprop tnd/poll_interval
     integer 1800
  setprop tnd/poll_interval = <replaceable>0-to-1800-seconds</replaceable>
  quit</screen>
</step>
<step>
<para>Then, restart the daemon.</para>
<screen>$ svcadm restart tnd</screen>
</step>
</procedure>
<example xml:id="managetnet-29">

<title>Updating Network Information in the Kernel</title>
<para>In this example, the security administrator is setting up a network.
No users are on the network. Because many changes are going to be made to
the network databases, the administrator ensures that the kernel cache is
updated from network database changes every two minutes. This poll interval
is retained across boots.</para>
<screen>$ svccfg -s tnd
  listprop tnd/poll_interval
     integer 1800
  setprop tnd/poll_interval = 120
  listprop tnd/poll_interval
     integer 120
  quit
$ svcadm restart tnd</screen>
<para>When the network has been set up, the administrator sets the poll interval
to its original value.</para>
<screen>$ svccfg -s tnd
  setprop tnd/poll_interval = 1800
  listprop tnd/poll_interval
     integer 1800
quit
$ svcadm restart tnd</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="txconf-10">

<title>How to Verify That a Host's Interfaces Are Up</title>
<indexterm xml:id="indexterm-688">
<primary>checking</primary>
<secondary>interface is up</secondary>
</indexterm>
<indexterm xml:id="indexterm-689">
<primary>troubleshooting</primary>
<secondary>verifying interface is up</secondary>
</indexterm>
<indexterm xml:id="indexterm-690">
<primary>checking</primary>
<secondary>roles are working</secondary>
</indexterm>
<indexterm xml:id="indexterm-691">
<primary>verifying</primary>
<secondary>interface is up</secondary>
</indexterm>
<indexterm xml:id="indexterm-692">
<primary>interfaces</primary>
<secondary>verifying they are up</secondary>
</indexterm>
<tasksummary>
<para>Use this procedure if your system does not communicate with others as
expected.</para>
</tasksummary>
<taskprerequisites>

<para>You must be in the global zone in a role that can check network settings.
The Security Administrator role and the System Administrator role can check
these settings.</para>
</taskprerequisites>
<procedure>
<step>
<para>Verify that the host's network interface is up.</para>
<screen># <userinput>ifconfig -a</userinput>
...
hme0: flags=1000843&lt;BROADCAST,RUNNING,MULTICAST,IPv4&gt; mtu 1500 index 2
         inet 192.168.0.11 netmask ffffff00 broadcast 192.168.0.255
hme0:3 flags=1000843&lt;BROADCAST,RUNNING,MULTICAST,IPv4&gt; mtu 1500 index 2
         inet 192.168.0.12 netmask ffffff00 broadcast 192.168.0.255</screen>
<para>This system has two network interfaces, <literal>hme0</literal> and <literal>hme0:3</literal>. Neither interface is up.</para>
</step>
<step>
<para>If the interface is not up, bring the interface up.</para>
<para>Then,
check that the interface is up.</para>
<screen># <userinput>ifconfig hme0 up</userinput>
# <userinput>ifconfig -a</userinput>
...
hme0: flags=1000843&lt;<userinput>UP</userinput>,BROADCAST,RUNNING,MULTICAST,...
hme0:3 flags=1000843&lt;<userinput>UP</userinput>,BROADCAST,RUNNING,MULTICAST,..</screen>
</step>
</procedure>
</task>
</sect2>
<sect2>
<title/>
<task id="managetnet-19">

<title>How to Debug the Trusted Extensions Network</title>
<indexterm xml:id="indexterm-693">
<primary>troubleshooting</primary>
<secondary>trusted network</secondary>
</indexterm>
<tasksummary>
<para>
<indexterm xml:id="indexterm-694">
<primary>
<command>snoop</command> command</primary>
</indexterm>
<indexterm xml:id="indexterm-695">
<primary>
<command>netstat</command> command</primary>
</indexterm>
<indexterm xml:id="indexterm-696">
<primary>commands</primary>
<secondary>troubleshooting networking</secondary>
</indexterm>To debug two machines that should be communicating and are not,
you can use Trusted Extensions and Solaris debugging tools. For example, Solaris network
debugging commands such as <command>snoop</command> and <command>netstat</command> are
available. For details, see the <olink remap="external" targetdoc="819-2240" targetptr="snoop-1m">
<citerefentry>
<refentrytitle>snoop</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> and <olink remap="external" targetdoc="819-2240" targetptr="netstat-1m">
<citerefentry>
<refentrytitle>netstat</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man pages. For commands that
are specific to Trusted Extensions, see <olink remap="external" targetdoc="chapter-2.xml" targetptr="txtool-tbl-4">Table
2–4</olink>.</para>
<para>For contacting labeled zones, see <olink remap="external" targetdoc="chapter-10.xml" targetptr="managezones-6">Managing
Zones (Tasks)</olink>.</para>
<para>For debugging NFS mounts, see <olink remap="external" targetdoc="chapter-11.xml" targetptr="managefiles-20">How
to Troubleshoot Mount Failures</olink>.</para>
<para>For debugging LDAP communication, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="manageldap-4">How
to Debug a Client Connection to the LDAP Server</olink>.</para>
</tasksummary>
<taskprerequisites>

<para>You must be in the global zone in a role that can check network settings.
The Security Administrator role and the System Administrator role can check
these settings.</para>
</taskprerequisites>
<procedure>
<step>
<para>Check that the hosts that cannot communicate are using the same
naming service.</para>
<substeps>
<step>
<para>Check the <filename>nsswitch.conf</filename> file on each machine.</para>
</step>
<step>
<para>Check the values for Trusted Extensions databases in the <filename>nsswitch.conf</filename> file.</para>
<screen># Trusted Extensions
tnrhtp: files ldap
tnrhdb: files ldap</screen>
</step>
<step>
<para>If the values are different, fix the <filename>nsswitch.conf</filename> file
to contain the correct values.</para>
<para>
<indexterm xml:id="indexterm-697">
<primary>actions</primary>
<secondary>Name Service Switch</secondary>
</indexterm>
<indexterm xml:id="indexterm-698">
<primary>Name Service Switch action</primary>
</indexterm>To modify these entries, the System Administrator role uses the
Name Service Switch action. For details, see <olink remap="external" targetdoc="chapter-3.xml" targetptr="commontasks-42">How
to Launch CDE Administrative Actions in Trusted Extensions</olink>. This action
preserves the required DAC and MAC file permissions.</para>
</step>
</substeps>
</step>
<step>
<para>Check that the LDAP naming service is configured.</para>
<screen>ldaplist -l</screen>
</step>
<step>
<para>Check that both hosts are in the LDAP naming service.</para>
<screen>ldaplist -l hosts | grep <replaceable>hostname</replaceable>
</screen>
</step>
<step>
<para>Check that each host is defined correctly.</para>
<itemizedlist>
<listitem>
<para>Check that each host is assigned to a security template that
is compatible with the security template of the other host.</para>
</listitem>
<listitem>
<para>On an unlabeled computer, check that the default label assignment
is correct.</para>
</listitem>
<listitem>
<para>Check that the assignment in each host machine's kernel cache
matches the assignment on the network, and on the other host.</para>
</listitem>
<listitem>
<para>Check that the multilevel ports (MLPs) are correctly configured.</para>
</listitem>
</itemizedlist>
<para>
<indexterm xml:id="indexterm-699">
<primary>
<command>tninfo</command> command</primary>
<secondary>using</secondary>
</indexterm>To get security information for the source, destination, and gateway
hosts in the transmission, use the <command>tninfo</command> command.</para>
<substeps>
<step>
<para>Display the IP address and assigned security template for a given
host.</para>
<screen>$ tninfo -h <replaceable>hostname</replaceable>
IP Address: <replaceable>IP-address</replaceable>
Template: <replaceable>template-name</replaceable>
</screen>
</step>
<step>
<para>Display a template definition by using <command>tninfo -t</command>.</para>
<screen>$ tninfo -t <replaceable>template-name</replaceable>
template: <replaceable>template-name</replaceable>
host_type: <replaceable>one of</replaceable> CIPSO <replaceable>or</replaceable> UNLABELED
doi: 1
min_sl: <replaceable>minimum-label</replaceable>
hex: <replaceable>minimum-hex-label</replaceable>
max_sl: <replaceable>maximum-label</replaceable>
hex: <replaceable>maximum-hex-label</replaceable>
</screen>
</step>
<step>
<para>Display the MLPs for a zone by using <command>tninfo -m</command>.</para>
<screen>$ tninfo -m <replaceable>zone-name</replaceable>
private: <replaceable>ports-that-are-specific-to-this-zone-only</replaceable>
shared: <replaceable>ports-that-the-zone-shares-with-other-zones</replaceable>
</screen>
</step>
</substeps>
</step>
<step>
<para>Fix any incorrect information.</para>
<itemizedlist>
<listitem>
<para>To change or check network security information, use the Solaris Management Console tools.
For details, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-15">How to Open the Trusted
Networking Tools</olink>
</para>
</listitem>
<listitem>
<para>To update the kernel cache, restart the <command>tnctl</command> service
on the host whose information is out of date. Allow some time for this process
to complete. Then refresh the <command>tnd</command>. If refresh fails, try
restarting the <command>tnd</command>. For details, see <olink remap="internal" targetdoc="chapter-13.xml" targetptr="managetnet-36">How to Synchronize Kernel Cache With Network Databases</olink>.</para>
<para>Rebooting clears the kernel cache. At boot time, the cache is
populated with database information. The <filename>nsswitch.conf</filename> file
determines whether local databases or LDAP databases are used to populate
the kernel.</para>
</listitem>
</itemizedlist>
</step>
<step>
<para>Collect information to help you in debugging.</para>
<stepalternatives>
<step>
<para>Use the <command>get</command> subcommand to the <command>route</command> command.</para>
<screen>$ route get [ip] -secattr sl=<replaceable>label</replaceable>,doi=<replaceable>integer</replaceable>
</screen>
<para>For details, see the <olink remap="external" targetdoc="819-2240" targetptr="route-1m">
<citerefentry>
<refentrytitle>route</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man
page.</para>
</step>
<step>
<para>Use the <command>snoop -v</command> command.</para>
<para>The <option>
v</option> option displays the details of packet headers, including label
information. This command provides a lot of detail, so you might want to restrict
the packets that the command examines. For details, see the <olink remap="external" targetdoc="819-2240" targetptr="snoop-1m">
<citerefentry>
<refentrytitle>snoop</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man page.</para>
</step>
<step>
<para>Use the <option>
R</option> option with the <command>netstat -a|-r</command> command.</para>
<para>The <option>
aR</option> option displays extended security attributes
for sockets. The <option>
rR</option> option displays routing table entries.
For details, see the <olink remap="external" targetdoc="819-2240" targetptr="netstat-1m">
<citerefentry>
<refentrytitle>netstat</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man
page.</para>
</step>
</stepalternatives>
</step>
</procedure>
</task>
</sect2>
<sect2>
<title/>
<task id="manageldap-4">

<title>How to Debug a Client Connection to the LDAP
Server</title>
<indexterm xml:id="indexterm-700">
<primary>LDAP</primary>
<secondary>troubleshooting</secondary>
</indexterm>
<indexterm xml:id="indexterm-701">
<primary>troubleshooting</primary>
<secondary>LDAP</secondary>
</indexterm>
<tasksummary>
<para>Misconfiguration of the client entry on the LDAP server can prevent
the client from communicating with the server. Similarly, misconfiguration
of files on the client can also prevent communication. Check the following
entries and files when attempting to debug a client-server communication problem.</para>
</tasksummary>
<taskprerequisites>

<para>You must be in the Security Administrator role in the global zone on
the LDAP client.</para>
</taskprerequisites>
<procedure>
<step>
<para>
<indexterm xml:id="indexterm-702">
<primary>
<command>tninfo</command> command</primary>
<secondary>using</secondary>
</indexterm>Check that the remote host template of the LDAP server is correct.</para>
<para>Check also that the remote host template for the gateway to the LDAP
server is correct.</para>
<screen># tninfo -h <replaceable>LDAP-server</replaceable>
# route get <replaceable>LDAP-server</replaceable>
# tninfo -h <replaceable>gateway-to-LDAP-server</replaceable>
</screen>
<para>If a remote host template assignment is incorrect, assign the host to
the correct template in the Solaris Management Console.</para>
</step>
<step>
<para>Check the <filename>/etc/hosts</filename> file.</para>
<para>Your
machine, the interfaces for the labeled zones on your machine, the gateway
to the LDAP server, and the LDAP server should be listed in the file. You
might have more entries.</para>
<para>Look for duplicate entries. Remove any
entries that are labeled zones on other systems. For example, if <literal>Lserver</literal> is the name of your LDAP server, and <literal>LServer-zones</literal> is
the shared interface for the labeled zones, remove <literal>LServer-zones</literal> from <filename>/etc/hosts</filename>.</para>
<para>Correct the file.</para>
</step>
<step>
<para>If you are using DNS, check that the entries in the <filename>resolv.conf</filename> file are accurate.</para>
<screen># more resolv.conf
search <replaceable>list of domains</replaceable>
domain <replaceable>domain-name</replaceable>
nameserver <replaceable>IP-address</replaceable>

...
nameserver <replaceable>IP-address</replaceable>
</screen>
<para>Correct the file.</para>
</step>
<step>
<para>Check that the <filename>tnrhdb</filename> and <filename>tnrhtp</filename> entries
in the <filename>nsswitch.conf</filename> file are accurate.</para>
</step>
<step>
<para>Check that the client is correctly configured on the server.</para>
<screen># ldaplist -l tnrhdb <replaceable>client-IP-address</replaceable>
</screen>
</step>
<step>
<para>Check that the interfaces for your labeled zones are correctly
configured on the LDAP server.</para>
<screen># ldaplist -l tnrhdb <replaceable>client-zone-IP-address</replaceable>
</screen>
</step>
<step>
<para>Verify that you can <command>ping</command> the LDAP server from
all currently running zones.</para>
<screen># ldapclient list
...
NS_LDAP_SERVERS= <replaceable>LDAP-server-address</replaceable>
# zlogin <replaceable>zone-name1</replaceable> ping <replaceable>LDAP-server-address</replaceable>
<replaceable>LDAP-server-address</replaceable> is alive
# zlogin <replaceable>zone-name2</replaceable> ping <replaceable>LDAP-server-address</replaceable>
<replaceable>LDAP-server-address</replaceable> is alive
...</screen>
</step>
<step>
<para>Then, configure LDAP and reboot.</para>
<substeps>
<step>
<para>Run the Create LDAP Client action.</para>
<para>This action re-clients
the global zone to the LDAP server.</para>
</step>
<step>
<para>In every labeled zone, re-client the zone to the LDAP server.</para>
<screen># zlogin <replaceable>zone-name1</replaceable>
# ldapclient init \
-a profileName=<replaceable>profileName</replaceable> \
-a domainName=<replaceable>domain</replaceable> \
-a proxyDN=<replaceable>proxyDN</replaceable> \
-a proxyPassword=<replaceable>password</replaceable> <replaceable>LDAP-Server-IP-Address</replaceable>
# exit
# zlogin <replaceable>zone-name2</replaceable> ...</screen>
</step>
<step>
<para>Then, halt all zones, lock the file systems, and reboot.</para>
<para>If you are using ZFS, halt the zones and lock the file systems before
rebooting. If you are not using ZFS, you can reboot without halting the zones
and locking the file systems.</para>
<screen># zoneadm list
# zoneadm -z <replaceable>zonename</replaceable> halt
# lockfs -fa
# reboot</screen>
</step>
</substeps>
</step>
</procedure>
</task>
</sect2>
</sect1>
</chapter>
