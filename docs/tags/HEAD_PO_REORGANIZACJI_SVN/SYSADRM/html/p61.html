<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Planning and Configuring Non-Global Zones
(Tasks) - System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Solaris Containers-Resource Management and Solaris Zones<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p60.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p62.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="z.conf.start-1"></a>Chapter&nbsp;18<h3>Planning and Configuring Non-Global Zones
(Tasks)</h3><p>This chapter describes what you need to do before you can configure
a zone on your system. This chapter also describes how to configure a zone,
modify a zone configuration, and delete a zone configuration from your system.</p>
<p>For an introduction to the zone configuration process, see <a href="p54.html">Chapter&nbsp;17, Non-Global Zone Configuration (Overview)</a>.</p>
<p>For information about <tt>lx</tt> branded zone configuration,
see <a href="p117.html">Chapter&nbsp;30, Planning the <tt>lx</tt> Branded Zone Configuration (Overview)</a> and <a href="p123.html">Chapter&nbsp;31, Configuring the <tt>lx</tt> Branded Zone (Tasks)</a>.</p>
<a name="z.conf.start-2"></a><h3>Planning and Configuring a Non-Global Zone
(Task Map)</h3>
<p><a name="indexterm-221"></a><a name="indexterm-222"></a>Before you set up your system to use zones, you must first collect
information and make decisions about how to configure the zones. The following
task map summarizes how to plan and configure a zone.</p>
<table><tr><th><p>Task</p>
</th><th><p>Description</p>
</th><th><p>For Instructions</p>
</th></tr>
<tr><td><p>Plan your zone strategy.</p>
</td><td><ul><li><p>Evaluate the applications running on your system to determine
which applications you want to run in a zone.</p>
</li>
<li><p>Assess the availability of disk space to hold the files that
are unique in the zone.</p>
</li>
<li><p>If you are also using resource management features, determine
how to align the zone with the resource management boundaries.</p>
</li>
<li><p>If you are using resource pools, configure the pools if necessary.</p>
</li>
</ul>
</td><td><p>Refer to historical usage. Also see <a href="p61.html#z.conf.start-9">Disk Space Requirements</a> and <a href="p33.html#rmpool-114">Resource Pools Used in Zones</a>.</p>
</td></tr>
<tr><td><p>Determine the name for the zone.</p>
</td><td><p>Decide what to call the zone based on the naming conventions.</p>
</td><td><p>See <a href="p58.html#z.config.ov-12">Zone Configuration Data</a> and <a href="p62.html#z.conf.start-5">Zone Host Name</a>.</p>
</td></tr>
<tr><td><p>Determine the zone path.</p>
</td><td><p>Each zone has a path to its root directory that is relative to the global
zone's root directory.</p>
</td><td><p>See <a href="p58.html#z.config.ov-12">Zone Configuration Data</a>.</p>
</td></tr>
<tr><td><p>Evaluate the need for CPU restriction if you are not configuring resource
pools.</p>
</td><td><p>Review your application requirements.</p>
</td><td><p>See <a href="p54.html#gejlw"><tt>dedicated-cpu</tt> Resource</a>.</p>
</td></tr>
<tr><td><p>Evaluate the need for memory allocation if you plan to cap memory for
the zone by using <tt>rcapd</tt> from the global zone.</p>
</td><td><p>Review your application requirements.</p>
</td><td><p>See <a href="p27.html">Chapter&nbsp;10, Physical Memory Control Using the Resource Capping Daemon (Overview)</a>, <a href="p30.html">Chapter&nbsp;11, Administering the Resource Capping Daemon (Tasks)</a>, and <a href="p55.html#gejkz">Physical Memory Control and the <tt>capped-memory</tt> Resource</a>.</p>
</td></tr>
<tr><td><p>Make the FSS the default scheduler on the system.</p>
</td><td><p>Give each zone CPU shares to control the zone's entitlement to CPU resources.
The FSS guarantees a fair dispersion of CPU resources among zones that is
based on allocated shares.</p>
</td><td><p><a href="p22.html">Chapter&nbsp;8, Fair Share Scheduler (Overview)</a>, <a href="p55.html#gejen">Scheduling Class</a>.</p>
</td></tr>
<tr><td><p>Determine whether the zone will be a shared-IP zone or an exclusive-IP
zone.</p>
</td><td><p>For a shared-IP zone, which is the default, obtain or configure IP addresses
for the zone. Depending on your configuration, you must obtain at least one
IP address for each non-global zone that you want to have network access.</p>
<p>For an exclusive-IP zone, determine the data-link that will be assigned
to the zone. The zone requires exclusive access to one or more network interfaces.
The interface could be a separate LAN such as <tt>bge1</tt>, or
a separate VLAN such as <tt>bge2000</tt>. The data-link must be
GLDv3. A data-link that is <b>not</b> GLDv3 is identified as <tt>type: legacy</tt> in the output of the <tt>dladm</tt> <tt>show-link</tt> command.</p>
</td><td><p>See <a href="p62.html">Determine the Zone Host Name and Obtain the Network Address</a>, <a href="p63.html#z.conf.start-29">How to Configure the Zone</a>, and <i>System Administration Guide: IP Services</i>.</p>
<p>For more information on GLDv3 interfaces, see Solaris OS
Interface Types in <i>System Administration
Guide: IP Services</i>.</p>
</td></tr>
<tr><td><p>Determine which file systems you want to mount in the zone.</p>
</td><td><p>Review your application requirements.</p>
</td><td><p>See <a href="p56.html">File Systems Mounted in Zones</a> for
more information.</p>
</td></tr>
<tr><td><p>Determine which network interfaces should be made available in the zone.</p>
</td><td><p>Review your application requirements.</p>
</td><td><p>See <a href="p98.html#z.admin.ov-12">Shared-IP Network Interfaces</a> for
more information.</p>
</td></tr>
<tr><td><p>Determine whether you must alter the default set of non-global zone
permissions.</p>
</td><td><p>Check the set of privileges: default, privileges that can be added and
removed, and privileges that cannot be used at this time.</p>
</td><td><p>See <a href="p100.html#z.admin.ov-18">Privileges in a Non-Global Zone</a>.</p>
</td></tr>
<tr><td><p>Determine which devices should be configured in each zone.</p>
</td><td><p>Review your application requirements.</p>
</td><td><p>Refer to the documentation for your application.</p>
</td></tr>
<tr><td><p>Configure the zone.</p>
</td><td><p> Use <tt>zonecfg</tt> to create a configuration for the zone.</p>
</td><td><p>See <a href="p63.html">Configuring, Verifying, and Committing a Zone</a>.</p>
</td></tr>
<tr><td><p>Verify and commit the configured zone.</p>
</td><td><p>Determine whether the resources and properties specified are valid on
a hypothetical system.</p>
</td><td><p>See <a href="p63.html">Configuring, Verifying, and Committing a Zone</a>.</p>
</td></tr>
</table><a name="z.conf.start-3"></a><h3>Evaluating the Current System Setup</h3>
<p>Zones can be used on any machine that runs the Solaris 10 or later release.
The following primary machine considerations are associated with the use of
zones.</p>
<ul><li><p>The performance requirements of the applications running within
each zone.</p>
</li>
<li><p>The availability of disk space to hold the files that are
unique within each zone.</p>
</li>
</ul>
<a name="z.conf.start-9"></a><h4>Disk Space Requirements</h4>
<p><a name="indexterm-223"></a>There are no limits on how much disk space can be consumed by
a zone. The global administrator is responsible for space restriction. The
global administrator must ensure that local storage is sufficient to hold
a non-global zone's root file system. Even a small uniprocessor system can
support a number of zones running simultaneously.</p>
<p>The nature of the packages installed in the global zone affects the
space requirements of the non-global zones that are created. The number of
packages and space requirements are factors.</p>
<a name="fgotf"></a><h5>Sparse Root Zones</h5>
<p>Non-global zones that have <tt>inherit-pkg-dir</tt> resources
are called sparse root zones.</p>
<p>The sparse root zone model optimizes the sharing of objects in the following
ways:</p>
<ul><li><p>Only a subset of the packages installed in the global zone
are installed directly into the non-global zone.</p>
</li>
<li><p>Read-only loopback file systems, identified as <tt>inherit-pkg-dir</tt> resources, are used to gain access to other files.</p>
</li>
</ul>
<p>In this model, all packages appear to be installed in the non-global
 zone. Packages that do not deliver content into read-only loopback mount
file systems are fully installed. There is no need to install content  delivered
into read-only loopback mounted file systems since that content is inherited
(and visible) from the global zone.</p>
<ul><li><p>As a general guideline, a zone requires about 100 megabytes
of free disk space per zone when the global zone has been installed with all
of the standard Solaris packages.</p>
</li>
<li><p>By default, any additional packages installed in the global
zone also populate the non-global zones. The amount of disk space required
might be increased accordingly, depending on whether the additional packages
deliver files that reside in the <tt>inherit-pkg-dir</tt> resource
space.</p>
</li>
</ul>
<p>An additional 40 megabytes of RAM per zone are suggested, but not required
on a machine with sufficient swap space.</p>
<a name="fgouj"></a><h5>Whole Root Zones</h5>
<p>The whole root zone model provides the maximum configurability. All
of the required and any selected optional Solaris packages are installed into
the private file systems of the zone. The advantages of this model include
the capability for global administrators to customize their zones file system
layout. This would be done, for example, to add arbitrary unbundled or third-party
packages.</p>
<p>The disk requirements for this model are determined by the disk space
used by the packages currently installed in the global zone.</p>
<hr>
<p><b>Note - </b>If you create a sparse root zone that contains the following <tt>inherit-pkg-dir</tt> directories, you must remove these directories from
the non-global zone's configuration <b>before the zone is installed</b> to
have a whole root zone :</p>
<ul><li><p><tt>/lib</tt></p>
</li>
<li><p><tt>/platform</tt></p>
</li>
<li><p><tt>/sbin</tt></p>
</li>
<li><p><tt>/usr</tt></p>
</li>
</ul>
<p>See <a href="p63.html#z.conf.start-29">How to Configure the Zone</a>.</p>
<hr>
<a name="z.conf.start-13"></a><h4>Restricting Zone Size</h4>
<p><a name="indexterm-224"></a>The following options can be used to restrict zone size:</p>
<ul><li><p>You can place the zone on a <tt>lofi</tt>-mounted
partition. This action will limit the amount of space consumed by the zone
to that of the file used by <tt>lofi</tt>. For more information,
see the <tt>lofiadm</tt>(1M) and <tt>lofi</tt>(7D) man pages.</p>
</li>
<li><p>You can use soft partitions to divide disk slices or logical
volumes into partitions. You can use these partitions as zone roots, and thus
limit per-zone disk consumption. The soft partition limit is 8192 partitions.
For more information, see Chapter 12, Soft Partitions
(Overview), in <i>Solaris Volume Manager
Administration Guide</i>.</p>
</li>
<li><p>You can use the standard partitions of a disk for zone roots,
and thus limit per-zone disk consumption.</p>
</li>
</ul>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p60.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p62.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

