<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title><tt>capped-cpu</tt> Resource - System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Solaris Containers-Resource Management and Solaris Zones<?GenHTML /ReferencePage> > <a href="p54.html">17.&nbsp;&nbsp;Non-Global Zone Configuration (Overview)</a> > <a href="p54.html#z.config.ov-3">Zone Components</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p54.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p56.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="gepzc"></a><h4><tt>capped-cpu</tt> Resource</h4>
<p><a name="indexterm-159"></a><a name="indexterm-160"></a>The <tt>capped-cpu</tt> resource
provides an absolute fine-grained limit on the amount of CPU resources that
can be consumed by a project or a zone. When used in conjunction with  processor
sets, CPU caps limit CPU usage within a set. The <tt>capped-cpu</tt> resource
has a single <tt>ncpus</tt> property that is a positive decimal
with two digits to the right of the decimal. This property corresponds to
units of CPUs. The resource does not accept a range. The resource does accept
a decimal number. When specifying <tt>ncpus</tt>, a value of <tt>1</tt> means 100 percent of a CPU. A value of <tt>1.25</tt> means
125 percent, because 100 percent corresponds to one full CPU on the system.</p>
<hr>
<p><b>Note - </b>The <tt>capped-cpu</tt> resource and the <tt>dedicated-cpu</tt> resource are incompatible.</p>
<hr>
<a name="gejen"></a><h4>Scheduling Class</h4>
<p><a name="indexterm-161"></a>You
can use the <b>fair share scheduler</b> (FSS) to control the
allocation of available CPU resources among zones, based on their importance.
This importance is expressed by the number of <b>shares</b> of
CPU resources that you assign to each zone. Even if you are not using FSS
to manage CPU resource allocation between zones, you can set the zone's scheduling-class
to use FSS so that you can set shares on projects within the zone.</p>
<p>When you explicitly set the <tt>cpu-shares</tt> property,
the fair share scheduler (FSS) will be used as the scheduling class for that
zone. However, the preferred way to use FSS in this case is to set FSS to
be the system default scheduling class with the <tt>dispadmin</tt> command.
That way, all zones will benefit from getting a fair share of the system CPU
resources. If <tt>cpu-shares</tt> is not set for a zone, the zone
will use the system default scheduling class. The following actions set the
scheduling class for a zone:</p>
<ul><li><p>You can use the <tt>scheduling-class</tt> property
in <tt>zonecfg</tt> to set the scheduling class for the zone.</p>
</li>
<li><p>You can set the scheduling class for a zone through the resource
pools facility. If the zone is associated with a pool that has its <tt>pool.scheduler</tt> property set to a valid scheduling class, then processes running
in the zone run in that scheduling class by default. See <a href="p32.html#rmpool-2">Introduction to Resource Pools</a> and <a href="p43.html#rmpool.task-22">How to Associate a Pool With a Scheduling Class</a>.</p>
</li>
<li><p>If the <tt>cpu-shares</tt> rctl is set and FSS has
not been set as the scheduling class for the zone through another action, <tt>zoneadmd</tt> sets the scheduling class to FSS when the zone boots.</p>
</li>
<li><p>If the scheduling class is not set through any other action,
the zone inherits the system default scheduling class.</p>
</li>
</ul>
<p>Note that you can use the <tt>priocntl</tt> described in the <tt>priocntl</tt>(1) man page to move running processes
into a different scheduling class without changing the default scheduling
class and rebooting.</p>
<a name="gejkz"></a><h4>Physical Memory Control and the <tt>capped-memory</tt> Resource</h4>
<p><a name="indexterm-162"></a><a name="indexterm-163"></a>The <tt>capped-memory</tt> resource sets limits for <tt>physical</tt>, <tt>swap</tt>, and <tt>locked</tt> memory.
Each limit is optional, but at least one must be set.</p>
<ul><li><p><a name="indexterm-164"></a>Determine
values for this resource if you plan to cap memory for the zone by using <tt>rcapd</tt> from the global zone. The <tt>physical</tt> property
of the <tt>capped-memory</tt> resource is used by <tt>rcapd</tt> as
the <tt>max-rss</tt> value for the zone.</p>
</li>
<li><p><a name="indexterm-165"></a>The <tt>swap</tt> property of the <tt>capped-memory</tt> resource is
the preferred way to set the <tt>zone.max-swap</tt> resource control.</p>
</li>
<li><p><a name="indexterm-166"></a>The <tt>locked</tt> property of the <tt>capped-memory</tt> resource
is the preferred way to set the <tt>zone.max-locked-memory</tt> resource
control.</p>
</li>
</ul>
<p>For more information, see <a href="p27.html">Chapter&nbsp;10, Physical Memory Control Using the Resource Capping Daemon (Overview)</a>, <a href="p30.html">Chapter&nbsp;11, Administering the Resource Capping Daemon (Tasks)</a>, and <a href="p63.html#z.conf.start-29">How to Configure the Zone</a>.</p>
<a name="z.config.ov-6"></a><h4>Zone Network Interfaces</h4>
<p>Zone network interfaces configured by the <tt>zonecfg</tt> command
to provide network connectivity will automatically be set up and placed in
the zone when it is booted.</p>
<p>The Internet Protocol (IP) layer accepts and delivers packets for the
network. This layer includes IP routing, the Address Resolution Protocol (ARP),
IP security architecture (IPsec), and IP Filter.</p>
<p>There are two IP types available for non-global zones, shared-IP and
exclusive-IP. The shared-IP zone shares a network interface and the exclusive-IP
zone must have a dedicated network interface.</p>
<p>For information about IP features in each type, see <a href="p98.html">Networking in Shared-IP Non-Global Zones</a> and <a href="p99.html">Networking in Exclusive-IP Non-Global Zones</a>.</p>
<a name="gekku"></a><h5>Shared-IP Non-Global Zones</h5>
<p><a name="indexterm-167"></a><a name="indexterm-168"></a>The shared-IP
zone is the default type. The zone must have one or more dedicated IP addresses.
A shared-IP zone shares the IP layer configuration and state with the global
zone. The zone should use the shared-IP instance if both of the following
are true:</p>
<ul><li><p>The zone is to be connected to the same data-link, that is,
be on the same IP subnet or subnets as the global zone</p>
</li>
<li><p>You do not want the other capabilities that the exclusive-IP
zone provides.</p>
</li>
</ul>
<p>Shared-IP zones are assigned one or more IP addresses using the <tt>zonecfg</tt> command. The data-link names must also be configured in the global
zone.</p>
<p>These addresses are associated with logical network interfaces. The <tt>ifconfig</tt> command can be used from the global zone to add or remove
logical interfaces in a running zone. For more information, see <a href="p98.html#z.admin.ov-12">Shared-IP Network Interfaces</a>.</p>
<a name="gekkb"></a><h5>Exclusive-IP Non-Global Zones</h5>
<p><a name="indexterm-169"></a><a name="indexterm-170"></a>Full
IP-level functionality is available in an exclusive-IP zone.</p>
<p>An exclusive-IP zone has its own IP-related state.</p>
<p>This includes the ability to use the following features in an exclusive-IP
zone:</p>
<ul><li><p><a name="indexterm-171"></a>DHCPv4 and IPv6 stateless address autoconfiguration</p>
</li>
<li><p><a name="indexterm-172"></a>IP Filter, including network address translation
(NAT) functionality</p>
</li>
<li><p><a name="indexterm-173"></a>IP Network Multipathing (IPMP)</p>
</li>
<li><p><a name="indexterm-174"></a>IP routing</p>
</li>
<li><p><tt>ndd</tt> for setting TCP/UDP/SCTP as well as
IP/ARP-level knobs</p>
</li>
<li><p>IP security (IPsec) and IKE, which automates the provision
of authenticated keying material for IPsec security association</p>
</li>
</ul>
<p>An exclusive-IP zone is assigned its own set of data-links using the <tt>zonecfg</tt> command. The zone is given a data-link name such as <tt>xge0</tt>, <tt>e1000g1</tt>, or <tt>bge32001</tt>, using
the <tt>physical</tt> property of the <tt>net</tt> resource.
The <tt>address</tt> property of the <tt>net</tt> resource
is not set.</p>
<p>Note that the assigned data-link enables the <tt>snoop</tt> command
to be used.</p>
<p>The <tt>dladm</tt> command can be used with the <tt>show-linkprop</tt> subcommand to show the assignment of data-links to running exclusive-IP
zones. The <tt>dladm</tt> command can be used with the <tt>set-linkprop</tt> subcommand to assign additional data-links to running zones. See <a href="p109.html">Administering Data-Links in Exclusive-IP Non-Global Zones</a> for
usage examples.</p>
<p>Inside a running exclusive-IP zone, the <tt>ifconfig</tt> command
can be used to configure IP, which includes the ability to add or remove logical
interfaces. The IP configuration in a zone can be set up in the same way as
for the global zone, by using the <tt>sysidtools</tt> described
in <tt>sysidcfg</tt>(4).</p>
<hr>
<p><b>Note - </b>The IP configuration of an exclusive-IP zone can only be viewed
from the global zone by using the <tt>zlogin</tt> command. An example
follows.</p>
<pre>global# <tt><b>zlogin zone1 ifconfig -a</b></tt></pre><hr>
<a name="geocw"></a><h5>Security Differences Between Shared-IP and Exclusive-IP
Non-Global Zones</h5>
<p>In a shared-IP zone, applications in the zone, including the superuser,
cannot send packets with source IP addresses other than the ones assigned
to the zone through the <tt>zonecfg</tt> utility. This type of zone
does not have access to send and receive arbitrary data-link (layer 2) packets.</p>
<p>For an exclusive-IP zone, <tt>zonecfg</tt> instead grants
the entire specified data-link to the zone. As a result, the superuser in
an exclusive-IP zone can send spoofed packets on those data-links, just as
can be done in the global  zone.</p>
<a name="geotb"></a><h5>Using Shared-IP and Exclusive-IP Non-Global Zones
at the Same Time</h5>
<p>The shared-IP zones always share the IP layer with the global zone,
and the exclusive-IP zones always have their own instance of the IP layer.
Both shared-IP zones and exclusive-IP zones can be used on the same machine.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p54.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p56.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

