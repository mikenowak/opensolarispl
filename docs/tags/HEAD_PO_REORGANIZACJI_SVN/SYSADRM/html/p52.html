<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Introduction to Solaris Zones - System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Solaris Containers-Resource Management and Solaris Zones<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p51.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p53.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="zones.intro-1"></a>Chapter&nbsp;16<h3>Introduction to Solaris Zones</h3><p>The Solaris Zones facility in the Solaris Operating
System provides an isolated environment in which to run applications on your
system. Solaris Zones are a component of the Solaris Container environment.</p>
<p>This chapter covers the following topics:</p>
<ul><li><p><a href="p52.html#zones.intro-2">Zones Overview</a></p>
</li>
<li><p><a href="p52.html#zones.intro-3">When to Use Zones</a></p>
</li>
<li><p><a href="p52.html#zones.intro-5">How Zones Work</a></p>
</li>
<li><p><a href="p53.html#zones.intro-9">Features Provided by Non-Global Zones</a></p>
</li>
<li><p><a href="p53.html#zones.intro-10">Setting Up Zones on Your System (Task Map)</a></p>
</li>
</ul>
<p>If you are ready to start creating zones on your system, skip to <a href="p54.html">Chapter&nbsp;17, Non-Global Zone Configuration (Overview)</a>.</p>
<hr>
<p><b>Note - </b>For information on branded zones, see <a href="p113.html#gchhk">Part&nbsp;III, Branded Zones</a>.</p>
<p>For information on using zones on a Solaris
Trusted Extensions system, see Chapter 10, Managing
Zones in Trusted Extensions (Tasks), in <i>Solaris
Trusted Extensions Administrator&rsquo;s Procedures</i> and Zones
in Trusted Extensions in <i>Solaris Trusted
Extensions Transition Guide</i>.</p>
<hr>
<a name="zones.intro-2"></a><h3>Zones Overview</h3>
<p><a name="indexterm-138"></a>The Solaris Zones partitioning technology is used to virtualize
operating system services and provide an isolated and secure environment for
running applications. A <b>zone</b> is a virtualized operating
system environment created within a single instance of the Solaris Operating
System. When you create a zone, you produce an application execution environment
in which processes are isolated from the rest of the system. This isolation
prevents processes that are running in one zone from monitoring or affecting
processes that are running in other zones. Even a process running with superuser
credentials cannot view or affect activity in other zones.</p>
<p>A zone also provides an abstract layer that separates applications from
the physical attributes of the machine on which they are deployed. Examples
of these attributes include physical device paths.</p>
<p>Zones can be used on any machine that is running the Solaris 10 or later
release. The upper limit for the number of zones on a system is 8192. The
number of zones that can be effectively hosted on a single system is determined
by the total resource requirements of the application software running in
all of the zones.</p>
<p><a name="indexterm-139"></a><a name="indexterm-140"></a><a name="indexterm-141"></a>There are two types of non-global zone root file
system models: sparse and whole root. The <b>sparse root zone</b> model
optimizes the sharing of objects. The <b>whole root zone</b> model
provides the maximum configurability. These concepts are discussed in <a href="p61.html">Chapter&nbsp;18, Planning and Configuring Non-Global Zones (Tasks)</a>.</p>
<a name="zones.intro-3"></a><h3>When to Use Zones</h3>
<p>Zones are ideal for environments that consolidate a number of applications
on a single server. The cost and complexity of managing numerous machines
make it advantageous to consolidate several applications on larger, more scalable
servers.</p>
<p>The following figure shows a system with four zones. Each of the zones <tt>apps</tt>, <tt>users</tt>, and <tt>work</tt> is running
a workload unrelated to the workloads of the other zones, in a sample consolidated
environment. This example illustrates that different versions of the same
application can be run without negative consequences in different zones, to
match the consolidation requirements. Each zone can provide a customized set
of services.</p>
<a name="zones.intro-fig-14"></a>Figure 16-1 Zones Server Consolidation Example<img src="figures/serv-con-zones.gif" alt=""></img><p>Zones enable more efficient resource utilization on your system. Dynamic
resource reallocation permits unused resources to be shifted to other containers
as needed. Fault and security isolation mean that poorly behaved applications
do not require a dedicated and under-utilized system. With the use of zones,
these applications can be consolidated with other applications.</p>
<p>Zones allow you to delegate some administrative functions while maintaining
overall system security.</p>
<a name="zones.intro-5"></a><h3>How Zones Work</h3>
<p>A non-global zone can be thought of as a box. One or more applications
can run in this box without interacting with the rest of the system. Solaris
zones isolate software applications or services by using flexible, software-defined
boundaries. Applications that are running in the same instance of the Solaris
Operating System can then be managed independently of one other. Thus, different
versions of the same application can be run in different zones, to match the
requirements of your configuration.</p>
<p>A process assigned to a zone can manipulate, monitor, and directly communicate
with other processes that are assigned to the same zone. The process cannot
perform these functions with processes that are assigned to other zones in
the system or with processes that are not assigned to a zone. Processes that
are assigned to different zones are only able to communicate through network
APIs.</p>
<p>IP networking can be configured in two different ways, depending on
whether the zone has its own exclusive IP instance or shares the IP layer
configuration and state with the global zone. For more information about IP
types in zones, see <a href="p55.html#z.config.ov-6">Zone Network Interfaces</a>.
For configuration information, see <a href="p63.html#z.conf.start-29">How to Configure the Zone</a>.</p>
<p><a name="indexterm-142"></a><a name="indexterm-143"></a><a name="indexterm-144"></a><a name="indexterm-145"></a>Every Solaris system contains a <b>global zone</b>.
The global zone has a dual function. The global zone is both the default zone
for the system and the zone used for system-wide administrative control. All
processes run in the global zone if no <b>non-global</b> zones,
referred to simply as zones, are created by the <b>global administrator</b>.</p>
<p>The global zone is the only zone from which a non-global zone can be
configured, installed, managed, or uninstalled. Only the global zone is bootable
from the system hardware. Administration of the system infrastructure, such
as physical devices, routing, or dynamic reconfiguration (DR), is only possible
in the global zone. Appropriately privileged processes running in the global
zone can access objects associated with other zones.</p>
<p>Unprivileged processes in the global zone might be able to perform operations
not allowed to privileged processes in a non-global zone. For example, users
in the global zone can view information about every process in the system.
If this capability presents a problem for your site, you can restrict access
to the global zone.</p>
<p><a name="indexterm-146"></a><a name="indexterm-147"></a>Each zone, including the global zone, is assigned
a zone name. The global zone always has the name <tt>global</tt>.
Each zone is also given a unique numeric identifier, which is assigned by
the system when the zone is booted. The global zone is always mapped to ID <tt>0</tt>.  Zone names and numeric IDs are discussed in <a href="p57.html">Using the <tt>zonecfg</tt> Command</a>.</p>
<p>Each zone also has a node name that is completely independent of the
zone name. The node name is assigned by the administrator of the zone. For
more information, see <a href="p96.html#z.admin.ov-11">Non-Global Zone Node Name</a>.</p>
<p>Each zone has a path to its root directory that is relative to the global
zone's root directory. For more information, see <a href="p57.html">Using the <tt>zonecfg</tt> Command</a>.</p>
<p>The scheduling class for a non-global zone is set to the scheduling
class for the system by default. See <a href="p55.html#gejen">Scheduling Class</a> for
a discussion of methods used to set the scheduling class in a zone.</p>
<a name="zones.intro-17"></a><h4>Summary of Zone Features</h4>
<p><a name="indexterm-148"></a>The following table summarizes the characteristics of global and
non-global zones.</p>
<table><tr><th><p>Type of Zone</p>
</th><th><p>Characteristic</p>
</th></tr>
<tr><td><p>Global</p>
</td><td><p></p>
<ul><li><p>Is assigned ID <tt>0</tt> by the system</p>
</li>
<li><p>Provides the single instance of the Solaris kernel that is
bootable and running on the system</p>
</li>
<li><p>Contains a complete installation of the Solaris system software
packages</p>
</li>
<li><p>Can contain additional software packages or additional software,
directories, files, and other data not installed through packages</p>
</li>
<li><p>Provides a complete and consistent product database that contains
information about all software components installed in the global zone</p>
</li>
<li><p>Holds configuration information specific to the global zone
only, such as the global zone host name and file system table</p>
</li>
<li><p>Is the only zone that is aware of all devices and all file
systems</p>
</li>
<li><p>Is the only zone with knowledge of non-global zone existence
and configuration</p>
</li>
<li><p>Is the only zone from which a non-global zone can be configured,
installed, managed, or uninstalled</p>
</li>
</ul>
</td></tr>
<tr><td><p>Non-Global</p>
</td><td><p></p>
<ul><li><p>Is assigned a zone ID by the system when the zone is booted</p>
</li>
<li><p>Shares operation under the Solaris kernel booted from the
global zone</p>
</li>
<li><p>Contains an installed subset of the complete Solaris Operating
System software packages</p>
</li>
<li><p>Contains Solaris software packages shared from the global
zone</p>
</li>
<li><p>Can contain additional installed software packages not shared
from the global zone</p>
</li>
<li><p>Can contain additional software, directories, files, and other
data created on the non-global zone that are not installed through packages
or shared from the global zone</p>
</li>
<li><p>Has a complete and consistent product database that contains
information about all software components installed on the zone, whether present
on the non-global zone or shared read-only from the global zone</p>
</li>
<li><p>Is not aware of the existence of any other zones</p>
</li>
<li><p>Cannot install, manage, or uninstall other zones, including
itself</p>
</li>
<li><p>Has configuration information specific to that non-global
zone only, such as the non-global zone host name and file system table</p>
</li>
<li><p>Can have its own time zone setting</p>
</li>
</ul>
</td></tr>
</table><a name="zones.intro-11"></a><h4>How Non-Global Zones Are Administered</h4>
<p><a name="indexterm-149"></a><a name="indexterm-150"></a>A global administrator has
superuser privileges or the Primary Administrator role. When logged in to
the global zone, the global administrator can monitor and control the system
as a whole.</p>
<p>A non-global zone can be administered by a <b>zone administrator</b>.
The global administrator assigns the Zone Management profile to the zone administrator.
The privileges of a zone administrator are confined to a non-global zone.</p>
<a name="zones.intro-8"></a><h4>How Non-Global Zones Are Created</h4>
<p><a name="indexterm-151"></a>The global administrator uses the <tt>zonecfg</tt> command
to configure a zone by specifying various parameters for the zone's virtual
platform and application environment. The zone is then installed by the global
administrator, who uses the zone administration command <tt>zoneadm</tt> to
install software at the package level into the file system hierarchy established
for the zone. The <tt>zoneadm</tt> command is used to boot the zone.
The global administrator can then log in to the installed zone by using the <tt>zlogin</tt> command. At first login, the internal configuration for the
zone is completed.</p>
<p>For information about zone configuration, see <a href="p54.html">Chapter&nbsp;17, Non-Global Zone Configuration (Overview)</a>. For information about zone installation, see <a href="p67.html">Chapter&nbsp;19, About Installing, Halting, Cloning, and Uninstalling Non-Global Zones (Overview)</a>. For information about
zone login, see <a href="p75.html">Chapter&nbsp;21, Non-Global Zone Login (Overview)</a>.</p>
<a name="zones.intro-12"></a><h4>Non-Global Zone State Model</h4>
<p><a name="indexterm-152"></a><a name="indexterm-153"></a>A non-global
zone can be in one of the following six states:</p>
<dl><dt>Configured</dt>
<dd><p>The zone's configuration is complete and committed to stable
storage. However, those elements of the zone's application environment that
must be specified after initial boot are not yet present.</p>
</dd>
<dt>Incomplete</dt>
<dd><p>During an install or uninstall operation, <tt>zoneadm</tt> sets
the state of the target zone to incomplete. Upon successful completion of
the operation, the state is set to the correct state.</p>
<p>A damaged installed zone can be marked incomplete by using the <tt>mark</tt> subcommand of <tt>zoneadm</tt>. Zones in the incomplete
state are shown in the output of <tt>zoneadm</tt> <tt>list</tt> <tt>-iv</tt>.</p>
</dd>
<dt>Installed</dt>
<dd><p>The zone's configuration is instantiated on the system. The <tt>zoneadm</tt> command is used to verify that the configuration can be
successfully used on the designated Solaris system. Packages are installed
under the zone's root path. In this state, the zone has no associated virtual
platform.</p>
</dd>
<dt>Ready</dt>
<dd><p>The virtual platform for the zone is established. The kernel
creates the <tt>zsched</tt> process, network interfaces are set
up and made available to the zone, file systems are mounted, and devices are
configured. A unique zone ID is assigned by the system. At this stage, no
processes associated with the zone have been started.</p>
</dd>
<dt>Running</dt>
<dd><p>User processes associated with the zone application environment
are running. The zone enters the running state as soon as the first user process
associated with the application environment (<tt>init</tt>) is created.</p>
</dd>
<dt>Shutting down and Down</dt>
<dd><p>These states are transitional states that are visible while
the zone is being halted. However, a zone that is unable to shut down for
any reason will stop in one of these states.</p>
</dd>
</dl>
<p><a href="p70.html">Chapter&nbsp;20, Installing, Booting, Halting, Uninstalling,  and Cloning Non-Global Zones (Tasks)</a> and the <tt>zoneadm</tt>(1M) man page describe how to
use the <tt>zoneadm</tt> command to initiate transitions between
these states.</p>
<a name="zones.intro-tbl-15"></a>Table 16-1 Commands That Affect Zone
State<table><tr><th><p>Current Zone State</p>
</th><th><p>Applicable Commands</p>
</th></tr>
<tr><td><p>Configured</p>
</td><td><p><tt>zonecfg</tt> <tt>-z</tt> <i>zonename</i> <tt>verify</tt></p>
<p><tt>zonecfg</tt> <tt>-z</tt> <i>zonename</i> <tt>commit</tt></p>
<p><tt>zonecfg</tt> <tt>-z</tt> <i>zonename</i> <tt>delete</tt></p>
<p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>attach</tt></p>
<p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>verify</tt></p>
<p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>install</tt></p>
<p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>clone</tt></p>
<p>You can also use <tt>zonecfg</tt> to rename a zone in the
configured or installed state.</p>
</td></tr>
<tr><td><p>Incomplete</p>
</td><td><p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>uninstall</tt></p>
</td></tr>
<tr><td><p>Installed</p>
</td><td><p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>ready</tt> (optional)</p>
<p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>boot</tt></p>
<p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>uninstall</tt> uninstalls the configuration of the specified zone from
the system.</p>
<p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>move</tt> <i>path</i> </p>
<p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>detach</tt></p>
<p><tt>zonecfg</tt> <tt>-z</tt> <i>zonename</i> can
be used to add or remove an <tt>attr</tt>, <tt>bootargs</tt>, <tt>capped-memory</tt>, <tt>dataset</tt>, <tt>capped-cpu</tt>, <tt>dedicated-cpu</tt>, <tt>device</tt>, <tt>fs</tt>, <tt>ip-type</tt>, <tt>limitpriv</tt>, <tt>net</tt>, <tt>rctl</tt>, or <tt>scheduling-class</tt> property. You can also
rename a zone in the installed state. The <tt>inherit-pkg-dir</tt> resources
cannot be changed.</p>
</td></tr>
<tr><td><p>Ready</p>
</td><td><p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>boot</tt></p>
<p><tt>zoneadm</tt> <tt>halt</tt> and system reboot
return a zone in the ready state to the installed state.</p>
<p><tt>zonecfg</tt> <tt>-z</tt> <i>zonename</i> can
be used to add or remove <tt>attr</tt>, <tt>bootargs</tt>, <tt>capped-memory</tt>, <tt>dataset</tt>, <tt>capped-cpu</tt>, <tt>dedicated-cpu</tt>, <tt>device</tt>, <tt>fs</tt>, <tt>ip-type</tt>, <tt>limitpriv</tt>, <tt>net</tt>, <tt>rctl</tt>, or <tt>scheduling-class</tt> property. The <tt>inherit-pkg-dir</tt> resources cannot be changed.</p>
</td></tr>
<tr><td><p>Running</p>
</td><td><p><tt>zlogin</tt> <i>options</i> <tt>zonename</tt></p>
<p><tt>zoneadm</tt> <tt>-z</tt> <i>zonename</i> <tt>reboot</tt></p>
<p><tt>zoneadm</tt> <tt>-z</tt><i> zonename</i> <tt>halt</tt> returns a ready zone to the installed state.</p>
<p><tt>zoneadm</tt> <tt>halt</tt> and system reboot
return a zone in the running state to the installed state.</p>
<p><tt>zonecfg</tt> <tt>-z</tt> <i>zonename</i> can
be used to add or remove an <tt>attr</tt>, <tt>bootargs</tt>, <tt>capped-memory</tt>, <tt>dataset</tt>, <tt>capped-cpu</tt>, <tt>dedicated-cpu</tt>, <tt>device</tt>, <tt>fs</tt>, <tt>ip-type</tt>, <tt>limitpriv</tt>, <tt>net</tt>, <tt>rctl</tt>, or <tt>scheduling-class</tt> property. The <tt>zonepath</tt> and<tt> inherit-pkg-dir</tt> resources cannot be changed.</p>
</td></tr>
</table><hr>
<p><b>Note - </b>Parameters changed through <tt>zonecfg</tt> do not affect
a running zone. The zone must be rebooted for the changes to take effect.</p>
<hr>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p51.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p53.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

