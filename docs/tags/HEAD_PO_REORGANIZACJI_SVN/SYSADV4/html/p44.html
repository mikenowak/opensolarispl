<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title><tt>share</tt> Command - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p31.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a> > <a href="p36.html">NFS Commands</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p43.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p45.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="rfsrefer-25"></a><h4><tt>share</tt> Command</h4>
<a name="indexterm-608"></a><hr>
<p><b>Note - </b>Starting
with the Solaris Express, Developer Edition 2/07 release, <tt>sharemgr</tt> and <tt>sharectl</tt> are the preferred utilities for managing your file systems
and file-sharing protocols. See <a href="p38.html"><tt>sharemgr</tt> Command</a> and <a href="p43.html"><tt>sharectl</tt> Command</a></p>
<hr>
<p><a name="indexterm-609"></a>With this command, you can make a local file system on an NFS
server available for mounting. You can also use the <tt>share</tt> command
to display a list of the file systems on your system that are currently shared.
The NFS server must be running for the <tt>share</tt> command to
work. The NFS server software is started automatically during boot if an entry
is in <tt>/etc/dfs/dfstab</tt>. The command does not report an
error if the NFS server software is not running, so you must verify that the
software is running.  </p>
<p>The objects that can be shared include any directory tree. However,
each file system hierarchy is limited by the disk slice or partition that
the file system is located on. For instance, sharing the root (<tt>/</tt>)
file system would not also share <tt>/usr</tt>, unless these directories
are on the same disk partition or slice. Normal installation places root on
slice 0 and <tt>/usr</tt> on slice 6. Also, sharing <tt>/usr</tt> would
not share any other local disk partitions that are mounted on subdirectories
of <tt>/usr</tt>.</p>
<p>A file system cannot be shared if that file system is part of a larger
file system that is already being shared. For example, if <tt>/usr</tt> and <tt>/usr/local</tt> are on one disk slice, <tt>/usr</tt> can
be shared or <tt>/usr/local</tt> can be shared. However, if both
directories need to be shared with different share options, <tt>/usr/local</tt> must
be moved to a separate disk slice.</p>
<p><a name="indexterm-610"></a><a name="indexterm-611"></a><a name="indexterm-612"></a><a name="indexterm-613"></a>You can gain access to a file system that is read-only shared
through the file handle of a file system that is read-write shared. However,
the two file systems have to be on the same disk slice. You can create a more
secure situation. Place those file systems that need to be read-write on a
separate partition or separate disk slice from the file systems that you need
to share as read-only.     </p>
<hr>
<p><b>Note - </b>For information about how NFS version 4 functions when a file
system is unshared and then reshared, refer to <a href="p48.html#rfsrefer-148">Unsharing and Resharing a File System in NFS Version 4</a>.</p>
<hr>
<a name="rfsrefer-26"></a><h5>Non-File-System-Specific <tt>share</tt> Options</h5>
<p><a name="indexterm-614"></a><a name="indexterm-615"></a><a name="indexterm-616"></a>Some of the options that you can include with the <tt>-o</tt> flag
are as follows.  </p>
<dl><dt>rw|ro</dt>
<dd><p><a name="indexterm-617"></a><a name="indexterm-618"></a><a name="indexterm-619"></a><a name="indexterm-620"></a><a name="indexterm-621"></a><a name="indexterm-622"></a>The <i>pathname</i> file system is shared
read-write or read-only for all clients.      </p>
</dd>
<dt>rw=<i>accesslist</i></dt>
<dd><p><a name="indexterm-623"></a><a name="indexterm-624"></a>The file system is shared read-write for the clients that are
listed only. All other requests are denied. Starting with the Solaris 2.6
release, the list of clients that are defined in <i>accesslist</i> has
been expanded. See <a href="p44.html#rfsrefer-27">Setting Access Lists With the <tt>share</tt> Command</a> for more information. You can use this option to
override an <tt>-ro</tt> option.  </p>
</dd>
</dl>
<a name="rfsrefer-103"></a><h5>NFS-Specific <tt>share</tt> Options</h5>
<p>The options that you can use with NFS file systems include the following.</p>
<dl><dt>aclok</dt>
<dd><p>This option enables an NFS server that supports the NFS version
2 protocol to be configured to do access control for NFS version 2 clients.
Without this option, all clients are given minimal access. With this option,
the clients have maximal access. For instance, on file systems that are shared
with the <tt>-aclok</tt> option, if anyone has read permissions, everyone
does. However, without this option, you can deny access to a client who should
have access permissions. A decision to permit too much access or too little
access depends on the security systems already in place. See Using Access Control Lists to Protect Files in <i>System Administration Guide: Security Services</i> for more information
about access control lists (ACLs).</p>
<hr>
<p><b>Note - </b>To use ACLs, ensure that clients and servers run software that
supports the NFS version 3 and NFS_ACL protocols. If the software only supports
the NFS version 3 protocol, clients obtain correct access but cannot manipulate
the ACLs. If the software supports the NFS_ACL protocol, the clients obtain
correct access and can manipulate the ACLs. Starting with the Solaris 2.5
release, the Solaris system supports both protocols.</p>
<hr>
</dd>
<dt>anon=<i>uid</i></dt>
<dd><p><a name="indexterm-625"></a><a name="indexterm-626"></a>You use <i>uid</i> to select the user ID of
unauthenticated users. If you set <i>uid</i> to <tt>-1</tt>,
the server denies access to unauthenticated users. You can grant root access
by setting <tt>anon=0</tt>, but this option allows unauthenticated
users to have root access, so use the <tt>root</tt> option instead.
 </p>
</dd>
<dt>index=<i>filename</i></dt>
<dd><p>When a user accesses an NFS URL, the <tt>-index=</tt><i>filename</i> option forces the HTML file to load, instead of displaying
a list of the directory. This option mimics the action of current browsers
if an <tt>index.html</tt> file is found in the directory that
the HTTP URL is accessing. This option is the equivalent of setting the <tt>DirectoryIndex</tt> option for <tt>httpd</tt>. For instance,
suppose that the <tt>dfstab</tt> file entry resembles the following:</p>
<pre>share -F nfs -o ro,public,index=index.html /export/web</pre><p>These URLs then display the same information:</p>
<pre>nfs://&lt;<i>server</i>>/&lt;<i>dir</i>>
nfs://&lt;<i>server</i>>/&lt;<i>dir</i>>/index.html
nfs://&lt;<i>server</i>>//export/web/&lt;<i>dir</i>>
nfs://&lt;<i>server</i>>//export/web/&lt;<i>dir</i>>/index.html
http://&lt;<i>server</i>>/&lt;<i>dir</i>>
http://&lt;<i>server</i>>/&lt;<i>dir</i>>/index.html</pre></dd>
<dt>log=<i>tag</i></dt>
<dd><p><a name="indexterm-627"></a>This option specifies the tag in <tt>/etc/nfs/nfslog.conf</tt> that
contains the NFS server logging configuration information for a file system.
This option must be selected to enable NFS server logging. </p>
</dd>
<dt>nosuid</dt>
<dd><p><a name="indexterm-628"></a><a name="indexterm-629"></a><a name="indexterm-630"></a>This option signals that all attempts to enable the <tt>setuid</tt> or <tt>setgid</tt> mode should be ignored. NFS clients cannot create files with
the <tt>setuid</tt> or <tt>setgid</tt> bits on.  </p>
</dd>
<dt>public</dt>
<dd><p>The <tt>-public</tt> option has been added to the <tt>share</tt> command to enable WebNFS browsing. Only one file system on
a server can be shared with this option.</p>
</dd>
<dt>root=<i>accesslist</i></dt>
<dd><p><a name="indexterm-631"></a><a name="indexterm-632"></a>The server gives root access to the hosts in the list. By default,
the server does not give root access to any remote hosts. If the selected
security mode is anything other than <tt>-sec=sys</tt>, you can only
include client host names in the <i>accesslist</i>. Starting
with the Solaris 2.6 release, the list of clients that are defined in <i>accesslist</i> is expanded. See <a href="p44.html#rfsrefer-27">Setting Access Lists With the <tt>share</tt> Command</a> for more information.  </p>
<hr>
<p><b>Caution - </b><a name="indexterm-633"></a><a name="indexterm-634"></a><a name="indexterm-635"></a>Granting root access to other hosts has wide security implications.
Use the <tt>-root=</tt> option with extreme caution.   </p>
<hr>
</dd>
<dt>root=<i>client-name</i></dt>
<dd><p>The <i>client-name</i> value is used with
AUTH_SYS authentication to check the client's IP address against a list of
addresses provided by <tt>exportfs</tt>(1B).
 If a match is found, <tt>root</tt> access is given to the file
systems being shared.</p>
</dd>
<dt>root=<i>host-name</i></dt>
<dd><p>For secure NFS modes, such as AUTH_SYS or RPCSEC_GSS, the
server checks the clients' principal names against a list of host-based principal
names that are derived from an access list. The generic syntax for the client's
principal  name is <tt>root@</tt><i>hostname</i>.
For Kerberos V the syntax is <tt>root/</tt><i>hostname.fully.qualified</i><tt>@REALM</tt>. When you use the <i>host-name</i> value,
the clients on the access list must have the credentials for a principal name.
For Kerberos V, the client must have a valid keytab entry for its <tt>root/</tt><i>hostname.fully.qualified</i><tt>@REALM</tt> principal
name. For more information, see Configuring Kerberos Clients in <i>System Administration Guide: Security Services</i>.</p>
</dd>
<dt>sec=<i>mode</i>[:<i>mode</i>]</dt>
<dd><p><i>mode</i> selects the security modes
that are needed to obtain access to the file system. By default, the security
mode is UNIX authentication. You can specify multiple modes, but use each
security mode only once per command line. Each <tt>-mode</tt> option
applies to any subsequent <tt>-rw</tt>, <tt>-ro</tt>, <tt>-rw=</tt>, <tt>-ro=</tt>, <tt>-root=</tt>, and <tt>-window=</tt> options
until another <tt>-mode</tt> is encountered. The use of <tt>-sec=none</tt> maps
all users to user <tt>nobody</tt>.</p>
</dd>
<dt>window=<i>value</i></dt>
<dd><p><i>value</i> selects the maximum lifetime
in seconds of a credential on the NFS server. The default value is 30000 seconds
or 8.3 hours.</p>
</dd>
</dl>
<a name="rfsrefer-27"></a><h5>Setting Access Lists With the <tt>share</tt> Command</h5>
<p>In Solaris releases prior to 2.6, the <i>accesslist</i> that
was included with either the <tt>-ro=</tt>, <tt>-rw=</tt>, or <tt>-root=</tt> option of the <tt>share</tt> command was restricted
to a list of host names or netgroup names. Starting with the Solaris 2.6 release,
the access list can also include a domain name, a subnet number, or an entry
to deny access. These extensions should simplify file access control on a
single server without having to change the namespace or maintain long lists
of clients.</p>
<p><a name="indexterm-636"></a><a name="indexterm-637"></a><a name="indexterm-638"></a><a name="indexterm-639"></a><a name="indexterm-640"></a><a name="indexterm-641"></a>This command provides read-only access for most systems but allows
read-write access for <tt>rose</tt> and <tt>lilac</tt>:
     </p>
<pre># <tt><b>share -F nfs -o ro,rw=rose:lilac /usr/src</b></tt></pre><p><a name="indexterm-642"></a><a name="indexterm-643"></a><a name="indexterm-644"></a>In the next example, read-only access is assigned to any host
in the <tt>eng</tt> netgroup. The client <tt>rose</tt> is
specifically given read-write access.   </p>
<pre># <tt><b>share -F nfs -o ro=eng,rw=rose /usr/src</b></tt></pre><hr>
<p><b>Note - </b>You cannot specify both <tt>rw</tt> and <tt>ro</tt> without
arguments. If no read-write option is specified, the default is read-write
for all clients.</p>
<hr>
<p>To share one file system with multiple clients, you must type all options
on the same line. Multiple invocations of the <tt>share</tt> command
on the same object &ldquo;remember&rdquo; only the last command that is run.
This command enables read-write access to three client systems, but only <tt>rose</tt> and <tt>tulip</tt> are given access to the file system
as <tt>root</tt>.</p>
<pre># <tt><b>share -F nfs -o rw=rose:lilac:tulip,root=rose:tulip /usr/src</b></tt></pre><p>When sharing a file system that uses multiple authentication mechanisms,
ensure that you include the <tt>-ro</tt>, <tt>-ro=</tt>, <tt>-rw</tt>, <tt>-rw=</tt>, <tt>-root</tt>, and <tt>-window</tt> options
after the correct security modes. In this example, UNIX authentication is
selected for all hosts in the netgroup that is named <tt>eng</tt>.
These hosts can only mount the file system in read-only mode. The hosts <tt>tulip</tt> and <tt>lilac</tt> can mount the file system read-write
if these hosts use Diffie-Hellman authentication. With these options, <tt>tulip</tt> and <tt>lilac</tt> can mount the file system read-only
even if these hosts are not using DH authentication. However, the host names
must be listed in the <tt>eng</tt> netgroup. </p>
<pre># <tt><b>share -F nfs -o sec=dh,rw=tulip:lilac,sec=sys,ro=eng /usr/src</b></tt></pre><p>Even though UNIX authentication is the default security mode, UNIX authentication
is not included if the <tt>-sec</tt> option is used. Therefore, you
must include a <tt>-sec=sys</tt> option if UNIX authentication is to
be used with any other authentication mechanism.</p>
<p>You can use a DNS domain name in the access list by preceding the actual
domain name with a dot. The string that follows the dot is a domain name,
not a fully qualified host name. The following entry allows mount access to
all hosts in the <tt>eng.example.com</tt> domain:</p>
<pre># <tt><b>share -F nfs -o ro=.:.eng.example.com /export/share/man</b></tt></pre><p>In this example, the single &ldquo;<tt>.</tt>&rdquo; matches
all hosts that are matched through the NIS or NIS+ namespaces.  The results
that are returned from these name services do not include the domain name.
The &ldquo;<tt>.eng.example.com</tt>&rdquo; entry matches all hosts
that use DNS for namespace resolution. DNS always returns a fully qualified
host name. So, the longer entry is required if you use a combination of DNS
and the other namespaces.</p>
<p>You can use a subnet number in an access list by preceding the actual
network number or the network name with &ldquo;<tt>@</tt>&rdquo;.
This character differentiates the network name from a netgroup or a fully
qualified host name. You must identify the subnet in either <tt>/etc/networks</tt> or in an NIS or NIS+ namespace. The following entries have the
same effect if the <tt>192.168</tt> subnet has been identified as
the <tt>eng</tt> network:</p>
<pre># <tt><b>share -F nfs -o ro=@eng /export/share/man</b></tt>
# <tt><b>share -F nfs -o ro=@192.168 /export/share/man</b></tt>
# <tt><b>share -F nfs -o ro=@192.168.0.0 /export/share/man</b></tt></pre><p>The last two entries show that you do not need to include the full network
address.</p>
<p>If the network prefix is not byte aligned, as with Classless Inter-Domain
Routing (CIDR), the mask length can be explicitly specified on the command
line. The mask length is defined by following either the network name or the
network number with a slash and the number of significant bits in the prefix
of the address. For example:</p>
<pre># <tt><b>share -f nfs -o ro=@eng/17 /export/share/man</b></tt>
# <tt><b>share -F nfs -o ro=@192.168.0/17 /export/share/man</b></tt></pre><p>In these examples, the &ldquo;<tt>/17</tt>&rdquo; indicates
that the first 17 bits in the address are to be used as the mask. For additional
information about CIDR, look up RFC 1519.</p>
<p>You can also select negative access by placing a &ldquo;<tt>-</tt>&rdquo;
before the entry. Note that the entries are read from left to right. Therefore,
you must place the negative access entries before the entry that the negative
access entries apply to:</p>
<pre># <tt><b>share -F nfs -o ro=-rose:.eng.example.com /export/share/man</b></tt></pre><p>This example would allow access to any hosts in the <tt>eng.example.com</tt> domain except the host that is named <tt>rose</tt>.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p43.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p45.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

