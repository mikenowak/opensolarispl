<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>How to Control Downloads to the FTP Server - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p158.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a> > <a href="p163.html">Controlling Uploads and Downloads on the FTP Server</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p163.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p165.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="wuftp-173"></a><h4><img src="graphics/procedure.gif"> How to Control Downloads to the FTP Server</h4>
<ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="wuftp-step-176"></a><b>Add the following entries to the <tt>ftpaccess</tt> file to prevent users from retrieving files.</b><pre>noretrieve [absolute|relative] [class=<i>classname]...</i> [-] <i>filename ...</i></pre><dl><dt><tt>noretrieve</tt></dt>
<dd><p>Keyword that is used to deny retrieval of a particular file
or files</p>
</dd>
<dt><tt>absolute|relative</tt></dt>
<dd><p>Parameter that specifies whether the <i>root-dir</i> 
directory paths are interpreted as absolute or relative to the current <tt>chroot</tt> directory</p>
</dd>
<dt><tt>class</tt></dt>
<dd><p>Keyword that is used to specify <tt>class=&lt;classname></tt> of
users to which <tt>noretrieve</tt> restrictions apply </p>
</dd>
<dt><i>filename</i></dt>
<dd><p>Name of file the user is not permitted to retrieve</p>
</dd>
</dl>
</li></ol>Example 28-14 Controlling Downloads to the FTP Server<pre>noretrieve /etc/passwd</pre><p>The preceding example states that all users are prevented from retrieving
the <tt>/etc/passwd</tt> file.</p>
<a name="wuftp-15a2"></a><h3>Virtual Hosting</h3>
<p>Virtual hosting allows the FTP server to support multiple domains on
the same machine. Each virtual host requires a separate logical interface
and IP address.</p>
<p>The FTP server supports two types of virtual hosting: <b>limited</b> and <b>complete</b>. With limited virtual hosting, the same configuration
files are used for all virtual hosts. With complete virtual hosting, separate
configuration files can be used for each virtual host.</p>
<hr>
<p><b>Note - </b>By default, real and guest users are not allowed to log in to
virtual hosts. You can set the following <tt>ftpaccess</tt> directives
to override the default.</p>
<pre>To allow access to specific users:
virtual <i>address</i> allow <i>username</i>
To deny access to anonymous users:
virtual <i>address</i> private <i>username</i></pre><hr>
<p>See <tt>ftpaccess</tt>(4) for
further information.</p>
<a name="wuftp-179"></a><h4><img src="graphics/procedure.gif"> How to Enable Limited Virtual Hosting</h4>
<p>Limited virtual hosting provides partial support for virtual FTP servers.
You can enable support for limited virtual hosting by specifying the virtual
root directory. If required, you can also set the following parameters for
the virtual host in the <tt>ftpaccess</tt> file:</p>
<ul><li><p><tt>banner</tt></p>
</li>
<li><p><tt>logfile</tt></p>
</li>
<li><p><tt>email</tt></p>
</li>
<li><p><tt>hostname</tt></p>
</li>
</ul>
<p>All directives in the <tt>ftpaccess</tt> file are shared
globally across all virtual servers.</p>
<ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="wuftp-step-182"></a><b>Add the following entries to the <tt>ftpaccess</tt> file.</b><pre>virtual <i>address</i> root|banner|logfile <i>path</i>
virtual <i>address</i> hostname|email <i>string</i></pre><dl><dt><tt>virtual</tt></dt>
<dd><p>Keyword that is used to enable virtual server capabilities</p>
</dd>
<dt><i>address</i></dt>
<dd><p>IP address of the virtual server</p>
</dd>
<dt><tt>root</tt></dt>
<dd><p>The root directory of the virtual server</p>
</dd>
<dt><tt>banner</tt></dt>
<dd><p>Banner file that is displayed when a connection is made to
the virtual server</p>
</dd>
<dt><tt>logfile</tt></dt>
<dd><p>Record of file transfers that are made to and from the virtual
server</p>
</dd>
<dt><i>path</i></dt>
<dd><p>Variable that is used to specify the location of directories
and files on the virtual server</p>
</dd>
<dt><tt>email</tt></dt>
<dd><p>Email address that is used in message files and in the <tt>HELP</tt> command</p>
</dd>
<dt><tt>hostname</tt></dt>
<dd><p>Name of the host that is shown in the greeting message or
status command</p>
</dd>
<dt><i>string</i></dt>
<dd><p>Variable that is used to specify <tt>email</tt> or <tt>hostname</tt> parameters</p>
</dd>
</dl>
<hr>
<p><b>Note - </b>While it is possible to use <tt>hostname</tt> as the <i>address</i> of the virtual server, you are strongly encouraged to
use the IPv4 address instead. DNS must be available when the FTP connection
is received in order for <tt>hostname</tt> to be matched. For an
IPv6 host, use the host name rather than the IPv6 address.</p>
<hr>
</li></ol>Example 28-15 Enabling Limited Virtual Hosting in the <tt>ftpaccess</tt> File<pre>virtual 10.1.2.3 root    /var/ftp/virtual/ftp-serv
virtual 10.1.2.3 banner  /var/ftp/virtual/ftp-serv/banner.msg
virtual 10.1.2.3 logfile /var/log/ftp/virtual/ftp-serv/xferlog</pre><p>The preceding example sets the location of the <tt>root</tt> directory, <tt>banner</tt>, and <tt>logfile</tt> on a virtual FTP server.</p>
<a name="egkcd"></a>Example 28-16 Enabling Limited Virtual Hosting on the Command Line<p>The <tt>ftpaddhost</tt>(1M) script with the <tt>-l</tt> option is provided
to configure limited virtual hosts.</p>
<p>In the following example, <tt>ftpaddhost</tt> is run with <tt>-l</tt> <tt>-b</tt> <tt>-x</tt> options to configure limited
virtual hosting with a test banner and the logfile <tt>/var/ftp/virtual/10.1.2.3/xferlog</tt> under a virtual root <tt>/var/ftp/virtual/10.1.2.3</tt>.</p>
<pre># <tt><b>ftpaddhost -l -b -x /var/ftp/virtual/10.1.2.3/xferlog</b></tt> \
<tt><b>/var/ftp/virtual/10.1.2.3</b></tt></pre>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p163.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p165.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

