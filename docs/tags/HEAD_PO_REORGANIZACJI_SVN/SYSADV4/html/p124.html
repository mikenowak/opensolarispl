<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Fixing Common PPP Problems
(Tasks) - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p123.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p125.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="pppsvrconfig.troubleshoot-1"></a>Chapter&nbsp;21<h3>Fixing Common PPP Problems
(Tasks)</h3><p>This chapter contains information
for troubleshooting common problems
that occur with Solaris PPP 4.0. The
following topics are covered:</p>
<ul><li><p><a href="p124.html#ppp.trouble-16">Tools for Troubleshooting PPP</a></p>
</li>
<li><p><a href="p125.html">Solving PPP-Related and PPPoE-Related Problems</a></p>
</li>
<li><p><a href="p128.html">Fixing Leased-Line Problems</a></p>
</li>
<li><p><a href="p128.html#ppp.trouble-92">Diagnosing and Fixing Authentication Problems</a></p>
</li>
</ul>
<p>The sources <b>PPP Design,
Implementation, and Debugging</b> by
James Carlson and the Australian National
University's web site also have detailed
advice for PPP troubleshooting. For
more information, see <a href="p103.html#pppsvrconfig.intro-3">Professional Reference Books About PPP</a> and <a href="p103.html#pppsvrconfig.intro-35">Web Sites About PPP</a>.</p>
<a name="pppsvrconfig.troubleshoot-2"></a><h3>Solving PPP Problems (Task
Map)</h3>
<p><a name="indexterm-1909"></a><a name="indexterm-1910"></a>Use the following task
map to quickly access advice and solutions
for common PPP problems.</p>
<a name="ppp.trouble-tbl-15"></a>Table 21-1 Task
Map for Troubleshooting PPP<table><tr><th><p>Task</p>
</th><th><p>Definition </p>
</th><th><p>For Instructions</p>
</th></tr>
<tr><td><p>Obtain diagnostic information
about the PPP link</p>
</td><td><p>Use PPP diagnostic tools to
obtain output for troubleshooting.</p>
</td><td><p><a href="p124.html#ppp.trouble-10">How to Obtain Diagnostic Information From <tt>pppd</tt></a></p>
</td></tr>
<tr><td><p>Obtain debugging information
for the PPP link</p>
</td><td><p>Use the <tt>pppd debug</tt> command
to generate output for troubleshooting.</p>
</td><td><p><a href="p124.html#ppp.trouble-21">How to Turn on PPP Debugging</a></p>
</td></tr>
<tr><td><p>Troubleshoot general problems
with the network layer</p>
</td><td><p>Identify and fix PPP problems
that are network-related by using
a series of checks.</p>
</td><td><p><a href="p125.html#ppp.trouble-75">How to Diagnose Network Problems</a></p>
</td></tr>
<tr><td><p>Troubleshoot general communications
problems</p>
</td><td><p>Identify and fix communications
problems that affect the PPP link.</p>
</td><td><p><a href="p126.html#ppp.trouble-93">How to Diagnose and Fix Communications Problems</a></p>
</td></tr>
<tr><td><p>Troubleshoot configuration problems</p>
</td><td><p>Identify and fix problems in
the PPP configuration files.</p>
</td><td><p><a href="p126.html#ppp.trouble-100">How to Diagnose Problems With the PPP Configuration</a></p>
</td></tr>
<tr><td><p>Troubleshoot modem-related problems</p>
</td><td><p>Identify and fix modem problems.</p>
</td><td><p><a href="p126.html#ppp.trouble-27">How to Diagnose Modem Problems</a></p>
</td></tr>
<tr><td><p>Troubleshoot chat script-related
problems</p>
</td><td><p>Identify and fix chat script
problems on a dial-out machine.</p>
</td><td><p><a href="p126.html#ppp.trouble-44">How to Obtain Debugging Information for Chat Scripts</a></p>
</td></tr>
<tr><td><p>Troubleshoot serial-line speed
problems</p>
</td><td><p>Identify and fix line&ndash;speed
problems on a dial-in server.</p>
</td><td><p><a href="p127.html#ppp.trouble-35">How to Diagnose and Fix Serial-Line Speed Problems</a></p>
</td></tr>
<tr><td><p>Troubleshoot common problems
for leased lines</p>
</td><td><p>Identify and fix performance
problems on a leased line.</p>
</td><td><p><a href="p128.html">Fixing Leased-Line Problems</a></p>
</td></tr>
<tr><td><p>Troubleshoot problems related
to authentication</p>
</td><td><p>Identify and fix problems related
to the authentication databases.</p>
</td><td><p><a href="p128.html#ppp.trouble-92">Diagnosing and Fixing Authentication Problems</a></p>
</td></tr>
<tr><td><p>Troubleshoot problem areas for
PPPoE</p>
</td><td><p>Use PPP diagnostic tools to
obtain output for identifying and
fixing PPPoE problems.</p>
</td><td><p><a href="p127.html#ppp.trouble-56">How to Obtain Diagnostic Information for PPPoE</a></p>
</td></tr>
</table><a name="ppp.trouble-16"></a><h3>Tools
for Troubleshooting PPP</h3>
<p><a name="indexterm-1911"></a><a name="indexterm-1912"></a>PPP links generally have
three major areas of failure:</p>
<ul><li><p>Failure of the link
to be established</p>
</li>
<li><p>Poor performance of
the link during regular usage</p>
</li>
<li><p>Problems that can
be traced to the networks on either
side of the link</p>
</li>
</ul>
<p>The easiest way to find out
if PPP works is to run a command over
the link. Run a command  such as <tt>ping</tt> or <tt>traceroute</tt> to
a host on the peer's network. Then
observe the results. However, you
should use PPP and UNIX debugging
tools to monitor performance of an
established link  or to troubleshoot
a problematic link.</p>
<p>This section explains how to
obtain diagnostic information from <tt>pppd</tt> and its associated
log files. The remaining sections
in this chapter describe common problems
with PPP that you can discover and
fix with the aid of the PPP troubleshooting
tools.</p>
<a name="ppp.trouble-10"></a><h4><img src="graphics/procedure.gif"> How
to Obtain Diagnostic Information From <tt>pppd</tt></h4>
<a name="indexterm-1913"></a><a name="indexterm-1914"></a><p>The next procedure shows how
to view the current operation of a
link on the local machine.</p>
<ol><li><a name="ppp.trouble-step-67"></a><b>Become
superuser on the local machine or
assume an equivalent role.</b><p>Roles
contain authorizations and privileged
commands. For more information about
roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>.
To configure a role with the Primary
Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="ppp.trouble-step-12"></a><b><a name="indexterm-1915"></a><a name="indexterm-1916"></a><a name="indexterm-1917"></a><a name="indexterm-1918"></a><a name="indexterm-1919"></a><a name="indexterm-1920"></a>Run <tt>pppd</tt> with
the serial device configured for PPP
as the argument:</b><pre># <tt><b>pppd</b></tt> <tt><b>cua/b</b></tt> <tt><b>debug updetach</b></tt></pre><p>The next examples show the resulting
displays for a dial-up link and a
leased-line link when <tt>pppd</tt> runs
in the foreground. If you run <tt>pppd
debug</tt> in the background,
the output that is produced is sent
to the <tt>/etc/ppp/connect-errors</tt> file. </p></li></ol><a name="ppp.trouble-ex-17"></a>Example 21-1 Output From a Properly Operating
Dial-up Link<pre># <tt><b>pppd /dev/cua/b debug updetach</b></tt>
have route to 0.0.0.0/0.0.0.0 via 172.21.0.4
serial speed set to 230400 bps
Using interface sppp0
Connect: sppp0 &lt;--> /dev/cua/b
sent [LCP ConfReq id=0x7b &lt;asyncmap 0x0> &lt;magic 0x73e981c8> &lt;pcomp> &lt;accomp>]
rcvd [LCP Ident id=0x79 magic=0x0 "ppp-2.4.0b1 (Sun Microsystems, Inc., Oct  6 
	2004 09:36:22)"]
Peer Identification: ppp-2.4.0b1 (Sun Microsystems, Inc., Oct  6 2004 09:36:22)
	rcvd [LCP ConfRej id=0x7b &lt;asyncmap 0x0>]
sent [LCP Ident id=0x7c magic=0x0 "ppp-2.4.0b1 (Sun Microsystems, Inc., Sep 15 
	2004 09:38:33)"
sent [LCP ConfReq id=0x7d &lt;magic 0x73e981c8> &lt;pcomp> &lt;accomp>]
rcvd [LCP ConfAck id=0x7d &lt;magic 0x73e981c8> &lt;pcomp> &lt;accomp>]
rcvd [LCP ConfAck id=0x78 &lt;magic 0xdd4ad820> &lt;pcomp> &lt;accomp>]
sent [LCP ConfAck id=0x78 &lt;magic 0xdd4ad820> &lt;pcomp> &lt;accomp>]
sent [LCP Ident id=0x7e magic=0x73e981c8 "ppp-2.4.0b1 (Sun Microsystems, Inc., 
	Sep 15 2004 09:38:33)"]
sent [IPCP ConfReq id=0x3d &lt;addr 0.0.0.0> &lt;compress VJ 0f 01>]
rcvd [LCP Ident id=0x7a magic=0xdd4ad820 "ppp-2.4.0b1 (Sun Microsystems, Inc., 
	Oct  6 2004 09:36:22)"]
Peer Identification: ppp-2.4.0b1 (Sun Microsystems, Inc., Oct  6 2004 09:36:22)
rcvd [IPCP ConfReq id=0x92 &lt;addr 10.0.0.1> &lt;compress VJ 0f 01>
sent [IPCP ConfAck id=0x92 &lt;addr 10.0.0.1> &lt;compress VJ 0f 01>
rcvd [IPCP ConfNak id=0x3d &lt;addr 10.0.0.2>]]
sent [IPCP ConfReq id=0x3e &lt;addr 10.0.0.2> &lt;compress VJ 0f 01>]
rcvd [IPCP ConfAck id=0x3e &lt;addr 10.0.0.2> &lt;compress VJ 0f 01>]
local  IP address 10.0.0.2
remote IP address 10.0.0.1</pre><a name="ppp.trouble-ex-18"></a>Example 21-2 Output From a Properly Operating
Leased-Line Link<pre># <tt><b>pppd /dev/se_hdlc1 default-asyncmap debug updetach</b></tt>
pppd 2.4.0b1 (Sun Microsystems, Inc., Oct 24 2004 07:13:18) started by root, uid 0
synchronous speed appears to be 0 bps
init option: '/etc/ppp/peers/syncinit.sh' started (pid 105122)
Serial port initialized.
synchronous speed appears to be 64000 bps
Using interface sppp0
Connect: sppp0 &lt;--> /dev/se_hdlc1
sent [LCP ConfReq id=0xe9 &lt;magic 0x474283c6>&lt;pcomp> &lt;accomp>]
rcvd [LCP ConfAck id=0xe9 &lt;magic 0x474283c6>&lt;pcomp> &lt;accomp>]
rcvd [LCP ConfReq id=0x22 &lt;magic 0x8e3a53ff>&lt;pcomp> &lt;accomp>]
sent [LCP ConfReq id=0x22 &lt;magic 0x8e3a53ff>&lt;pcomp> &lt;accomp>]
sent [LCP Ident id=0xea magic=0x474283c6 "ppp-2.4.0b1 (Sun Microsystems, Inc., Oct 
	22 2004 14:31:44)"]
sent [IPCP ConfReq id=0xf7 &lt;addr 0.0.0.0> &lt;compress VJ Of o1>]]
sent [CCP ConfReq id=0x3f &lt;deflate 15> &lt;deflate(old#) 15> &lt;bsd v1 15>]
rcvd [LCP Ident id=0x23 magic=0x8e3a53ff "ppp-2.4.0b1 (Sun Microsystems, Inc., Oct 
	22 2004 14:31:44)"]
Peer Identification: ppp-2.4.0b1 (Sun Microsystems, Inc., Oct 22 2004 14:31:44)
rcvd [IPCP ConfReq id=0x25 &lt;addr 10.0.0.1> &lt;compress VJ Of 01>]
sent [IPCP ConfAck id=0x25 &lt;addr 10.0.0.1> &lt;compress VJ Of 01>]
rcvd [CCP ConfReq id=0x3 &lt;deflate 15> &lt;deflate(old#) 15 &lt;bsd v1 15>]
sent [CCP ConfAck id=0x3 &lt;deflate 15> &lt;deflate(old#) 15 &lt;bsd v1 15>]
rcvd [IPCP ConfNak id=0xf8 &lt;addr 10.0.0.2>]
rcvd [IPCP ConfReq id=0xf7 &lt;addr 10.0.0.2> &lt;compress VJ Of 01>]
rcvd [CCP ConfAck id=0x3f &lt;deflate 15> &lt;deflate(old#) 15 &lt;bsd v1 15>]
Deflate (15) compression enabled
rcvd [IPCP ConfAck id=0xf8 &lt;addr 10.0.0.2> &lt;compress VJ Of 01>]
local  IP address 10.0.0.2
remote IP address 10.0.0.1</pre><a name="ppp.trouble-21"></a><h4><img src="graphics/procedure.gif"> How
to Turn on PPP Debugging</h4>
<p><a name="indexterm-1921"></a><a name="indexterm-1922"></a><a name="indexterm-1923"></a><a name="indexterm-1924"></a><a name="indexterm-1925"></a><a name="indexterm-1926"></a>The next task shows how
to use the <tt>pppd</tt> command
to obtain debugging information.</p>
<hr>
<p><b>Note - </b>You only need to perform
step 1 through step 3 once for each
host. Thereafter, you can proceed
to step 4 to turn on debugging for
the host.</p>
<hr>
<ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="ppp.trouble-step-68"></a><b>Create
a log file to hold output from <tt>pppd</tt>.</b><pre># <tt><b>touch</b></tt> <tt>/var/log/pppdebug</tt></pre></li><li><a name="ppp.trouble-step-30"></a><b>Add
the following <tt>syslog</tt> facilities
for <tt>pppd</tt> in <tt>/etc/syslog.conf</tt>.</b><pre><tt><b>daemon.debug;local2.debug       /var/log/pppdebug</b></tt></pre></li><li><a name="ppp.trouble-step-31"></a><b>Restart <tt>syslogd</tt>.</b><pre># <tt><b>pkill -HUP -x syslogd</b></tt></pre></li><li><a name="ppp.trouble-step-24"></a><b>Turn
on debugging for calls to a particular
peer by using the following syntax
of <tt>pppd</tt>.</b><pre># <tt><b>pppd debug call</b></tt> <i>peer-name</i> </pre><p><i>peer-name</i> must
be the name of a file in the <tt>/etc/ppp/peers</tt> directory.</p></li><li><a name="ppp.trouble-step-23"></a><b>View
the contents of the log file.</b><pre># <tt><b>tail -f</b></tt> <tt>/var/log/pppdebug</tt></pre><p>For an example of a log file,
see <a href="p127.html#ppp.trouble-step-59">Step&nbsp;3</a>.</p></li></ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p123.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p125.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

