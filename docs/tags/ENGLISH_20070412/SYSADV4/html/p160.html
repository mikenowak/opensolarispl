<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>How to Restrict Access to the Default FTP Server - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p158.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a> > <a href="p158.html#wuftp-43">Controlling FTP Server Access</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p159.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p161.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="wuftp-51"></a><h4><img src="graphics/procedure.gif"> How to Restrict Access to the Default FTP Server</h4>
<p>In addition to the controls mentioned previously, you can add explicit
statements to the <tt>ftpaccess</tt> file to restrict access to
the FTP server. </p>
<ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="wuftp-step-54"></a><b>Add the following entries to the <tt>ftpaccess</tt> file.</b><ol><li><a name="wuftp-step-162"></a><b>By default, all users are allowed access to
the default (non-virtual) FTP server. To deny access for specific users (other
than <tt>anonymous</tt>), add the following entry:</b><pre>defaultserver deny <i>username</i> [<i>username...</i>]</pre><dl><dt><tt>defaultserver</tt></dt>
<dd><p>Keyword that is used to identify the non-virtual server to
which access can be denied or allowed</p>
</dd>
<dt><i>username</i></dt>
<dd><p>Login name of a user with restricted access to the <tt>defaultserver</tt></p>
</dd>
</dl>
</li><li><a name="wuftp-step-161"></a><b>To allow access for users who are not listed
on the <tt>deny</tt> line, add the following line:</b><pre>defaultserver allow <i>username</i> [<i>username...</i>]</pre></li><li><a name="wuftp-step-149a"></a><b>To prevent access by anonymous users, add
the entry: </b><pre>defaultserver private</pre></li></ol></li></ol>Example 28-5 Restricting Access to the Default FTP Server<pre>defaultserver deny *
defaultserver allow <i>username</i></pre><p>The previous example states that the FTP server denies access to all
users except <tt>anon</tt> users and those users who are listed
on the <tt>allow</tt> line.</p>
<p><a name="indexterm-2930"></a>You can also use the <tt>ftphosts</tt>  file to deny
access to particular login accounts from various hosts. See <tt>ftphosts</tt>(4) for additional information.</p>
<a name="wuftp-10"></a><h3>Setting Up FTP Server Logins</h3>
<p>To access an FTP server, you must first log in. The FTP server supports
three types of user login accounts for <b>real</b>, <b>guests</b>, and <b>anonymous</b> users.</p>
<ul><li><p><b>Real</b> users have accounts
that allow them to establish terminal sessions on systems that run the FTP
server. Subject to directory and file access permissions, the entire disk
structure is visible to real users.</p>
</li>
<li><p><b>Guest</b>  users also need
accounts to log in to the FTP server. Each guest account is set up with a
user name and password. Functioning login shells are not assigned to guests
to prevent users from establishing terminal sessions. At login, the FTP server
performs a <tt>chroot</tt>(2) operation
to restrict a guest's view of the server's disk structure.</p>
<hr>
<p><b>Note - </b>Login shells for real and guest users must be listed in the <tt>/etc/shells</tt> file to allow access to the FTP server.</p>
<hr>
</li>
<li><p><b>Anonymous</b> users log
in to the FTP server by using the either <tt>ftp</tt> or <tt>anonymous</tt> as a user name. By convention, anonymous users supply an email
address when prompted for a password.</p>
<p>At login, the FTP server
performs a <tt>chroot</tt>(2) operation
that restricts the anonymous user's view of the server's disk structure. A
single file area is shared by all anonymous users, unlike the separate areas
that can be created for each guest user.</p>
<p>Real and guest users
log in by using individual accounts with passwords that are known only to
one person. Anonymous users log in to a well-known account that is potentially
available to anyone. Most large-scale file distribution is created by using
the anonymous account.</p>
</li>
</ul>
<a name="wuftp-153"></a><h4><img src="graphics/procedure.gif"> How to Set Up Real FTP Users</h4>
<p><a name="indexterm-2931"></a>To enable access for real users to the FTP server, follow these
instructions:</p>
<ol><li><a name="wuftp-step-150"></a><b>Verify that the user has an account that is
set up with a user name and password that can be used to establish a terminal
session.</b><p>For more information, see Chapter 4, Managing User Accounts and Groups (Overview), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="wuftp-step-151"></a><b>Confirm that the real user is a member of
a class in the <tt>ftpaccess</tt> file.</b><p>For information
on the user classes that are defined in the <tt>ftpaccess</tt> file,
see <a href="p158.html#wuftp-45">How to Define FTP Server Classes</a>.</p></li><li><a name="wuftp-step-152"></a><b>Verify that the user's login shell is listed
in the <tt>/etc/shells</tt> file.</b></li></ol><a name="wuftp-18"></a><h4><img src="graphics/procedure.gif"> How to Set Up Guest FTP Users</h4>
<p><a name="indexterm-2932"></a>The <tt>ftpconfig</tt> script is used to copy all necessary
system files to the home directory. When the guest user and the guest's home
directory already exist, the <tt>ftpconfig</tt> script updates the
area with the current system files.</p>
<p>For more information, see <tt>ftpconfig</tt>(1M)</p>
<hr>
<p><b>Note - </b>Unlike the user name (<tt>anonymous</tt> or <tt>ftp</tt>)
that is set for anonymous users, user names for FTP guests are not fixed.
Any name that would work as a real user name can be selected.</p>
<hr>
<p>To enable access by a guest user to the FTP server, do the following:</p>
<ol><li><a name="wuftp-step-153"></a><b>Use the <tt>useradd</tt> script
to create a guest user account with a login shell of <tt>/bin/true</tt> and
a home directory of <tt></tt><i>/root-dir/./home-dir</i><tt></tt>. </b><p>For more information, see <tt>useradd</tt>(1M) and Chapter 4, Managing User Accounts and Groups (Overview), in <i>System Administration Guide: Basic Administration</i>.</p><hr>
<p><b>Note - </b>In this procedure, <tt><b>/home/guests/./guest1</b></tt> is
used as the home directory name for a user who is called <tt>guest1</tt>.</p>
<hr>
<pre># <tt><b>/usr/sbin/useradd -m -c "Guest FTP" -d \</b></tt>
  <tt><b>/home/guests/./guest1 -s /bin/true guest1</b></tt></pre></li><li><a name="wuftp-step-155"></a><b>Assign a password to the guest account.</b></li><li><a name="wuftp-step-156"></a><b>Add a <tt>guestuser</tt> entry to
the <tt>ftpaccess</tt> file.</b><pre>guestuser guest1</pre><hr>
<p><b>Note - </b>You can also use the <tt>guestgroup</tt> capability
in the <tt>ftpaccess</tt> file to specify guest users. The <tt>guest-root</tt> capability in <tt>ftpaccess</tt> eliminates
the need for the <tt>/./</tt> in the guest user's home directory
path.</p>
<hr>
</li><li><a name="wuftp-step-155gg"></a><b>Confirm that the guest user is a member
of a <tt>class</tt> in the <tt>ftpaccess</tt> file.
See <a href="p158.html#wuftp-45">How to Define FTP Server Classes</a> for
further information.</b></li><li><a name="wuftp-step-157"></a><b>Use the <tt>ftpconfig</tt> script
to create the required files in the <tt>chroot</tt> area.</b><pre><tt><b>/usr/sbin/ftpconfig -d /home/guests</b></tt></pre></li><li><a name="wuftp-step-156g"></a><b>Confirm that <tt>/bin/true</tt> is
listed in the <tt>/etc/shells</tt> file. See <a href="p161.html#wuftp-18-a">How to Create the <tt>/etc/shells</tt> file</a>.</b></li></ol>Example 28-6 Setting Up a Guest FTP Server<p>In this example, the FTP area is set up in the <tt>/home/guests</tt> directory.</p>
<pre># <tt><b>/usr/sbin/ftpconfig -d /home/guests</b></tt>
Updating directory /home/guests</pre>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p159.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p161.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

