<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Network File System Administration (Tasks) - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p14.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p16.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="rfsadmin-8"></a>Chapter&nbsp;5<h3>Network File System Administration (Tasks)</h3><p>This chapter provides information about how to perform such NFS administration
tasks as setting up NFS services, adding new file systems to share, and mounting
file systems. The chapter also covers the use of the Secure NFS system and
the use of WebNFS functionality. The last part of the chapter includes troubleshooting
procedures and a list of some of the NFS error messages and their meanings.</p>
<ul><li><p><a href="p15.html#rfsadmin-56">Automatic File-System Sharing</a></p>
</li>
<li><p><a href="p17.html">Mounting File Systems</a></p>
</li>
<li><p><a href="p19.html">Setting Up NFS Services</a></p>
</li>
<li><p><a href="p21.html">Administering the Secure NFS System</a></p>
</li>
<li><p><a href="p22.html">WebNFS Administration Tasks</a></p>
</li>
<li><p><a href="p22.html#rfsadmin-127">Task Overview for Autofs Administration</a></p>
</li>
<li><p><a href="p27.html">Strategies for NFS Troubleshooting</a></p>
</li>
<li><p><a href="p27.html#rfsadmin-215">NFS Troubleshooting Procedures</a></p>
</li>
<li><p><a href="p30.html#rfsadmin-255">NFS Error Messages</a></p>
</li>
</ul>
<p>Your responsibilities as an NFS administrator depend on your site's
requirements and the role of your computer on the network. You might be responsible
for all the computers on your local network, in which instance you might be
responsible for determining these configuration items:</p>
<ul><li><p>Which computers should be dedicated servers</p>
</li>
<li><p>Which computers should act as both servers and clients</p>
</li>
<li><p>Which computers should be clients only</p>
</li>
</ul>
<p>Maintaining a server after it has been set up involves the following
tasks:</p>
<ul><li><p>Sharing and unsharing file systems as necessary</p>
</li>
<li><p>Modifying administrative files to update the lists of file
systems your computer shares or mounts automatically</p>
</li>
<li><p>Checking the status of the network</p>
</li>
<li><p>Diagnosing and fixing NFS-related problems as they arise</p>
</li>
<li><p>Setting up maps for autofs</p>
</li>
</ul>
<p>Remember, a computer can be both a server and a client. So, a computer
can be used to share local file systems with remote computers and to mount
remote file systems.</p>
<hr>
<p><b>Note - </b><a name="indexterm-159"></a><a name="indexterm-160"></a>If your system has zones enabled and you want to use this feature
in a non-global zone, see <i>System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</i> for
more information.</p>
<hr>
<a name="rfsadmin-56"></a><h3>Automatic File-System Sharing</h3>
<p><a name="indexterm-161"></a><a name="indexterm-162"></a><a name="indexterm-163"></a><a name="indexterm-164"></a>Servers provide access to their file systems by sharing the file
systems over the NFS environment. Note the following:</p>
<ul><li><p>Previously, you would specify which file systems are to be
shared with the <tt>share</tt> command or with the <tt>/etc/dfs/dfstab</tt> file.</p>
<p>Entries in the <tt>/etc/dfs/dfstab</tt> file
are shared automatically whenever you start NFS server operation. You should
set up automatic sharing if you need to share the same set of file systems
on a regular basis. For example, if your computer is a server that supports
home directories, you need to make the home directories available at all times.
Most file-system sharing should be done automatically. The only time that
manual sharing should occur is during testing or troubleshooting.</p>
<p>The <tt>dfstab</tt> file lists all the file systems that your server shares
with its clients. This file also controls which clients can mount a file system.
You can modify <tt>dfstab</tt> to add or delete a file system
or change the way sharing occurs. Just edit the file with any text editor
that is supported (such as <tt>vi</tt>). The next time that the
computer enters run level 3, the system reads the updated <tt>dfstab</tt> to
determine which file systems should be shared automatically.</p>
<p><a name="indexterm-165"></a>Each line in the <tt>dfstab</tt> file consists of
a <tt>share</tt> command, the same command that you type at the
command-line prompt to share the file system. The <tt>share</tt> command
is located in <tt>/usr/sbin</tt>.</p>
</li>
<li><p>Starting in the Solaris Express, Developer Edition 2/07 release,
you can use the <tt>sharemgr</tt> and <tt>sharectl</tt> utilities
to manage file systems and file-sharing protocols. For more information, see
the following:</p>
<ul><li><p><tt>sharemgr</tt>(1M) man page and <a href="p38.html"><tt>sharemgr</tt> Command</a></p>
</li>
<li><p><tt>sharectl</tt>(1M) man page and <a href="p43.html"><tt>sharectl</tt> Command</a></p>
</li>
</ul>
<hr>
<p><b>Note - </b>When you use <tt>sharemgr</tt>, you do not need to use
the <tt>share</tt>, <tt>shareall</tt>,  and <tt>unshare</tt> commands.
Also, you do not need to edit the <tt>/etc/dfs/dfstab</tt> file.</p>
<hr>
</li>
</ul>
<a name="rfsadmin-tbl-166"></a>Table 5-1 File-System Sharing
Task Map<table><tr><th><p>Task</p>
</th><th><p>Description</p>
</th><th><p>For Instructions</p>
</th></tr>
<tr><td><p>Establish automatic file-system sharing</p>
</td><td><p>Steps to configure a server so that file systems are automatically shared
when the server is rebooted</p>
<hr>
<p><b>Note - </b>The procedure shows you how to use the <tt>sharemgr</tt> command. The example that follows the procedure uses the <tt>share</tt> and <tt>shareall</tt> commands to complete the same task.</p>
<hr>
</td><td><p><a href="p15.html#rfsadmin-57">How to Set Up Automatic File-System Sharing</a></p>
</td></tr>
<tr><td><p>Enable WebNFS</p>
</td><td><p>Steps to configure a server so that users can access files by using
WebNFS</p>
<hr>
<p><b>Note - </b>The
procedure shows you how to use the <tt>sharemgr</tt> command. The
example that follows the procedure uses the <tt>share</tt> and <tt>shareall</tt> commands to complete the same task.</p>
<hr>
</td><td><p><a href="p16.html">How to Enable WebNFS Access</a></p>
</td></tr>
<tr><td><p>Enable NFS server logging</p>
</td><td><p>Steps to configure a server so that NFS logging is run on selected file
systems</p>
<hr>
<p><b>Note - </b>The
procedure shows you how to use the <tt>sharemgr</tt> command. The
example that follows the procedure uses the <tt>share</tt> and <tt>shareall</tt> commands to complete the same task.</p>
<hr>
</td><td><p><a href="p16.html#rfsadmin-101">How to Enable NFS Server Logging</a></p>
</td></tr>
</table><a name="rfsadmin-57"></a><h4><img src="graphics/procedure.gif"> How to Set Up Automatic File-System Sharing</h4>
<p>Starting with the Solaris Express, Developer Edition 2/07 release, you
can do the following:</p>
<ul><li><p>Use the <tt>sharemgr</tt> utility to share file
systems, set property values for the shared file systems, and perform related
tasks. For information about <tt>sharemgr</tt>, including descriptions
of subcommands and properties, see the <tt>sharemgr</tt>(1M) man page and <a href="p38.html"><tt>sharemgr</tt> Command</a>.</p>
</li>
<li><p>Use the <tt>sharectl</tt> utility to configure file-sharing
protocols, such as NFS. See the <tt>sharectl</tt>(1M) man page and <a href="p43.html"><tt>sharectl</tt> Command</a>.</p>
</li>
</ul>
<hr>
<p><b>Note - </b>When you use <tt>sharemgr</tt>, you do not need to use
the <tt>share</tt>, <tt>shareall</tt>,  and <tt>unshare</tt> commands.
Also, you do not need to edit the <tt>/etc/dfs/dfstab</tt> file.</p>
<hr>
<p>The following procedure uses the <tt>sharemgr</tt> utility.
If you prefer to use the <tt>share</tt> and <tt>shareall</tt> utilities,
see the example that follows this procedure. Note that whether you use <tt>sharemgr</tt> or <tt>share</tt> and <tt>shareall</tt>, you
must set up your autofs maps so that clients can access the file systems that
you have shared on the server.</p>
<ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="rfsadmin-step-59"></a><b>Use the <tt>sharemgr</tt> utility
to assign property values to the file system to be shared.</b><ol><li><b>Use the following syntax to create a share group with the desired
property value.</b><pre># sharemgr create [-P protocol] [-p property=value] share-group</pre></li><li><b>Use the following syntax to add shares to the share group.</b><pre># sharemgr add-share -s share-path [-t] [-d description] [-r resource-name] share-group</pre></li><li>(Optional) <b>If necessary, use the following syntax
to set more property values to an existing share group.</b><pre># sharemgr set [-P protocol] [-S security-mode] [-p property=value] share-group</pre><hr>
<p><b>Note - </b>You do not need to repeat this command-line syntax for each additional
property value. You can use the <tt>-p</tt> option multiple times to
define multiple properties on the same command line.</p>
<hr>
</li></ol></li><li><a name="rfsadmin-step-1209"></a><b>Use the <tt>sharemgr</tt> utility
to verify what you have created by using the     following syntax.</b><pre># sharemgr show [-v] [-p] [-x] [share-group...]</pre></li></ol><a name="gecqk"></a>Example 5-1 How to Use the <tt>share</tt> and <tt>shareall</tt> Commands
to Set Up Automatic File-System Sharing<ol><li><p>Become superuser or assume an equivalent role.</p>
<p>Roles
contain authorizations and privileged commands. For more information about
roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>.
To configure a role with the Primary Administrator    profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<li><p>Add entries for each file system to be shared.</p>
<p><a name="indexterm-166"></a><a name="indexterm-167"></a><a name="indexterm-168"></a>Edit <tt>/etc/dfs/dfstab</tt>. Add one entry to the
file for every file system that you want to be automatically shared. Each
entry must be on a line by itself in the file and use this syntax:</p>
<pre>share [-F nfs] [-o specific-options] [-d description] pathname</pre><p>See the <tt>dfstab</tt>(4) man
page for a description of <tt>/etc/dfs/dfstab</tt> and the <tt>share_nfs</tt>(1M) man page
for a complete list of options.</p>
</li>
<li><p>Share the file system.</p>
<p><a name="indexterm-169"></a><a name="indexterm-170"></a>After the entry is in <tt>/etc/dfs/dfstab</tt>, you
can share the file system by either rebooting the system or by using the <tt>shareall</tt> command.</p>
<pre># <tt><b>shareall</b></tt></pre></li>
<li><p>Verify that the information is correct.</p>
<p>Run the <tt>share</tt> command to check that the correct options are listed:</p>
<pre># <tt><b>share</b></tt>
-        /export/share/man   ro   ""
-        /usr/src     rw=eng   ""
-        /export/ftp    ro,public  ""</pre></li>
</ol>
<h6>See Also</h6><p>Whether you use <tt>sharemgr</tt> or <tt>share</tt> and <tt>shareall</tt>, the next step is to set up your autofs maps so that clients
can access the file systems that you have shared on the server. See <a href="p22.html#rfsadmin-127">Task Overview for Autofs Administration</a>.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p14.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p16.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

