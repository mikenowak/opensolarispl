<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Administering the Caching of Web Pages
(Tasks) - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p6.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p6.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p8.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="nca-4"></a><h3>Administering the Caching of Web Pages
(Tasks)</h3>
<p>The following sections cover the procedures to enable or disable
parts of the service.</p>
<a name="nca-5"></a><h4><img src="graphics/procedure.gif"> How to Enable Caching of Web Pages</h4>
<a name="indexterm-10"></a><a name="indexterm-11"></a><ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="nca-step-8"></a><b>Register the interfaces.</b><p><a name="indexterm-12"></a>Type the names of each of the physical interfaces in
the <tt>/etc/nca/nca.if</tt> file. See the <tt>nca.if</tt>(4) man
page for more information.</p><pre># <tt><b>cat /etc/nca/nca.if</b></tt>
hme0
hme1</pre><p>Each interface must have an accompanying <tt>hostname.</tt><i>interface-name</i><tt></tt> file and an entry in <tt>/etc/hosts</tt> file for the contents of <tt>hostname.</tt><i>interface-name</i><tt></tt>. To start the NCA feature
on all interfaces, place an asterisk, <tt>*</tt>, in the <tt>nca.if</tt> file.</p></li><li><a name="nca-step-9"></a><b>Enable the <tt>ncakmod</tt> kernel
module.</b><p>Change the <tt>status</tt> entry in <tt>/etc/nca/ncakmod.conf</tt> to <tt>enabled</tt>.</p><pre># <tt><b>cat /etc/nca/ncakmod.conf</b></tt>
#
# NCA Kernel Module Configuration File
#
status=<tt><b>enabled</b></tt>
httpd_door_path=/var/run/nca_httpd_1.door
nca_active=disabled</pre><p><a name="indexterm-13"></a>See the <tt>ncakmod.conf</tt>(4) man page for more
information.</p></li><li><a name="nca-step-10"></a>(Optional) <b>Enable NCA logging.</b><p>Change the <tt>status</tt> entry in <tt>/etc/nca/ncalogd.conf</tt> to <tt>enabled</tt>.</p><pre># <tt><b>cat /etc/nca/ncalogd.conf</b></tt>
#
# NCA Logging Configuration File
#
status=<tt><b>enabled</b></tt>
logd_path_name="/var/nca/log"
logd_file_size=1000000</pre><p><a name="indexterm-14"></a>You can change the location of the log file by changing
the path that is indicated by the <tt>logd_path_name</tt> entry.
The log file can be a raw device or a file. See the following examples
for samples of NCA log file paths. See the <tt>ncalogd.conf</tt>(4) man page for more
information about the configuration file.</p></li><li><a name="nca-step-47"></a>(Optional) <b>Define ports
for multiple instance support.</b><p>Add the port numbers
in the <tt>/etc/nca/ncaport.conf</tt> file. This entry
causes NCA to monitor port 80 on all configured IP addresses.</p><pre># <tt><b>cat /etc/nca/ncaport.conf</b></tt>
#
# NCA Kernel Module Port Configuration File
#
  .
  .
<tt><b>ncaport=*/80</b></tt></pre></li><li><a name="nca-step-11"></a><b>For x86 only: Increase the virtual
memory size.</b><p>Use the <tt>eeprom</tt> command
to set the <tt>kernelbase</tt> of the system.</p><pre># <tt><b>eeprom kernelbase=0x90000000</b></tt>
# <tt><b>eeprom kernelbase</b></tt>
kernelbase=0x90000000</pre><p>The second command verifies that the parameter has been set.</p><hr>
<p><b>Note - </b>By setting the <tt>kernelbase</tt>, you reduce
the amount of virtual memory that user processes can use to less
than 3 Gbytes. This restriction means that the system is not ABI
compliant. When the system boots, the console displays a message
that warns you about noncompliance. Most programs do not actually
need the full 3&ndash;Gbyte virtual address space. If you have a
program that needs more than 3 Gbytes, you need to run the program
on a system that does not have NCA enabled.</p>
<hr>
</li><li><a name="nca-step-12"></a><b>Reboot the server.</b></li></ol>Example 2-1 Using a Raw Device as the NCA Log File<p>The <tt>logd_path_name</tt> string in <tt>ncalogd.conf</tt> can define a raw device as the place to store the NCA
log file. The advantage to using a raw device is that the service
can run faster because the overhead in accessing a raw device is
less. </p>
<p>The NCA service tests any raw device that is listed in the
file to ensure that no file system is in place. This test ensures
that no active file systems are accidentally written over.</p>
<p>To prevent this test from finding a file system, run the following
command. This command destroys part of the file system on any disk
partition that had been configured as a file system. In this example, <tt>/dev/rdsk/c0t0d0s7</tt> is the raw device that has an old file
system in place.</p>
<pre># <tt><b>dd if=/dev/zero of=/dev/rdsk/c0t0d0s7 bs=1024 count=1</b></tt></pre><p>After running <tt>dd</tt>, you can then add the
raw device to the <tt>ncalogd.conf</tt> file.</p>
<pre># <tt><b>cat /etc/nca/ncalogd.conf</b></tt>
#
# NCA Logging Configuration File
#
status=enabled
logd_path_name="<tt><b>/dev/rdsk/c0t0d0s7</b></tt>"
logd_file_size=1000000</pre>Example 2-2 Using Multiple Files for NCA Logging<p>The <tt>logd_path_name</tt> string in <tt>ncalogd.conf</tt> can define multiple targets as the place to store the
NCA log file. The second file is used when the first file is full.
The following example shows how to select to write to the <tt>/var/nca/log</tt> file first and then use a raw partition.</p>
<pre># <tt><b>cat /etc/nca/ncalogd.conf</b></tt>
#
# NCA Logging Configuration File
#
status=enabled
logd_path_name="<tt><b>/var/nca/log /dev/rdsk/c0t0d0s7</b></tt>"
logd_file_size=1000000</pre><a name="nca-13"></a><h4><img src="graphics/procedure.gif"> How to Disable Caching of Web Pages</h4>
<a name="indexterm-15"></a><a name="indexterm-16"></a><ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="nca-step-16"></a><b>Disable the <tt>ncakmod</tt> kernel
module.</b><p>Change the <tt>status</tt> entry in <tt>/etc/nca/ncakmod.conf</tt> to <tt>disabled</tt>.</p><pre># <tt><b>cat /etc/nca/ncakmod.conf</b></tt>
# NCA Kernel Module Configuration File
#
status=<tt><b>disabled</b></tt>
httpd_door_path=/var/run/nca_httpd_1.door
nca_active=disabled</pre><p><a name="indexterm-17"></a>See the <tt>ncakmod.conf</tt>(4) man page for more
information.</p></li><li><a name="nca-step-17"></a><b>Disable NCA logging.</b><p>Change
the <tt>status</tt> entry in <tt>/etc/nca/ncalogd.conf</tt> to <tt>disabled</tt>.</p><pre># <tt><b>cat /etc/nca/ncalogd.conf</b></tt>
#
# NCA Logging Configuration File
#
status=<tt><b>disabled</b></tt>
logd_path_name="/var/nca/log"
logd_file_size=1000000</pre><p><a name="indexterm-18"></a>See the <tt>ncalogd.conf</tt>(4) man page for more
information.</p></li><li><a name="nca-step-18"></a><b>Reboot the server.</b></li></ol><a name="nca-19"></a><h4><img src="graphics/procedure.gif"> How to Enable or Disable NCA Logging</h4>
<p><a name="indexterm-19"></a><a name="indexterm-20"></a><a name="indexterm-21"></a>NCA logging can be turned on or turned off, as needed,
after NCA has been enabled. See <a href="p7.html#nca-5">How to Enable Caching of Web Pages</a> for more information.</p>
<ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="nca-step-22"></a><b>Change NCA logging.</b><p>To
permanently disable logging, you need to change the status in <tt>/etc/nca/ncalogd.conf</tt> to <tt>disabled</tt> and
reboot the system. See the <tt>ncalogd.conf</tt>(4) man page for more
information.</p><ol><li><a name="nca-step-23"></a><b>Stop logging.</b><pre># <tt><b>/etc/init.d/ncalogd stop</b></tt></pre></li><li><a name="nca-step-24"></a><b>Start logging.</b><pre># <tt><b>/etc/init.d/ncalogd start</b></tt></pre></li></ol></li></ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p6.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p8.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

