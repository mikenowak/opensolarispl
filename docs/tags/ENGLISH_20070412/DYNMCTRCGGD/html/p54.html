<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title><tt>pid</tt> Provider - Solaris Dynamic Tracing Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2005-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >Solaris Dynamic Tracing Guide<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p53.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p55.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="chp-pid"></a>Chapter&nbsp;30<h3><tt>pid</tt> Provider</h3><p>The <tt>pid</tt> provider allows for tracing of the entry and return of any function in a user process as well as any instruction as specified by an absolute address or function offset. The <tt>pid</tt> provider has no probe effect when probes are not enabled. When probes are enabled, the probes only induce probe effect on those processes that are traced.</p>
<a name="chp-pid-names"></a><h3>Naming <tt>pid</tt> Probes</h3>
<a name="indexterm-423"></a><p><a name="indexterm-424"></a>The <tt>pid</tt> provider actually defines a <b>class</b> of providers. Each process can potentially have its own associated <tt>pid</tt> provider. A process with ID 123, for example, would be traced by using the <tt>pid123</tt> provider. For probes from one of these providers, the module portion of the probe description refers to an object loaded in the corresponding process's address space. The following example uses <tt>mdb</tt>(1) to display a list of objects:</p>
<pre><tt><b>$ mdb -p 1234</b></tt>
Loading modules: [ ld.so.1 libc.so.1 ]
<tt><b>> ::objects</b></tt>
    BASE    LIMIT     SIZE NAME
   10000    34000    24000 /usr/bin/csh
ff3c0000 ff3e8000    28000 /lib/ld.so.1
ff350000 ff37a000    2a000 /lib/libcurses.so.1
ff200000 ff2be000    be000 /lib/libc.so.1
ff3a0000 ff3a2000     2000 /lib/libdl.so.1
ff320000 ff324000     4000 /platform/sun4u/lib/libc_psr.so.1</pre><p>In the probe description, you name the object by the name of the file, not its full path name. You can also omit the &ldquo;<tt>.1</tt>&rdquo; or &ldquo;<tt>so.1</tt>&rdquo; suffix. All of the following examples name the same probe:</p>
<pre>pid123:libc.so.1:strcpy:entry
pid123:libc.so:strcpy:entry
pid123:libc:strcpy:entry</pre><p>The first example is the actual name of the probe. The other examples are convenient aliases that are replaced with the full load object name internally.</p>
<p>For the load object of the executable, you can use the alias <tt>a.out</tt>. The following two probe descriptions name the same probe:</p>
<pre>pid123:csh:main:return
pid123:a.out:main:return</pre><p><a name="indexterm-425"></a><a name="indexterm-426"></a>As with all anchored DTrace probes, the function field of the probe description names a function in the module field. A user application binary might have several names for the same function. For example, <tt>mutex_lock</tt> might be an alternate name for the function <tt>pthread_mutex_lock</tt> in <tt>libc.so.1</tt>. DTrace chooses one canonical name for such functions and uses that name internally. The following example shows how DTrace internally remaps module and function names to a canonical form:</p>
<pre><tt><b># dtrace -q -n pid101267:libc:mutex_lock:entry'{ \</b></tt>
    <tt><b>printf("%s:%s:%s:%s\n", probeprov, probemod, probefunc, probename); }'</b></tt>
pid101267:libc.so.1:pthread_mutex_lock:entry
<tt><b>^C</b></tt></pre><p>This automatic renaming means that the names of the probes you enable may be slightly different than those actually enabled. The canonical name will always be consistent between runs of DTrace on systems running the same Solaris release.</p>
<p>See <a href="p57.html">Chapter&nbsp;33, User Process Tracing</a> for examples of how to use the <tt>pid</tt> provider effectively.</p>
<a name="chp-pid-fb"></a><h3>Function Boundary Probes</h3>
<p><a name="indexterm-427"></a><a name="indexterm-428"></a>The <tt>pid</tt> provider enables you to trace function entry and return in user programs just as the FBT provider provides that capability for the kernel. Most of the examples in this manual that use the FBT provider to trace kernel function calls can be modified slightly to apply to user processes.</p>
<a name="chp-pid-entry"></a><h4><tt>entry</tt> Probes</h4>
<p><a name="indexterm-429"></a><a name="indexterm-430"></a>An <tt>entry</tt> probe fires when the traced function is invoked. The arguments to entry probes are the values of the arguments to the traced function.</p>
<a name="chp-pid-return"></a><h4><tt>return</tt> Probes</h4>
<p><a name="indexterm-431"></a><a name="indexterm-432"></a>A <tt>return</tt> probes fires when the traced function returns or makes a tail call to another function. The value for <tt>arg0</tt> is the offset in the function of the return instruction; <tt>arg1</tt> holds the return value.</p>
<a name="chp-pid-offsets"></a><h3>Function Offset Probes</h3>
<p><a name="indexterm-433"></a><a name="indexterm-434"></a>The <tt>pid</tt> provider lets you trace any instruction in a function. For example to trace the instruction 4 bytes into a function <tt>main()</tt>, you could use a command similar to the following example:</p>
<pre>pid123:a.out:main:4</pre><p>Every time the program executes the instruction at address <tt>main+4</tt>, this probe will be activated. The arguments for offset probes are undefined. The <tt>uregs[]</tt> array will help you examine process state at these probe sites. See <a href="p58.html"><tt>uregs[]</tt> Array</a> for more information.</p>
<a name="chp-pid-stability"></a><h3>Stability</h3>
<p><a name="indexterm-435"></a><a name="indexterm-436"></a>The <tt>pid</tt> provider uses DTrace's stability mechanism to describe its stabilities, as shown in the following table. For more information about the stability mechanism, see <a href="p64.html">Chapter&nbsp;39, Stability</a>.</p>
<table><tr><th><p>Element</p>
</th><th><p>Name stability</p>
</th><th><p>Data stability</p>
</th><th><p>Dependency class</p>
</th></tr>
<tr><td><p>Provider</p>
</td><td><p>Evolving</p>
</td><td><p>Evolving</p>
</td><td><p>ISA</p>
</td></tr>
<tr><td><p>Module</p>
</td><td><p>Private</p>
</td><td><p>Private</p>
</td><td><p>Unknown</p>
</td></tr>
<tr><td><p>Function</p>
</td><td><p>Private</p>
</td><td><p>Private</p>
</td><td><p>Unknown</p>
</td></tr>
<tr><td><p>Name</p>
</td><td><p>Evolving</p>
</td><td><p>Evolving</p>
</td><td><p>ISA</p>
</td></tr>
<tr><td><p>Arguments</p>
</td><td><p>Private</p>
</td><td><p>Private</p>
</td><td><p>Unknown</p>
</td></tr>
</table>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p53.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p55.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

