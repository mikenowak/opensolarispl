<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p131.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p133.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ipfilter-admin-1"></A><b>Chapter&nbsp;26</b><h1>Solaris IP Filter (Tasks)</h1>
<p>This chapter provides step-by-step instructions for Solaris IP Filter tasks. For
overview information about Solaris IP Filter, see <A HREF="p128.html#eupsq">Chapter&nbsp;25, Solaris IP Filter (Overview)</A>.</p>
<p>This chapter contains the following information:</p>
<ul><li><p><A HREF="p132.html#etmhi">Configuring Solaris IP Filter</A></p>
</li>
<li><p><A HREF="p133.html#fabar">Deactivating and Disabling Solaris IP Filter</A></p>
</li>
<li><p><A HREF="p133.html#eubbd">Working With Solaris IP Filter Rule Sets</A></p>
</li>
<li><p><A HREF="p137.html#faaxo">Displaying Statistics and Information for Solaris IP Filter</A></p>
</li>
<li><p><A HREF="p138.html#faavk">Working With Log Files for Solaris IP Filter</A></p>
</li>
<li><p><A HREF="p139.html#ipfilter-admin-2">Creating and Editing Solaris IP Filter Configuration Files</A></p>
</li>
</ul>
<A NAME="etmhi"></A><h2>Configuring Solaris IP Filter</h2>
<p>The following task map identifies the procedures associated with configuring
Solaris IP Filter.</p>
<A NAME="euazt"></A><p><b>Table 26-1 </b>Configuring Solaris IP Filter (Task
Map)</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Task</p></th><th scope="col"><p>Description</p></th><th scope="col"><p>For Instructions</p></th></tr>
<tr><td><p>Initially enable Solaris IP Filter.</p></td><td><p>Solaris IP Filter is not enabled by default. You must either enable
it manually or use the configuration files in the <tt>/etc/ipf/</tt> directory
and reboot the system.
Beginning with Solaris Express, Developer Edition 2/07 release,
packet filter hooks replaced the <tt>pfil</tt> module to enable
Solaris IP filter.</p></td><td><p><A HREF="p132.html#gdwzk">How to Enable Solaris IP Filter</A>&nbsp;</p></td></tr>
<tr><td><p>Re-enable Solaris IP Filter.</p></td><td><p>If Solaris IP Filter is deactivated or disabled, you can re-enable Solaris
IP Filter either by rebooting the system or by using the <tt>ipf</tt> command.</p></td><td><p><A HREF="p132.html#eubbr">How to Re-Enable Solaris IP Filter</A>&nbsp;</p></td></tr>
<tr><td><p>Enable loopback filtering</p></td><td><p>As an option, you can enable loopback filtering, for example, to filter traffic
between zones.</p></td><td><p><A HREF="p132.html#gdwzr">How to Enable Loopback Filtering</A>&nbsp;</p></td></tr>
</table><A NAME="gdwzk"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Enable Solaris IP Filter</h3>
<A NAME="indexterm-2343"></A><p>Use this procedure to enable Solaris IP Filter on a system that is running
at least  Solaris Express, Developer Edition 2/07 OS.</p>
<ol><li><p><b>Assume a role that includes the IP Filter Management rights profile,
or become superuser.</b></p><p>You can assign the IP Filter Management rights
profile to a role that you create. To create the role and assign the role
to a user, see "Configuring RBAC (Task Map)" in <i>System Administration Guide: Security Services</i>.</p>
</li>
<li><p><b>Create a packet filtering rule set.</b></p><p>The packet filtering
rule set contains packet filtering rules that are used by Solaris IP Filter.
If you want the packet filtering rules to be loaded at boot time, edit the <tt>/etc/ipf/ipf.conf</tt> file to implement IPv4
packet filtering. Use the <tt>/etc/ipf/ipf6.conf</tt> file
for IPv6 packet filtering rules. If you do not want the packet filtering
rules loaded at boot time, put the rules in a file of your choice, and manually
activate packet filtering. For information about packet filtering, see <A HREF="p129.html#euqfb">Using Solaris IP Filter's Packet Filtering Feature</A>.
For information about working with configuration files, see <A HREF="p139.html#ipfilter-admin-2">Creating and Editing Solaris IP Filter Configuration Files</A>.</p>
</li>
<li><p><b>(Optional) Create a network address translation (NAT) configuration
file.</b></p><p><hr size="1" noshade><p><b>Note - </b>Network Address Translation
(NAT) does not support IPv6.</p>
<hr size="1" noshade></p><p>Create an <tt>ipnat.conf</tt> file if you want to use network address translation. If you want
the NAT rules to be loaded at boot time, create a file called <tt>/etc/ipf/ipnat.conf</tt> in which to put NAT rules. If you do not want the NAT rules loaded
at boot time, put the <tt>ipnat.conf</tt> file in a location of
your choice, and manually activate the NAT rules.</p>
<p>For more information
about NAT, see <A HREF="p130.html#euqfc">Using Solaris IP Filter's NAT Feature</A>.</p>
</li>
<li><p><b>(Optional) Create an address pool configuration file.</b></p><p>Create
an <tt>ipool.conf</tt> file if you want to refer to a group of
addresses as a single address pool. If you want the address pool configuration
file to be loaded at boot time, create a file called <tt>/etc/ipf/ippool.conf</tt> in which to put the address pool. If you do not want the address
pool configuration file to be loaded at boot time, put the <tt>ippool.conf</tt> file
in a location of your choice, and manually activate the rules.</p>
<p>An address pool can contain only IPv4 addresses or only IPv6 addresses. It
can also contain both IPv4 and IPv6 addresses.</p>
<p>For more information
about address pools, see <A HREF="p130.html#euqfe">Using Solaris IP Filter's Address Pools Feature</A>.</p>
</li>
<li><p><b>(Optional) Enable filtering of loopback traffic.</b></p><p>If
you intend to filter traffic between zones that are configured in your system,
you must enable loopback filtering. See <A HREF="p132.html#gdwzr">How to Enable Loopback Filtering</A>. Make sure that you also define the appropriate
rule sets that apply to the zones.</p>
</li>
<li><p><b>Activate Solaris IP Filter.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>svcadm enable network/ipfilter</b></tt></pre>
</td></table><br></li>
</ol><A NAME="eubbr"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Re-Enable Solaris IP Filter</h3>
<A NAME="indexterm-2344"></A><A NAME="indexterm-2345"></A><A NAME="indexterm-2346"></A><A NAME="indexterm-2347"></A><A NAME="indexterm-2348"></A><A NAME="indexterm-2349"></A><A NAME="indexterm-2350"></A><p>You can re-enable packet filtering after it has been temporarily disabled.</p>
<ol><li><p><b>Assume a role that includes the IP Filter Management rights profile,
or become superuser.</b></p><p>You can assign the IP Filter Management rights
profile to a role that you create. To create the role and assign the role
to a user, see "Configuring RBAC (Task Map)" in <i>System Administration Guide: Security Services</i>.</p>
</li>
<li><p><b>Enable Solaris IP Filter and activate filtering using one of the
following methods:</b></p><ul><li><p>Reboot the machine.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>reboot</b></tt></pre>
</td></table><br><p><hr size="1" noshade><p><b>Note - </b>When IP Filter is enabled, after a reboot the following files
are loaded if they are present: the <tt>/etc/ipf/ipf.conf</tt> file, the <tt>/etc/ipf/ipf6.conf</tt> file when using IPv6, or the <tt>/etc/ipf/ipnat.conf</tt>.</p>
<hr size="1" noshade></p></li>
<li><p>Perform the following series of commands to enable Solaris
IP Filter and activate filtering:</p>
<ol Type="a"><li><p>Enable Solaris IP Filter.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipf -E</b></tt></pre>
</td></table><br></li>
<li><p>Activate packet filtering.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipf -f </tt><i>filename<tt></i></b></tt></pre>
</td></table><br></li>
<li><p>(Optional) Activate NAT.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipnat -f </tt><i>filename<tt></i></b></tt></pre>
</td></table><br><p><hr size="1" noshade><p><b>Note - </b>Network Address Translation (NAT) does not support IPv6.</p>
<hr size="1" noshade></p></li>
</ol>
</li>
</ul>
</li>
</ol><A NAME="gdwzr"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Enable Loopback Filtering</h3>
<A NAME="indexterm-2351"></A><p><hr size="1" noshade><p><b>Note - </b>You can filter loopback traffic only if your system is running
at least Solaris Express, Developer Edition 2/07 release.
In previous Solaris 10 releases, loopback filtering is not supported.</p>
<hr size="1" noshade></p><ol><li><p><b>Assume a role that includes the IP Filter Management rights profile,
or become superuser.</b></p><p>You can assign the IP Filter Management rights
profile to a role that you create. To create the role and assign the role
to a user, see "Configuring RBAC (Task Map)" in <i>System Administration Guide: Security Services</i>.</p>
</li>
<li><p><b>Stop Solaris IP Filter if it is running.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>svcadm disable network/ipfilter</b></tt></pre>
</td></table><br></li>
<li><p><b>Edit the <tt>/etc/ipf.conf</tt> or <tt>/etc/ipf6.conf</tt> file by adding the following line at the beginning of the file:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre>set intercept_loopback true;</pre>
</td></table><br><p>This line must precede all the IP filter rules that are defined in the
file. However, you can insert comments before the line, similar to the following
example:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># 
# Enable loopback filtering to filter between zones 
# 
set intercept_loopback true; 
# 
# Define policy 
# 
block in all 
block out all 
&lt;other rules>
...</pre>
</td></table><br></li>
<li><p><b>Start the Solaris IP filter.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>svcadm enable network/ipfilter</b></tt></pre>
</td></table><br></li>
<li><p><b>To verify the status of loopback filtering, use the following
command:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipf --T ipf_loopback</b></tt>
ipf_loopback    min 0   max 0x1 current 1
#</pre>
</td></table><br><p>If loopback filtering is disabled, the command would generate the following
output:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>ipf_loopback    min 0   max 0x1 current 0</pre>
</td></table><br></li>
</ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p131.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p133.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

