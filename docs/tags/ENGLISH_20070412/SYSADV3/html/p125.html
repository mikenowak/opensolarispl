<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p119.html#ike-task-1">23.&nbsp;&nbsp;Configuring IKE (Tasks)</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p124.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p126.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ike-task-17"></A><h2>Configuring IKE to Find Attached
Hardware (Task Map)</h2>
<p><A NAME="indexterm-2164"></A><A NAME="indexterm-2165"></A><A NAME="indexterm-2166"></A>The following table points to procedures that inform IKE about
attached hardware. You must inform IKE about attached hardware before IKE
can use the hardware. To use the hardware, follow the hardware procedures
in <A HREF="p121.html#ike-task-25">Configuring IKE With Public Key Certificates</A>.</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Task</p></th><th scope="col"><p>Description</p></th><th scope="col"><p>For Instructions</p></th></tr>
<tr><td><p>Offload IKE key operations to the Sun Crypto Accelerator 1000 board</p></td><td><p>Links IKE to the PKCS&nbsp;#11 library.</p></td><td><p><A HREF="p125.html#ike-task-32">How to Configure IKE to Find the Sun Crypto Accelerator 1000 Board</A>&nbsp;</p></td></tr>
<tr><td><p>Offload IKE key operations and store the keys on the Sun Crypto Accelerator 4000 board</p></td><td><p>Links IKE to the PKCS&nbsp;#11 library and lists the name of the attached
hardware.</p></td><td><p><A HREF="p125.html#ike-task-11">How to Configure IKE to Find the Sun Crypto Accelerator 4000 Board</A>&nbsp;</p></td></tr>
</table><A NAME="ike-task-35"></A><h2>Configuring IKE to Find Attached Hardware</h2>
<p><A NAME="indexterm-2167"></A>Public key certificates can also be stored on attached hardware,
the Sun Crypto Accelerator 1000 board and the Sun Crypto Accelerator 4000 board. With the Sun Crypto Accelerator 4000 board, public key operations
can also be offloaded from the system to the board.</p>
<A NAME="ike-task-32"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Configure IKE to Find the Sun Crypto Accelerator 1000 Board</h3>
<A NAME="indexterm-2168"></A><A NAME="indexterm-2169"></A><A NAME="indexterm-2170"></A><A NAME="indexterm-2171"></A><A NAME="indexterm-2172"></A><h5>Before You Begin</h5><p>The following procedure assumes that a Sun Crypto Accelerator 1000 board is attached to the
system. The procedure also assumes that the software for the board has been
installed and that the software has been configured. For instructions, see
the <i>Sun Crypto Accelerator 1000 Board Version 1.1 Installation
and User's Guide</i>.</p>
<ol><li><p><b>On the system console, assume the Primary Administrator role or
become superuser.</b></p><p>The Primary Administrator role includes the
Primary Administrator profile. To create the role and assign the role to a
user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
<p><hr size="1" noshade><p><b>Note - </b>Logging in remotely exposes security-critical traffic to eavesdropping.
Even if you somehow protect the remote login, the security of the system is
reduced to the security of the remote login session.</p>
<hr size="1" noshade></p></li>
<li><p><b>Check that the
library is linked.</b></p><p>Type
the following command to determine whether a PKCS&nbsp;#11 library is linked:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ikeadm get stats</b></tt>
Phase 1 SA counts:
Current:   initiator:          0   responder:          0
Total:     initiator:          0   responder:          0
Attempted: initiator:          0   responder:          0
Failed:    initiator:          0   responder:          0
           initiator fails include 0 time-out(s)
PKCS#11 library linked in from /usr/lib/libpkcs11.so
# </pre>
</td></table><br></li>
<li><p><b>Solaris 10 1/06: In this release, you can store keys in the softtoken
keystore.</b></p><p>For information on the keystore that is provided by
the Solaris cryptographic framework, see the <tt>cryptoadm</tt>(1M) man page. For an example
of using the keystore, see <A HREF="p125.html#ike-task-46">Example 23-9</A>.</p>
</li>
</ol><A NAME="ike-task-11"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Configure IKE to Find the Sun Crypto Accelerator 4000 Board</h3>
<A NAME="indexterm-2173"></A><A NAME="indexterm-2174"></A><A NAME="indexterm-2175"></A><A NAME="indexterm-2176"></A><A NAME="indexterm-2177"></A><h5>Before You Begin</h5><p>The following procedure assumes that a Sun Crypto Accelerator 4000 board is attached to the
system. The procedure also assumes that the software for the board has been
installed and that the software has been configured. For instructions, see
the <i>Sun Crypto Accelerator 4000 Board Installation and User's Guide</i>.
The guide is available from the <A  HREF="http://www.sun.com/products-n-solutions/hardware/docs">http://www.sun.com/products-n-solutions/hardware/docs</A> web site, under Network and Security Products.</p>
<ol><li><p><b>On the system console, assume the Primary Administrator role or
become superuser.</b></p><p>The Primary Administrator role includes the
Primary Administrator profile. To create the role and assign the role to a
user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
<p><hr size="1" noshade><p><b>Note - </b>Logging in remotely exposes security-critical traffic to eavesdropping.
Even if you somehow protect the remote login, the security of the system is
reduced to the security of the remote login session.</p>
<hr size="1" noshade></p></li>
<li><p><b>Check that the PKCS&nbsp;#11 library is linked.</b></p><p>IKE uses the library's
routines to handle key generation and key storage on the Sun Crypto Accelerator 4000 board. Type the following command to determine whether a PKCS&nbsp;#11
library has been linked:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>$ <tt><b>ikeadm get stats</b></tt>
...
PKCS#11 library linked in from /usr/lib/libpkcs11.so
$</pre>
</td></table><br><p><hr size="1" noshade><p><b>Note - </b>The Sun Crypto Accelerator 4000 board supports keys up to 2048 bits for RSA. For DSA,
this board supports keys up to 1024 bits.</p>
<hr size="1" noshade></p></li>
<li><p><b><A NAME="indexterm-2178"></A><A NAME="indexterm-2179"></A><A NAME="indexterm-2180"></A><A NAME="indexterm-2181"></A>Find the token ID for the attached Sun Crypto Accelerator 4000 board.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre>$ <tt><b>ikecert tokens</b></tt>
Available tokens with library "/usr/lib/libpkcs11.so":

"Sun Metaslot                     "</pre>
</td></table><br><p>The library returns a token ID, also called a <A HREF="p193.html#glossary-124">keystore name</A>, of 32 characters. In this
example, you could use the <tt>Sun Metaslot</tt> token
with the <tt>ikecert</tt> commands to store and to accelerate IKE
keys.</p>
<p>For instructions on how to use the token, see <A HREF="p123.html#ike-task-14">How to Generate and Store Public Key Certificates on Hardware</A>.</p>
<p>The trailing spaces are automatically padded
by the <tt>ikecert</tt> command.</p>
</li>
</ol><A NAME="ike-task-46"></A><h5>Example 23-9 &nbsp;&nbsp;Finding and Using Metaslot Tokens</h5>
<A NAME="indexterm-2182"></A><A NAME="indexterm-2183"></A><p>Tokens can be stored on disk, on an attached board, or in the softtoken
keystore that the Solaris encryption framework provides. The softtoken keystore
token ID might resemble the following.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>$ <tt><b>ikecert tokens</b></tt>
Available tokens with library "/usr/lib/libpkcs11.so":

"Sun Metaslot                   "</pre>
</td></table><br><p>To create a passphrase for the softtoken keystore, see the <tt>pktool</tt>(1) man page.</p>
<p>A command that resembles the following would add a certificate to the
softtoken keystore. <tt>Sun.Metaslot.cert</tt> is a file that contains the CA certificate:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ikecert certdb -a -T "Sun Metaslot" &lt; Sun.Metaslot.cert</b></tt>
Enter PIN for PKCS#11 token: <em>Type user:passphrase</em></pre>
</td></table><br><A NAME="ike-task-19"></A><h2>Changing IKE Transmission Parameters
(Task Map)</h2>
<p><A NAME="indexterm-2184"></A><A NAME="indexterm-2185"></A><A NAME="indexterm-2186"></A>The following table points to procedures to configure transmission
parameters for IKE.</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Task</p></th><th scope="col"><p>Description</p></th><th scope="col"><p>For Instructions</p></th></tr>
<tr><td><p>Make key negotiation more efficient</p></td><td><p>Changes the key negotiation parameters.</p></td><td><p><A HREF="p125.html#ike-task-34">How to Change the Duration of Phase 1 IKE Key Negotiation</A>&nbsp;</p></td></tr>
<tr><td><p>Configure key negotiation to allow for delays in transmission</p></td><td><p>Lengthens the key negotiation parameters.</p></td><td><p><A HREF="p125.html#ike-task-26">Example 23-10</A>&nbsp;</p></td></tr>
<tr><td><p>Configure key negotiation to succeed quickly, or to show failures quickly</p></td><td><p>Shortens the key negotiation parameters.</p></td><td><p><A HREF="p125.html#ike-task-28">Example 23-11</A>&nbsp;</p></td></tr>
</table><A NAME="ike-task-20"></A><h2>Changing IKE Transmission Parameters</h2>
<A NAME="indexterm-2187"></A><A NAME="indexterm-2188"></A><A NAME="indexterm-2189"></A><A NAME="indexterm-2190"></A><A NAME="indexterm-2191"></A><p>When IKE negotiates keys, the speed of transmission can affect the success
of the negotiation. Normally, you would not need to change the default values
for IKE transmission parameters. However, when optimizing key negotiation
over very dirty lines, or when reproducing a problem, you might want to change
the transmission values.</p>
<p>Longer duration times enable IKE to negotiate keys over unreliable transmission
lines. You can lengthen certain parameters so that initial attempts succeed.
If the initial attempt does not succeed, you can space subsequent attempts
to offer more time for success.</p>
<p>Shorter duration times enable you to take advantage of reliable transmission
lines. You can more quickly retry a failed negotiation to speed up the negotiation.
When diagnosing a problem, you might also want to speed up the negotiation
for a quick failure. Shorter durations also enable the Phase 1 SAs to be used
for their lifetime.</p>
<A NAME="ike-task-34"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Change the Duration of Phase
1 IKE Key Negotiation</h3>
<ol><li><p><b>On the system console, assume the Primary Administrator role or
become superuser.</b></p><p>The Primary Administrator role includes the
Primary Administrator profile. To create the role and assign the role to a
user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
<p><hr size="1" noshade><p><b>Note - </b><A NAME="indexterm-2192"></A>Logging in remotely exposes security-critical traffic to eavesdropping.
Even if you somehow protect the remote login, the security of the system is
reduced to the security of the remote login session.</p>
<hr size="1" noshade></p></li>
<li><p><b><A NAME="indexterm-2193"></A>Change the default values of the global transmission parameters
on each system.</b></p><p><A NAME="indexterm-2194"></A><A NAME="indexterm-2195"></A><A NAME="indexterm-2196"></A><A NAME="indexterm-2197"></A><A NAME="indexterm-2198"></A>On each system, modify Phase 1 duration parameters the <tt>/etc/inet/ike/config</tt> file.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>### ike/config file on <em>system</em>

## Global parameters
#
## Phase 1 transform defaults
#
#expire_timer      300
#retry_limit         5
#retry_timer_init    0.5 (integer or float)
#retry_timer_max    30   (integer or float)</pre>
</td></table><br><table border="0" cellspacing="5"><tr><td valign="top"><p><tt>expire_timer</tt></p></td><td valign="top"><p>The number of seconds to let a not-yet-complete IKE Phase
I negotiation linger before deleting the negotiation attempt. By default,
the attempt lingers for 30 seconds.</p>
</td></tr><tr><td valign="top"><p><tt>retry_limit</tt></p></td><td valign="top"><p>The number of retransmits before any IKE negotiation is aborted.
By default, IKE tries five times.</p>
</td></tr><tr><td valign="top"><p><tt>retry_timer_init</tt></p></td><td valign="top"><p>The initial interval between retransmits. This interval is
doubled until the <tt>retry_timer_max</tt>  value is  reached. The
initial interval is 0.5 seconds.</p>
</td></tr><tr><td valign="top"><p><tt>retry_timer_max</tt></p></td><td valign="top"><p>The maximum interval in seconds between retransmits. The retransmit
interval stops growing at this limit. By default, the limit is 30 seconds.</p>
</td></tr></table>
</li>
<li><p><b>Reboot the system.</b></p><p>Or, stop and start the <tt>in.iked</tt> daemon.</p>
</li>
</ol><A NAME="ike-task-26"></A><h5>Example 23-10 &nbsp;&nbsp;Lengthening IKE Phase 1 Negotiation Times</h5>
<p>In the following example, a system is connected to its IKE peers by
a high-traffic transmission line. The original settings are in comments in
the file. The new settings lengthen the negotiation time.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>### ike/config file on partym
## Global Parameters
#
## Phase 1 transform defaults
#expire_timer   300
#retry_limit      5
#retry_timer_init 0.5 (integer or float)
#retry_timer_max 30   (integer or float)
#
<tt><b>expire_timer  600</b></tt>
<tt><b>retry_limit  10</b></tt>
<tt><b>retry_timer_init  2.5</b></tt>
<tt><b>retry_timer_max  180</b></tt></pre>
</td></table><br><A NAME="ike-task-28"></A><h5>Example 23-11 &nbsp;&nbsp;Shortening IKE Phase 1 Negotiation Times</h5>
<p>In the following example, a system is connected to its IKE peers by
a high-speed line with little traffic. The original settings are in comments
in the file. The new settings shorten the negotiation time.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>### ike/config file on partym
## Global Parameters
#
## Phase 1 transform defaults
#expire_timer   300
#retry_limit      5
#retry_timer_init 0.5 (integer or float)
#retry_timer_max 30   (integer or float)
#
<tt><b>expire_timer  120</b></tt>
<tt><b>retry_timer_init  0.20</b></tt></pre>
</td></table><br>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p124.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p126.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

