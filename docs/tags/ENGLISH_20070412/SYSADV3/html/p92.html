<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p90.html#eyatl">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p91.html#eyhuv">DHCP Client Host Names</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p91.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p93.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="dhcp-admin-1058sm"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Enable a Solaris Client to Request
a Specific Host Name</h3>
<A NAME="indexterm-1540"></A><A NAME="indexterm-1541"></A><ol><A NAME="dhcp-admin-step-523"></A><li><p><b>On the client system, edit the <tt>/etc/default/dhcpagent</tt> file as superuser.</b></p></li>
<A NAME="dhcp-admin-step-524"></A><li><p><b>Find the <tt>REQUEST_HOSTNAME</tt> keyword
in the <tt>/etc/default/dhcpagent</tt> file and modify the keyword
as follows:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre>REQUEST_HOSTNAME=yes</pre>
</td></table><br><p>If a comment sign (#) is in front of <tt>REQUEST_HOSTNAME</tt>,
remove the #. If the <tt>REQUEST_HOSTNAME</tt> keyword is not present,
insert the keyword.</p>
</li>
<A NAME="dhcp-admin-step-525"></A><li><p><b>Edit the <tt>/etc/hostname</tt>.<i>interface</i> file on the client system to add the following line:</b></p><pre style="font-family:arial,helvetica,sans-serif"><tt>inet</tt> <i>hostname</i></pre>
<p><i>hostname</i> is the name that you want the client
to use.</p>
</li>
<A NAME="dhcp-admin-step-526"></A><li><p><b>Type the following commands to have the
client perform a full DHCP negotiation upon rebooting:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>pkill dhcpagent</b></tt>
# <tt><b>rm /etc/dhcp/</tt><i>interface<tt></i>.dhc</b></tt>
# <tt><b>reboot</b></tt></pre>
</td></table><br><p>The DHCP data that is cached on the client is removed. The client restarts
the protocol to request new configuration information, including a new host
name. The DHCP server first makes sure that the host name is not in use by
another system on the network. The server then assigns the host name to the
client. If configured to do so, the DHCP server can update name services with
the client's host name.</p>
<p>If you want to change the host name later,
repeat <A HREF="p92.html#dhcp-admin-step-525">Step&nbsp;3</A> and <A HREF="p92.html#dhcp-admin-step-526">Step&nbsp;4</A>.</p>
</li>
</ol><A NAME="dhcp-overview-5"></A><h2>DHCP Client Systems and Name Services</h2>
<p>Solaris systems support the following name services: DNS, NIS, NIS+,
and a local file store (<tt>/etc/inet/hosts</tt>). Each name service
requires some configuration before it is usable. The name service switch configuration
file (see <tt>nsswitch.conf</tt>(4)) must also be set up appropriately to indicate the
name services to be used.</p>
<p>Before a DHCP client system can use a name service, you must configure
the system as a client of the name service.</p>
<p>The following table summarizes issues that are related to each name
service and DHCP. The table includes links to documentation that can help
you set up clients for each name service.</p>
<A NAME="dhcp-overview-tbl-3"></A><p><b>Table 16-1 </b>Name Service Client
Setup Information for DHCP Client Systems</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Name Service </p></th><th scope="col"><p>Client Setup Information</p></th></tr>
<tr><td><p>NIS</p></td><td><p>If you are using Solaris DHCP to send Solaris network install information
to a client system, you can use a configuration macro that contains the <tt>NISservs</tt> and <tt>NISdmain</tt> options. These options
pass the IP addresses of NIS servers and the NIS domain name to the client.
The client then automatically becomes an NIS client.</p><p>If a DHCP client system is already running the Solaris OS, the NIS client
is not automatically configured on that system when the DHCP server sends
NIS information to the client.</p><p>If the DHCP server is configured to send NIS information to the DHCP
client system, you can see the values given to the client if you use the <tt>dhcpinfo</tt> command on the client as follows:</p><p># <tt>/sbin/dhcpinfo NISdmain</tt></p><p># <tt>/sbin/dhcpinfo NISservs</tt></p><p>Use the values returned for the NIS domain name and NIS servers when
you set up the system as an NIS client.</p><p>You set up an NIS client for a Solaris DHCP client system in the standard
way, as documented in Chapter 5, "Setting Up and Configuring NIS Service," in <i>System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</i>. </p><p><hr size="1" noshade><p><b>Tip - </b>You can write a script that uses <tt>dhcpinfo</tt> and <tt>ypinit</tt> to automate NIS client configuration on DHCP client systems.</p><hr size="1" noshade></p></td></tr>
<tr><td><p>NIS+</p></td><td><p>If the DHCP client system receives a nonreserved IP address, the address
might not always be the same. You must set up the NIS+ client for a DHCP client
system in a nonstandard way, which is documented in <A HREF="p92.html#dhcp-admin-77">Setting Up DHCP Clients as NIS+ Clients</A>.
This procedure is necessary because NIS+ uses security measures to authenticate
requests for service. The security measures depend upon the IP address.</p><p>If the DHCP client system has been manually assigned an IP address,
the client's address is always the same. You can set up the NIS+ client in
the standard way, which is documented in "Setting Up NIS+ Client Machines" in <i>System Administration Guide: Naming and Directory Services (NIS+)</i>.</p></td></tr>
<tr><td><p><tt>/etc/inet/hosts</tt></p></td><td><p>You must set up the <tt>/etc/inet/hosts</tt> file for a
DHCP client system that is to use <tt>/etc/inet/hosts</tt> for
its name service.</p><p>The DHCP client system's host name is added to its own <tt>/etc/inet/hosts</tt> file by the DHCP tools. However, you must manually add the host
name to the <tt>/etc/inet/hosts</tt> files of other systems in
the network. If the DHCP server system uses <tt>/etc/inet/hosts</tt> for
name resolution, you must also manually add the client's host name on the
system.</p></td></tr>
<tr><td><p>DNS</p></td><td><p>If the DHCP client system receives the DNS domain name through DHCP,
the client system's <tt>/etc/resolv.conf</tt> file is configured
automatically. The <tt>/etc/nsswitch.conf</tt> file is also automatically
updated to append <tt>dns</tt> to the <tt>hosts</tt> line
after any other name services in the search order. See <i>System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</i>for more information about DNS.</p></td></tr>
</table><A NAME="dhcp-admin-77"></A><h3>Setting Up DHCP Clients as NIS+ Clients</h3>
<p>You can use the NIS+ name service on Solaris systems that are DHCP clients.
However, to do so requires you to partially circumvent one of the security-enhancing
features of NIS+, the creation of Data Encryption Standard (DES) credentials.
When you set up an NIS+ client that is <b>not</b> using DHCP,
you add unique DES credentials for the client to the NIS+ server. There are
several ways to create credentials, such as using the <tt>nisclient</tt> script
or the <tt>nisaddcred</tt> command.</p>
<p>For DHCP clients, you <b>cannot</b> use these methods.
NIS+ credential generation requires a client to have a static host name to
create and store the credentials. If you want to use NIS+ and DHCP, you must
create identical credentials to be used for all the host names of DHCP clients.
In this way, no matter what IP address and associated host name that a DHCP
client receives, the client can use the same DES credentials.</p>
<hr size="1" noshade><p><IMG ALT="Caution" src="graphics/caution.gif">  <b>Caution - </b>Before performing the following procedure, be aware that NIS+
was designed for increased security. This procedure weakens that security
by allowing random DHCP clients to receive NIS+ credentials.</p><hr size="1" noshade><p>The following procedure shows you how to create identical credentials
for all DHCP host names. This procedure is valid only if you know the host
names that DHCP clients use. For example, when the DHCP server generates the
host names, you know the possible host names that a client can receive.</p>
<A NAME="dhcp-admin-22"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Set Up Solaris DHCP Clients as NIS+
Clients</h4>
<p>A DHCP client system that is to be an NIS+ client must use credentials
that belong to another NIS+ client system in the NIS+ domain. This procedure
only produces credentials for the system, which apply only to the superuser
logged in to the system. Other users who log in to the DHCP client system
must have their own unique credentials in the NIS+ server. These credentials
are created according to a procedure in the <i>System Administration Guide: Naming and Directory Services (NIS+)</i>.</p>
<ol><A NAME="dhcp-admin-step-564"></A><li><p><b>Create the credentials for a client by
typing the following command on the NIS+ server:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>nisgrep </tt><i>nisplus-client-name<tt></i> cred.org_dir > /tmp/</tt><i>file<tt></i></b></tt></pre>
</td></table><br><p>This command writes the <tt>cred.org_dir</tt> table entry
for the NIS+ client to a temporary file.</p>
</li>
<A NAME="dhcp-admin-step-565"></A><li><p><b>Use the <tt>cat</tt> command
to view the contents of the temporary file.</b></p><p>Or, use a text editor.</p>
</li>
<A NAME="dhcp-admin-step-565a"></A><li><p><b>Copy the credentials to use for DHCP
clients.</b></p><p>You must copy the public key and private key, which are
long strings of numbers and letters separated by colons. The credentials are
to be pasted into the command issued in the next step.</p>
</li>
<A NAME="dhcp-admin-step-566"></A><li><p><b>Add credentials for a DHCP client by
typing the following command:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>nistbladm -a cname="</b></tt> <i>dhcp-client-name</i>@<i>nisplus-domain</i><tt><b>" auth_type=DES \</b></tt>
<tt><b>auth_name="unix.</b></tt><i>dhcp-client-name</i>@<i>nisplus-domain</i><tt><b>" \</b></tt>
<tt><b>public_data=</b></tt><i>copied-public-key</i> <tt><b>\</b></tt> 
<tt><b>private_data=</b></tt><i>copied-private-key</i></pre>
</td></table><br><p>For the <i>copied-public-key</i>, paste the public
key information that you copied from the temporary file. For the <i>copied-private-key</i>, paste the private key information that you copied from the
temporary file.</p>
</li>
<A NAME="dhcp-admin-step-567"></A><li><p><b>Remote copy files from the NIS+ client
system to the DHCP client system by typing the following commands on the DHCP
client system:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>rcp</b></tt> <i>nisplus-client-name</i><tt><b>:/var/nis/NIS_COLD_START /var/nis</b></tt>
# <tt><b>rcp</b></tt> <i>nisplus-client-name</i><tt><b>:/etc/.rootkey /etc</b></tt>
# <tt><b>rcp</b></tt> <i>nisplus-client-name</i><tt><b>:/etc/defaultdomain /etc</b></tt></pre>
</td></table><br><p>If you get a "permission denied" message, the systems might
not be set up to allow remote copying. In this case, you can copy the files
as a regular user to an intermediate location. As superuser, copy the files
from the intermediate location to the proper location on the DHCP client system.</p>
</li>
<A NAME="dhcp-admin-step-568"></A><li><p><b>Copy the correct name service switch
file for NIS+ by typing the following command on the DHCP client system:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cp /etc/nsswitch.nisplus /etc/nsswitch.conf</b></tt></pre>
</td></table><br></li>
<A NAME="dhcp-admin-step-569"></A><li><p><b>Reboot the DHCP client system.</b></p><p>The
DHCP client system should now be able to use NIS+ services.</p>
</li>
</ol><A NAME="dhcp-admin-570"></A><h5>Example 16-1 &nbsp;&nbsp;Setting up a Solaris DHCP Client System as an NIS+ Client</h5>
<p>The following example assumes that you have one system <tt>nisei</tt>,
which is an NIS+ client in the NIS+ domain <tt>dev.example.net</tt>.
You also have one DHCP client system, <tt>dhow</tt>, and you want <tt>dhow</tt> to be an NIS+ client.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre><em>(First log in as superuser on the NIS+ server)</em>
# <tt><b>nisgrep nisei cred.org_dir > /tmp/nisei-cred</b></tt>
# <tt><b>cat /tmp/nisei-cred</b></tt>
nisei.dev.example.net.:DES:unix.nisei@dev.example.net:46199279911a84045b8e0
c76822179138173a20edbd8eab4:90f2e2bb6ffe7e3547346dda624ec4c7f0fe1d5f37e21cff63830
c05bc1c724b
# <tt><b>nistbladm -a cname="dhow@dev.example.net." \</b></tt>
<tt><b>auth_type=DES auth_name="unix.dhow@dev.example.net" \</b></tt>
<tt><b>public_data=46199279911a84045b8e0c76822179138173a20edbd8eab4 \</b></tt>
<tt><b>private_data=90f2e2bb6ffe7e3547346dda624ec4c7f0fe1d5f37e21cff63830\</b></tt>
<tt><b>c05bc1c724b</b></tt>
# <tt><b>rlogin dhow</b></tt>
<em>(Log in as superuser on dhow)</em>
# <tt><b>rcp nisei:/var/nis/NIS_COLD_START /var/nis</b></tt>
# <tt><b>rcp nisei:/etc/.rootkey /etc</b></tt>
# <tt><b>rcp nisei:/etc/defaultdomain /etc</b></tt>
# <tt><b>cp /etc/nsswitch.nisplus /etc/nsswitch.conf</b></tt>
# <tt><b>reboot</b></tt></pre>
</td></table><br><p>The DHCP client system <tt>dhow</tt> should now be able to
use NIS+ services.</p>
<A NAME="eojcc"></A><h5>Example 16-2 &nbsp;&nbsp;Adding Credentials With a Script</h5>
<p>If you want to set up a large number of DHCP client systems as NIS+
clients, you can write a script. A script can quickly add the entries to the <tt>cred.org_dir</tt> NIS+ table. The following example shows a sample script.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>#! /usr/bin/ksh  
# 
# Copyright (c) by Sun Microsystems, Inc. All rights reserved. 
# 
# Sample script for cloning a credential. Hosts file is already populated  
# with entries of the form dhcp-[0-9][0-9][0-9]. The entry we're cloning 
# is dhcp-001. 
#  
#  
PUBLIC_DATA=6e72878d8dc095a8b5aea951733d6ea91b4ec59e136bd3b3 
PRIVATE_DATA=3a86729b685e2b2320cd7e26d4f1519ee070a60620a93e48a8682c5031058df4
HOST="dhcp-" 
DOMAIN="mydomain.example.com"  
 
for 
i in 002 003 004 005 006 007 008 009 010 011 012 013 014 015 016 017 018 019
do         
     print - ${HOST}${i}         
     #nistbladm -r [cname="${HOST}${i}.${DOMAIN}."]cred.org_dir         
     nistbladm -a cname="${HOST}${i}.${DOMAIN}." \
         auth_type=DES auth_name="unix.${HOST}${i}@${DOMAIN}" \
         public_data=${PUBLIC_DATA} private_data=${PRIVATE_DTA} cred.org_Dir
done  
 
exit 0</pre>
</td></table><br>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p91.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p93.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

