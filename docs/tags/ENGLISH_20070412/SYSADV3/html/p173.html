<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p172.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p174.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ipqos-config-planning-1"></A><b>Chapter&nbsp;33</b><h1>Planning for an IPQoS-Enabled Network (Tasks)</h1>
<p>You can configure IPQoS on any system that runs the Solaris OS. The
IPQoS system then works with Diffserv-aware routers to provide differentiated
services and traffic management on an intranet. </p>
<p>This chapter contains planning tasks for adding IPQoS-enabled systems
onto a Diffserv-aware network. The following topics are covered.</p>
<ul><li><p><A HREF="p173.html#ipqos-config-planning-2">General IPQoS Configuration Planning (Task Map)</A></p>
</li>
<li><p><A HREF="p173.html#ipqos-config-planning-5">Planning the Diffserv Network Topology</A></p>
</li>
<li><p><A HREF="p173.html#ipqos-config-planning-7">Planning the Quality-of-Service Policy</A></p>
</li>
<li><p><A HREF="p173.html#euiht">QoS Policy Planning (Task Map)</A></p>
</li>
<li><p><A HREF="p176.html#ipqos-config-planning-13">Introducing the IPQoS Configuration Example</A></p>
</li>
</ul>
<A NAME="ipqos-config-planning-2"></A><h2>General IPQoS Configuration Planning
(Task Map)</h2>
<p><A NAME="indexterm-3053"></A><A NAME="indexterm-3054"></A>Implementing differentiated services, including IPQoS, on a network
requires extensive planning. You must consider not only the position and function
of each IPQoS-enabled system, but also each system's relationship to the router
on the local network. The following task map lists the major planning tasks
for implementing IPQoS on your network.</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Task</p></th><th scope="col"><p>Description</p></th><th scope="col"><p>For Instructions</p></th></tr>
<tr><td><p>1. Plan a Diffserv network topology that incorporates IPQoS-enabled
systems.</p></td><td><p>Learn about the various Diffserv network topologies to determine the
best solution for your site.</p></td><td><p><A HREF="p173.html#ipqos-config-planning-5">Planning the Diffserv Network Topology</A>.</p></td></tr>
<tr><td><p>2. Plan the different types of services to be offered by the IPQoS systems.</p></td><td><p>Organize the types of services that the network provides into service-level
agreements (SLAs).</p></td><td><p><A HREF="p173.html#ipqos-config-planning-7">Planning the Quality-of-Service Policy</A>.</p></td></tr>
<tr><td><p>3. Plan the QoS policy for each IPQoS system.</p></td><td><p>Decide on the classes, metering, and accounting features that are needed
to implement each SLA.</p></td><td><p><A HREF="p173.html#ipqos-config-planning-7">Planning the Quality-of-Service Policy</A>.</p></td></tr>
<tr><td><p>4. If applicable, plan the policy for the Diffserv router.</p></td><td><p>Decide any scheduling and queuing policies for the Diffserv router that
is used with the IPQoS systems.</p></td><td><p>Refer to router documentation for queuing and scheduling policies.</p></td></tr>
</table><A NAME="ipqos-config-planning-5"></A><h2>Planning the Diffserv Network Topology</h2>
<p><A NAME="indexterm-3055"></A><A NAME="indexterm-3056"></A>To provide differentiated services for your network, you need
at least one IPQoS-enabled system and a Diffserv-aware router. You can expand
this basic scenario in a variety of ways, as explained in this section.</p>
<A NAME="ipqos-config-planning-3"></A><h3>Hardware Strategies for the Diffserv
Network</h3>
<p><A NAME="indexterm-3057"></A><A NAME="indexterm-3058"></A>Typically, customers run IPQoS on servers and server consolidations,
such as the Sun Enterprise&trade; 0000 server. Conversely, you can also run
IPQoS on desktop systems such as UltraSPARC<IMG alt="reg" SRC="ents/reg.gif" border="0"> systems, depending
on the needs of your network. The following list describes possible systems
for an IPQoS configuration:</p>
<ul><li><p>Solaris systems that offer various services, such as web servers
and database servers</p>
</li>
<li><p>Application servers that offer email, FTP, or other popular
network applications</p>
</li>
<li><p>Web cache servers or proxy servers</p>
</li>
<li><p>Network of IPQoS-enabled server farms that are managed by
Diffserv-aware load balancers</p>
</li>
<li><p>Firewalls that manage traffic for a single heterogeneous network</p>
</li>
<li><p>IPQoS systems that are part of a virtual local area network
(LAN)</p>
</li>
</ul>
<p>You might introduce IPQoS systems into a network topology with already
functioning Diffserv-aware routers. If your router does not currently offer
Diffserv, consider the Diffserv solutions that are offered by Cisco Systems,
Juniper Networks, and other router manufacturers. If the local router does
not implement Diffserv, then the router passes marked packets on to the next
hop without evaluating the marks.</p>
<A NAME="ipqos-config-planning-4"></A><h3>IPQoS Network Topologies</h3>
<p><A NAME="indexterm-3059"></A><A NAME="indexterm-3060"></A>This section illustrates IPQoS strategies for various network
needs.</p>
<A NAME="ipqos-config-planning-9"></A><h4>IPQoS on Individual Hosts</h4>
<p><A NAME="indexterm-3061"></A><A NAME="indexterm-3062"></A>The following figure shows a single network of IPQoS-enabled systems. </p>
<A NAME="ipqos-config-planning-fig-41"></A><p><b>Figure 33-1 </b>IPQoS Systems on a Network
Segment</p>
<IMG src="figures/IPQos-en-hosts.gif" class="figure" alt="Topology diagram shows a local network with a Diffserv
router, and three IPQoS-enabled systems: FTP server, database server, and
a web server." title="Topology diagram shows a local network with a Diffserv
router, and three IPQoS-enabled systems: FTP server, database server, and
a web server."><p>This network is but one segment of a corporate intranet. By enabling
IPQoS on the application servers and web servers, you can control the rate
at which each IPQoS system releases outgoing traffic. If you make the router
Diffserv aware, you can further control incoming and outgoing traffic.</p>
<p>The examples in this guide use the "IPQoS on an individual host"
scenario. For the example topology that is used throughout the guide, see <A HREF="p177.html#ipqos-config-planning-fig-44">Figure 33-4</A>.</p>
<A NAME="ipqos-config-planning-10"></A><h4>IPQoS on a Network of Server Farms</h4>
<p><A NAME="indexterm-3063"></A><A NAME="indexterm-3064"></A>The following figure shows a network with several heterogeneous
server farms.</p>
<A NAME="ipqos-config-planning-fig-42"></A><p><b>Figure 33-2 </b>Network of IPQoS-Enabled
Server Farms</p>
<IMG src="figures/IPQos-nw-serv-farm.gif" class="figure" alt="Topology diagram shows a network with a Diffserv router,
an IPQoS-enabled load balancer, and three server farms." title="Topology diagram shows a network with a Diffserv router,
an IPQoS-enabled load balancer, and three server farms."><p>In such a topology, the router is Diffserv aware, and therefore able
to queue and rate both incoming and outgoing traffic. The load balancer is
also Diffserv-aware, and the server farms are IPQoS enabled. The load balancer
can provide additional filtering beyond the router by using selectors such
as user ID and project ID. These selectors are included in the application
data.</p>
<p>This scenario provides flow control and traffic forwarding to manage
congestion on the local network. This scenario also prevents outgoing traffic
from the server farms from overloading other portions of the intranet.</p>
<A NAME="ipqos-config-planning-11"></A><h4>IPQoS on a Firewall</h4>
<p><A NAME="indexterm-3065"></A><A NAME="indexterm-3066"></A>The following figure shows a segment of a corporate network that
is secured from other segments by a firewall.</p>
<A NAME="ipqos-config-planning-fig-43"></A><p><b>Figure 33-3 </b>Network Protected by an IPQoS-Enabled
Firewall</p>
<IMG src="figures/IPQos-firewall.gif" class="figure" alt="Topology diagram shows a network consisting of a Diffserv
router, an IPQoS-enabled firewall, a Solaris system, and other hosts." title="Topology diagram shows a network consisting of a Diffserv
router, an IPQoS-enabled firewall, a Solaris system, and other hosts."><p>In this scenario, traffic flows into a Diffserv-aware router where the
packets are filtered and queued. All incoming traffic that is forwarded by
the router then travels into the IPQoS-enabled firewall. To use IPQoS, the
firewall must not bypass the IP forwarding stack.</p>
<p>The firewall's security policy determines whether incoming traffic is
permitted to enter or depart the internal network. The QoS policy controls
the service levels for incoming traffic that has passed the firewall. Depending
on the QoS policy, outgoing traffic can also be marked with a forwarding behavior. </p>
<A NAME="ipqos-config-planning-7"></A><h2>Planning the Quality-of-Service
Policy</h2>
<p><A NAME="indexterm-3067"></A>When you plan the quality-of-service (QoS) policy, you must review,
classify, and then prioritize the services that your network provides. You
must also assess the amount of available bandwidth to determine the rate at
which each traffic class is released onto the network. </p>
<A NAME="ipqos-config-planning-19"></A><h3>QoS Policy Planning Aids</h3>
<p><A NAME="indexterm-3068"></A>Gather information for planning the QoS policy in a format that
includes the information needed for the IPQoS configuration file. For example,
you can use the following template to list the major categories of information
to be used in the IPQoS configuration file.</p>
<A NAME="ipqos-config-planning-tbl-28"></A><p><b>Table 33-1 </b>QoS
Planning Template</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Class</p></th><th scope="col"><p>Priority</p></th><th scope="col"><p>Filter</p></th><th scope="col"><p>Selector</p></th><th scope="col"><p>Rate</p></th><th scope="col"><p>Forwarding?</p></th><th scope="col"><p>Accounting?</p></th></tr>
<tr><td><p>Class 1</p></td><td><p>1</p></td><td><p>Filter 1</p><p>Filter 3</p></td><td><p>Selector 1</p><p>Selector 2</p></td><td><p>Meter rates, depending on meter type</p></td><td><p>Marker drop precedence</p></td><td><p>Requires flow-accounting statistics</p></td></tr>
<tr><td><p>Class 1</p></td><td><p>1</p></td><td><p>Filter 2</p></td><td><p>Selector 1</p><p>Selector 2</p><p>&nbsp;</p></td><td><p>N/A</p></td><td><p>N/A</p></td><td><p>N/A</p></td></tr>
<tr><td><p>Class 2</p></td><td><p>2</p></td><td><p>Filter 1</p></td><td><p>Selector 1</p><p>Selector 2</p></td><td><p>Meter rates, depending on meter type</p></td><td><p>Marker drop precedence</p></td><td><p>Requires flow-accounting statistics</p></td></tr>
<tr><td><p>Class 2</p></td><td><p>2</p></td><td><p>Filter 2</p></td><td><p>Selector 1</p><p>Selector 2</p></td><td><p>N/A</p></td><td><p>N/A</p></td><td><p>N/A</p></td></tr>
</table><p>You can divide each major category to further define the QoS policy.
Subsequent sections explain how to obtain information for the categories that
are shown in the template.</p>
<A NAME="euiht"></A><h3>QoS Policy Planning (Task Map)</h3>
<p><A NAME="indexterm-3069"></A><A NAME="indexterm-3070"></A>This task map lists the major tasks for planning a QoS policy.</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Task</p></th><th scope="col"><p>Description</p></th><th scope="col"><p>For Instructions</p></th></tr>
<tr><td><p>1. Design your network topology to support IPQoS.</p></td><td><p>Identify the hosts and routers on your network to provide differentiated
services.</p></td><td><p><A HREF="p174.html#ipqos-config-planning-32">How to Prepare a Network for IPQoS</A>&nbsp;</p></td></tr>
<tr><td><p>2. Define the classes into which services on your network must be divided.</p></td><td><p>Examine the types of services and SLAs that are offered by your site,
and determine the discrete traffic classes into which these services fall.</p></td><td><p><A HREF="p174.html#ipqos-config-planning-14">How to Define the Classes for Your QoS Policy</A>&nbsp;</p></td></tr>
<tr><td><p>3. Define filters for the classes.</p></td><td><p>Determine the best ways of separating traffic of a particular class
from the network traffic flow.</p></td><td><p><A HREF="p175.html#ipqos-config-planning-42">How to Define Filters in the QoS Policy</A>&nbsp;</p></td></tr>
<tr><td><p>4. Define flow-control rates for measuring traffic as packets leave
the IPQoS system.</p></td><td><p>Determine acceptable flow rates for each class of traffic.</p></td><td><p><A HREF="p175.html#ipqos-config-planning-16">How to Plan Flow Control</A>&nbsp;</p></td></tr>
<tr><td><p>5. Define DSCPs or user-priority values to be used in the QoS policy.</p></td><td><p>Plan a scheme to determine the forwarding behavior that is assigned
to a traffic flow when the flow is handled by the router or switch.</p></td><td><p><A HREF="p176.html#ipqos-config-planning-45">How to Plan Forwarding Behavior</A>&nbsp;</p></td></tr>
<tr><td><p>6. If applicable, set up a statistics-monitoring plan for traffic flows
on the network.</p></td><td><p>Evaluate the traffic classes to determine which traffic flows must be
monitored for accounting or statistical purposes.</p></td><td><p><A HREF="p176.html#ipqos-config-planning-18">How to Plan for Flow Accounting</A>&nbsp;</p></td></tr>
</table><p><hr size="1" noshade><p><b>Note - </b><A NAME="indexterm-3071"></A>The rest of this section explains how to plan the QoS policy of
an IPQoS-enabled system. To plan the QoS policy for the Diffserv router, refer
to the router documentation and the router manufacturer's web site. </p>
<hr size="1" noshade></p>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p172.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p174.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

