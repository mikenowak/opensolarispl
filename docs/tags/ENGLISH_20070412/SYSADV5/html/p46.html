<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Initializing an LDAP Client - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p45.html">12.&nbsp;&nbsp;Setting Up LDAP Clients (Tasks)</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p45.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p47.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="clientsetup-49"></a><h3>Initializing an LDAP Client</h3>
<p><tt>ldapclient</tt>(1M) is a utility used to set up LDAP clients in the Solaris
system. <tt>ldapclient</tt> assumes the server has already been
configured with the appropriate client profiles. You must install and configure
the server with the appropriate profiles before you can set up clients.</p>
<hr>
<p><b>Note - </b>The Solaris operating system does not support a configuration
in which a NIS client and a Native LDAP client co-exist on the same client
machine.</p>
<hr>
<p>There are two main ways to set up a client by using <tt>ldapclient</tt>.</p>
<ul><li><p><b>Profile</b></p>
<p>At a minimum, you
need to specify the server address containing the profile and domain you want
to use. If no profile is specified, then the &ldquo;default&rdquo; profile
is assumed. The server will provide the rest of the required information,
except for proxy and certificate database information. If a client's credential
level is <tt>proxy</tt> or <tt>proxy anonymous</tt>, you
must supply the proxy bind DN and password. See <a href="p36.html#ldapsecure-74">Assigning Client Credential Levels</a> for more information.</p>
</li>
<li><p><b>Manual</b></p>
<p>You configure the
profile on the client itself, which means defining all parameters from the
command line. Thus, the profile information is stored in cache files and is
never refreshed by the server.</p>
</li>
</ul>
<hr>
<p><b>Note - </b>Though you can manually configure clients, it is not recommended.
Using the configuration profiles decreases the complexity and cost of managing
clients.</p>
<hr>
<a name="clientsetup-50"></a><h4>Using Profiles to Initialize a Client</h4>
<a name="clientsetup-proc-52"></a><h4><img src="graphics/procedure.gif"> How to Initialize a Client Using Profiles</h4>
<ol><li><a name="clientsetup-step-79"></a><b>Become superuser or assume an equivalent
role.</b><p>Roles contain authorizations and privileged commands. For
more information about roles, see Chapter 8, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i>.</p></li><li><a name="clientsetup-step-53"></a><b>Run <tt>ldapclient</tt> with <tt>init</tt>.</b><pre># <tt><b>ldapclient init \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>profileName=new \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>domainName=west.example.com 192.168.0.1</b></tt>
System successfully configured</pre></li></ol><a name="gdzpf"></a><h4>Using Per-User Credentials</h4>
<hr>
<p><b>Note - </b>Do not edit
either of the client configuration files directly. Use <tt>ldapclient</tt> to
create or modify the content of these files.</p>
<hr>
<a name="gdzpl"></a><h4><img src="graphics/procedure.gif"> How to Initialize
a Client Using Per-User Credentials</h4>
<h6>Before You Begin</h6><p>Before you set up a client with per-user credentials the following items
must already be configured:</p>
<ul><li><p>One or more Kerberos KDC servers must be configured and running.</p>
</li>
<li><p>DNS, client access to a DNS server, and at least one DNS server,
must be configured and running.</p>
</li>
<li><p>Kerberos on the client machine must be configured and enabled.</p>
</li>
<li><p>A Kerberos client installation profile must exist. Such a
profile might be:</p>
<pre># cat /usr/tmp/krb5.profile
REALM SPARKS.COM
KDC kdc.example.com
ADMIN super/admin
FILEPATH /usr/tmp/krb5.conf
NFS 1
DNSLOOKUP none</pre></li>
<li><p>The LDAP server must be installed and configured to support
the <tt>sasl/GSSAPI</tt>.  </p>
</li>
<li><p>Appropriate identity mapping configurations must exist.</p>
</li>
<li><p>Kerberos host principals for the directory server and the
KDC must be set up in the KDC.</p>
</li>
<li><p><tt>idsconfig</tt> must have been run on the directory
server DIT to be used.</p>
</li>
<li><p>An appropriate per-user profile gssapi profile (such as <tt>gssapi_EXAMPLE.COM</tt>) must have been created.</p>
<p>An illustration
of a per-user profile in idsconfig is shown in the following partial example:</p>
<pre># /usr/lib/ldap/idsconfig
Do you wish to continue with server setup (y/n/h)? [n] y
Enter the iPlanet Directory Server's (iDS) hostname to setup: kdc.example.com
Enter the port number for iDS (h=help): [389] &lt;Enter your port>
Enter the directory manager DN: [cn=Directory Manager] &lt;Enter your DN>
Enter passwd for cn=Directory Manager : &lt;Enter your password>
Enter the domainname to be served (h=help): [example.com] &lt;Enter your domain>
Enter LDAP Base DN (h=help): [dc=example,dc=com] &lt;Enter your DN>
GSSAPI is supported. Do you want to set up gssapi:(y/n) [n] y
Enter Kerberos Realm: [EXAMPLE.COM] EXAMPLE.COM
You can create a sasl/GSSAPI enabled profile with default values now.
Do you want to create a sasl/GSSAPI default profile ? [n] y
Enter. the profile name (h=help): [gssapi_EXAMPLE.COM] &lt;Enter>
GSSAPI setup is done. ...</pre></li>
<li><p>The necessary user principals must exist in the Key Distribution
Center (KDC).</p>
</li>
<li><p>On the client machine, Kerberos must be initialized using
the client profile with a command such as:</p>
<p><tt><b># /usr/sbin/kclient
-p /usr/tmp/krb5.profile</b></tt></p>
</li>
<li><p><tt>/etc/nsswitch.ldap</tt> must be configured to
use dns for hosts and ipnodes like this:</p>
<p>host: files dns</p>
<p>ipnodes: files dns</p>
<p>(Modify this file with an editor as necessary)</p>
</li>
<li><p><tt>/etc/resolv.conf</tt> must be configured and
the dns service must be running 	(See the DNS chapters in this document
for details)</p>
</li>
<li><p>The directory server DIT must be pre-loaded with (at a minimum)
the users of this client machine, the client host and necessary auto_home
LDAP entries. See other sections of this manual for details on how to add
entries using <tt>ldapaddent</tt>.</p>
</li>
</ul>
<ol><li><b>Run<tt><b> ldapclient init</b></tt> to initialize the client
using the gssapi profile</b><p><tt><b># /usr/sbin/ldapclient init
-a profilename=gssapi_SPARKS.COM -a \</b></tt></p><p><tt><b>domainname=example.com
9.9.9.50</b></tt></p></li><li><b>Try to log in as a user:</b><p>Run <tt><b>kinit -p user</b></tt>.</p><p>Run <tt><b> ldaplist -l passwd</b></tt> user in user's
login session and you should see "userpassword." </p><p>But <tt><b>ldaplist
-l passwd bar</b></tt> can get the entry without <tt><b>userpassword</b></tt>.
By default root can still see <tt>userpassword</tt> of everybody.</p></li></ol><h6><h6>More Information</h6>Notes About Using Per-User Credentials<ul><li><p>If the syslog has messages: <tt>libsldap: Status: 7 Mesg:
openConnection: GSSAPI bind failed - 82 Local error</tt>, it is likely
that Kerberos is not initialized or its ticket is expired. Run <tt><b>klist</b></tt> to
browse it. Run <tt><b>kinit -p foo </b></tt>or <tt><b>kinit -R
-p foo</b></tt> and try again.</p>
</li>
<li><p>If you want to, you can add <tt><b>pam_krb5.so.1</b></tt> to <tt>/etc/pam.conf</tt> so it will automatically <tt>kinit </tt>when
you log in.</p>
</li>
<li><p>For example:</p>
<p><tt><b>login   auth optional
          pam_krb5.so.1 </b></tt></p>
<p><tt><b>rlogin  auth optional
          pam_krb5.so.1</b></tt> </p>
<p><tt><b>other   auth optional
          pam_krb5.so.1</b></tt></p>
</li>
<li><p>If a user is <tt>kinited</tt> and the syslog message
indicates <tt>Invalid credential</tt>, then the problem could be
the host entry (root) or user entry is not in LDAP directory or mapping rules
are not correct.</p>
</li>
<li><p>When <tt>ldapclient init</tt> is executed, it makes
some checks if the LDAP profile contains self/ sasl/GSSAPI configuration.
If it fails at <tt>/etc/nsswitch.ldap</tt> check, then the usual
reason is that dns was not added to <tt>host:</tt> and <tt>ipnodes:</tt>.</p>
</li>
<li><p>If it fails because the DNS client not enabled, run <tt><b>svcs
-l dns/client</b></tt> to see if <tt>/etc/resolv.conf</tt> is
missing or it is just disabled. Run <tt><b>svcadm enable dns/client</b></tt> to
enable it.</p>
</li>
<li><p>If the check fails because of sasl/GSSAPI bind, check syslog
to find out what went wrong.</p>
</li>
</ul>
<p>See other references in this guide and in the <i>System Administration Guide: Security Services</i> for
details.</p>
</h6>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p45.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p47.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

