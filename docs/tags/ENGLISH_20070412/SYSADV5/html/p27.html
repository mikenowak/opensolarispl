<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Changing a Machine's NIS Domain - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p21.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p26.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p28.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="anis2-16615"></a><h3>Changing a Machine's NIS Domain</h3>
<a name="indexterm-409"></a><a name="indexterm-410"></a><a name="indexterm-411"></a><p>To change the NIS domain name of a machine, do the following.</p>
<a name="anis2-proc-62"></a><h4><img src="graphics/procedure.gif"> How to Change a Machine's NIS Domain Name</h4>
<ol><li><a name="anis2-step-10"></a><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Chapter 8, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i>.</p></li><li><a name="anis2-step-63"></a><b>Edit the machine's <tt>/etc/defaultdomain</tt> file,
exchanging its present contents with the new domain name for the machine.</b><p>For example, if the current domain name is <tt>sales.doc.com</tt>,
you might change it to <tt>research.doc.com</tt>.</p></li><li><a name="anis2-step-64"></a><b>Run <tt>domainname</tt> `<tt>cat
/etc/defaultdomain</tt>'</b></li><li><a name="anis2-step-65"></a><b>Set the machine up as an NIS client, slave,
or master server.</b><p>See for <a href="p16.html">Chapter&nbsp;5, Setting Up and Configuring NIS Service</a> for details.</p></li></ol><a name="anis2-21536"></a><h3>Using NIS in Conjunction With DNS</h3>
<a name="indexterm-412"></a><a name="indexterm-413"></a><p>Typically, NIS clients are configured with the <tt>nsswitch.conf</tt> file
to use only NIS for machine name and address lookups. If this type of lookup
fails, an NIS server can forward these lookups to DNS.</p>
<a name="anis2-proc-1"></a><h4><img src="graphics/procedure.gif"> How to Configure Machine Name and Address Lookup
Through NIS and DNS</h4>
<ol><li><a name="anis2-step-11"></a><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Chapter 8, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i>.</p></li><li><a name="anis2-step-8"></a><b>The two map files, <tt>hosts.byname</tt> and <tt>hosts.byaddr</tt> must include the <tt>YP_INTERDOMAIN</tt> key.
To test this key, edit the <tt>Makefile</tt> and modify the following
lines.</b><pre>#B=<tt>-b</tt>
B=</pre><p>to</p><pre>B=<tt>-b</tt>
#B=</pre><p><tt>makedbm</tt> will now start with the <tt>-b</tt> flag
when it makes the maps, and the <tt>YP_INTERDOMAIN</tt> key will
be inserted into the <tt>ndbm</tt> files.</p></li><li><a name="anis2-step-2"></a><b>Run the <tt>make</tt> command to rebuild
maps.</b><pre># <tt><b>/usr/ccs/bin/make hosts</b></tt></pre></li><li><a name="anis2-step-3"></a><b>Check that all the NIS server's <tt>/etc/resolv.conf</tt> files point to valid nameservers.</b><hr>
<p><b>Note - </b>If you have NIS servers that are not running Solaris, Release
2, make sure <tt>YP_INTERDOMAIN</tt> exists in the hosts maps.</p>
<hr>
</li><li><a name="anis2-step-44"></a><b>To enable DNS forwarding, restart each server.</b><pre># <tt><b>svcadm restart network/nis/server:</tt><i>&lt;instance></i><tt></b></tt></pre><p>In this implementation of NIS, <tt>ypserv</tt> automatically
starts with the <tt>-d</tt> option to forward requests to DNS.</p></li></ol><a name="anis2-6"></a><h4>Dealing with Mixed NIS Domains</h4>
<p>If the master and slave servers are not both running Solaris 2, refer
to the following table for how to avoid potential problems. The notation &ldquo;4.0.3+&rdquo;
refers to that and later releases of SunOS. <tt>makedm</tt> <tt>-b</tt> is
a reference to the &ldquo;B&rdquo; variable in the <tt>Makefile</tt>.</p>
<a name="anis2-tbl-7"></a>Table 6-1 NIS/DNS in Heterogeneous NIS
Domains<table><tr><th rowspan="2" align="center"><p>Slave</p>
</th><th colspan="3" align="center"><p>Master</p>
</th></tr>
<tr><th align="center"><p>4.0.3+</p>
</th><th colspan="2" align="center"><p>Solaris NIS</p>
</th></tr>
<tr><td><p><b>4.0.3+</b></p>
</td><td><p>Master: <tt>makedbm <tt>-b</tt></tt></p>
<p>Slave: <tt>ypxfr</tt></p>
</td><td><p>Master: <tt>makedbm <tt>-b</tt></tt></p>
<p>Slave: <tt>ypxfr <tt>-b</tt></tt></p>
</td><td><p>Master: <tt>ypserv <tt>-d</tt></tt></p>
<p>Slave: <tt>ypxfr <tt>-b</tt></tt></p>
</td></tr>
<tr><td><p><b>Solaris NIS</b></p>
</td><td><p>Master: <tt>makedbm <tt>-b</tt></tt></p>
<p>Slave: <tt>ypxfr</tt></p>
</td><td><p>Master: <tt>makedbm <tt>-b</tt></tt></p>
<p>Slave: <tt>ypxfr</tt></p>
</td><td><p>Master: <tt>ypserv <tt>-d</tt></tt></p>
<p>Slave:<tt>ypxfr</tt> with <tt>resolv.conf</tt> or <tt>ypxfr <tt>-b</tt></tt></p>
</td></tr>
</table>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p26.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p28.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

