<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Populating the Directory Server Using <tt>ldapaddent</tt> - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p41.html">11.&nbsp;&nbsp;Setting Up Sun Java System Directory Server With LDAP Clients (Tasks)</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p42.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p44.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="sundssetup-70"></a><h3>Populating the Directory Server Using <tt>ldapaddent</tt></h3>
<a name="indexterm-496"></a><hr>
<p><b>Note - </b><a name="indexterm-497"></a>Before populating the directory server with data, you must configure
the server to store passwords in UNIX <tt>Crypt</tt> format if you
are using <tt>pam_unix</tt>. If you are using <tt>pam_ldap</tt>,
you can store passwords in any format. For more information about setting
the password in UNIX <tt>crypt</tt> format, see the Sun Java System Directory Server documents.</p>
<hr>
<p><tt>ldapaddent</tt> reads from the standard input (that being
an <tt>/etc/filename</tt> like <tt>passwd</tt>) and
places this data to the container associated with the service. Client configuration
determines how the data will be written by default.</p>
<hr>
<p><b>Note - </b><tt>ldapaddent</tt>(1M) can only run on an LDAP client. <a href="p45.html">Chapter&nbsp;12, Setting Up LDAP Clients (Tasks)</a> describes
how to configure a client for the LDAP naming service.</p>
<hr>
<a name="sundssetup-proc-37"></a><h4><img src="graphics/procedure.gif"> How to Populate Sun Java System Directory Server With User
Password Data Using <tt>ldapaddent</tt></h4>
<p>See <tt>ldapaddent</tt>(1M). See <a href="p34.html">Chapter&nbsp;9, LDAP Basic Components and Concepts (Overview)</a> for information about
LDAP security and write-access to the directory server.</p>
<ol><li><b>Use the <tt>ldapaddent</tt> command to add <tt>/etc/passwd</tt> entries to the server.</b><pre># <tt><b>ldapaddent</b></tt> <tt>-D</tt> <tt><b>"cn=directory manager"</b></tt> <tt>-f</tt> <tt><b>/etc/passwd passwd</b></tt></pre></li></ol><a name="sundssetup-27"></a><h3>Managing Printer Entries</h3>
<a name="sundssetup-30"></a><h4>Adding Printers</h4>
<p>To add printer entries to the LDAP directory, use either the <tt>printmgr</tt> configuration tool or the <tt>lpset <tt>-n</tt> ldap</tt> command-line
utility. See <tt>lpset</tt>(1M).
Note that the printer objects added to the directory only define the connection
parameter, required by print system clients, of printers. Local print server
configuration data is still held in files. A typical printer entry would look
like the following:</p>
<pre>printer-uri=myprinter,ou=printers,dc=mkg,dc=example,dc=com
objectclass=top
objectclass=printerService
objectclass=printerAbstract
objectclass=sunPrinter
printer-name=myprinter
sun-printer-bsdaddr=printsvr.example.com,myprinter,Solaris
sun-printer-kvp=description=HP LaserJet (PS)
printer-uri=myprinter</pre><a name="sundssetup-29"></a><h4>Using <tt>lpget</tt></h4>
<p><tt>lpget</tt>(1M) can
be used to list all printer entries known by the LDAP client's LDAP directory.
If the LDAP client's LDAP server is a replica server, then printers listed
might not be the same as that in the master LDAP server depending on the update
replication agreement. See <tt>lpget</tt>(1M) for
more information.</p>
<p>For example, to list all printers for a given base DN, type the following:</p>
<pre># <tt><b>lpget</b></tt> <tt>-n</tt> <tt><b>ldap list</b></tt>
myprinter:
	dn=myprinter,ou=printers,dc=mkt,dc=example,dc=com
	bsdaddr=printsvr.example.com,myprinter,Solaris
	description=HP LaserJet (PS)</pre><a name="sundssetup-26"></a><h3>Populating the Directory Server With Additional
Profiles</h3>
<p>Use <tt>ldapclient</tt> with the <tt>genprofile</tt> option
to create an LDIF representation of a configuration profile, based on the
attributes specified. The profile you create can then be loaded into an LDAP
server to be used as the client profile. The client profile can be downloaded
by the client by using <tt>ldapclient init</tt>.</p>
<p>Refer to <tt>ldapclient</tt>(1M) for information about using <tt>ldapclient genprofile</tt>.</p>
<a name="sundssetup-proc-34"></a><h4><img src="graphics/procedure.gif"> How to Populate the Directory Server
With Additional Profiles Using <tt>ldapclient</tt></h4>
<ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles
contain authorizations and privileged commands. For more information about
roles, see Chapter 8, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i>.</p></li><li><a name="sundssetup-step-35"></a><b>Use <tt>ldapclient</tt> with
the <tt>genprofile</tt> command.</b><pre># <tt><b>ldapclient genprofile \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>profileName=myprofile \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>defaultSearchBase=dc=west,dc=example,dc=com \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>"defaultServerList=192.168.0.1 192.168.0.2:386" \</b></tt></pre><p><tt><b>> myprofile.ldif</b></tt></p></li><li><a name="sundssetup-step-36"></a><b>Upload the new profile to the server.</b><pre># <tt><b>ldapadd</b></tt> <tt>-h</tt> <tt><b>192.168.0.1</b></tt> <tt>-D</tt> <tt><b>&ldquo;cn=directory manager&rdquo;</b></tt> <tt>-f</tt> <tt><b>myprofile.ldif</b></tt></pre></li></ol><a name="sundssetup-31"></a><h3>Configuring the Directory Server to Enable
Account Management</h3>
<p>In order for <tt>pam_ldap</tt> to work properly, the password
and account lockout policy must be properly configured on the server. You
can use the Directory Server Console or <tt>ldapmodify</tt> to configure
the account management policy for the LDAP directory. For procedures and more
information, see the &ldquo;User Account Management&rdquo; chapter in the <i>Administration Guide</i> for the version of Sun Java System Directory Server that you are
using.</p>
<hr>
<p><b>Note - </b>After you enable <tt>pam_ldap</tt> account management,
all users must provide a password any time they log in to the system. A login
password is required for authentication. Therefore, nonpassword-based logins
using tools such as <tt>rsh</tt>, <tt>rlogin</tt>, or <tt>ssh</tt> will fail.</p>
<hr>
<p>Passwords for <tt>proxy</tt> users should <b>never</b> be
allowed to expire.  If proxy passwords expire, clients using the <tt>proxy</tt> credential
level  cannot retrieve naming service information from the server. To ensure
that proxy users have passwords that do not expire, modify the proxy accounts
with the following script.</p>
<pre># <tt><b>ldapmodify</b></tt> <tt>-h</tt> <tt><b></tt><i>ldapserver</i><tt></b></tt> <tt>-D</tt> <tt><b></tt><i>administrator DN</i><tt> \</b></tt>
<tt><b></b></tt><tt>-w</tt> <tt><b></tt><i>administrator password</i><tt> &lt;&lt;EOF</b></tt>
<tt><b>dn: </tt><i>proxy user DN</i><tt></b></tt>
<tt><b>DNchangetype: modify</b></tt>
<tt><b>replace: passwordexpirationtime</b></tt>
<tt><b>passwordexpirationtime: 20380119031407Z</b></tt>
<tt><b>EOF</b></tt></pre><hr>
<p><b>Note - </b><tt>pam_ldap</tt> account management relies on Sun Java System Directory Server to
maintain and provide password aging and account expiration information for
users. The directory server does not interpret the corresponding data from
shadow entries to validate user accounts. <tt>pam_unix</tt>, however,
examines the shadow data to determine if accounts are locked or if passwords
are aged. Since the shadow data is not kept up to date by the LDAP naming
services or the directory server, <tt>pam_unix</tt> should not grant
access based on the shadow data. The shadow data is retrieved using the <tt>proxy</tt> identity.  Therefore, do not allow <tt>proxy</tt> users
to have read access to the <tt>userPassword</tt> attribute. Denying <tt>proxy</tt> users read access to <tt>userPassword</tt> prevents <tt>pam_unix</tt> from making an invalid account validation.</p>
<hr>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p42.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p44.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

