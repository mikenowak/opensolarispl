<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML//EN" "docbook.dtd"[
	<!ENTITY % xinclude SYSTEM "xinclude.mod">
	%xinclude;
]>

<chapter xmlns="http://docbook.org/ns/docbook" version="5.0" xml:id="rbactask-1">



<title>Using Role-Based Access Control (Tasks)</title>
<toc>
<para>This chapter covers tasks for distributing the capabilities of superuser
by using discrete roles. The mechanisms that roles can use include rights
profiles, authorizations, and privileges. The following is a list of the task
maps in this chapter.</para>
<itemizedlist>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-14">Using RBAC (Task Map)</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-15">Configuring RBAC (Task Map)</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-40">Using Roles (Task Map)</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-10">Managing RBAC (Task Map)</olink>
</para>
</listitem>
</itemizedlist>
<para>
<indexterm xml:id="indexterm-1110">
<primary>right</primary>
<see>
rights profiles</see>
</indexterm>For an overview of RBAC, see <olink remap="external" targetdoc="chapter-7.xml" targetptr="rbac-1">Role-Based Access Control (Overview)</olink>. For reference
information, see <olink remap="external" targetdoc="chapter-9.xml" targetptr="rbacref-1">Chapter 9, Role-Based Access
Control (Reference)</olink>. To use privileges with RBAC or without RBAC,
see <olink remap="external" targetdoc="chapter-10.xml" targetptr="privtask-1">Chapter 10, Privileges (Tasks)</olink>.</para>
</toc>
<sect1 xml:id="rbactask-14">
<title>Using RBAC (Task Map)</title>
<indexterm xml:id="indexterm-1111">
<primary>task maps</primary>
<secondary>using RBAC</secondary>
</indexterm>
<indexterm xml:id="indexterm-1112">
<primary>using</primary>
<secondary>RBAC task map</secondary>
</indexterm>
<para>To use RBAC requires planning, configuring RBAC, and knowing how to
assume a role. Once roles become familiar, you might further customize RBAC
to handle new operations. The following task map points to these major tasks.</para>
<informaltable frame="all" pgwide="1">
<tgroup cols="3" colsep="1" rowsep="1">
<colspec colname="colspec6" colwidth="25.13*"/>
<colspec colname="colspec7" colwidth="36.35*"/>
<colspec colname="colspec8" colwidth="37.52*"/>
<thead>
<row>
<entry>
<para>Task</para>
</entry>
<entry>
<para>Description</para>
</entry>
<entry>
<para>For Instructions</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>Plan and configure RBAC </para>
</entry>
<entry>
<para>Configure RBAC at your site.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-15">Configuring RBAC (Task Map)</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Use roles</para>
</entry>
<entry>
<para>Assume roles from the command line and in the Solaris Management Console
GUI.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-40">Using Roles (Task Map)</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Customize RBAC</para>
</entry>
<entry>
<para>Customize RBAC for your site.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-10">Managing RBAC (Task Map)</olink>
</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1>
<sect1 xml:id="rbactask-15">
<title>Configuring RBAC (Task Map)</title>
<indexterm xml:id="indexterm-1113">
<primary>task maps</primary>
<secondary>configuring RBAC</secondary>
</indexterm>
<indexterm xml:id="indexterm-1114">
<primary>configuring</primary>
<secondary>RBAC task map</secondary>
</indexterm>
<para>To use RBAC effectively requires planning. Use the following task map
to plan and initially implement RBAC at your site.</para>
<informaltable frame="all" pgwide="1">
<tgroup cols="3" colsep="1" rowsep="1">
<colspec colname="colspec6" colwidth="25.13*"/>
<colspec colname="colspec7" colwidth="36.35*"/>
<colspec colname="colspec8" colwidth="37.52*"/>
<thead>
<row>
<entry>
<para>Task</para>
</entry>
<entry>
<para>Description</para>
</entry>
<entry>
<para>For Instructions</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>1. Plan for RBAC </para>
</entry>
<entry>
<para>Involves examining your site's security needs, and deciding how to use
RBAC at your site.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-16">How to Plan Your RBAC Implementation</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>2. Learn to use the Solaris Management Console</para>
</entry>
<entry>
<para>Involves becoming familiar with the Solaris Management Console.</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2379" targetptr="smcover-1">Chapter 2, <citetitle remap="chapter">Working With the Solaris Management Console (Tasks),</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>3. Configure the first user and role</para>
</entry>
<entry>
<para>Uses the RBAC configuration tools in the Solaris Management Console
to create a user and a role, and to assign the role to the user.</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2379" targetptr="smcover-95">
<citetitle remap="section">Using the Solaris Management Tools With RBAC (Task Map)</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>4. (Optional) Create other users who can assume roles</para>
</entry>
<entry>
<para>Ensures that users who can assume an administrative role exist.</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2379" targetptr="smcover-95">
<citetitle remap="section">Using the Solaris Management Tools With RBAC (Task Map)</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>
</para>
</entry>
</row>
<row>
<entry morerows="3">
<para>5. (Recommended) Create other roles and assign them to users</para>
</entry>
<entry morerows="1">
<para>Uses the RBAC tools to create roles for particular administrative areas,
and to assign the roles to users.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-32">How to Create and Assign a Role By Using
the GUI</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-18">Example 8–5</olink>
</para>
</entry>
</row>
<row>
<entry morerows="1">
<para>Uses the command line to create roles, and to assign the roles to users</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-22">How to Create a Role From the Command
Line</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-44">How to Assign a Role to a Local User</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>6. (Recommended) Audit role actions</para>
</entry>
<entry>
<para>Preselect an audit class that includes the audit event that records
role actions.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-34">How to Audit Roles</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>7. (Optional) Make <literal>root</literal> user a role </para>
</entry>
<entry>
<para>Prevents anonymous <literal>root</literal> login, which is a security
hole.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-20">How to Make root User Into a Role</olink>
</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1>
<sect1 xml:id="rbactask-30">
<title>Configuring RBAC</title>
<indexterm xml:id="indexterm-1115">
<primary>RBAC</primary>
<secondary>configuring</secondary>
</indexterm>
<indexterm xml:id="indexterm-1116">
<primary>configuring</primary>
<secondary>RBAC</secondary>
</indexterm>
<para>RBAC can be configured with the following utilities:</para>
<itemizedlist>
<listitem>
<para>
<emphasis role="strong">Solaris Management Console GUI –</emphasis> The
preferred method for performing RBAC-related tasks is through the GUI. The
console tools for managing the RBAC elements are contained in the Users Tool
collection.</para>
</listitem>
<listitem>
<para>
<emphasis role="strong">Solaris Management Console commands –</emphasis> With the Solaris Management Console command-line interfaces, such
as <command>smrole</command>, you can operate on any name service. The Solaris
Management Console commands require authentication to connect to the server.
As a result, these commands are not practical for use in scripts.</para>
</listitem>
<listitem>
<para>
<emphasis role="strong">Local commands –</emphasis> With
the <literal>user</literal>* and <literal>role</literal>* set of command-line
interfaces, such as <command>useradd</command>, you can operate on local files
only. The commands that operate on local files must be run by superuser or
by a role with the appropriate privileges.</para>
</listitem>
</itemizedlist>
<sect2>
<title/>
<task id="rbactask-16">

<title>How to Plan Your RBAC Implementation</title>
<indexterm xml:id="indexterm-1117">
<primary>RBAC</primary>
<secondary>planning</secondary>
</indexterm>
<indexterm xml:id="indexterm-1118">
<primary>planning</primary>
<secondary>RBAC</secondary>
</indexterm>
<indexterm xml:id="indexterm-1119">
<primary>configuring</primary>
<secondary>RBAC</secondary>
</indexterm>
<indexterm xml:id="indexterm-1120">
<primary>administering</primary>
<secondary>roles to replace superuser</secondary>
</indexterm>
<indexterm xml:id="indexterm-1121">
<primary>replacing</primary>
<secondary>superuser with roles</secondary>
</indexterm>
<tasksummary>
<para>RBAC can be an integral part of how an organization manages its information
resources. Planning requires a thorough knowledge of the RBAC capabilities
as well as the security requirements of your organization.</para>
</tasksummary>
<procedure>
<step>
<para>Learn the basic RBAC concepts.</para>
<para>Read <olink remap="external" targetdoc="chapter-7.xml" targetptr="rbac-1">Role-Based Access Control (Overview)</olink>. Using RBAC
to administer a system is very different from using conventional UNIX administrative
practices. You should be familiar with the RBAC concepts before you start
your implementation. For greater detail, see <olink remap="external" targetdoc="chapter-9.xml" targetptr="rbacref-1">Chapter 9,
Role-Based Access Control (Reference)</olink>.</para>
</step>
<step>
<para>Examine your security policy.</para>
<para>Your organization's
security policy should detail the potential threats to your system, measure
the risk of each threat, and have a strategy to counter these threats. Isolating
the security-relevant tasks through RBAC can be a part of the strategy. Although
you can install the recommended roles and their configurations as is, you
might need to customize your RBAC configuration to adhere to your security
policy.</para>
</step>
<step>
<para>Decide how much RBAC your organization needs.</para>
<para>Depending
on your security needs, you can use varying degrees of RBAC, as follows:</para>
<itemizedlist>
<listitem>
<para>
<emphasis role="strong">No RBAC –</emphasis> You can
perform all tasks as <literal>root</literal> user. In this configuration,
you log in as yourself. Then, you type <literal>root</literal> as the user
when you select a Solaris Management Console tool.</para>
</listitem>
<listitem>
<para>
<emphasis role="strong">Single Role Only –</emphasis> This
method adds one role. The one role is assigned the Primary Administrator rights
profile. This method is similar to the superuser model, in that the role has
superuser capabilities. However, this method enables you to track the user
who has assumed the role.</para>
</listitem>
<listitem>
<para>
<emphasis role="strong">Recommended Roles –</emphasis> This
method creates three roles that are based on the following rights profiles:
Primary Administrator, System Administrator, and Operator. The roles are suitable
for organizations with administrators at different levels of responsibility.</para>
</listitem>
<listitem>
<para>
<emphasis role="strong">Custom Roles –</emphasis> You
can create your own roles to meet the security requirements of your organization.
The new roles can be based on existing or customized rights profiles.</para>
</listitem>
<listitem>
<para>
<emphasis role="strong">Root User as a Role –</emphasis> This
method  prevents any user from logging in as <literal>root</literal>. Instead,
users must log in as ordinary users prior to assuming the <literal>root</literal> role.
For details, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-20">How to Make root User Into
a Role</olink>.</para>
</listitem>
</itemizedlist>
</step>
<step>
<para>Decide which recommended roles are appropriate for your organization.</para>
<para>Review the capabilities of the recommended roles and default
rights profiles. Default rights profiles enable administrators to configure
a recommended role by using a single profile. Three default rights profiles
are available for configuring the recommended roles:</para>
<itemizedlist>
<listitem>
<para>
<emphasis role="strong">Primary Administrator rights profile –</emphasis> For configuring a role that can perform all administrative tasks,
can grant rights to others, and can edit rights that are associated with administrative
roles. A user in this role can assign this role to other users, and can grant
rights to other users.</para>
</listitem>
<listitem>
<para>
<emphasis role="strong">System Administrator rights profile –</emphasis> For configuring a role that can perform most administrative tasks
that are not related to security. For example, the System Administrator can
add new user accounts, but cannot set passwords or grant rights to other users.</para>
</listitem>
<listitem>
<para>
<emphasis role="strong">Operator rights profile –</emphasis> For
configuring a role that can perform simple administrative tasks, such as media
backup and printer maintenance.</para>
</listitem>
</itemizedlist>
<para>To further examine rights profiles, read one of the following:</para>
<itemizedlist>
<listitem>
<para>In the <filename class="directory">/etc/security</filename> directory,
read the contents of the <filename>prof_attr</filename> database and the <filename>exec_attr</filename> database.</para>
</listitem>
<listitem>
<para>In the Solaris Management Console, use the Rights tool to
display the contents of a rights profile.</para>
</listitem>
<listitem>
<para>In this book, refer to <olink remap="external" targetdoc="chapter-9.xml" targetptr="rbacref-26">Contents
of Rights Profiles</olink> for summaries of some typical rights profiles.</para>
</listitem>
</itemizedlist>
</step>
<step>
<para>Decide if any additional roles or rights profiles are appropriate
for your organization.</para>
<para>Look for other applications or families
of applications at your site that might benefit from restricted access. Applications
that affect security, that can cause denial-of-service problems, or that require
special administrator training are good candidates for RBAC. You can customize
roles and rights profiles to handle the security requirements of your organization.</para>
<substeps>
<step>
<para>Determine which commands are needed for the new task.</para>
</step>
<step>
<para>Decide which rights profile is appropriate for this task.</para>
<para>Check if an existing rights profile can handle this task or if a separate
rights profile needs to be created.</para>
</step>
<step>
<para>Determine which role is appropriate for this rights profile.</para>
<para>Decide if the rights profile for this task should be assigned to an
existing role or if a new role should be created. If you use an existing role,
check that the other rights profiles are appropriate for users who are assigned
to this role.</para>
</step>
</substeps>
</step>
<step>
<para>Decide which users should be assigned to the available roles.</para>
<para>According to the principle of least privilege, you should assign users
to roles that are appropriate to their level of trust. When you prevent users
from access to tasks that the users do not need to perform, you reduce potential
problems.</para>
</step>
</procedure>
</task>
</sect2>
<sect2>
<title/>
<task id="rbactask-32">

<title>How to Create and Assign a Role By Using the
GUI</title>
<indexterm xml:id="indexterm-1122">
<primary>rights profiles</primary>
<secondary>creating roles for</secondary>
</indexterm>
<indexterm xml:id="indexterm-1123">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>for particular profiles</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1124">
<primary>administering</primary>
<secondary>roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1125">
<primary>RBAC</primary>
<secondary>adding roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1126">
<primary>roles</primary>
<secondary>adding for particular profiles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1127">
<primary>configuring</primary>
<secondary>roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1128">
<primary>creating</primary>
<secondary>roles</secondary>
<tertiary>for particular profiles</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1129">
<primary>adding</primary>
<secondary>roles</secondary>
<tertiary>for particular profiles</tertiary>
</indexterm>
<tasksummary>
<para>To create a new role, you can be superuser, or you can use the Primary
Administrator role. In this procedure, the creator of the new role has assumed
the role of Primary Administrator.</para>
</tasksummary>
<taskprerequisites>

<itemizedlist>
<listitem>
<para>You have already created users who can assume a role at your
site. If the users are not yet created, create them by following the instructions
in <olink remap="external" targetdoc="819-2379" targetptr="usersetup-21">
<citetitle remap="section">How to Add a User With the Solaris Management Console’s Users Tool</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>
<olink remap="external" targetdoc="819-2379" targetptr="smcover-95">
<citetitle remap="section">Using the Solaris Management Tools With RBAC (Task Map)</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>.</para>
</listitem>
<listitem>
<para>You have been assigned the Primary Administrator role by following
the procedures in <olink remap="external" targetdoc="819-2379" targetptr="smcover-95">
<citetitle remap="section">Using the Solaris Management Tools With RBAC (Task Map)</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>.</para>
</listitem>
</itemizedlist>
</taskprerequisites>
<procedure>
<step>
<para>Start the Solaris Management Console.</para>
<screen># <userinput>/usr/sbin/smc &amp;</userinput>
</screen>
<para>For login instructions, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-21">How to Assume
a Role in the Solaris Management Console</olink>.</para>
</step>
<step>
<para>Click the Administrative Roles icon.</para>
</step>
<step>
<para>Select Add Administrative Role from the Action menu.</para>
</step>
<step>
<para>Create a new role by filling in the fields in the series of dialog
boxes.</para>
<para>For possible roles, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-35">Example
8–1</olink> to <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-41">Example 8–4</olink>.</para>
<tip>

<para>All tools in the Solaris Management Console display information
in the bottom section of the page or at the left side of a wizard panel. Choose
Help at any time to find additional information about performing tasks in
this interface.</para>
</tip>
</step>
<step>
<para>
<indexterm xml:id="indexterm-1130">
<primary>assigning</primary>
<secondary>role to a user</secondary>
</indexterm>Assign the role to a user.</para>
<tip>

<para>After filling in the properties of the role, the last dialog box
prompts you for a user for the role.</para>
</tip>
</step>
<step>
<para>
<indexterm xml:id="indexterm-1131">
<primary>daemons</primary>
<secondary>
<command>nscd</command> (name service cache daemon)</secondary>
</indexterm>
<indexterm xml:id="indexterm-1132">
<primary>
<command>nscd</command> (name service cache daemon)</primary>
<secondary>starting with <command>svcadm</command> command</secondary>
</indexterm>
<indexterm xml:id="indexterm-1133">
<primary>
<command>svcadm</command> command</primary>
<secondary>restarting name service</secondary>
</indexterm>In a terminal window, restart the name service cache daemon.</para>
<screen># <userinput>svcadm restart system/name-service-cache</userinput>
</screen>
<para>For more information, see the <olink remap="external" targetdoc="819-2240" targetptr="svcadm-1m">
<citerefentry>
<refentrytitle>svcadm</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> and <olink remap="external" targetdoc="819-2240" targetptr="nscd-1m">
<citerefentry>
<refentrytitle>nscd</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man pages.</para>
</step>
</procedure>
<example xml:id="rbactask-35">

<title>Creating a Role for the System Administrator Rights Profile</title>
<indexterm xml:id="indexterm-1134">
<primary>System Administrator (RBAC)</primary>
<secondary>creating role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1135">
<primary>adding</primary>
<secondary>System Administrator role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1136">
<primary>creating</primary>
<secondary>System Administrator role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1137">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>System Administrator role</tertiary>
</indexterm>
<para>In this example, the new role can do system administration tasks that
are not connected to security. The role is created by performing the preceding
procedure with the following parameters:</para>
<itemizedlist>
<listitem>
<para>Role name: <literal>sysadmin</literal>
</para>
</listitem>
<listitem>
<para>Role full name: <literal>System Administrator</literal>
</para>
</listitem>
<listitem>
<para>Role description: <literal>Performs non-security admin tasks</literal>
</para>
</listitem>
<listitem>
<para>Rights profile: <literal>System Administrator</literal>
</para>
<para>This rights profile is at the top of the list of profiles that are included
in the role.</para>
</listitem>
</itemizedlist>
</example>
<example xml:id="rbactask-37">

<title>Creating a Role for the Operator Rights Profile</title>
<indexterm xml:id="indexterm-1138">
<primary>Operator (RBAC)</primary>
<secondary>creating role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1139">
<primary>adding</primary>
<secondary>Operator role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1140">
<primary>creating</primary>
<secondary>Operator role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1141">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>Operator role</tertiary>
</indexterm>
<para>The Operator rights profile can manage printers and back up the system
to offline media. You might want to assign the role to one user on each shift.
To do so, you would select the role mailing list option in the Step 1: Enter
a Role Name dialog box. The role is created by performing the preceding procedure
with the following parameters:</para>
<itemizedlist>
<listitem>
<para>Role name: <literal>operadm</literal>
</para>
</listitem>
<listitem>
<para>Role full name: <literal>Operator</literal>
</para>
</listitem>
<listitem>
<para>Role description: <literal>Backup operator</literal>
</para>
</listitem>
<listitem>
<para>Rights profile: <literal>Operator</literal>
</para>
<para>This
rights profile must be at the top of the list of profiles that are included
in the role.</para>
</listitem>
</itemizedlist>
</example>
<example xml:id="rbactask-39">

<title>Creating a Role for a Security-Related Rights Profile</title>
<indexterm xml:id="indexterm-1142">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>security-related roles</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1143">
<primary>adding</primary>
<secondary>security-related roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1144">
<primary>creating</primary>
<secondary>security-related roles</secondary>
</indexterm>
<para>By default, the only rights profile that contains security-related commands
and rights is the Primary Administrator profile. If you want to create a role
that is not as powerful as Primary Administrator, but can handle some security-related
tasks, you must create the role.</para>
<para>In the following example, the role protects devices. The role is created
by performing the preceding procedure with the following parameters:</para>
<itemizedlist>
<listitem>
<para>
<indexterm xml:id="indexterm-1145">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>Device Security role</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1146">
<primary>Device Security (RBAC)</primary>
<secondary>creating role</secondary>
</indexterm>Role name: <literal>devicesec</literal>
</para>
</listitem>
<listitem>
<para>Role full name: <literal>Device Security</literal>
</para>
</listitem>
<listitem>
<para>Role description: <literal>Configures Devices</literal>
</para>
</listitem>
<listitem>
<para>Rights profile: <literal>Device Security</literal>
</para>
</listitem>
</itemizedlist>
<para>In the following example, the role secures systems and hosts on the
network. The role is created by performing the preceding procedure with the
following parameters:</para>
<itemizedlist>
<listitem>
<para>
<indexterm xml:id="indexterm-1147">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>Network Security role</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1148">
<primary>Network Security (RBAC)</primary>
<secondary>creating role</secondary>
</indexterm>Role name: <literal>netsec</literal>
</para>
</listitem>
<listitem>
<para>Role full name: <literal>Network Security</literal>
</para>
</listitem>
<listitem>
<para>Role description: <literal>Handles IPsec, IKE, and SSH</literal>
</para>
</listitem>
<listitem>
<para>Rights profile: <literal>Network Security</literal>
</para>
</listitem>
</itemizedlist>
</example>
<example xml:id="rbactask-41">

<title>Creating a Role for a Rights Profile With Limited Scope</title>
<indexterm xml:id="indexterm-1149">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>role with limited scope</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1150">
<primary>adding</primary>
<secondary>roles</secondary>
<tertiary>with limited scope</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1151">
<primary>creating</primary>
<secondary>roles</secondary>
<tertiary>with limited scope</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1152">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>DHCP Management role</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1153">
<primary>DHCP Management (RBAC)</primary>
<secondary>creating role</secondary>
</indexterm>
<para>A number of rights profiles are of limited scope. In this example, the
sole task of the role is to manage DHCP. The role is created by performing
the preceding procedure with the following parameters:</para>
<itemizedlist>
<listitem>
<para>Role name: <literal>dhcpmgt</literal>
</para>
</listitem>
<listitem>
<para>Role full name: <literal>DHCP Management</literal>
</para>
</listitem>
<listitem>
<para>Role description: <literal>Manages Dynamic Host Config Protocol</literal>
</para>
</listitem>
<listitem>
<para>Rights profile: <literal>DHCP Management</literal>
</para>
</listitem>
</itemizedlist>
</example>
<example xml:id="rbactask-18">

<title>Modifying a User's Role Assignment</title>
<indexterm xml:id="indexterm-1154">
<primary>roles</primary>
<secondary>modifying assignment to a user</secondary>
</indexterm>
<indexterm xml:id="indexterm-1155">
<primary>adding</primary>
<secondary>roles</secondary>
<tertiary>to a user</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1156">
<primary>modifying</primary>
<secondary>role assignment to a user</secondary>
</indexterm>
<indexterm xml:id="indexterm-1157">
<primary>assigning</primary>
<secondary>role to a user</secondary>
</indexterm>
<para>In this example, a role is added to an existing user. The user's role
assignment is modified by clicking the User Accounts icon in the Users tool
in the Solaris Management Console, double-clicking the user, and following
the online help to add a role to the user's capabilities.</para>
</example>
<taskrelated role="troubleshooting">

<para>
<indexterm xml:id="indexterm-1158">
<primary>roles</primary>
<secondary>troubleshooting</secondary>
</indexterm>
<indexterm xml:id="indexterm-1159">
<primary>troubleshooting</primary>
<secondary>role capabilities</secondary>
</indexterm>Check the following if the role does not have the capabilities
that it should:</para>
<itemizedlist>
<listitem>
<para>Are the role's rights profiles listed in the GUI from most
to least powerful?</para>
<para>For example, if the <literal>All</literal> rights
profile is at the top of the list, then no commands are run with security
attributes. A profile that contains commands with security attributes must
precede the <literal>All</literal> rights profile in the list.</para>
</listitem>
<listitem>
<para>Do the commands in the role's rights profiles have the appropriate
security attributes?</para>
<para>For example, when the policy is <literal>suser</literal>,
some commands require <literal>uid=0</literal> rather than <literal>euid=0</literal>.</para>
</listitem>
<listitem>
<para>Is the rights profile defined in the appropriate name service
scope? Is the role operating in the name service scope where the rights profile
is defined?</para>
</listitem>
<listitem>
<para>Has the name service cache, <literal>svc:/system/name-service-cache</literal>, been restarted?</para>
<para>The <command>nscd</command> daemon
can have a lengthy time-to-live interval. By restarting the daemon, you update
the name service with current data.</para>
</listitem>
</itemizedlist>
</taskrelated>
</task>
</sect2>
<sect2>
<title/>
<task id="rbactask-22">

<title>How to Create a Role From the Command Line</title>
<indexterm xml:id="indexterm-1160">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>on command line</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1161">
<primary>adding</primary>
<secondary>roles</secondary>
<tertiary>from command line</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1162">
<primary>creating</primary>
<secondary>roles</secondary>
<tertiary>on command line</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1163">
<primary>configuring</primary>
<secondary>roles</secondary>
<tertiary>from command line</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1164">
<primary>RBAC</primary>
<secondary>adding roles from command line</secondary>
</indexterm>
<indexterm xml:id="indexterm-1165">
<primary>roles</primary>
<secondary>adding from command line</secondary>
</indexterm>
<tasksummary>
<para>The Solaris Management Console GUI is the preferred method for managing
RBAC. To use the GUI, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-32">How to Create and
Assign a Role By Using the GUI</olink>. You can also use the command-line
interfaces, as described in this procedure.</para>
<note>

<para>Do not attempt to administer RBAC with the command line and the
graphical user interface at the same time. Conflicting changes could be made
to the configuration, and the behavior would be unpredictable. You can use
both tools to administer RBAC, but you cannot use both concurrently.</para>
</note>
</tasksummary>
<taskprerequisites>

<para>To create a role, you must either assume a role that includes the Primary
Administrator rights profile, or switch to the user <literal>root</literal>.</para>
</taskprerequisites>
<procedure>
<step>
<para>Assume the Primary Administrator role, or become superuser.</para>
<para>The Primary Administrator role includes the Primary Administrator profile. To create
the role and assign the role to a user, see <olink remap="external" targetdoc="819-2379" targetptr="smcover-1">Chapter 2, <citetitle remap="chapter">Working With the Solaris Management Console (Tasks),</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>.</para>
</step>
<step>
<para>Choose one of the following commands to create a role on the command
line.</para>
<stepalternatives>
<step>
<para>
<indexterm xml:id="indexterm-1166">
<primary>
<command>roleadd</command> command</primary>
<secondary>using</secondary>
</indexterm>For roles in the local name service scope, use the <command>roleadd</command> command.</para>
<note>

<para>The <command>roleadd</command> command is more limited than the
Solaris Management Console GUI or command-line interfaces. After running the <command>roleadd</command> command, you must run the <command>usermod</command> command
to assign the role to a user. And, the user then must set the password for
the role, as shown in <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-44">How to Assign a Role
to a Local User</olink>.</para>
</note>
<screen># roleadd -c <replaceable>comment</replaceable> \
-g <replaceable>group</replaceable> -m <replaceable>homedir</replaceable> -u <replaceable>UID</replaceable> -s <replaceable>shell</replaceable> \
-P <replaceable>profile</replaceable> <replaceable>rolename</replaceable>
</screen>
<variablelist>
<varlistentry>
<term>
<option>
c</option> <replaceable>comment</replaceable>
</term>
<listitem>
<para>Is a comment that describes <replaceable>rolename</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
g</option> <replaceable>group</replaceable>
</term>
<listitem>
<para>Is the group assignment for <replaceable>rolename</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
m</option> <replaceable>homedir</replaceable>
</term>
<listitem>
<para>Is the path to the home directory for <replaceable>rolename</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
u</option> <replaceable>UID</replaceable>
</term>
<listitem>
<para>Is the UID for <replaceable>rolename</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
s</option> <replaceable>shell</replaceable>
</term>
<listitem>
<para>Is the login shell for <replaceable>rolename</replaceable>.
This shell must be a profile shell.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
P</option> <replaceable>profile</replaceable>
</term>
<listitem>
<para>Is one or more rights profiles for <replaceable>rolename</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<replaceable>rolename</replaceable>
</term>
<listitem>
<para>Is the name of the new local role.</para>
</listitem>
</varlistentry>
</variablelist>
</step>
<step>
<para>Use the <command>smrole add</command> command.</para>
<para>This
command creates a role in a distributed name service, such as NIS, NIS+, or
LDAP. This command runs as a client of the Solaris Management Console server.</para>
<screen>$ /usr/sadm/bin/smrole -D <replaceable>domain-name</replaceable> \ 
-r <replaceable>admin-role</replaceable> -l <replaceable>&lt;Type admin-role password&gt;
</replaceable> \
add -- -n <replaceable>rolename</replaceable> -a <replaceable>rolename</replaceable> -d <replaceable>directory</replaceable>\
-F <replaceable>full-description</replaceable> -p <replaceable>profile</replaceable>
</screen>
<variablelist>
<varlistentry>
<term>
<option>
D</option> <replaceable>domain-name</replaceable>
</term>
<listitem>
<para>Is the name of the domain that you want to manage.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
r</option> <replaceable>admin-role</replaceable>
</term>
<listitem>
<para>Is the name of the administrative role that can modify the
role. The administrative role must have the <literal>solaris.role.assign</literal> authorization.
If you are modifying a role that you have assumed, the role must have the <literal>solaris.role.delegate</literal> authorization.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
l</option>
</term>
<listitem>
<para>Is the prompt for the password of <replaceable>admin-role</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<literal>--</literal>
</term>
<listitem>
<para>Is the required separator between authentication options and
subcommand options.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
n</option> <replaceable>rolename</replaceable>
</term>
<listitem>
<para>Is the name of the new role.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
c</option> <replaceable>comment</replaceable>
</term>
<listitem>
<para>Is the comment that describes the capabilities of the role.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
a</option> <replaceable>username</replaceable>
</term>
<listitem>
<para>Is the name of the user who can assume <replaceable>rolename</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
d</option> <replaceable>directory</replaceable>
</term>
<listitem>
<para>Is the home directory for <replaceable>rolename</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
F</option> <replaceable>full-description</replaceable>
</term>
<listitem>
<para>Is the full description for <replaceable>rolename</replaceable>.
This description is displayed in the Solaris Management Console GUI.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
p</option> <replaceable>profile</replaceable>
</term>
<listitem>
<para>Is a rights profile that is included in the capabilities of <replaceable>rolename</replaceable>. This option gives commands with administrative capabilities
to the role. You can specify multiple <option>
p</option> <replaceable>profile</replaceable> options.</para>
</listitem>
</varlistentry>
</variablelist>
</step>
</stepalternatives>
</step>
<step>
<para>To put the changes into effect, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-44">How
to Assign a Role to a Local User</olink>.</para>
</step>
</procedure>
<example xml:id="rbactask-19">

<title>Creating a Custom Operator Role by Using the <command>smrole</command> Command</title>
<indexterm xml:id="indexterm-1167">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>Custom Operator role</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1168">
<primary>
<command>smrole</command> command</primary>
<secondary>using</secondary>
</indexterm>
<indexterm xml:id="indexterm-1169">
<primary>adding</primary>
<secondary>customized role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1170">
<primary>creating</primary>
<secondary>customized role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1171">
<primary>Custom Operator (RBAC)</primary>
<secondary>creating role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1172">
<primary>RBAC</primary>
<secondary>adding custom roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1173">
<primary>adding</primary>
<secondary>custom roles (RBAC)</secondary>
</indexterm>
<indexterm xml:id="indexterm-1174">
<primary>roles</primary>
<secondary>adding custom roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1175">
<primary>configuring</primary>
<secondary>custom roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1176">
<primary>
<option>
a</option> option</primary>
<secondary>
<command>smrole</command> command</secondary>
</indexterm>
<para>The <command>smrole</command> command specifies a new role and its attributes
in a name service. In the following example, the Primary Administrator creates
a new version of the Operator role. The role includes the standard Operator
rights profile as well as the Media Restore rights profile. Note that the
command prompts you for a password for the new role.</para>
<screen>% <userinput>su - primaryadm</userinput>
Password: <lineannotation>&lt;Type primaryadm password&gt;
</lineannotation> 
$ <userinput>/usr/sadm/bin/smrole add -H myHost -- -c "Backup and Restore Operator" \</userinput>
<userinput>-n operadm2 -a janedoe -d /export/home/operadm \</userinput>
<userinput>-F "Backup/Restore Operator" -p "Operator" -p "Media Restore"</userinput>
Authenticating as user: primaryadm

Type /? for help, pressing &lt;enter&gt; accepts the default denoted by [ ]
Please enter a string value for: password :: <lineannotation>&lt;Type primaryadm password&gt;
</lineannotation>

Loading Tool: com.sun.admin.usermgr.cli.role.UserMgrRoleCli from myHost
Login to myHost as user primaryadm was successful.
Download of com.sun.admin.usermgr.cli.role.UserMgrRoleCli from myHost was successful.

Type /? for help, pressing &lt;enter&gt; accepts the default denoted by [ ]
Please enter a string value for: password ::<lineannotation>&lt;Type operadm2 password&gt;
</lineannotation>

$ <userinput>svcadm restart system/name-service-cache</userinput>
</screen>
<para>The <command>smrole</command> command with the <command>list</command> subcommand
is used to display the new role:</para>
<screen>$ <userinput>/usr/sadm/bin/smrole list --</userinput>
Authenticating as user: primaryadm

Type /? for help, pressing &lt;enter&gt; accepts the default denoted by [ ]
Please enter a string value for: password :: <lineannotation>&lt;Type  primaryadm password&gt;
</lineannotation>

Loading Tool: com.sun.admin.usermgr.cli.role.UserMgrRoleCli from myHost
Login to myHost as user primaryadm was successful.
Download of com.sun.admin.usermgr.cli.role.UserMgrRoleCli from myHost was successful.
root                    0             Superuser
primaryadm            100             Most powerful role
sysadmin              101             Performs non-security admin tasks
operadm               102             Backup Operator
operadm2              103             Backup/Restore Operator</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="rbactask-44">

<title>How to Assign a Role to a Local User</title>
<indexterm xml:id="indexterm-1177">
<primary>roles</primary>
<secondary>assigning with <command>usermod</command> command</secondary>
</indexterm>
<indexterm xml:id="indexterm-1178">
<primary>
<command>usermod</command> command</primary>
<secondary>using to assign role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1179">
<primary>assigning</primary>
<secondary>role to a user locally</secondary>
</indexterm>
<tasksummary>
<para>This procedure assigns a local role to a local user, restarts the name
cache daemon, and then shows how the user can assume the role.</para>
<para>To assign a role to a user in a distributed name service, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-22">How to Create a Role From the Command Line</olink> and <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-23">How to Change the Properties of a Role</olink>.</para>
</tasksummary>
<taskprerequisites>

<para>You have added a local role, as described in <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-22">How to Create a Role From the Command Line</olink>. You must have assumed
the role of Primary Administrator or have switched to superuser.</para>
</taskprerequisites>
<procedure>
<step>
<para>Assign the role to a local user.</para>
<para>If you added a local
role with the <command>roleadd</command> command, this step is required. This
step is optional when you use the <command>smrole</command> command and the
Solaris Management Console to create a role.</para>
<screen># usermod -u <replaceable>UID</replaceable> -R <replaceable>rolename</replaceable>
</screen>
<variablelist>
<varlistentry>
<term>
<option>
u</option> <replaceable>UID</replaceable>
</term>
<listitem>
<para>Is the UID of the user.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
R</option> <replaceable>rolename</replaceable>
</term>
<listitem>
<para>Is the role that is being assigned to the user.</para>
</listitem>
</varlistentry>
</variablelist>
</step>
<step>
<para>To put the changes into effect, restart the name service cache
daemon.</para>
<screen># svcadm restart system/name-service-cache</screen>
<para>If you added a role with a Solaris Management Console interface, go
to <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-40">Using Roles (Task Map)</olink>. Otherwise,
continue with the next step.</para>
</step>
<step performance="optional">

<para>To unlock the role account, the user must
create a password.</para>
<para>If you added a local role with the <command>roleadd</command> command, this step is required.</para>
<screen>% su - <replaceable>rolename</replaceable>
Password: <lineannotation>&lt;Type rolename password&gt;
</lineannotation>
Confirm Password: <lineannotation>&lt;Retype rolename password&gt;
</lineannotation>
$</screen>
</step>
</procedure>
<example xml:id="rbactask-17">

<title>Creating and Assigning a Local Role From the Command Line</title>
<indexterm xml:id="indexterm-1180">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>Crypto Management role</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1181">
<primary>adding</primary>
<secondary>cryptomgt role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1182">
<primary>adding</primary>
<secondary>security-related role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1183">
<primary>Crypto Management (RBAC)</primary>
<secondary>creating role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1184">
<primary>cryptographic framework</primary>
<secondary>administering with role</secondary>
</indexterm>
<para>In this example, a role is created to administer the Solaris Cryptographic
Framework. The Crypto Management rights profile contains the <command>cryptoadm</command> command
for administering hardware and software cryptographic services on a local
system.</para>
<screen># <userinput>roleadd -c "Cryptographic Services manager" \</userinput>
<userinput>-g 14 -m /export/home/cryptoadm -u 104 -s pfksh \</userinput>
<userinput>-P "Crypto Management" cryptomgt</userinput>
# <userinput>usermod -u 1111 -R cryptomgt</userinput>
# <userinput>svcadm restart system/name-service-cache</userinput>
% <userinput>su - cryptomgt</userinput>
Password: <lineannotation>&lt;Type cryptomgt password&gt;
</lineannotation>
Confirm Password: <lineannotation>&lt;Retype cryptomgt password&gt;
</lineannotation>
$ <userinput>/usr/ucb/whoami</userinput>
cryptomgt
$</screen>
<para>For information about the Solaris Cryptographic Framework, see <olink remap="external" targetdoc="chapter-12.xml" targetptr="scf-1">Chapter 12, Solaris Cryptographic Framework (Overview)</olink>.
To administer the framework, see <olink remap="external" targetdoc="chapter-13.xml" targetptr="scftask-28">Administering
the Cryptographic Framework (Task Map)</olink>.</para>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="rbactask-34">

<title>How to Audit Roles</title>
<indexterm xml:id="indexterm-1185">
<primary>roles</primary>
<secondary>auditing</secondary>
</indexterm>
<indexterm xml:id="indexterm-1186">
<primary>auditing</primary>
<secondary>roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1187">
<primary>adding</primary>
<secondary>auditing of roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1188">
<primary>RBAC</primary>
<secondary>auditing roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1189">
<primary>monitoring</primary>
<secondary>use of privileged commands</secondary>
</indexterm>
<tasksummary>
<para>The actions that a role performs can be audited. Included in the audit
record is the login name of the user who assumed the role, the role name,
and the action that the role performed.  The <literal>6180:AUE_prof_cmd:profile
command:ua,as</literal> audit event collects the information. By preselecting
the <literal>as</literal> class or the <literal>ua</literal> class, you can
audit role actions.</para>
</tasksummary>
<procedure>
<step>
<para>Plan for auditing and edit the audit configuration files.</para>
<para>For more information, see <olink remap="external" targetdoc="chapter-28.xml" targetptr="audittask-3">Solaris Auditing
(Task Map)</olink>.</para>
</step>
<step>
<para>Include the <literal>ua</literal> class or the <literal>as</literal> class
in the <literal>flags</literal> line of the <filename>audit_control</filename> file.</para>
<screen># audit_control file
dir:/var/audit
flags:lo,<userinput>as</userinput>
minfree:20
naflags:lo</screen>
<para>The <literal>ua</literal> class and the <literal>as</literal> class
include other audit events. To see the audit events that are included in a
class, read the <filename>audit_event</filename> file. You can also use the <command>bsmrecord</command> command, as shown in <olink remap="external" targetdoc="chapter-28.xml" targetptr="audittask-33">Example
28–22</olink>.</para>
</step>
<step>
<para>Finish configuring the auditing service, then enable auditing.</para>
<para>For more information, see <olink remap="external" targetdoc="chapter-28.xml" targetptr="audittask-28">Configuring
and Enabling the Auditing Service</olink>.</para>
</step>
</procedure>
</task>
</sect2>
<sect2>
<title/>
<task id="rbactask-20">

<title>How to Make <literal>root</literal> User Into
a Role</title>
<indexterm xml:id="indexterm-1190">
<primary>roles</primary>
<secondary>making <literal>root</literal> user into role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1191">
<primary>roles</primary>
<secondary>creating</secondary>
<tertiary>
<literal>root</literal> role</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1192">
<primary>
<literal>root</literal> user</primary>
<secondary>changing to <literal>root</literal> role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1193">
<primary>access</primary>
<secondary>
<literal>root</literal> access</secondary>
<tertiary>preventing login (RBAC)</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1194">
<primary>configuring</primary>
<secondary>
<literal>root</literal> user as role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1195">
<primary>creating</primary>
<secondary>
<literal>root</literal> user as role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1196">
<primary>changing</primary>
<secondary>
<literal>root</literal> user into role</secondary>
</indexterm>
<tasksummary>
<para>This procedure shows how to change <literal>root</literal> from a login
user to a role. When you complete this procedure, you can no longer log in
to the system as <literal>root</literal>, except in single-user mode. You
can <command>su</command> to <literal>root</literal> if the <literal>root</literal> role
has been assigned to you.</para>
<para>By changing the <literal>root</literal> user into a role, you prevent
anonymous <literal>root</literal> login. Because a user must log in and <emphasis>then</emphasis> assume the <literal>root</literal> role, the user's login
ID is provided to the auditing service and is in the <filename>sulog</filename> file.</para>
</tasksummary>
<taskprerequisites>

<para>If you change the <literal>root</literal> user into a role without assigning
the role to a valid user or without a currently existing role that is equivalent
to the <literal>root</literal> user, no one can become superuser.</para>
<itemizedlist>
<listitem>
<para>For safety, at least one local user should be assigned the <literal>root</literal> role.</para>
</listitem>
<listitem>
<para>You cannot perform this procedure when you are logged in as <literal>root</literal>. You must log in as yourself, then <command>su</command> to <literal>root</literal>.</para>
</listitem>
</itemizedlist>
</taskprerequisites>
<procedure>
<step>
<para>As an ordinary user, log in to the target host.</para>
</step>
<step>
<para>Assume the Primary Administrator role, or become superuser.</para>
<para>The Primary Administrator role includes the Primary Administrator profile.
To create the role and assign the role to a user, see <olink remap="external" targetdoc="819-2379" targetptr="smcover-95">
<citetitle remap="section">Using the Solaris Management Tools With RBAC (Task Map)</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>.</para>
</step>
<step>
<para>
<indexterm xml:id="indexterm-1197">
<primary>
<command>useradd</command> command</primary>
<secondary>adding local user</secondary>
</indexterm>
<indexterm xml:id="indexterm-1198">
<primary>adding</primary>
<secondary>local user</secondary>
</indexterm>
<indexterm xml:id="indexterm-1199">
<primary>creating</primary>
<secondary>local user</secondary>
</indexterm>
<indexterm xml:id="indexterm-1200">
<primary>users</primary>
<secondary>adding local user</secondary>
</indexterm>
<indexterm xml:id="indexterm-1201">
<primary>users</primary>
<secondary>creating local user</secondary>
</indexterm>Create a local user who can assume the <literal>root</literal> role.</para>
<screen>$ useradd -c <replaceable>comment</replaceable> -d <replaceable>homedir username</replaceable>
</screen>
<variablelist>
<varlistentry>
<term>
<option>
c</option> <replaceable>comment</replaceable>
</term>
<listitem>
<para>Is the comment that describes the user.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
d</option> <replaceable>homedir</replaceable>
</term>
<listitem>
<para>Is the home directory of the user. This directory should be
on the local system.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<replaceable>username</replaceable>
</term>
<listitem>
<para>Is the name of the new local user.</para>
</listitem>
</varlistentry>
</variablelist>
<screen># <userinput>useradd -c "Local administrative user" -d /export/home1 admuser</userinput>
</screen>
</step>
<step>
<para>Give the user a password.</para>
<screen># <userinput>passwd -r files admuser</userinput>
New Password:    <lineannotation>&lt;Type password&gt;
</lineannotation>
Re-enter new Password: <lineannotation>&lt;Retype password&gt;
</lineannotation>
passwd: password successfully changed for admuser
#</screen>
</step>
<step>
<para>Make sure that you are not logged in as <literal>root</literal>.</para>
<screen># <userinput>who</userinput>
jdoe    console      May 24 13:51    (:0)
jdoe    pts/5        May 24 13:51    (:0.0)
jdoe    pts/4        May 24 13:51    (:0.0)
jdoe    pts/10       May 24 13:51    (:0.0)</screen>
</step>
<step>
<para>Change <literal>root</literal> user into a role.</para>
<screen># <userinput>usermod -K type=role root</userinput>
</screen>
</step>
<step>
<para>Verify that <literal>root</literal> is a role.</para>
<para>The <literal>root</literal> entry in the <filename>user_attr</filename> file should appear
similar to the following:</para>
<screen>root::::type=role;auths=solaris.*,solaris.grant;profiles=Web Console 
Management,All;lock_after_retries=no</screen>
</step>
<step>
<para>Assign the <literal>root</literal> role to the local administrative
user.</para>
<screen># <userinput>usermod -R root admuser</userinput>
</screen>
</step>
<step>
<para>Configure the name service to return in case of failure.</para>
<substeps>
<step>
<para>Open a new terminal window and assume the <literal>root</literal> role.</para>
<screen>% <userinput>whoami</userinput>
jdoe
% <userinput>su - admuser</userinput>
Enter password:   <lineannotation>&lt;Type admuser password&gt;
</lineannotation>
% <userinput>roles</userinput>
root
% <userinput>su - root</userinput>
Enter password:   <lineannotation>&lt;Type root password&gt;
</lineannotation>
#</screen>
</step>
<step>
<para>Edit the <filename>nsswitch.conf</filename> file.</para>
<para>
<indexterm xml:id="indexterm-1202">
<primary>configuring</primary>
<secondary>name service</secondary>
</indexterm>For example, the following entries in the <filename>nsswitch.conf</filename> file
would enable the name service to return.</para>
<screen>passwd:  files nis [TRYAGAIN=0 UNAVAIL=return NOTFOUND=return]
group:  files nis [TRYAGAIN=0 UNAVAIL=return NOTFOUND=return]</screen>
</step>
</substeps>
</step>
<step>
<para>Assign the <literal>root</literal> role to selected user accounts
in the name service.</para>
<para>For the procedure, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-25">How to Change the RBAC Properties of a User</olink>.</para>
</step>
</procedure>
</task>
</sect2>
</sect1>
<sect1 xml:id="rbactask-40">
<title>Using Roles (Task Map)</title>
<para>
<indexterm xml:id="indexterm-1203">
<primary>task maps</primary>
<secondary>using roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1204">
<primary>using</primary>
<secondary>roles task map</secondary>
</indexterm>
<indexterm xml:id="indexterm-1205">
<primary>assuming role</primary>
<secondary>how to</secondary>
</indexterm>
<indexterm xml:id="indexterm-1206">
<primary>user procedures</primary>
<secondary>assuming a role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1207">
<primary>user procedures</primary>
<secondary>using an assigned role</secondary>
</indexterm>The following task map points to procedures for using your role
after roles have been assigned.</para>
<informaltable frame="all" pgwide="1">
<tgroup cols="3" colsep="1" rowsep="1">
<colspec colname="colspec6" colwidth="21.40*"/>
<colspec colname="colspec7" colwidth="38.80*"/>
<colspec colname="colspec8" colwidth="38.80*"/>
<thead>
<row>
<entry>
<para>Task</para>
</entry>
<entry>
<para>Description</para>
</entry>
<entry>
<para>For Instructions</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>Use the Solaris Management Console</para>
</entry>
<entry>
<para>Authenticate yourself as a role to perform administrative tasks in the
Solaris Management Console.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-21">How to Assume a Role in the Solaris Management
Console</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Assume a role in a terminal window</para>
</entry>
<entry>
<para>Perform command-line administrative tasks in a profile shell.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-2">How to Assume a Role in a Terminal Window</olink>
</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1>
<sect1 xml:id="rbactask-42">
<title>Using Roles</title>
<para>
<indexterm xml:id="indexterm-1208">
<primary>using</primary>
<secondary>roles</secondary>
</indexterm>After you have set up roles with default Solaris rights profiles,
and assigned the roles to users, the roles can be used. A role can be assumed
on the command line. In the Solaris Management Console, a role can also be
used for administering the system locally and over the network.</para>
<sect2>
<title/>
<task id="rbactask-2">

<title>How to Assume a Role in a Terminal Window</title>
<indexterm xml:id="indexterm-1209">
<primary>roles</primary>
<secondary>assuming in a terminal window</secondary>
</indexterm>
<indexterm xml:id="indexterm-1210">
<primary>assuming role</primary>
<secondary>in a terminal window</secondary>
</indexterm>
<indexterm xml:id="indexterm-1211">
<primary>roles</primary>
<secondary>assuming</secondary>
</indexterm>
<indexterm xml:id="indexterm-1212">
<primary>
<command>su</command> command</primary>
<secondary>in role assumption</secondary>
</indexterm>
<indexterm xml:id="indexterm-1213">
<primary>roles</primary>
<secondary>using an assigned role</secondary>
</indexterm>
<taskprerequisites>

<para>The role must already be assigned to you. The name service must be updated
with that information.</para>
</taskprerequisites>
<procedure>
<step>
<para>
<indexterm xml:id="indexterm-1214">
<primary>
<command>roles</command> command</primary>
<secondary>using</secondary>
</indexterm>
<indexterm xml:id="indexterm-1215">
<primary>displaying</primary>
<secondary>roles you can assume</secondary>
</indexterm>
<indexterm xml:id="indexterm-1216">
<primary>listing</primary>
<secondary>roles you can assume</secondary>
</indexterm>
<indexterm xml:id="indexterm-1217">
<primary>roles</primary>
<secondary>listing local roles</secondary>
</indexterm>In a terminal window, determine which roles you can assume.</para>
<screen>% roles
<replaceable>Comma-separated list of role names is displayed</replaceable>
</screen>
</step>
<step>
<para>Use the <command>su</command> command to assume a role.</para>
<screen>% su - <replaceable>rolename</replaceable>
Password: <lineannotation>&lt;Type rolename password&gt;
</lineannotation>
$</screen>
<para>The <command>su -</command> <replaceable>rolename</replaceable> command changes
the shell to a profile shell for the role. A profile shell recognizes security
attributes (authorizations, privileges, and set ID bits).</para>
</step>
<step>
<para>Verify that you are now in a role.</para>
<screen>$ /usr/ucb/whoami
<replaceable>rolename</replaceable>
</screen>
<para>You can now perform role tasks in this terminal window.</para>
</step>
<step performance="optional">

<para>View the capabilities of your role.</para>
<para>For the procedure, see <olink remap="external" targetdoc="chapter-10.xml" targetptr="privtask-24">How to Determine
the Privileged Commands That a Role Can Run</olink>.</para>
</step>
</procedure>
<example xml:id="rbactask-11">

<title>Assuming the Primary Administrator Role</title>
<indexterm xml:id="indexterm-1218">
<primary>roles</primary>
<secondary>assuming Primary Administrator role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1219">
<primary>assuming role</primary>
<secondary>Primary Administrator</secondary>
</indexterm>
<indexterm xml:id="indexterm-1220">
<primary>Primary Administrator (RBAC)</primary>
<secondary>assuming role</secondary>
</indexterm>
<para>In the following example, the user assumes the role of Primary Administrator.
In the default configuration, this role is equivalent to superuser. The role
then checks to see which privileges are available to any command that is typed
in the profile shell for the role.</para>
<screen>% <userinput>roles</userinput>
sysadmin,oper,primaryadm
% <userinput>su - primaryadm</userinput>
Password: <lineannotation>&lt;Type primaryadm password&gt;
</lineannotation>
$ <userinput>/usr/ucb/whoami</userinput> <lineannotation>Prompt has changed to role prompt</lineannotation>
primaryadm
$ <userinput>ppriv $$</userinput>
1200:   pfksh
flags = &lt;none&gt;
        E (Effective): all
        I (Inheritable): basic
        P (Permitted): all
        L (Limit): all</screen>
<para>For information about privileges, see <olink remap="external" targetdoc="chapter-7.xml" targetptr="prbac-2">Privileges
(Overview)</olink>.</para>
</example>
<example xml:id="rbactask-57">

<title>Assuming the <literal>root</literal> Role</title>
<indexterm xml:id="indexterm-1221">
<primary>roles</primary>
<secondary>assuming <literal>root</literal> role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1222">
<primary>assuming role</primary>
<secondary>
<literal>root</literal>
</secondary>
</indexterm>
<indexterm xml:id="indexterm-1223">
<primary>
<literal>root</literal> role (RBAC)</primary>
<secondary>assuming role</secondary>
</indexterm>
<para>In the following example, the user assumes the <literal>root</literal> role.
The role was created in <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-20">How to Make root User
Into a Role</olink>
</para>
<screen>% <userinput>roles</userinput>
root
% <userinput>su - root</userinput>
Password: <lineannotation>&lt;Type root password&gt;
</lineannotation>
# <userinput>/usr/ucb/whoami</userinput> <lineannotation>Prompt has changed to role prompt</lineannotation>
root
$ <userinput>ppriv $$</userinput>
1200:   pfksh
flags = &lt;none&gt;
        E: all
        I: basic
        P: all
        L: all</screen>
<para>For information about privileges, see <olink remap="external" targetdoc="chapter-7.xml" targetptr="prbac-2">Privileges
(Overview)</olink>.</para>
</example>
<example xml:id="rbactask-13">

<title>Assuming the System Administrator Role</title>
<indexterm xml:id="indexterm-1224">
<primary>roles</primary>
<secondary>assuming System Administrator role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1225">
<primary>assuming role</primary>
<secondary>System Administrator</secondary>
</indexterm>
<indexterm xml:id="indexterm-1226">
<primary>System Administrator (RBAC)</primary>
<secondary>assuming role</secondary>
</indexterm>
<para>In the following example, the user assumes the role of System Administrator.
In contrast to the Primary Administrator role, the System Administrator has
the basic set of privileges in its effective set.</para>
<screen>% <userinput>roles</userinput>
sysadmin,oper,primaryadm
% <userinput>su - sysadmin</userinput>
Password: <lineannotation>&lt;Type sysadmin password&gt;
</lineannotation>
$ <userinput>/usr/ucb/whoami</userinput> <lineannotation>Prompt has changed to role prompt</lineannotation>
sysadmin
$ <userinput>ppriv $$</userinput>
1200:   pfksh
flags = &lt;none&gt;
        E: basic
        I: basic
        P: basic
        L: all</screen>
<para>For information about privileges, see <olink remap="external" targetdoc="chapter-7.xml" targetptr="prbac-2">Privileges
(Overview)</olink>. For a short description of the capabilities of the role,
see <olink remap="external" targetdoc="chapter-9.xml" targetptr="rbacref-23">System Administrator Rights Profile</olink>.</para>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="rbactask-21">

<title>How to Assume a Role in the Solaris Management
Console</title>
<indexterm xml:id="indexterm-1227">
<primary>roles</primary>
<secondary>assuming in Solaris Management Console</secondary>
</indexterm>
<indexterm xml:id="indexterm-1228">
<primary>assuming role</primary>
<secondary>in Solaris Management Console</secondary>
</indexterm>
<indexterm xml:id="indexterm-1229">
<primary>RBAC</primary>
<secondary>using privileged applications</secondary>
</indexterm>
<indexterm xml:id="indexterm-1230">
<primary>roles</primary>
<secondary>assuming</secondary>
</indexterm>
<indexterm xml:id="indexterm-1231">
<primary>
<command>su</command> command</primary>
<secondary>in role assumption</secondary>
</indexterm>
<indexterm xml:id="indexterm-1232">
<primary>roles</primary>
<secondary>using an assigned role</secondary>
</indexterm>
<tasksummary>
<para>To change information in the Solaris Management Console GUI requires
administrative capabilities. A role gives you administrative capabilities.
If you want to view information, you must have the <systemitem>solaris.admin.usermgr.read</systemitem> authorization. The Basic Solaris User rights profile includes
this authorization.</para>
</tasksummary>
<taskprerequisites>

<para>An administrative role that can change the properties of users or roles
must have already been assigned to you. For example, the Primary Administrator
role can change the properties of users or roles.</para>
</taskprerequisites>
<procedure>
<step>
<para>Start the Solaris Management Console.</para>
<screen>% <userinput>/usr/sbin/smc &amp;</userinput>
</screen>
<para>For detailed instructions, see <olink remap="external" targetdoc="819-2379" targetptr="smcover-95">
<citetitle remap="section">Using the Solaris Management Tools With RBAC (Task Map)</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>.</para>
</step>
<step>
<para>Select the toolbox for your task.</para>
<para>Navigate to the
toolbox that contains the tool or collection in the appropriate name service
scope and click the icon. The scopes are files (local), NIS, NIS+, and LDAP.
If the appropriate toolbox is not displayed in the navigation pane, choose
Open Toolbox from the Console menu and load the relevant toolbox.</para>
</step>
<step>
<para>Select the tool that you want to use.</para>
<para>Navigate to
the tool or collection and click the icon. The tools for managing the RBAC
elements are in the Users tool, as shown in the following figure.</para>
<mediaobject>
<imageobject>
<imagedata fileref="figures/usercoll.gif"/>
</imageobject>
<textobject>
<simpara>Window titled Management Tools shows the Navigation pane
on the left, the Tools pane on the right, and the Information pane with Context
Help below.</simpara>
</textobject>
</mediaobject>
</step>
<step>
<para>Type your user name and password in the Login: User Name dialog
box.</para>
</step>
<step>
<para>Authenticate yourself in the Login: Role dialog box.</para>
<para>The
Role option menu in the dialog box displays the roles that are assigned to
you. Choose a role and type the role password.</para>
</step>
</procedure>
</task>
</sect2>
</sect1>
<sect1 xml:id="rbactask-10">
<title>Managing RBAC (Task Map)</title>
<indexterm xml:id="indexterm-1233">
<primary>managing</primary>
<secondary>RBAC task map</secondary>
</indexterm>
<indexterm xml:id="indexterm-1234">
<primary>task maps</primary>
<secondary>managing RBAC</secondary>
</indexterm>
<para>The following task map points to procedures for customizing role-based
access control (RBAC) after RBAC has been initially implemented.</para>
<informaltable frame="all" pgwide="1">
<tgroup cols="3" colsep="1" rowsep="1">
<colspec colname="colspec6" colwidth="21.34*"/>
<colspec colname="colspec7" colwidth="43.14*"/>
<colspec colname="colspec8" colwidth="34.52*"/>
<thead>
<row>
<entry>
<para>Task</para>
</entry>
<entry>
<para>Description</para>
</entry>
<entry>
<para>For Instructions</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>Modify the properties of a role</para>
</entry>
<entry>
<para>Modifies the capabilities (privileges, privileged commands, profiles,
or authorizations) of a role.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-23">How to Change the Properties of a Role</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Create or change rights profiles</para>
</entry>
<entry>
<para>Creates a rights profile. Or modifies the authorizations, privileged
commands, or supplementary rights profiles in a rights profile.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-24">How to Create or Change a Rights Profile</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Change a user's administrative capabilities</para>
</entry>
<entry>
<para>Adds a role, a rights profile, an authorization, or privileges to an
ordinary  user.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-25">How to Change the RBAC Properties of
a User</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Secure legacy applications</para>
</entry>
<entry>
<para>Turns on the set ID permissions for legacy applications. Scripts can
contain commands with set IDs. Legacy applications can check for authorizations,
if appropriate.</para>
</entry>
<entry>
<para>
<olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-26">How to Add RBAC Properties to Legacy
Applications</olink>
</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>These procedures manage the elements that are used in RBAC. For user
management procedures, refer to <olink remap="external" targetdoc="819-2379" targetptr="usersetup-92366">Chapter 5, <citetitle remap="chapter">Managing User Accounts and Groups (Tasks),</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>.</para>
</sect1>
<sect1 xml:id="rbactask-4">
<title>Managing RBAC</title>
<para>The Solaris Management Console GUI is the preferred method for managing
RBAC.</para>
<note>

<para>Do not attempt to administer RBAC with the command line and the
graphical user interface at the same time. Conflicting changes could be made
to the configuration, and the behavior would be unpredictable. Both tools
can administer RBAC, but you cannot use both tools concurrently.</para>
</note>
<sect2>
<title/>
<task id="rbactask-23">

<title>How to Change the Properties of a
Role</title>
<indexterm xml:id="indexterm-1235">
<primary>roles</primary>
<secondary>changing properties of</secondary>
</indexterm>
<indexterm xml:id="indexterm-1236">
<primary>roles</primary>
<secondary>modifying</secondary>
</indexterm>
<indexterm xml:id="indexterm-1237">
<primary>changing</primary>
<secondary>properties of role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1238">
<primary>administering</primary>
<secondary>properties of a role</secondary>
</indexterm>
<indexterm xml:id="indexterm-1239">
<primary>configuring</primary>
<secondary>roles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1240">
<primary>modifying</primary>
<secondary>roles (RBAC)</secondary>
</indexterm>
<indexterm xml:id="indexterm-1241">
<primary>obtaining</primary>
<secondary>privileged commands</secondary>
</indexterm>
<indexterm xml:id="indexterm-1242">
<primary>RBAC</primary>
<secondary>modifying roles</secondary>
</indexterm>
<taskprerequisites>

<para>You must have assumed the role of Primary Administrator or have switched
to superuser to change the properties of a role. Role properties include password,
rights profiles, and authorizations.</para>
</taskprerequisites>
<procedure role="single-step">
<step>
<para>Use one of the following methods to change the properties of a
role.</para>
<stepalternatives>
<step>
<para>Use the Users tool in the Solaris Management Console.</para>
<para>To
start the console, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-21">How to Assume a Role
in the Solaris Management Console</olink>. Follow the instructions in the
left-hand pane to modify a role in Administrative Roles. For more extensive
information, see the online help.</para>
</step>
<step>
<para>Use the <command>rolemod</command> command.</para>
<para>
<indexterm xml:id="indexterm-1243">
<primary>
<command>rolemod</command> command</primary>
<secondary>changing properties of role</secondary>
</indexterm>This command modifies the attributes of a role that is defined
in the local name service.</para>
<screen>$ rolemod -c <replaceable>comment</replaceable> -P <replaceable>profile-list</replaceable> <replaceable>rolename</replaceable>
</screen>
<variablelist>
<varlistentry>
<term>
<option>
c</option> <replaceable>comment</replaceable>
</term>
<listitem>
<para>Is the new comment that describes the capabilities of the
role.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
P</option> <replaceable>profile-list</replaceable>
</term>
<listitem>
<para>Is the list of the profiles that are included in the role.
This list replaces the current list of profiles.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<replaceable>rolename</replaceable>
</term>
<listitem>
<para>Is the name of an existing, local role that you want to modify.</para>
</listitem>
</varlistentry>
</variablelist>
<para>For more command options, see the <olink remap="external" targetdoc="819-2240" targetptr="rolemod-1m">
<citerefentry>
<refentrytitle>rolemod</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man page.</para>
</step>
<step>
<para>Use the <command>smrole</command> command with the <command>modify</command> subcommand.</para>
<para>
<indexterm xml:id="indexterm-1244">
<primary>
<command>smrole</command> command</primary>
<secondary>changing properties of role</secondary>
</indexterm>This command modifies the attributes of a role in a distributed
name service, such as NIS, NIS+, or LDAP. This command runs as a client of
the Solaris Management Console server.</para>
<screen>$ /usr/sadm/bin/smrole -D <replaceable>domain-name</replaceable> \ 
-r <replaceable>admin-role</replaceable> -l <replaceable>&lt;Type admin-role password&gt;
</replaceable> \
modify -- -n <replaceable>rolename</replaceable>  -r <replaceable>username</replaceable> -u <replaceable>username</replaceable>
</screen>
<variablelist>
<varlistentry>
<term>
<option>
D</option> <replaceable>domain-name</replaceable>
</term>
<listitem>
<para>Is the name of the domain that you want to manage.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
r</option> <replaceable>admin-role</replaceable>
</term>
<listitem>
<para>Is the name of the administrative role that can modify the
role. The administrative role must have the <literal>solaris.role.assign</literal> authorization.
If you are modifying a role that you have assumed, the role must have the <literal>solaris.role.delegate</literal> authorization.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
l</option>
</term>
<listitem>
<para>Is the prompt for the password of <replaceable>admin-role</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<literal>--</literal>
</term>
<listitem>
<para>Is the required separator between authentication options and
subcommand options.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
n</option> <replaceable>rolename</replaceable>
</term>
<listitem>
<para>Is the name of the new role.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
r</option> <replaceable>username</replaceable>
</term>
<listitem>
<para>Is the name of the user who can no longer assume <replaceable>rolename</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
u</option> <replaceable>username</replaceable>
</term>
<listitem>
<para>Is the name of the user who can now assume <replaceable>rolename</replaceable>.</para>
</listitem>
</varlistentry>
</variablelist>
<para>For more command options, see the <olink remap="external" targetdoc="819-2240" targetptr="smrole-1m">
<citerefentry>
<refentrytitle>smrole</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man page.</para>
</step>
</stepalternatives>
</step>
</procedure>
<example xml:id="rbactask-33">

<title>Changing a Local Role's Properties With the <command>rolemod</command> Command</title>
<para>In this example, the <literal>operadm</literal> role is modified to
include the Media Restore rights profile.</para>
<screen>$ <userinput>rolemod -c "Handles printers, backup, AND restore" \</userinput>
<userinput>-P "Printer Management,Media Backup,Media Restore,All" operadm</userinput>
</screen>
</example>
<example xml:id="rbactask-45">

<title>Changing a Local Role's Properties With the <command>smrole modify</command> Command</title>
<para>In the following example, the <literal>operadm</literal> role is modified
to add the Media Restore rights profile.</para>
<screen>$ <userinput>/usr/sadm/bin/smrole -r primaryadm -l</userinput> <replaceable>&lt;Type primaryadm password&gt;
</replaceable> <userinput>\</userinput>
<userinput>modify -- -n operadm -c "Handles printers, backup, AND restore" \</userinput>
<userinput>-p "Media Restore"</userinput>
</screen>
</example>
<example xml:id="rbactask-43">

<title>Changing a Role in a Domain With the <command>smrole modify</command> Command</title>
<para>In the following example, the <literal>clockmgr</literal> role is changed.
The NIS user whose ID is <literal>108</literal> can no longer assume the role.
The NIS user whose ID is <literal>110</literal> can assume the role <literal>clockmgr</literal>.</para>
<screen>$ <userinput>/usr/sadm/bin/smrole -D nis:/examplehost/example.domain \</userinput>
<userinput>-r primaryadm -l</userinput> <replaceable>&lt;Type primaryadm password&gt;
</replaceable> <userinput>\</userinput>
<userinput>modify -- -n clockmgr -r 108 -u 110</userinput>
</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="rbactask-24">

<title>How to Create or Change a Rights Profile</title>
<indexterm xml:id="indexterm-1245">
<primary>changing</primary>
<secondary>rights profile contents</secondary>
</indexterm>
<indexterm xml:id="indexterm-1246">
<primary>rights profiles</primary>
<secondary>changing contents of</secondary>
</indexterm>
<indexterm xml:id="indexterm-1247">
<primary>rights profiles</primary>
<secondary>methods of creating</secondary>
</indexterm>
<indexterm xml:id="indexterm-1248">
<primary>rights profiles</primary>
<secondary>modifying</secondary>
</indexterm>
<indexterm xml:id="indexterm-1249">
<primary>adding</primary>
<secondary>new rights profile</secondary>
</indexterm>
<indexterm xml:id="indexterm-1250">
<primary>creating</primary>
<secondary>rights profiles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1251">
<primary>administering</primary>
<secondary>rights profiles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1252">
<primary>administering</primary>
<secondary>RBAC properties</secondary>
</indexterm>
<indexterm xml:id="indexterm-1253">
<primary>RBAC</primary>
<secondary>editing rights profiles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1254">
<primary>Rights tool</primary>
<secondary>description</secondary>
</indexterm>
<indexterm xml:id="indexterm-1255">
<primary>adding</primary>
<secondary>attributes to a rights profile</secondary>
</indexterm>
<indexterm xml:id="indexterm-1256">
<primary>configuring</primary>
<secondary>rights profiles</secondary>
</indexterm>
<tasksummary>
<para>A rights profile is a property of a role. You should create or change
a rights profile when the <filename>prof_attr</filename> database does not
contain a rights profile that fulfills your needs. To learn more about rights
profiles, see <olink remap="external" targetdoc="chapter-7.xml" targetptr="rbac-33">RBAC Rights Profiles</olink>.</para>
</tasksummary>
<taskprerequisites>

<para>To create or change a rights profile, you must have assumed the role
of Primary Administrator or have switched to superuser.</para>
</taskprerequisites>
<procedure role="single-step">
<step>
<para>Use one of the following methods to change the properties of a
role.</para>
<stepalternatives>
<step>
<para>
<indexterm xml:id="indexterm-1257">
<primary>configuring</primary>
<secondary>rights profiles</secondary>
</indexterm>Use the Users tool in the Solaris Management Console.</para>
<para>To
start the console, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-21">How to Assume a Role
in the Solaris Management Console</olink>. Follow the instructions in the
left-hand pane to create or change a rights profile in Rights. For more extensive
information, see the online help.</para>
</step>
<step>
<para>
<indexterm xml:id="indexterm-1258">
<primary>
<command>smprofile</command> command</primary>
<secondary>changing rights profile</secondary>
</indexterm>Use the <command>smprofile</command> command.</para>
<para>
<indexterm xml:id="indexterm-1259">
<primary>deleting</primary>
<secondary>rights profiles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1260">
<primary>rights profiles</primary>
<secondary>creating</secondary>
<tertiary>on command line</tertiary>
</indexterm>This command enables you to add, modify, list, or delete a rights
profile. The command works on files, and in a distributed name service, such
as NIS, NIS+, or LDAP. The <command>smprofile</command> command runs as a
client of the Solaris Management Console server.</para>
<screen>$ /usr/sadm/bin/smprofile -D <replaceable>domain-name</replaceable> \ 
-r <replaceable>admin-role</replaceable> -l <replaceable>&lt;Type admin-role password&gt;
</replaceable> \
add | modify -- -n <replaceable>profile-name</replaceable> \
-d <replaceable>description</replaceable>  -m <replaceable>help-file</replaceable> -p <replaceable>supplementary-profile</replaceable>
</screen>
<variablelist>
<varlistentry>
<term>
<option>
D</option> <replaceable>domain-name</replaceable>
</term>
<listitem>
<para>Is the name of the domain that you want to manage.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
r</option> <replaceable>admin-role</replaceable>
</term>
<listitem>
<para>Is the name of the administrative role that can modify the
role. The administrative role must have the <literal>solaris.role.assign</literal> authorization.
If you are modifying a role that you have assumed, the role must have the <literal>solaris.role.delegate</literal> authorization.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
l</option>
</term>
<listitem>
<para>Is the prompt for the password of <replaceable>admin-role</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<literal>--</literal>
</term>
<listitem>
<para>Is the required separator between authentication options and
subcommand options.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
n</option> <replaceable>profile-name</replaceable>
</term>
<listitem>
<para>Is the name of the new profile.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
d</option> <replaceable>description</replaceable>
</term>
<listitem>
<para>Is a short description of the profile.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
m</option> <replaceable>help-file</replaceable>
</term>
<listitem>
<para>Is the name of the HTML help file that you have created and
placed in the <filename>/usr/lib/help/profiles/locale/C</filename> directory.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
p</option> <replaceable>supplementary-profile</replaceable>
</term>
<listitem>
<para>Is the name of an existing rights profile that is included
in this rights profile. You can specify multiple <option>
p</option> <replaceable>supplementary-profile</replaceable> options.</para>
</listitem>
</varlistentry>
</variablelist>
<para>For more command options, see the <olink remap="external" targetdoc="819-2240" targetptr="smprofile-1m">
<citerefentry>
<refentrytitle>smprofile</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man page.</para>
</step>
</stepalternatives>
</step>
</procedure>
<example xml:id="rbactask-47">

<title>Modifying a Rights Profile From the Command Line</title>
<para>
<indexterm xml:id="indexterm-1261">
<primary>changing</primary>
<secondary>rights profile from command line</secondary>
</indexterm>
<indexterm xml:id="indexterm-1262">
<primary>configuring</primary>
<secondary>rights profile from command line</secondary>
</indexterm>
<indexterm xml:id="indexterm-1263">
<primary>rights profiles</primary>
<secondary>changing from command line</secondary>
</indexterm>In the following example, the Network Management rights profile
is made a supplementary profile of the Network Security rights profile. The
role that contains the Network Security profile can now configure the network
and hosts, as well has run security-relevant commands.</para>
<screen>$ <userinput>/usr/sadm/bin/smprofile -D nisplus:/example.host/example.domain \</userinput>
<userinput>-r primaryadm -l</userinput> <replaceable>&lt;Type primaryadm password&gt;
</replaceable> <userinput>\</userinput>
<userinput>modify -- -n "Network Security" \</userinput>
<userinput>-d "Manage network and host configuration and security" \</userinput>
<userinput>-m RtNetConfSec.html -p "Network Management"</userinput>
</screen>
<para>The administrator created a new help file, <filename>RtNetConfSec.html</filename>,
and placed it in the <filename>/usr/lib/help/profiles/locale/C</filename> directory,
before running this command.</para>
</example>
<example xml:id="rbactask-49">

<title>Creating a New Rights Profile With the Rights Tool</title>
<para>
<indexterm xml:id="indexterm-1264">
<primary>RBAC</primary>
<secondary>adding new rights profile</secondary>
</indexterm>
<indexterm xml:id="indexterm-1265">
<primary>adding</primary>
<secondary>rights profiles with Solaris Management Console</secondary>
</indexterm>
<indexterm xml:id="indexterm-1266">
<primary>rights profiles</primary>
<secondary>creating</secondary>
<tertiary>in Solaris Management Console</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1267">
<primary>creating</primary>
<secondary>rights profiles with Solaris Management Console</secondary>
</indexterm>The following table shows sample data for a hypothetical rights
profile that is called “Build Administrator”. This rights profile
includes the commands in the subdirectory <filename class="directory">/usr/local/swctrl/bin</filename>. These commands have an effective UID of <literal>0</literal>.
The Build Administrator rights profile would be useful for administrators
who manage the builds and versioning for software development.</para>
<informaltable frame="topbot" pgwide="1">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colname="colspec0" colwidth="19.50*"/>
<colspec colname="colspec1" colwidth="25.72*"/>
<colspec colname="colspec2" colwidth="53.79*"/>
<thead>
<row rowsep="1">
<entry>
<para>Tab</para>
</entry>
<entry>
<para>Field</para>
</entry>
<entry>
<para>Example</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>General</para>
</entry>
<entry>
<para>Name</para>
</entry>
<entry>
<para>Build Administrator</para>
</entry>
</row>
<row>
<entry>
<para>
</para>
</entry>
<entry>
<para>Description</para>
</entry>
<entry>
<para>For managing software builds and versioning.</para>
</entry>
</row>
<row>
<entry>
<para>
</para>
</entry>
<entry>
<para>Help File Name</para>
</entry>
<entry>
<para>
<filename>BuildAdmin.html</filename>
</para>
</entry>
</row>
<row>
<entry>
<para>Commands</para>
</entry>
<entry>
<para>Add Directory</para>
</entry>
<entry>
<para>Click Add Directory, type <filename class="directory">/usr/local/swctrl/bin</filename> in the dialog box, and click OK.</para>
</entry>
</row>
<row>
<entry>
<para>
</para>
</entry>
<entry>
<para>Commands Denied / Commands Permitted</para>
</entry>
<entry>
<para>Move <filename class="directory">/usr/local/swctrl/bin</filename> to
the Commands Permitted column.</para>
</entry>
</row>
<row>
<entry>
<para>
</para>
</entry>
<entry>
<para>Set Security Attributes</para>
</entry>
<entry>
<para>Select <filename class="directory">/usr/local/swctrl/bin</filename>,
click Set Security Attributes, and set Effective UID = <literal>root</literal>.</para>
</entry>
</row>
<row>
<entry>
<para>Authorizations</para>
</entry>
<entry>
<para>Authorizations Excluded / Authorizations Included</para>
</entry>
<entry>
<para>
<emphasis>No authorizations.</emphasis>
</para>
</entry>
</row>
<row>
<entry>
<para>Supplementary Rights</para>
</entry>
<entry>
<para>Rights Excluded / Rights Included</para>
</entry>
<entry>
<para>
<emphasis>No supplementary rights profiles.</emphasis>
</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</example>
<taskrelated role="troubleshooting">

<para>
<indexterm xml:id="indexterm-1268">
<primary>troubleshooting</primary>
<secondary>rights profiles</secondary>
</indexterm>
<indexterm xml:id="indexterm-1269">
<primary>rights profiles</primary>
<secondary>troubleshooting</secondary>
</indexterm>Check the following if the rights profile does not provide the
role with the capabilities that you expect:</para>
<itemizedlist>
<listitem>
<para>Are the rights profiles for the role listed in the GUI from
most to least powerful?</para>
<para>For example, if the <literal>All</literal> rights
profile is at the top of the list, then no commands are run with security
attributes. A profile that contains commands with security attributes must
precede the <literal>All</literal> rights profile in the list.</para>
</listitem>
<listitem>
<para>Is a command listed more than once in the role's rights profiles?
If so, does the first instance of the command have all the security attributes
that are required?</para>
<para>For example, a command can require privileges
for particular options to the command. For the options that require privileges
to succeed, the first instance of the command in the highest rights profile
in the list must have the assigned privileges.</para>
</listitem>
<listitem>
<para>Do the commands in the role's rights profiles have the appropriate
security attributes?</para>
<para>For example, when the policy is <literal>suser</literal>,
some commands require <literal>uid=0</literal> rather than <literal>euid=0</literal> to
succeed.</para>
</listitem>
<listitem>
<para>Has the name service cache, <literal>svc:/system/name-service-cache</literal>, been restarted?</para>
<para>The <command>nscd</command> daemon
can have a lengthy time-to-live interval. By restarting the daemon, you update
the name service with current data.</para>
</listitem>
</itemizedlist>
</taskrelated>
</task>
</sect2>
<sect2>
<title/>
<task id="rbactask-25">

<title>How to Change the RBAC Properties
of a User</title>
<indexterm xml:id="indexterm-1270">
<primary>RBAC</primary>
<secondary>modifying users</secondary>
</indexterm>
<indexterm xml:id="indexterm-1271">
<primary>modifying</primary>
<secondary>users (RBAC)</secondary>
</indexterm>
<indexterm xml:id="indexterm-1272">
<primary>users</primary>
<secondary>modifying properties (RBAC)</secondary>
</indexterm>
<indexterm xml:id="indexterm-1273">
<primary>User Accounts tool</primary>
<secondary>description</secondary>
</indexterm>
<tasksummary>
<para>User properties include password, rights profiles, and authorizations.
The most secure method of giving a user administrative capabilities is to
assign a role to the user. For a discussion, see <olink remap="external" targetdoc="chapter-7.xml" targetptr="rbac-10">Security
Considerations When Directly Assigning Security Attributes</olink>.</para>
</tasksummary>
<taskprerequisites>

<para>You must have assumed the role of Primary Administrator or have switched
to superuser to change the properties of a user.</para>
</taskprerequisites>
<procedure role="single-step">
<step>
<para>Use one of the following methods to change the RBAC properties
of a user.</para>
<stepalternatives>
<step>
<para>Use the Users tool in the Solaris Management Console.</para>
<para>To
start the console, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-21">How to Assume a Role
in the Solaris Management Console</olink>. Follow the instructions in the
left-hand pane to modify a user in User Accounts. For more extensive information,
see the online help.</para>
<tip>

<para>It is not good practice to assign authorizations, privileges, or
rights profiles directly to users. The preferred approach is to assign a role
to users. Users then  assume a role to perform privileged operations.</para>
</tip>
</step>
<step>
<para>
<indexterm xml:id="indexterm-1274">
<primary>
<command>usermod</command> command</primary>
<secondary>changing user's RBAC properties</secondary>
</indexterm>Use the <command>usermod</command> command.</para>
<para>This command
modifies the attributes of a user that is defined in the local name service.</para>
<screen>$ usermod -R <replaceable>rolename</replaceable> <replaceable>username</replaceable>
</screen>
<variablelist>
<varlistentry>
<term>
<option>
R</option> <replaceable>rolename</replaceable>
</term>
<listitem>
<para>Is the name of an existing local role.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<replaceable>username</replaceable>
</term>
<listitem>
<para>Is the name of an existing, local user that you want to modify.</para>
</listitem>
</varlistentry>
</variablelist>
<para>For more command options, see the <olink remap="external" targetdoc="819-2240" targetptr="usermod-1m">
<citerefentry>
<refentrytitle>usermod</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man page.</para>
</step>
<step>
<para>
<indexterm xml:id="indexterm-1275">
<primary>
<command>smuser</command> command</primary>
<secondary>changing user's RBAC properties</secondary>
</indexterm>Use the <command>smuser</command> command with the <command>modify</command> subcommand.</para>
<para>This command modifies the attributes of a user in a distributed
name service, such as NIS, NIS+, or LDAP. This command runs as a client of
the Solaris Management Console server.</para>
<screen>$ /usr/sadm/bin/smuser -D <replaceable>domain-name</replaceable> \ 
-r <replaceable>admin-role</replaceable> -l <replaceable>&lt;Type admin-role password&gt;
</replaceable> \
modify -- -n <replaceable>username</replaceable> -a <replaceable>rolename</replaceable>
</screen>
<variablelist>
<varlistentry>
<term>
<option>
D</option> <replaceable>domain-name</replaceable>
</term>
<listitem>
<para>Is the name of the domain that you want to manage.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
r</option> <replaceable>admin-role</replaceable>
</term>
<listitem>
<para>Is the name of the administrative role that can modify the
role. The administrative role must have the <literal>solaris.role.assign</literal> authorization.
If you are modifying a role that you have assumed, the role must have the <literal>solaris.role.delegate</literal> authorization.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
l</option>
</term>
<listitem>
<para>Is the prompt for the password of <replaceable>admin-role</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<literal>--</literal>
</term>
<listitem>
<para>Is the required separator between authentication options and
subcommand options.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
n</option> <replaceable>username</replaceable>
</term>
<listitem>
<para>Is the name of the user who is being assigned <replaceable>rolename</replaceable>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<option>
a</option> <replaceable>rolename</replaceable>
</term>
<listitem>
<para>Is the name of the role that you are assigning to <replaceable>username</replaceable>. You can specify multiple <option>
a</option> <replaceable>rolename</replaceable>options.</para>
</listitem>
</varlistentry>
</variablelist>
<para>For more command options, see the <olink remap="external" targetdoc="819-2240" targetptr="smuser-1m">
<citerefentry>
<refentrytitle>smuser</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man page.</para>
</step>
</stepalternatives>
</step>
</procedure>
<example xml:id="rbactask-53">

<title>Modifying a Local User's RBAC Properties From the Command Line</title>
<para>In this example, the user <literal>jdoe</literal> can now assume the
role of System Administrator.</para>
<screen>$ <userinput>usermod -R sysadmin jdoe</userinput>
</screen>
</example>
<example xml:id="rbactask-51">

<title>Modifying a User's RBAC Properties With the <command>smuser</command> Command</title>
<indexterm xml:id="indexterm-1276">
<primary>RBAC</primary>
<secondary>changing user properties</secondary>
<tertiary>from command line</tertiary>
</indexterm>
<indexterm xml:id="indexterm-1277">
<primary>changing</primary>
<secondary>user properties from command line</secondary>
</indexterm>
<indexterm xml:id="indexterm-1278">
<primary>users</primary>
<secondary>changing properties from command line</secondary>
</indexterm>
<para>In this example, the user <literal>jdoe</literal> is assigned two roles,
System Administrator and Operator. Because the user and the roles are defined
locally, the <option>
D</option> option is not necessary.</para>
<screen>$ <userinput>/usr/sadm/bin/smuser -r primaryadm -l</userinput> <replaceable>&lt;Type primaryadm password&gt;
</replaceable> <userinput>\</userinput>
<userinput>modify -- -n jdoe -a sysadmin -a operadm</userinput>
</screen>
<para>In the following example, the user is defined in the NIS name service.
Therefore, the <option>
D</option> option is required. Two roles are defined
in the name service. One role, <literal>root</literal>, is defined locally.</para>
<screen>$ <userinput>/usr/sadm/bin/smuser -D nis:/examplehost/example.domain \</userinput>
<userinput>-r primaryadm -l</userinput> <replaceable>&lt;Type primaryadm password&gt;
</replaceable> <userinput>\</userinput>
<userinput>modify -- -n jdoe -a sysadmin -a operadm -a root</userinput>
</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task id="rbactask-26">

<title>How to Add RBAC Properties to Legacy
Applications</title>
<indexterm xml:id="indexterm-1279">
<primary>adding</primary>
<secondary>RBAC properties to legacy applications</secondary>
</indexterm>
<indexterm xml:id="indexterm-1280">
<primary>adding</primary>
<secondary>security attributes to legacy applications</secondary>
</indexterm>
<tasksummary>
<para>A legacy application is a command or set of commands. The security attributes
are set for each command in a rights profile. The rights profile is then included
in a role. A user who assumes the role can run the legacy application with
the security attributes.</para>
<para>To add legacy applications to the Solaris Management Console, see <olink remap="external" targetdoc="819-2379" targetptr="smcover-118">
<citetitle remap="section">Adding Tools to the Solaris Management Console</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle>
</olink>.</para>
</tasksummary>
<taskprerequisites>

<para>You must have assumed the role of Primary Administrator or have switched
to superuser to change the security attributes of a command in a rights profile.</para>
</taskprerequisites>
<procedure>
<step>
<para>Use the Users tool in the Solaris Management Console.</para>
<para>To
start the console, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-21">How to Assume a Role
in the Solaris Management Console</olink>. Follow the instructions in the
left-hand pane to modify a rights profile in Rights. For more extensive information,
see the online help.</para>
</step>
<step>
<para>Add security attributes to the commands that implement the legacy
application.</para>
<para>You add security attributes to a legacy application
in the same way that you would for any command. You must add the command with
security attributes to a rights profile. For a legacy command, give the command <literal>euid=0</literal> or <literal>uid=0</literal> security attributes. For details
of the procedure, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-24">How to Create or Change
a Rights Profile</olink>.</para>
</step>
<step>
<para>After adding the legacy application to a rights profile, include
the rights profile in a role's list of profiles.</para>
<para>To add a rights
profile to a role, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-23">How to Change the Properties
of a Role</olink>.</para>
</step>
</procedure>
<example xml:id="rbactask-55">

<title>Adding Security Attributes to Commands in a Script</title>
<para>
<indexterm xml:id="indexterm-1281">
<primary>RBAC</primary>
<secondary>securing scripts</secondary>
</indexterm>
<indexterm xml:id="indexterm-1282">
<primary>scripts</primary>
<secondary>securing</secondary>
</indexterm>
<indexterm xml:id="indexterm-1283">
<primary>securing</primary>
<secondary>scripts</secondary>
</indexterm>If a command in a script needs to have the <command>setuid</command> bit
or <command>setgid</command> bit set to succeed, the script executable <emphasis>and</emphasis> the command must have the security attributes added in a rights
profile. Then, the rights profile is included in a role, and the role is assigned
to a user. When the user assumes the role and executes the script, the command
runs with the security attributes.</para>
<para>To add security attributes to a command or shell script, see <olink remap="internal" targetdoc="chapter-8.xml" targetptr="rbactask-24">How to Create or Change a Rights Profile</olink>.</para>
</example>
<example xml:id="rbactask-12">

<title>Checking for Authorizations in a Script or Program</title>
<para>
<indexterm xml:id="indexterm-1284">
<primary>RBAC</primary>
<secondary>checking scripts or programs for authorizations</secondary>
</indexterm>
<indexterm xml:id="indexterm-1285">
<primary>scripts</primary>
<secondary>checking for RBAC authorizations</secondary>
</indexterm>
<indexterm xml:id="indexterm-1286">
<primary>programs</primary>
<secondary>checking for RBAC authorizations</secondary>
</indexterm>To have a script for authorizations, you need to add a test that
is based on the <command>auths</command> command. For detailed information
about this command, see the <olink remap="external" targetdoc="819-2239" targetptr="auths-1">
<citerefentry>
<refentrytitle>auths</refentrytitle>
<manvolnum>
1
</manvolnum>
</citerefentry>
</olink> man
page.</para>
<para>For example, the following line tests if the user has the authorization
that is supplied as the <literal>$1</literal> argument:</para>
<screen>if [ `/usr/bin/auths|/usr/xpg4/bin/grep $1` ]; then
        echo Auth granted
else
        echo Auth denied
fi</screen>
<para>
<indexterm xml:id="indexterm-1287">
<primary>* (asterisk)</primary>
<secondary>checking for in RBAC authorizations</secondary>
</indexterm>
<indexterm xml:id="indexterm-1288">
<primary>asterisk (*)</primary>
<secondary>checking for in RBAC authorizations</secondary>
</indexterm>
<indexterm xml:id="indexterm-1289">
<primary>authorizations (RBAC)</primary>
<secondary>checking for wildcards</secondary>
</indexterm>To be more complete, the test should include logic that checks
for other authorizations that use wildcards. For example, to test if the user
has the <literal>solaris.admin.usermgr.write</literal> authorization, you
would need to check for the following strings:</para>
<itemizedlist>
<listitem>
<para>
<literal>solaris.admin.usermgr.write</literal>
</para>
</listitem>
<listitem>
<para>
<literal>solaris.admin.usermgr.*</literal>
</para>
</listitem>
<listitem>
<para>
<literal>solaris.admin.*</literal>
</para>
</listitem>
<listitem>
<para>
<literal>solaris.*</literal>
</para>
</listitem>
</itemizedlist>
<para>If you are writing a program, use the function <function>getauthattr
</function> to
test for the authorization.</para>
</example>
</task>
</sect2>
</sect1>
</chapter>
