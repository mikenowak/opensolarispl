<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML//EN" "docbook.dtd"[
	<!ENTITY % xinclude SYSTEM "xinclude.mod">
	%xinclude;
]>

<chapter xmlns="http://docbook.org/ns/docbook" version="5.0" arch="sparc" xml:id="hbsparcboot-79782">



<title>
Booting a System (Tasks)</title>
<toc>
<para>This chapter describes the procedures for using the <trademark>OpenBoot</trademark> PROM
monitor and the procedures for booting a SPARC based system to different run levels.</para>
<para>For information about the procedures that are associated with booting a SPARC
based system, see <olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-69">
Booting a System (Task Map)</olink>.</para>
<para>For overview information about the boot process, see <olink remap="external" targetdoc="chapter-8.xml" targetptr="hboverview-25463">Chapter 8, Shutting Down and Booting a System (Overview)</olink>. To troubleshoot
boot problems, see <olink remap="external" targetdoc="819-2380" targetptr="tsgeneral-8">
<citetitle remap="section">What to Do if Rebooting Fails</citetitle> in <citetitle remap="book">System Administration Guide: Advanced Administration</citetitle>
</olink>.</para>
<para>For step-by-step instructions on booting an x86 based system that
implements GRUB based booting, see <olink remap="external" targetdoc="chapter-11.xml" targetptr="hbx86boot-68676">Chapter 11, GRUB Based Booting (Tasks)</olink> </para>
<note>

<para>GRUB based booting is not available on SPARC based systems in this Solaris
release.</para>
</note>
<para>For step-by-step instructions on booting an x86 based system that does <emphasis>not</emphasis> implement GRUB based booting, see <olink remap="external" targetdoc="chapter-12.xml" targetptr="hbx86boot-aaa">Chapter 12, Booting a System (Tasks)</olink>.</para>
</toc>
<sect1 arch="sparc" xml:id="hbsparcboot-69">
<title>
Booting a System (Task Map)</title>
<informaltable frame="all" pgwide="1">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colname="column1" colwidth="112.00*"/>
<colspec colname="column2" colwidth="158.85*"/>
<colspec colname="column3" colwidth="125.15*"/>
<thead>
<row rowsep="1">
<entry colsep="1" rowsep="1">
<para>Task</para>
</entry>
<entry colsep="1" rowsep="1">
<para>Description</para>
</entry>
<entry colsep="1" rowsep="1">
<para>For Instructions</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry colsep="1" rowsep="1">
<para>Use the Boot PROM.</para>
</entry>
<entry colsep="1" rowsep="1">
<para>The boot PROM is used to boot a system. You might need to change the way the
system boots. For example, you might want to reset the device to boot from or run
hardware diagnostics before you bring the system to a multiuser level. Associated
tasks include the following:</para>
<itemizedlist>
<listitem>
<para>Identify the PROM revision number.</para>
</listitem>
<listitem>
<para>Identify devices on the system to boot from.</para>
</listitem>
<listitem>
<para>Change the default boot device when a new disk is added or when you
need to change the system boot method.</para>
</listitem>
</itemizedlist>
</entry>
<entry colsep="1" rowsep="1">
<para>
</para>
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-68368">
How to Find the PROM Revision Number for a System</olink>
</para>
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-75">
How to Identify Devices on a System</olink>
</para>
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-61766">
How to Change the Default Boot Device</olink>
</para>
</entry>
</row>
<row>
<entry colsep="1" rowsep="1">
<para>Reset the system.</para>
</entry>
<entry colsep="1" rowsep="1">
<para>When you reset the system, the system runs diagnostic tests on the hardware,
then reboots.</para>
</entry>
<entry colsep="1" rowsep="1">
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-84747">
How to Reset the System</olink>
</para>
</entry>
</row>
<row>
<entry colsep="1" rowsep="1">
<para>Boot a system.</para>
</entry>
<entry colsep="1" rowsep="1">
<para>Select one of the following boot methods:</para>
<itemizedlist>
<listitem>
<para>Boot to run level 3 – Used after shutting down the system or
performing a system hardware maintenance task. </para>
</listitem>
<listitem>
<para>Boot to run level S – Used after performing a system maintenance
task such as backing up a file system. At this level, only local file systems are
mounted and users cannot log in to the system.</para>
</listitem>
<listitem>
<para>Boot interactively – Used after making temporary changes to
a system file or the kernel for testing purposes.</para>
</listitem>
<listitem>
<para>Boot from the network – Used to boot a system from the network.
This method is used for booting a diskless client.</para>
</listitem>
</itemizedlist>
</entry>
<entry colsep="1" rowsep="1">
<para>
</para>
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-36744">
How to Boot a System to Run Level 3 (Multiuser Level)</olink>
</para>
<para>
</para>
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-83723">
How to Boot a System to Run Level S (Single-User Level)</olink>
</para>
<para>
</para>
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-66353">
How to Boot a System Interactively</olink>
</para>
<para>
</para>
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-60">
How to Boot a System From the Network</olink>
</para>
</entry>
</row>
<row>
<entry colsep="1" rowsep="1">
<para>Boot a system for recovery purposes.</para>
</entry>
<entry colsep="1" rowsep="1">
<para>Boot for recovery purposes – Used to boot the system when a damaged file
or file system is preventing the system from booting. You might need to do one or
both of the following to boot for recovery purposes:</para>
<itemizedlist>
<listitem>
<para>Stop the system to attempt recovery.</para>
</listitem>
<listitem>
<para>Boot to repair an important system file that is preventing the system
from booting successfully.</para>
</listitem>
</itemizedlist>
</entry>
<entry colsep="1" rowsep="1">
<para>
</para>
<para>
</para>
<para>
</para>
<para>
</para>
<para>
</para>
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-50162">
How to Stop the System for Recovery Purposes</olink>
</para>
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-82678">
How to Boot a System for Recovery Purposes</olink>
</para>
</entry>
</row>
<row>
<entry colsep="1" rowsep="1">
<para>Force a crash dump and reboot a system.</para>
</entry>
<entry colsep="1" rowsep="1">
<para>Force a crash dump and reboot the system - Used to force a crash dump for troubleshooting
purposes.</para>
</entry>
<entry colsep="1" rowsep="1">
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-70469">
How to Force a Crash Dump and Reboot of the System</olink>
</para>
</entry>
</row>
<row>
<entry colsep="1" rowsep="1">
<para>Troubleshoot problems with the <command>kmdb</command> command.</para>
</entry>
<entry colsep="1" rowsep="1">
<para>Boot <command>kmdb</command> – Used to troubleshoot system problems.</para>
</entry>
<entry colsep="1" rowsep="1">
<para>
<olink remap="internal" targetdoc="chapter-10.xml" targetptr="euayz">
How to Boot the System With the Kernel Debugger (<command>kmdb</command>)</olink>
</para>
<para>Use the <command>halt</command> command with the <option>
d</option> option if
you do not have time to debug the system interactively. Running the <command>halt</command> command with the <option>
d</option> option requires a manual reboot afterwards.
Whereas, if you use the <command>reboot</command> command, the system will reboot
automatically. </para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1>
<sect1 arch="sparc" xml:id="hbsparcboot-41506">
<title>
Using the Boot PROM</title>
<para>System administrators typically use the PROM level to boot a system. You need
to change the default boot device to do the following: </para>
<itemizedlist>
<listitem>
<para>Add a new drive to the system either permanently or temporarily</para>
</listitem>
<listitem>
<para>Change the network boot strategy</para>
</listitem>
<listitem>
<para>Temporarily boot a stand-alone system from the network</para>
</listitem>
</itemizedlist>
<para>For a complete list of PROM commands, see <olink remap="external" targetdoc="819-2240" targetptr="monitor-1m">
<citerefentry>
<refentrytitle>monitor</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> or <olink remap="external" targetdoc="819-2240" targetptr="eeprom-1m">
<citerefentry>
<refentrytitle>eeprom</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>.</para>
<sect2>
<title/>
<task arch="sparc" id="hbsparcboot-68368">

<title>
How to Find the PROM Revision Number
for a System</title>
<procedure role="single-step">
<step>
<para>
<indexterm xml:id="hbsparcboot-ix991">
<primary>
<command>banner</command> command (PROM)</primary>
</indexterm>Display a system's PROM revision number by using the <command>banner</command> command. </para>
<screen>ok <userinput>banner</userinput>
Sun Ultra 5/10 UPA/PCI (UltraSPARC-IIi 333MHz), No Keyboard
OpenBoot 3.15, 128 MB memory installed, Serial #<replaceable>number</replaceable>.
Ethernet address <replaceable>number</replaceable>, Host ID: <replaceable>number</replaceable>.</screen>
<para>
<indexterm xml:id="hbsparcboot-ix992">
<primary>PROM</primary>
<secondary>finding the PROM revision</secondary>
</indexterm>Hardware configuration information, including the revision number of the
PROM, is displayed. In this example, the PROM revision number is 3.15.</para>
</step>
</procedure>
</task>
</sect2>
<sect2>
<title/>
<task arch="sparc" id="hbsparcboot-75">

<title>
How to Identify Devices on a System</title>
<tasksummary>
<para>You might need to identify the devices on the system to determine what are the
appropriate devices to boot from.</para>
</tasksummary>
<taskprerequisites>

<para>Before you can safely use the <command>probe</command> commands to determine
what devices are attached to the system, you need to do the following:</para>
<itemizedlist>
<listitem>
<para>Change the PROM <literal>auto-boot?</literal> parameter to false.</para>
<screen>ok <userinput>setenv auto-boot? false</userinput>
</screen>
</listitem>
<listitem>
<para>Issue the <command>reset-all</command> command to clear system registers.</para>
<screen>ok <userinput>reset-all</userinput>
</screen>
</listitem>
</itemizedlist>
<para>You can view the <command>probe</command> commands that are available on your
system by using the <command>sifting probe</command> command:</para>
<screen>ok <userinput>sifting probe</userinput>
</screen>
<para>If you run the <command>probe</command> commands without clearing the system
registers, the following message is displayed:</para>
<screen>ok <userinput>probe-scsi</userinput>
This command may hang the system if a Stop-A or halt command
has been executed.  Please type reset-all to reset the system 
before executing this command. 
Do you wish to continue? (y/n) <userinput>n</userinput>
</screen>
</taskprerequisites>
<procedure>
<step xml:id="hbsparcboot-step-79">
<para>Identify the devices on the system.</para>
<screen>ok <userinput>probe-</userinput>
<replaceable>device</replaceable>
</screen>
</step>
<step xml:id="hbsparcboot-step-80">
<para>(Optional) If you want the system to reboot after
a power failure or after using the <command>reset</command> command, then reset the <literal>auto-boot?</literal> parameter to true.</para>
<screen>ok <userinput>setenv auto-boot? true</userinput>
auto-boot? =          true</screen>
</step>
<step xml:id="hbsparcboot-step-81">
<para>Boot the system back to multiuser mode.</para>
<screen>ok <userinput>reset</userinput>
</screen>
</step>
</procedure>
<example arch="sparc">

<title>
Identifying the Devices on a System</title>
<para>The following example shows how to identify the devices connected to an <trademark>Ultra</trademark> 10 system.</para>
<screen>ok <userinput>setenv auto-boot? false</userinput>
auto-boot? =          false
ok <userinput>reset-all</userinput>
Resetting ... 

Sun Ultra 5/10 UPA/PCI (UltraSPARC-IIi 333MHz), No Keyboard
OpenBoot 3.15, 128 MB memory installed, Serial #10933339.
Ethernet address 8:0:20:a6:d4:5b, Host ID: 80a6d45b.

ok <userinput>probe-ide</userinput>
  Device 0  ( Primary Master ) 
          ATA Model: ST34321A                                

  Device 1  ( Primary Slave ) 
         Not Present

  Device 2  ( Secondary Master ) 
         Removable ATAPI Model: CRD-8322B                               

  Device 3  ( Secondary Slave ) 
         Not Present

ok <userinput>setenv auto-boot? true</userinput>
auto-boot? =          true</screen>
<para>Alternatively, you can use the <command>devalias</command> command to identify
the device aliases and the associated paths of devices that <emphasis>might</emphasis> be
connected to the system. For example:</para>
<screen>ok <userinput>devalias</userinput>
screen                   /pci@1f,0/pci@1,1/SUNW,m64B@2
net                      /pci@1f,0/pci@1,1/network@1,1
cdrom                    /pci@1f,0/pci@1,1/ide@3/cdrom@2,0:f
disk                     /pci@1f,0/pci@1,1/ide@3/disk@0,0
disk3                    /pci@1f,0/pci@1,1/ide@3/disk@3,0
disk2                    /pci@1f,0/pci@1,1/ide@3/disk@2,0
disk1                    /pci@1f,0/pci@1,1/ide@3/disk@1,0
disk0                    /pci@1f,0/pci@1,1/ide@3/disk@0,0
ide                      /pci@1f,0/pci@1,1/ide@3
floppy                   /pci@1f,0/pci@1,1/ebus@1/fdthree
ttyb                     /pci@1f,0/pci@1,1/ebus@1/se:b
ttya                     /pci@1f,0/pci@1,1/ebus@1/se:a
keyboard!                /pci@1f,0/pci@1,1/ebus@1/su@14,3083f8:forcemode
keyboard                 /pci@1f,0/pci@1,1/ebus@1/su@14,3083f8
mouse                    /pci@1f,0/pci@1,1/ebus@1/su@14,3062f8
name                     aliases</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task arch="sparc" id="hbsparcboot-61766">

<title>
How to Change the Default Boot Device</title>
<tasksummary>
<para>You might need to identify the devices on the system before you can change the
default boot device to some other device. For information on identifying devices on
the system, see <olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-75">
How to Identify Devices on a System</olink>.</para>
</tasksummary>
<procedure>
<step>
<para>Become superuser or assume an equivalent role.</para>
<para>Roles contain authorizations and privileged commands. For more information about roles,
see <olink remap="external" targetdoc="819-3321" targetptr="rbactask-15">
<citetitle remap="section">Configuring RBAC (Task Map)</citetitle> in <citetitle remap="book">System Administration Guide: Security Services</citetitle>
</olink>.</para>
</step>
<step xml:id="hbsparcboot-step-3">
<para>Change to run level 0.</para>
<screen># <userinput>init 0</userinput>
</screen>
<para>The <literal>ok</literal> PROM prompt is displayed. For more information, see
the<olink remap="external" targetdoc="819-2240" targetptr="init-1m">
<citerefentry>
<refentrytitle>init</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man page.</para>
</step>
<step xml:id="hbsparcboot-step-5">
<para>Change the value of the <literal>boot-device</literal> parameter.</para>
<screen>ok <userinput>setenv boot-device</userinput> <replaceable>device</replaceable>[<replaceable>n</replaceable>]</screen>
<variablelist>
<varlistentry>
<term>
<literal>boot-device</literal>
</term>
<listitem>
<para>Identifies the parameter for setting the device from which to boot.</para>
</listitem>
</varlistentry>
<varlistentry>
<term>
<replaceable>device</replaceable>[<replaceable>n</replaceable>]</term>
<listitem>
<para>Identifies the <literal>boot-device</literal> value such as a disk
or the network. The <replaceable>n</replaceable> can be specified as the <replaceable>disk number</replaceable>.</para>
</listitem>
</varlistentry>
</variablelist>
<para>Use one of the <command>probe</command> commands if you need help identifying
the disk number.</para>
</step>
<step xml:id="hbsparcboot-step-6">
<para>Verify that the default boot device has been changed.</para>
<screen>ok <userinput>printenv boot-device</userinput>
</screen>
</step>
<step xml:id="hbsparcboot-step-7">
<para>Save the new <literal>boot-device</literal> value.</para>
<screen>ok <userinput>reset</userinput>
</screen>
<para>The new <literal>boot-device</literal> value is written to the PROM.</para>
</step>
</procedure>
<example arch="sparc">

<title>
Changing the Default Boot Device</title>
<para>In this example, the default boot device is set to disk.</para>
<screen># <userinput>init 0</userinput>
# 
INIT: New run level: 0
.
.
.
The system is down.
syncing file systems... done
Program terminated
ok <userinput>setenv boot-device disk</userinput>
boot-device =         disk
ok <userinput>printenv boot-device</userinput>
boot-device           disk                    disk
ok <userinput>reset</userinput>
Sun Ultra 5/10 UPA/PCI (UltraSPARC-IIi 333MHz), No Keyboard
OpenBoot 3.15, 128 MB memory installed, Serial #<replaceable>number</replaceable>.
Ethernet address <replaceable>number</replaceable>, Host ID: <replaceable>number</replaceable>.

Boot device: disk  File and args:
SunOS Release 5.9 Version 64-bit
.
.
.
pluto console login:</screen>
<para>In this example, the default boot device is set to the network.</para>
<screen># <userinput>init 0</userinput>
# 
INIT: New run level: 0
.
.
.
The system is down.
syncing file systems... done
Program terminated
ok <userinput>setenv boot-device net</userinput>
boot-device =         net
ok <userinput>printenv boot-device</userinput>
boot-device           net                    disk
ok <userinput>reset</userinput>
Sun Ultra 5/10 UPA/PCI (UltraSPARC-IIi 333MHz), No Keyboard
OpenBoot 3.15, 128 MB memory installed, Serial #<replaceable>number</replaceable>.
Ethernet address <replaceable>number</replaceable>, Host ID: <replaceable>number</replaceable>.



Boot device: net  File and args:
.
.
.
pluto console login:</screen>
</example>
</task>
</sect2>
<sect2 arch="sparc" xml:id="hbsparcboot-84747">
<title>
How to Reset the System</title>
<para>
<indexterm xml:id="hbsparcboot-ix995">
<primary>resetting</primary>
<secondary>a SPARC based system</secondary>
</indexterm>Run the <command>reset</command> command from the <literal>ok</literal> prompt. </para>
<screen>ok <userinput>reset</userinput>
</screen>
<para>
<indexterm xml:id="hbsparcboot-ix996">
<primary>
<command>reset</command> command</primary>
</indexterm>This self-test program, which runs diagnostic tests on the hardware, is
executed. Then, the system is rebooted. </para>
</sect2>
</sect1>
<sect1 arch="sparc" xml:id="hbsparcboot-9">
<title>
Booting a SPARC Based System</title>
<para>If a system is turned off, turning it on starts the multiuser boot sequence.
The following procedures show how to boot to different run levels from the <literal>ok</literal> PROM prompt. These procedures assume that the system has been cleanly
shut down, unless stated otherwise.</para>
<para>Use the <command>who -r</command> command to verify that the system is brought
to the specified run level. For a description of run levels, see <olink remap="external" targetdoc="chapter-14.xml" targetptr="hbrunlevels-25516">Chapter 14, Managing Services (Overview)</olink>.</para>
<sect2>
<title/>
<task arch="sparc" id="hbsparcboot-36744">

<title>
How to Boot a System to Run Level
3 (Multiuser Level)</title>
<tasksummary>
<para>Use this procedure to boot a system that is currently at run level 0 to run
level 3.</para>
</tasksummary>
<procedure>
<step xml:id="hbsparcboot-step-49">
<para>
<indexterm xml:id="hbsparcboot-ix998">
<primary>run level</primary>
<secondary>3 (multiuser with NFS)</secondary>
<tertiary>booting to</tertiary>
</indexterm>Boot the system to run level 3. </para>
<screen>ok <userinput>boot</userinput>
</screen>
<para>The automatic boot procedure displays a series of startup messages, and brings
the system to run level 3. For more information, see the <olink remap="external" targetdoc="819-2240" targetptr="boot-1m">
<citerefentry>
<refentrytitle>boot</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man page.</para>
</step>
<step xml:id="hbsparcboot-step-50">
<para>Verify that the system has booted to run level
3.</para>
<para>The login prompt is displayed when the boot process has finished successfully.</para>
<screen>
<replaceable>hostname</replaceable> console login:</screen>
</step>
</procedure>
<example arch="sparc">

<title>
Booting a System to Run Level 3 (Multiuser Level)</title>
<para>The following example displays the messages from booting a system to run level
3.</para>
<screen width="100">ok <userinput>boot</userinput>
Sun Ultra 5/10 UPA/PCI (UltraSPARC-IIi 333MHz)
OpenBoot 3.15, 128 MB memory installed, Serial #<replaceable>number</replaceable>.
Ethernet address <replaceable>number</replaceable>, Host ID: <replaceable>number</replaceable>.

Rebooting with command: boot
Boot device: /pci@1f,0/pci@1,1/ide@3/disk@0,0:a  File and args: kernel/sparcv9/unix
SunOS Release 5.10 Version s10_60 64-bit
Copyright 1983-2004 Sun Microsystems, Inc.  All rights reserved.
Use is subject to license terms.
configuring IPv4 interfaces: hme0.
add net default: gateway 172.20.27.248
Hostname: starlite
The system is coming up.  Please wait.
NIS domain name is example.com
starting rpc services: rpcbind keyserv ypbind done.
Setting netmask of hme0 to 255.255.255.0
Setting default IPv4 interface for multicast: add net 224.0/4: gateway starlite
syslog service starting.The system is ready.
Starting Sun(TM) Web Console Version 2.1-dev..
volume management starting.
The system is ready.
starlite console login: </screen>
<para>In the preceding example, <emphasis>sparcv9</emphasis> was used as an example
only. This string matches the output of the <command>isainfo</command> <option>
k</option> command.</para>
</example>
</task>
</sect2>
<sect2>
<title/>
<task arch="sparc" id="hbsparcboot-83723">

<title>
How to Boot a System to Run Level
S (Single-User Level)</title>
<tasksummary>
<para>Use this procedure to boot a system that is currently at run level 0 to run
level S.  This run level is used for system maintenance tasks, such as backing up
a file system.</para>
</tasksummary>
<procedure>
<step xml:id="hbsparcboot-step-12">
<para>
<indexterm xml:id="hbsparcboot-ix999">
<primary>booting</primary>
<secondary>to run level S</secondary>
<tertiary>SPARC</tertiary>
</indexterm>
<indexterm xml:id="hbsparcboot-ix1000">
<primary>run level</primary>
<secondary>s or S (single-user state)</secondary>
<tertiary>booting to</tertiary>
</indexterm>Boot the system to run level S.</para>
<screen>ok <userinput>boot -s</userinput>
</screen>
</step>
<step xml:id="hbsparcboot-step-55">
<para>Type the superuser password when the following
message is displayed:</para>
<screen>SINGLE USER MODE

Root password for system maintenance (control-d to bypass): <userinput>xxxxxx</userinput>
</screen>
</step>
<step xml:id="hbsparcboot-step-13">
<para>Verify that the system is at run level S.</para>
<screen># <userinput>who -r</userinput>
.       run-level S  Jun 10 15:27     3      0 </screen>
</step>
<step>
<para>Perform the maintenance task that required the run level change to S.</para>
</step>
<step xml:id="hbsparcboot-step-14">
<para>After you complete the system maintenance task,
type Control-D to bring the system to the multiuser state.</para>
</step>
</procedure>
<example arch="sparc">

<title>
Booting a System to Run Level S (Single-User Level)</title>
<para>The following example displays the messages from booting a system to run level
S.</para>
<screen>ok <userinput>boot -s</userinput>
.
.
.
Sun Microsystems Inc.   SunOS 5.10
Copyright 1983-2003 Sun Microsystems, Inc.  All rights reserved.
Use is subject to license terms.
configuring IPv4 interfaces: hme0.
Hostname: starlite

SINGLE USER MODE

Root password for system maintenance (control-d to bypass): <userinput>xxxxxx</userinput>
single-user privilege assigned to /dev/console.
Entering System Maintenance Mode
Oct 14 15:01:28 su: 'su root' succeeded for root on /dev/console
Sun Microsystems Inc.   SunOS 5.10
# <userinput>who -r</userinput>
   .       run-level S  Sep 19 08:49     S      0  ?
<lineannotation>(Perform some maintenance task)</lineannotation>
# <userinput>^D</userinput>
</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task arch="sparc" id="hbsparcboot-66353">

<title>
How to Boot a System Interactively</title>
<tasksummary>
<para>Use this boot option when you need to specify an alternate kernel or <filename>/etc/system</filename> file.</para>
</tasksummary>
<procedure>
<step xml:id="hbsparcboot-step-17">
<para>
<indexterm xml:id="hbsparcboot-ix1002">
<primary>booting</primary>
<secondary>interactively (how to)</secondary>
<tertiary>SPARC</tertiary>
</indexterm>Boot the system interactively.</para>
<screen>ok <userinput>boot -a</userinput>
</screen>
</step>
<step xml:id="hbsparcboot-step-18">
<para>Answer the following system prompts:</para>
<substeps>
<step>
<para>When prompted, enter the name of the kernel to use for booting.</para>
<para>Press enter to use the default kernel file name. Otherwise, provide the name
of an alternate kernel, press Enter.</para>
</step>
<step>
<para>When prompted, provide an alternate path for the <filename>modules</filename> directories.</para>
<para>Press enter to use the default module directories. Otherwise, provide
the alternate paths to module directories, press Enter.</para>
</step>
<step>
<para>When prompted, provide the name of an alternate system file.</para>
<para>Type <filename>/dev/null</filename> if your <filename>/etc/system</filename> file
has been damaged. </para>
</step>
<step>
<para>When prompted, enter the <literal>root</literal> filesystem type.</para>
<para>Press enter to select UFS for local disk booting, which is the default, or enter <literal>NFS</literal> for network booting.</para>
</step>
<step>
<para>When prompted, enter the physical name of <literal>root</literal> device. </para>
<para>Provide an alternate device name or press return to use the default.</para>
</step>
</substeps>
</step>
<step xml:id="hbsparcboot-step-56">
<para>If you are not prompted to answer these questions,
verify that you typed the <command>boot</command> <option>
a</option> command correctly.</para>
</step>
</procedure>
<example arch="sparc">

<title>
Booting a System Interactively</title>
<para>In the following example, the default choices (shown in square brackets <literal>[]</literal>) are accepted.</para>
<screen width="100">ok <userinput>boot -a</userinput>
.
.
.
Rebooting with command: boot -a
Boot device: /pci@1f,0/pci@1,1/ide@3/disk@0,0:a  
File and args: -a
Enter filename [kernel/sparcv9/unix]: <lineannotation>Press Return</lineannotation>
Enter default directory for modules [/platform/SUNW,Ultra-5_10/kernel 
     /platform/sun4u/kernel /kernel /usr/kernel]: <lineannotation>Press Return</lineannotation>
Name of system file [etc/system]: <lineannotation>Press Return</lineannotation>
SunOS Release 5.10 Version S10_60 64-bit
Copyright (c) 1983-2004 by Sun Microsystems, Inc. All rights reserved
Use is subject to license terms.
root filesystem type [ufs]: <lineannotation>Press Return</lineannotation>
Enter physical name of root device
[/pci@1f,0/pci@1,1/ide@3/disk@0,0:a]: <lineannotation>Press Return</lineannotation>
configuring IPv4 interfaces: hme0.
Hostname: starlite
The system is coming up.  Please wait.
checking ufs filesystems
.
.
.
The system is ready.
starlite console login:</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task arch="sparc" id="hbsparcboot-60">

<title>
How to Boot a System From the Network</title>
<tasksummary>
<para>Any system can boot from the network if a boot server is available. You might
want to boot a stand-alone system from the network if the system cannot boot from
the local disk. For information on changing or resetting the default boot device,
see <olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-61766">
How to Change the Default Boot Device</olink>.</para>
<para>Two network configuration boot strategies are available on sun–4u systems: </para>
<itemizedlist>
<listitem>
<para>RARP – Reverse Address Resolution Protocol and ONC+ RPC Bootparams
Protocol</para>
</listitem>
<listitem>
<para>DHCP – Dynamic Host Configuration Protocol</para>
</listitem>
</itemizedlist>
<para>The default network boot strategy is set to RARP. You can use either protocol,
depending on whether a RARP boot server or a DHCP boot server is available on your
network.</para>
<note>

<para>Sun Ultra systems must have PROM version 3.25.<replaceable>nn</replaceable> or
later to use the DHCP network boot strategy. For information on determining your PROM
version, see <olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-68368">
How to Find the PROM Revision Number for a System</olink>.</para>
</note>
<para>If both protocols are available, you can temporarily specify which protocol
to use in the <command>boot</command> command. Or, you can save the network boot strategy
across system reboots at the PROM level by setting up an NVRAM alias. The following
example uses the <command>nvalias</command> command to set up a network device alias
for booting DHCP by default on a Sun Ultra 10 system.</para>
<screen>ok <userinput>nvalias net	/pci@1f,4000/network@1,1:dhcp</userinput>
</screen>
<para>As a result, when you type <command>boot net</command>, the system boots by
using the DHCP network book strategy.</para>
<note>

<para>You should not use the <command>nvalias</command> command to modify the <filename>NVRAMRC</filename> file, unless you are very familiar with the syntax of this command
and the <command>nvunalias</command> command. For information on using these commands,
see the <citetitle>OpenBoot 3.x Command Reference Manual</citetitle>.</para>
</note>
</tasksummary>
<taskprerequisites>

<para>You must have already set up a RARP or DHCP boot server in your network to use
either protocol to boot successfully.</para>
</taskprerequisites>
<procedure>
<step>
<para>If necessary, shut down the system.</para>
</step>
<step xml:id="hbsparcboot-step-72">
<para>Determine the method for booting from the network,
and select one of the following:</para>
<substeps>
<step>
<para>Boot the system from the network by using the DHCP strategy.</para>
<screen>ok <userinput>boot net</userinput>[<userinput>:dhcp</userinput>]</screen>
<para>If you have changed the PROM setting to boot DHCP by default, as in the preceding <command>nvalias</command> example, you only have to specify <command>boot net</command>.</para>
</step>
<step xml:id="hbsparcboot-step-73">
<para>Boot the system from the network by using the
RARP strategy.</para>
<screen>ok <userinput>boot net</userinput>[<userinput>:rarp</userinput>]</screen>
<para>Because RARP is the default network boot strategy, you only have to specify <command>boot net:rarp</command> if you have changed the PROM value to boot DHCP.</para>
</step>
</substeps>
</step>
</procedure>
</task>
</sect2>
<sect2>
<title/>
<task arch="sparc" id="hbsparcboot-50162">

<title>
How to Stop the System for Recovery
Purposes</title>
<procedure>
<step xml:id="hbsparcboot-step-31">
<para>
<indexterm xml:id="indexterm-114">
<primary>stopping</primary>
<secondary>a system for recovery purposes</secondary>
<tertiary>SPARC</tertiary>
</indexterm>Type the Stop key sequence for your system.</para>
<para>The monitor displays
the <literal>ok</literal> PROM prompt.</para>
<screen>ok</screen>
<para>
<indexterm xml:id="hbsparcboot-ix1006">
<primary>
<literal>Stop-A</literal> keys</primary>
</indexterm>
<indexterm xml:id="hbsparcboot-ix1007">
<primary>
<literal>L1-A</literal> keys</primary>
</indexterm>
<indexterm xml:id="hbsparcboot-ix1008">
<primary>
<literal>Break</literal> key</primary>
</indexterm>The specific Stop key sequence depends on your keyboard type. For example,
you can press Stop-A or L1-A. On terminals, press the Break key. </para>
</step>
<step xml:id="hbsparcboot-step-32">
<para>Synchronize the file systems.</para>
<screen>ok <userinput>sync</userinput>
</screen>
</step>
<step xml:id="hbsparcboot-step-33">
<para>When you see the <literal>syncing file systems...</literal> message, press the Stop key sequence again.</para>
</step>
<step xml:id="hbsparcboot-step-34">
<para>Type the appropriate <command>boot</command> command
to start the boot process.</para>
<para>For more information, see the <olink remap="external" targetdoc="819-2240" targetptr="boot-1m">
<citerefentry>
<refentrytitle>boot</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink> man page.</para>
</step>
<step xml:id="hbsparcboot-step-52">
<para>Verify that the system was booted to the specified
run level.</para>
<screen># <userinput>who -r</userinput>
 .       run-level 3  May  2 07:39     3      0  S</screen>
</step>
</procedure>
<example arch="sparc">

<title>
Stopping the System for Recovery Purposes</title>
<screen>
<lineannotation>Press Stop-A</lineannotation>
ok <userinput>sync</userinput>
syncing file systems...
<lineannotation>Press Stop-A</lineannotation>
ok <userinput>boot</userinput>
</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task arch="sparc" id="hbsparcboot-82678">

<title>
How to Boot a System for Recovery
Purposes</title>
<tasksummary>
<para>Use this procedure when an important file, such as <filename>/etc/passwd</filename>,
has an invalid entry and causes the boot process to fail. </para>
<para>Use the stop sequence described in this procedure if you do not know the <literal>root</literal> password or if you can't log in to the system. For more information,
see <olink remap="internal" targetdoc="chapter-10.xml" targetptr="hbsparcboot-50162">
How to Stop the System for Recovery Purposes</olink>.</para>
<para>Substitute the device name of the file system to be repaired for the <replaceable>device-name</replaceable> variable in the following procedure. If you need help identifying
a system's device names, refer to <olink remap="external" targetdoc="819-2723" targetptr="devconfig-27211">
<citetitle remap="section">Displaying Device Configuration Information</citetitle> in <citetitle remap="book">System Administration Guide: Devices and File Systems</citetitle>
</olink>.</para>
</tasksummary>
<procedure>
<step xml:id="hbsparcboot-step-68">
<para>Stop the system by using the system's Stop key
sequence.</para>
</step>
<step xml:id="hbsparcboot-step-21">
<para>Boot the system in single-user mode.</para>
<itemizedlist>
<listitem>
<para>Boot the system from the Solaris Software 1 CD or DVD,</para>
<itemizedlist>
<listitem>
<para>Insert the Solaris installation media into the drive.</para>
</listitem>
<listitem>
<para>Boot from the installation media in single-user mode.</para>
<screen>ok <userinput>boot cdrom -s</userinput>
</screen>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>Boot the system from the network if an installation server or remote
CD or DVD drive is not available.</para>
<screen>ok <userinput>boot net -s</userinput>
</screen>
</listitem>
</itemizedlist>
</step>
<step xml:id="hbsparcboot-step-22">
<para>Mount the file system that contains the file
with an invalid entry.</para>
<screen># <userinput>mount /dev/dsk/</userinput>
<replaceable>device-name</replaceable> <userinput>/a</userinput>
</screen>
</step>
<step xml:id="hbsparcboot-step-23">
<para>Change to the newly mounted file system.</para>
<screen># <userinput>cd /a/</userinput>
<replaceable>file-system</replaceable>
</screen>
</step>
<step xml:id="hbsparcboot-step-24">
<para>Set the terminal type.</para>
<screen># <userinput>TERM=</userinput>
<replaceable>sun</replaceable>
# <userinput>export TERM</userinput>
</screen>
</step>
<step xml:id="hbsparcboot-step-25">
<para>Remove the invalid entry from the file by using
an editor.</para>
<screen># <userinput>vi</userinput> <replaceable>filename</replaceable>
</screen>
</step>
<step xml:id="hbsparcboot-step-26">
<para>Change to the root (<filename>/</filename>) directory.</para>
<screen># <userinput>cd /</userinput>
</screen>
</step>
<step xml:id="hbsparcboot-step-27">
<para>Unmount the <filename>/a</filename> directory.</para>
<screen># <userinput>umount /a</userinput>
</screen>
</step>
<step xml:id="hbsparcboot-step-28">
<para>Reboot the system.</para>
<screen># <userinput>init 6</userinput>
</screen>
</step>
<step xml:id="hbsparcboot-step-51">
<para>Verify that the system booted to run level 3.</para>
<para>The login prompt is displayed when the boot process has finished successfully.</para>
<screen>
<replaceable>hostname</replaceable> console login:</screen>
</step>
</procedure>
<example arch="sparc">

<title>
Booting a System for Recovery Purposes (Damaged Password File)</title>
<para>
<indexterm xml:id="hbsparcboot-ix1004">
<primary>repairing the <filename>/etc/passwd</filename> file</primary>
<secondary>SPARC</secondary>
</indexterm>
<indexterm xml:id="hbsparcboot-ix1005">
<primary>
<filename>/etc/passwd</filename> file</primary>
<secondary>recovering</secondary>
<tertiary>SPARC</tertiary>
</indexterm>
<indexterm xml:id="indexterm-115">
<primary>
<filename>passwd</filename> file</primary>
<secondary>recovering</secondary>
<tertiary>SPARC</tertiary>
</indexterm>The following example shows how to repair an important system file (in
this case, <filename>/etc/passwd</filename>) after booting from a local CD-ROM. </para>
<screen>ok <userinput>boot cdrom -s</userinput>
# <userinput>mount /dev/dsk/c0t3d0s0 /a</userinput>
# <userinput>cd /a/etc</userinput>
# <userinput>TERM=vt100</userinput>
# <userinput>export TERM</userinput>
# <userinput>vi passwd</userinput>
<lineannotation>(Remove invalid entry)</lineannotation>
# <userinput>cd /</userinput>
# <userinput>umount /a</userinput>
# <userinput>init 6</userinput>
</screen>
</example>
<example arch="sparc">

<title>
Booting a System if You Forgot the <literal>root</literal> Password</title>
<para>
<indexterm xml:id="indexterm-116">
<primary>forget root password</primary>
<secondary>SPARC</secondary>
</indexterm>
<indexterm xml:id="indexterm-117">
<primary>root password, forget</primary>
<secondary>SPARC</secondary>
</indexterm>
<indexterm xml:id="indexterm-118">
<primary>recover root password (how to)</primary>
<secondary>SPARC</secondary>
</indexterm>
<indexterm xml:id="indexterm-119">
<primary>superuser (root) password, forget</primary>
<secondary>SPARC</secondary>
</indexterm>The following example shows how to boot the system from the network when
you have forgotten the <literal>root</literal> password. This example assumes that
the network boot server is already available. Be sure to apply a new <literal>root</literal> password after the system has rebooted.</para>
<screen>ok <userinput>boot net -s</userinput>
# <userinput>mount /dev/dsk/c0t3d0s0 /a</userinput>
# <userinput>cd /a/etc</userinput>
# <userinput>TERM=vt100</userinput>
# <userinput>export TERM</userinput>
# <userinput>vi shadow</userinput>
<lineannotation>(Remove root's encrypted password string)</lineannotation>
# <userinput>cd /</userinput>
# <userinput>umount /a</userinput>
# <userinput>init 6</userinput>
</screen>
</example>
</task>
</sect2>
<sect2 arch="sparc" xml:id="hbsparcboot-37">
<title>
Forcing a Crash Dump and Rebooting
the System</title>
<para>Forcing a crash dump and rebooting the system is sometimes necessary for troubleshooting
purposes. The <command>savecore</command> feature is enabled by default.</para>
<para>For more information on system crash dumps, see <olink remap="external" targetdoc="819-2380" targetptr="tscrashdumps-40145">Chapter 24, <citetitle remap="chapter">Managing System Crash Information (Tasks),</citetitle> in <citetitle remap="book">System Administration Guide: Advanced Administration</citetitle>
</olink>. </para>
<task arch="sparc" xml:id="hbsparcboot-70469">
<title>
How to Force a Crash Dump and Reboot
of the System</title>
<tasksummary>
<para>Use this procedure to force a crash dump of the system. The example that follows
this procedure shows how to use the <command>halt</command> <option>
d</option> command
to force a crash dump of the system. You will need to manually reboot the system after
running this command.</para>
</tasksummary>
<procedure>
<step xml:id="hbsparcboot-step-39">
<para>Type the stop key sequence for your system.</para>
<para>The specific stop key sequence depends on your keyboard type. For example, you
can press Stop-A or L1-A. On terminals, press the Break key.</para>
<para>The PROM
displays the <literal>ok</literal> prompt.</para>
</step>
<step xml:id="hbsparcboot-step-40">
<para>
<indexterm xml:id="hbsparcboot-ix1010">
<primary>
<command>sync</command> command</primary>
</indexterm>
<indexterm xml:id="hbsparcboot-ix1011">
<primary>synchronize file systems with <command>sync</command> command</primary>
</indexterm>Synchronize the file systems and write the crash dump.  </para>
<screen>&gt; <userinput>n</userinput>
ok <userinput>sync</userinput>
</screen>
<para>After the crash dump is written to disk, the system will continue to reboot.</para>
</step>
<step xml:id="hbsparcboot-step-53">
<para>Verify the system boots to run level 3.</para>
<para>The login prompt is displayed when the boot process has finished successfully.</para>
<screen>
<replaceable>hostname</replaceable> console login:</screen>
</step>
</procedure>
<example>

<title>
Forcing a Crash Dump and Reboot of the System by Using the <command>halt</command> <option>
d</option> Command</title>
<para>This example shows how to force a crash dump and reboot of the system <literal>jupiter</literal> by using the <command>halt</command> <option>
d</option> and <command>boot</command> command. Use this method to force a crash dump and reboot of the system.</para>
<screen># <userinput>halt -d</userinput>
Jul 21 14:13:37 jupiter halt: halted by root

panic[cpu0]/thread=30001193b20: forced crash dump initiated at user request

000002a1008f7860 genunix:kadmin+438 (b4, 0, 0, 0, 5, 0)
  %l0-3: 0000000000000000 0000000000000000 0000000000000004 0000000000000004
  %l4-7: 00000000000003cc 0000000000000010 0000000000000004 0000000000000004
000002a1008f7920 genunix:uadmin+110 (5, 0, 0, 6d7000, ff00, 4)
  %l0-3: 0000030002216938 0000000000000000 0000000000000001 0000004237922872
  %l4-7: 000000423791e770 0000000000004102 0000030000449308 0000000000000005

syncing file systems... 1 1 done
dumping to /dev/dsk/c0t0d0s1, offset 107413504, content: kernel
100% done: 5339 pages dumped, compression ratio 2.68, dump succeeded
Program terminated
ok boot
Resetting ... 

Sun Ultra 5/10 UPA/PCI (UltraSPARC-IIi 333MHz), No Keyboard
OpenBoot 3.15, 128 MB memory installed, Serial #10933339.
Ethernet address 8:0:20:a6:d4:5b, Host ID: 80a6d45b.

Rebooting with command: boot
Boot device: /pci@1f,0/pci@1,1/ide@3/disk@0,0:a
File and args: kernel/sparcv9/unix
SunOS Release 5.10 Version s10_60 64-bit
Copyright 1983-2004 Sun Microsystems, Inc.  All rights reserved.
Use is subject to license terms.
configuring IPv4 interfaces: hme0.
add net default: gateway 172.20.27.248
Hostname: jupiter
The system is coming up.  Please wait.
NIS domain name is example.com
.
.
.
System dump time: Wed Jul 21 14:13:41 2004
Jul 21 14:15:23 jupiter savecore: saving system crash dump
in /var/crash/jupiter/*.0
Constructing namelist /var/crash/jupiter/unix.0
Constructing corefile /var/crash/jupiter/vmcore.0
100% done: 5339 of 5339 pages saved

Starting Sun(TM) Web Console Version 2.1-dev...
.
.
.</screen>
</example>
</task>
</sect2>
<sect2>
<title/>
<task arch="sparc" id="euayz">

<title>
How to Boot the System With the Kernel Debugger
(<command>kmdb</command>)</title>
<tasksummary>
<para>This procedure shows you the basics for loading the kernel debugger (<command>kmdb</command>). For more detailed information, see the <citetitle>Solaris Modular
Debugger Guide</citetitle>.</para>
</tasksummary>
<procedure>
<step>
<para>Halt the system, causing it to display the <literal>ok</literal> prompt.</para>
<para>To halt the system gracefully, use the <command>/usr/sbin/halt</command> command.</para>
</step>
<step>
<para>Type either <command>boot kmdb</command> or <command>boot <option>
k</option>
</command> to
request the loading of the kernel debugger. Press return.</para>
</step>
<step>
<para>Enter the kernel debugger.</para>
<para>The method used to enter the debugger
is dependent upon the type of console that is used to access the system:</para>
<itemizedlist>
<listitem>
<para>If a locally attached keyboard is being used, press Stop-A or L1–A,
depending upon the type of keyboard.</para>
</listitem>
<listitem>
<para>If a serial console is being used, send a break by using the method
that is appropriate for the type of serial console that is being used.</para>
</listitem>
</itemizedlist>
<para>A welcome message is displayed when you enter the kernel debugger for the first
time.</para>
<screen>Rebooting with command: kadb
Boot device: /iommu/sbus/espdma@4,800000/esp@4,8800000/sd@3,0
.
.
.</screen>
</step>
</procedure>
<example arch="sparc">

<title>
Booting the System With the Kernel Debugger (<command>kmdb</command>)</title>
<screen>ok <userinput>boot kmdb</userinput>
Resetting...

Executing last command: boot kmdb -d
Boot device: /pci@1f,0/ide@d/disk@0,0:a File and args: kmdb -d
Loading kmdb...</screen>
</example>
</task>
</sect2>
</sect1>
</chapter>
