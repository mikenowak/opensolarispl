<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML//EN" "docbook.dtd"[
	<!ENTITY % xinclude SYSTEM "xinclude.mod">
	%xinclude;
]>

<chapter xmlns="http://docbook.org/ns/docbook" version="5.0" xml:id="printref-76596">



<title>LP Print Service (Reference)</title>
<toc>
<para>This chapter provides the following reference information about the
LP print service.</para>
<itemizedlist>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-7.xml" targetptr="printref-18623">Structure of the LP Print Service</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-7.xml" targetptr="printref-92628">LP Print Service Commands</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-7.xml" targetptr="printref-37">Functions of the LP Print Service</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-7.xml" targetptr="printref-38">How LP Administers Files and Schedules Local Print Requests</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-7.xml" targetptr="printref-40">Scheduling Network Print Requests</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-7.xml" targetptr="printref-53457">Filtering Print Files</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-7.xml" targetptr="printref-41">What the Printer Interface Program Does</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-7.xml" targetptr="printref-42">How the <command>lpsched</command> Daemon Tracks the Status of Print Requests</olink>
</para>
</listitem>
<listitem>
<para>
<olink remap="internal" targetdoc="chapter-7.xml" targetptr="printref-46">Cleaning Out Log Files</olink>
</para>
</listitem>
</itemizedlist>
</toc>
<sect1 xml:id="printref-15">
<title>Printer Tasks</title>
<informaltable frame="topbot">
<tgroup cols="2" colsep="0" rowsep="0">
<colspec colname="colspec2" colwidth="50*"/>
<colspec colname="colspec3" colwidth="50*"/>
<thead>
<row rowsep="1">
<entry>
<para>Printer Task</para>
</entry>
<entry>
<para>For More Information</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>Set up printers with Solaris Print Manager and the <command>lp</command> commands</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="chapter-3.xml" targetptr="printsetup-33230">Chapter 3, Setting Up Printers (Tasks)</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Administer printers with the <command>lp</command> commands after the
printers are setup</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="chapter-4.xml" targetptr="printadmin-15883">Chapter 4, Administering Printers (Tasks)</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Manage character sets, filters, forms, and fonts</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="chapter-5.xml" targetptr="printforms-12319">Chapter 5, Managing Character Sets, Filters, Forms, and Fonts (Tasks)</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>Customize the LP print service</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="chapter-6.xml" targetptr="printcust-66310">Chapter 6, Customizing the LP Print Service (Tasks)</olink>
</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1>
<sect1 xml:id="printref-31909">
<title>Definition of the LP Print Service</title>
<para>
<indexterm xml:id="printref-ix163">
<primary>LP print service</primary>
<secondary>definition</secondary>
</indexterm>The <emphasis>LP print service</emphasis> is a set of software
utilities that allows users to print files while users continue to work. Originally,
the print service was called the <emphasis>LP spooler</emphasis>. <emphasis>LP</emphasis> represents
line printer, but the meaning now includes many other types of printers, such
as laser printers. <emphasis>Spool</emphasis> is an acronym for system peripheral
operation off-line.</para>
<para>The print service consists of the LP print service software, any print
filters you might provide, and the hardware, such as the printer, system,
and network connections.</para>
</sect1>
<sect1 xml:id="printref-18623">
<title>Structure of the LP Print Service</title>
<indexterm xml:id="printref-ix164">
<primary>LP print service</primary>
<secondary>structure of</secondary>
</indexterm>
<para>This section describes the directory structure, files and logs of the
LP print service.</para>
<sect2 xml:id="printref-32">
<title>LP Print Service Directories</title>
<para>
<indexterm xml:id="printref-ix166">
<primary>LP print service</primary>
<secondary>directories in</secondary>
</indexterm>The files of the LP print service are distributed among the directories
that are shown in the following table.</para>
<table frame="topbot" xml:id="printref-64046">

<title>Directories for the LP Print
Service</title>
<tgroup cols="2" colsep="0" rowsep="0">
<colspec colname="column1" colwidth="108*"/>
<colspec colname="column2" colwidth="252*"/>
<thead>
<row rowsep="1">
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Contents</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>
<filename>/usr/bin</filename>
</para>
</entry>
<entry>
<para>The LP print service user commands.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/etc/lp</filename>
</para>
</entry>
<entry>
<para>A hierarchy of LP server configuration files.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/usr/share/lib</filename>
</para>
</entry>
<entry>
<para>The <filename>terminfo</filename> database directory.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/usr/lib/print</filename>
</para>
</entry>
<entry>
<para>The <command>lp</command> conversion scripts, <command>in.lpd</command> daemon,
and the <command>printd</command> daemon. The <command>printd</command> daemon
transfers all pending jobs in the<filename>/var/spool/print</filename> directory
once per minute. When no jobs are remaining to transfer, the <command>printd</command> daemon
exits.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/usr/sbin</filename>
</para>
</entry>
<entry>
<para>The LP print service administrative commands</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/usr/lib/lp</filename>
</para>
</entry>
<entry>
<para>The <command>lpsched</command> program, binary files, PostScript filters,
and the <filename>model</filename> directory, which contains the standard
printer interface program.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/var/lp/logs</filename>
</para>
</entry>
<entry>
<para>LP log files such as <filename>lpsched.</filename>
<replaceable>n</replaceable> (which
includes messages from <literal>lpsched</literal>) and <filename>requests.</filename>
<replaceable>n</replaceable> (which includes information about completed print requests).</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/var/spool/lp</filename>
</para>
</entry>
<entry>
<para>The spooling directory where files are queued for printing.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/var/spool/print</filename>
</para>
</entry>
<entry>
<para>The staging area for LP print service client-side requests.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/etc/lp/model/uri</filename>
</para>
</entry>
<entry>
<para>The location of the interface script that process <replaceable>device-uri</replaceable> information.</para>
</entry>
</row>
</tbody>
</tgroup>
</table>
</sect2>
<sect2 xml:id="printref-11882">
<title>LP Print Service Configuration Files</title>
<indexterm xml:id="printref-ix167">
<primary>LP print service</primary>
<secondary>configuration files in</secondary>
</indexterm>
<para>The <command>lpsched</command> daemon stores configuration information
 in the <filename>/etc/lp</filename> directory, as described in the following
table.</para>
<caution>

<para>
<indexterm xml:id="printref-ix168">
<primary>private interfaces</primary>
</indexterm>
<indexterm xml:id="indexterm-124">
<primary>Expanded Printer Support</primary>
<secondary>private interfaces</secondary>
</indexterm>
<indexterm xml:id="printref-ix169">
<primary>
<filename>/etc/lp</filename> directory</primary>
</indexterm>The configuration files listed in this table are private interfaces.
These files are subject to change in future releases. You should not build
software that relies on these files being in their current locations or that
relies on the data being in the format currently used. </para>
</caution>
<table frame="topbot" xml:id="printref-69325">

<title>Contents of the <filename>/etc/lp</filename> Directory</title>
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colname="column1" colwidth="87*"/>
<colspec colname="column2" colwidth="110*"/>
<colspec colname="column3" colwidth="162*"/>
<thead>
<row rowsep="1">
<entry>
<para>File</para>
</entry>
<entry>
<para>Type</para>
</entry>
<entry>
<para>Description</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>
<filename>classes</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Files identifying classes provided by the <command>lpadmin -c</command> command.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>fd</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Description of existing filters.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>filter.table</filename>
</para>
</entry>
<entry>
<para>File</para>
</entry>
<entry>
<para>Print filter look-up table.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>forms</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Location to put files for each form. Initially, this directory is empty.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>interfaces</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Printer interface program files.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>logs</filename>
</para>
</entry>
<entry>
<para>Link to <filename>/var/lp/logs</filename>
</para>
</entry>
<entry>
<para>Log files of printing activities.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>model</filename>
</para>
</entry>
<entry>
<para>Link to <filename>/usr/lib/lp/model</filename>
</para>
</entry>
<entry>
<para>The standard printer interface program.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>printers</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Directories for each local printer. Each directory contains configuration
information and alert files for an individual printer.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>pwheels</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Print wheel files or cartridge files.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>ppd</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Each local queue that is configured with a PPD file has a copy of the
PPD file placed here.</para>
</entry>
</row>
</tbody>
</tgroup>
</table>
<para>
<indexterm xml:id="printref-ix171">
<primary>
<filename>/etc/printcap</filename> file</primary>
</indexterm>These configuration files serve a function similar to the <filename>/etc/printcap</filename> file on <command>lpd</command>-based print servers. </para>
<note>

<para>You can check the contents of the configuration files, but you
should not edit these files directly. Instead, use the <command>lpadmin</command> command
to make configuration changes. Your changes are written to the configuration
files in the <filename>/etc/lp</filename> directory. The <filename>lpsched</filename> daemon
administers and updates the configuration files.</para>
</note>
<para>
<indexterm xml:id="printref-ix172">
<primary>
<filename>/etc/lp/printers</filename> directory</primary>
</indexterm>The <filename>/etc/lp/printers</filename> directory has a subdirectory
for each local printer that is known to the system. The following example
shows the <filename>/etc/lp/printers</filename> subdirectories of printers <literal>sparc1</literal> and <literal>luna</literal>. </para>
<screen>$ <userinput>ls -l /etc/lp/printers</userinput>
drwxrwxr-x 2 lp lp 512 Jan 23 23:53 luna
drwxrwxr-x 2 lp lp 512 Jan 11 17:50 sparc1</screen>
<para>The following table describes the files within each printer-specific
directory.</para>
<informaltable frame="topbot">
<tgroup cols="2" colsep="0" rowsep="0">
<colspec colname="colspec0" colwidth="50*"/>
<colspec colname="colspec1" colwidth="50*"/>
<thead>
<row rowsep="1">
<entry>
<para>File Name</para>
</entry>
<entry>
<para>Description</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>
<filename>alert.sh</filename>
</para>
</entry>
<entry>
<para>Shell to execute in response to alerts</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>alert.vars</filename>
</para>
</entry>
<entry>
<para>Alert variables</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>configuration</filename>
</para>
</entry>
<entry>
<para>Configuration file</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>users.deny</filename>
</para>
</entry>
<entry>
<para>List of users to whom printer access is denied</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>comment</filename>
</para>
</entry>
<entry>
<para>Printer description</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>The configuration file for the printer <command>luna</command>, <filename>/etc/lp/printers/luna/configuration</filename>, would typically appear as follows:</para>
<screen>Banner: on: Always
Content types: PS
Device: /dev/term/b
Interface: /usr/lib/lp/model/standard
Printer type: PS
Modules: default</screen>
</sect2>
<sect2 xml:id="printref-33">
<title>The <filename>terminfo</filename> Database</title>
<indexterm xml:id="printref-ix173">
<primary>printer type</primary>
<secondary>defined in <filename>terminfo</filename> database</secondary>
</indexterm>
<para>The <filename>/usr/share/lib</filename> directory contains the <filename>terminfo</filename> database directory. This directory contains definitions for many
types of terminals and printers. The LP print service uses information in
the <filename>terminfo</filename> database to perform the following tasks:</para>
<itemizedlist>
<listitem>
<para>Initializes a printer</para>
</listitem>
<listitem>
<para>Establishes a selected page size, character pitch, line pitch,
and character set</para>
</listitem>
<listitem>
<para>Communicates the sequence of codes to a printer</para>
</listitem>
</itemizedlist>
<para>Each printer is identified in the <filename>terminfo</filename> database
with a short name. For a description of the structure of the <filename>terminfo</filename> database,
see <olink remap="external" targetdoc="chapter-2.xml" targetptr="printplan-15">Printer Type</olink>. If necessary, you
can add entries to the <filename>terminfo</filename> database, but doing so
is tedious and time-consuming For more information, see <olink remap="external" targetdoc="chapter-6.xml" targetptr="printcust-11157">Adding a <literal>terminfo</literal> Entry for an Unsupported Printer</olink>.</para>
</sect2>
<sect2 xml:id="printref-34">
<title>Daemons and LP Internal Files</title>
<para>
<indexterm xml:id="printref-ix174">
<primary>LP print service</primary>
<secondary>daemons</secondary>
</indexterm>
<indexterm xml:id="printref-ix175">
<primary>daemons</primary>
<secondary>print</secondary>
</indexterm>
<indexterm xml:id="printref-ix177">
<primary>print daemons</primary>
</indexterm>
<indexterm xml:id="printref-ix179">
<primary>files</primary>
<secondary>used by LP print service</secondary>
</indexterm>
<indexterm xml:id="printref-ix180">
<primary>LP print service</primary>
<secondary>files used by</secondary>
</indexterm>The <filename>/usr/lib/lp</filename> directory contains daemons
and files used by the LP print service, as described in the following table.
      </para>
<table frame="topbot" xml:id="printref-86958">

<title>Contents of the <filename>/usr/lib/lp</filename> Directory</title>
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colname="column1" colwidth="79*"/>
<colspec colname="column2" colwidth="100*"/>
<colspec colname="column3" colwidth="180*"/>
<thead>
<row rowsep="1">
<entry>
<para>File</para>
</entry>
<entry>
<para>Type</para>
</entry>
<entry>
<para>Description</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>
<filename>bin</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Contains files for generating printing alerts, slow filters, and queue
management programs.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>model</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Contains the standard printer interface program.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>postscript</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Contains all PostScript filter programs provided by the LP print service.
These filters come with descriptor files in the <filename>/etc/lp/fd</filename> directory.
These files tell the LP print service the characteristics of the filters and
where to locate them.</para>
</entry>
</row>
</tbody>
</tgroup>
</table>
</sect2>
<sect2 xml:id="printref-22672">
<title>LP Print Service Log Files</title>
<indexterm xml:id="printref-ix181">
<primary>log files</primary>
<secondary>for LP print service</secondary>
</indexterm>
<para>
<indexterm xml:id="printref-ix182">
<primary>LP print service</primary>
<secondary>log files</secondary>
</indexterm>The LP print service maintains two sets of log files that are
described in the following table.</para>
<informaltable frame="topbot">
<tgroup cols="2" colsep="0" rowsep="0">
<colspec colname="colspec2" colwidth="50*"/>
<colspec colname="colspec3" colwidth="50*"/>
<thead>
<row rowsep="1">
<entry>
<para>Log File Name</para>
</entry>
<entry>
<para>Description</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>
<command>syslogd</command>
</para>
</entry>
<entry>
<para>Set <literal>lpr.debug</literal> in <filename>/etc/syslog.conf</filename> to
enable LP print service logging</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/var/spool/lp</filename>
</para>
</entry>
<entry>
<para>A list of current requests that are in the print queue</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>/var/lp/logs/requests</filename>
</para>
</entry>
<entry>
<para>An ongoing history of print requests</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect2>
<sect2 xml:id="printref-35">
<title>Print Queue Logs</title>
<indexterm xml:id="printref-ix183">
<primary>print queue</primary>
<secondary>log of</secondary>
</indexterm>
<indexterm xml:id="printref-ix184">
<primary>log files</primary>
<secondary>print queue</secondary>
</indexterm>
<para>
<indexterm xml:id="printref-ix185">
<primary>
<filename>/var/spool/lp/tmp</filename> directory</primary>
</indexterm>
<indexterm xml:id="printref-ix186">
<primary>
<filename>/var/spool/lp/requests</filename> directory</primary>
</indexterm>The scheduler for each system keeps a log of print requests in
the <filename>/var/spool/lp/tmp/</filename>
<replaceable>system</replaceable> and <filename>/var/spool/lp/requests/</filename>
<replaceable>system</replaceable> directories.
Each print request has two files, one file in each directory, that contain
information about the request. The information in the <filename>/var/spool/lp/requests/</filename>
<replaceable>system</replaceable> directory can be accessed only
by superuser or <literal>lp</literal>. The information in the <filename>/var/spool/lp/tmp/</filename>
<replaceable>system</replaceable> directory can be accessed only
by the user who submitted the request, superuser, or <literal>lp</literal>.</para>
<para>The following example shows the contents of the <filename>/var/spool/lp/tmp/starbug</filename> directory:</para>
<screen>$ <userinput>ls /var/spool/lp/tmp/starbug</userinput>
5     5-0
# <userinput>cat 5-0</userinput>
C 1
D print1
F /etc/profile
P 20
T /etc/profile
t simple
U root
s 0000
v 2</screen>
<para>These files remain in their directories only as long as the print request
is in the queue. Once the print request is finished, the information in the
files is combined and appended to the <filename>/var/lp/logs/requests</filename> file.
This file is described in the next section.</para>
<para>Use the information in the <filename>/var/spool/lp/logs</filename> directory
if you need to track the status of a print request that is currently in the
queue.</para>
</sect2>
<sect2 xml:id="printref-36">
<title>History Log Files</title>
<indexterm xml:id="printref-ix187">
<primary>history log (print requests)</primary>
</indexterm>
<indexterm xml:id="printref-ix188">
<primary>log files</primary>
<secondary>print request history log</secondary>
</indexterm>
<para>The LP print service records a history of printing services in two log
files, <filename>lpsched</filename> and <filename>requests</filename>. These
log files are located in the <filename>/var/lp/logs</filename> directory.
You can use the information in these log files to diagnose and troubleshoot
printing problems. An example of the contents of the <filename>/var/lp/logs</filename> directory
is as follows:</para>
<screen># <userinput>cd /var/lp/logs</userinput>
# <userinput>ls</userinput>
lpsched.1    requests    requests.2
lpsched      lpsched.2   requests.1
# </screen>
<para>The two most important log files for troubleshooting are the following:</para>
<itemizedlist>
<listitem>
<para>The <filename>lpsched</filename> log file — Contains
information about local printing requests.</para>
</listitem>
<listitem>
<para>The <filename>requests</filename> log file — Contains
information about print requests that are completed and no longer in the print
queue.</para>
</listitem>
</itemizedlist>
<para>The <filename>requests</filename> log file has a simple structure so
that you can extract data using common UNIX shell commands. Requests are listed
in the order they are printed. They are also separated by lines showing their
request IDs. Each line below the separator line, the line that starts with
=, is marked with a single letter that identifies the kind of information
contained in that line. Each letter is separated from the data by a single
space.</para>
<para>The following example shows the contents of a <filename>requests</filename> log
file:</para>
<screen># <userinput>pwd</userinput>
/var/lp/logs
# <userinput>tail requests.2</userinput>
= print1-3, uid 0, gid 1, size 206662, Wed Mar 14 08:56:30 MST 2003
z print1
C 1
D print1
F /usr/dict/words
P 20
T /usr/dict/words
t simple
U root
s 0x0014
v 2
#</screen>
<para>
<indexterm xml:id="printref-ix189">
<primary>print requests</primary>
<secondary>log</secondary>
</indexterm>
<indexterm xml:id="printref-ix190">
<primary>log files</primary>
<secondary>codes in request log</secondary>
</indexterm>The following table shows the letter codes and the content of
their corresponding lines in the <filename>requests</filename> log file.  </para>
<table frame="topbot" xml:id="printref-68125">

<title>Codes in the <filename>requests</filename> Log
File</title>
<tgroup cols="2" colsep="0" rowsep="0">
<colspec colname="column1" colwidth="71*"/>
<colspec colname="column2" colwidth="288*"/>
<thead>
<row rowsep="1">
<entry>
<para>Letter</para>
</entry>
<entry>
<para>Content of Line</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>
<literal>=</literal>
</para>
</entry>
<entry>
<para>The separator line, which contains the following items: request ID,
user ID (UID), and group IDs (GIDs) of the user, the total number of bytes
in the original (unfiltered) file size, and the time when the request was
queued.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>z</literal>
</para>
</entry>
<entry>
<para>The name of the printer.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>C</literal>
</para>
</entry>
<entry>
<para>The number of copies printed.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>D</literal>
</para>
</entry>
<entry>
<para>The printer or class destination, or the word <literal>any</literal>.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>F</literal>
</para>
</entry>
<entry>
<para>The name of the file printed. The line is repeated for each file printed.
Files were printed in the order shown.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>f</literal>
</para>
</entry>
<entry>
<para>(Optional) The name of the form used.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>H</literal>
</para>
</entry>
<entry>
<para>(Optional) One of three types of special handling: resume, hold, and
immediate. </para>
</entry>
</row>
<row>
<entry>
<para>
<literal>N</literal>
</para>
</entry>
<entry>
<para>(Optional) The type of alert used when the print request was successfully
completed. The type is the letter <literal>M</literal> if the user was notified
by email or <literal>W</literal> if the user was notified by a message to
the terminal.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>O</literal>
</para>
</entry>
<entry>
<para>(Optional) The printer-dependent <option>
o</option> options. For example, <literal>nobanner</literal>.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>P</literal>
</para>
</entry>
<entry>
<para>The priority of the print request.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>p</literal>
</para>
</entry>
<entry>
<para>The list of pages printed.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>r</literal>
</para>
</entry>
<entry>
<para>(Optional) A single-letter line that is included if the user asked for “raw”
processing of the files with the <command>lp -r</command> command.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>S</literal>
</para>
</entry>
<entry>
<para>(Optional) The character set, print wheel, or cartridge used.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>T</literal>
</para>
</entry>
<entry>
<para>The title placed on the banner page.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>t</literal>
</para>
</entry>
<entry>
<para>The type of content found in the files.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>U</literal>
</para>
</entry>
<entry>
<para>The name of the user who submitted the print request.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>s</literal>
</para>
</entry>
<entry>
<para>The outcome of the request, shown as a combination of individual bits
expressed in hexadecimal format. Several bits are used internally by the print
service. The bits and what they mean are described in the following table.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>v</literal>
</para>
</entry>
<entry>
<itemizedlist>
<listitem>
<para>0 — Identifies that the print job originated from the <command>in.1pd</command> print daemon or another system on the network.</para>
</listitem>
<listitem>
<para>2 — Identifies that the print job originated from the <command>/usr/bin/lp</command> or <command>/usr/ucb/lpr</command> commands.</para>
</listitem>
<listitem>
<para>1 — Identifies that the print job originated from an
older version of the print software.</para>
</listitem>
</itemizedlist>
</entry>
</row>
<row>
<entry>
<para>
<literal>x</literal>
</para>
</entry>
<entry>
<para>(Optional) The slow filter used for the print request.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>Y</literal>
</para>
</entry>
<entry>
<para>(Optional) The list of special modes for the print filters used to print
the request.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>z</literal>
</para>
</entry>
<entry>
<para>(Optional) The printer used for the request. This printer differs from
the destination (the <literal>D</literal> line) if the request was queued
for any printer or a class of printers, or if the request was moved to another
destination.</para>
</entry>
</row>
</tbody>
</tgroup>
</table>
<para>The following table shows the outcome codes in the LP <filename>requests</filename> log
file and their descriptions.</para>
<table frame="topbot" xml:id="printref-25174">

<title>Outcome Codes in the <filename>requests</filename> Log File</title>
<tgroup cols="2" colsep="0" rowsep="0">
<colspec colname="column1" colwidth="108*"/>
<colspec colname="column2" colwidth="252*"/>
<thead>
<row rowsep="1">
<entry>
<para>Outcome Code</para>
</entry>
<entry>
<para>Description</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>
<literal>0x0001</literal>
</para>
</entry>
<entry>
<para>The request was held pending resume.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0002</literal>
</para>
</entry>
<entry>
<para>Slow filtering is running.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0004</literal>
</para>
</entry>
<entry>
<para>Slow filtering finished successfully.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0008</literal>
</para>
</entry>
<entry>
<para>The request is on the printer.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0010</literal>
</para>
</entry>
<entry>
<para>Printing finished successfully.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0020</literal>
</para>
</entry>
<entry>
<para>The request was held pending user change.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0040</literal>
</para>
</entry>
<entry>
<para>The request was canceled.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0080</literal>
</para>
</entry>
<entry>
<para>The request will print next.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0100</literal>
</para>
</entry>
<entry>
<para>The request failed filtering or printing.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0200</literal>
</para>
</entry>
<entry>
<para>The request is in transit to a remote printer (obsolete).</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0400</literal>
</para>
</entry>
<entry>
<para>The user will be notified.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x0800</literal>
</para>
</entry>
<entry>
<para>A notification is running.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x1000</literal>
</para>
</entry>
<entry>
<para>A remote system has accepted the request (obsolete).</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x2000</literal>
</para>
</entry>
<entry>
<para>The administrator placed a hold on the request.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x4000</literal>
</para>
</entry>
<entry>
<para>The printer had to change filters.</para>
</entry>
</row>
<row>
<entry>
<para>
<literal>0x8000</literal>
</para>
</entry>
<entry>
<para>The request is temporarily stopped.</para>
</entry>
</row>
</tbody>
</tgroup>
</table>
</sect2>
<sect2 xml:id="printref-15219">
<title>Spooling Directories</title>
<indexterm xml:id="printref-ix191">
<primary>spooling directory</primary>
<secondary>print service</secondary>
</indexterm>
<indexterm xml:id="printref-ix192">
<primary>printing</primary>
<secondary>spooling directory</secondary>
</indexterm>
<para>
<indexterm xml:id="printref-ix193">
<primary>
<filename>/var/spool/lp</filename> directory</primary>
</indexterm>Files queued for printing are stored in the <filename>/var/spool/lp</filename> directory
until they are printed, which might be only seconds. The following table shows
the contents of the <filename>/var/spool/lp</filename> directory. </para>
<table frame="topbot" xml:id="printref-74445">

<title>Contents of the <filename>/var/spool/lp</filename> Directory</title>
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colname="column1" colwidth="88*"/>
<colspec colname="column2" colwidth="88*"/>
<colspec colname="column3" colwidth="220*"/>
<thead>
<row rowsep="1">
<entry>
<para>File</para>
</entry>
<entry>
<para>Type</para>
</entry>
<entry>
<para>Description</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>
<filename>SCHEDLOCK</filename>
</para>
</entry>
<entry>
<para>File</para>
</entry>
<entry>
<para>Lock file for the scheduler. Check for this file if the scheduler terminates
and will not restart.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>admins</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Link to <filename>/etc/lp</filename>
<command>.</command>
</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>bin</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Link to <filename>/usr/lib/lp/bin</filename>
<command>.</command>
</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>logs</filename>
</para>
</entry>
<entry>
<para>Link</para>
</entry>
<entry>
<para>Link to <filename>../lp/logs</filename> where completed print requests
are logged.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>model</filename>
</para>
</entry>
<entry>
<para>Link</para>
</entry>
<entry>
<para>Link to <filename>/usr/lib/lp/model</filename>
<command>.</command>
</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>requests</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Directory that contains subdirectories for each configured printer where
print requests are logged until printed. Users cannot access this log.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>system</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>A print status file for the system.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>temp</filename>
</para>
</entry>
<entry>
<para>Link</para>
</entry>
<entry>
<para>Link to <filename>/var/spool/lp/tmp/</filename>
<replaceable>hostname</replaceable>,
which contains the spooled requests.</para>
</entry>
</row>
<row>
<entry>
<para>
<filename>tmp</filename>
</para>
</entry>
<entry>
<para>Directory</para>
</entry>
<entry>
<para>Directory for each configured printer where print requests are logged
until printed. Changes to existing print requests are also recorded in this
directory.</para>
</entry>
</row>
</tbody>
</tgroup>
</table>
</sect2>
</sect1>
<sect1 xml:id="printref-92628">
<title>LP Print Service Commands</title>
<para>The following table lists frequently used LP print service commands.
You must be superuser, <literal>lp</literal>, or assume an equivalent role
to use the <filename>1M</filename> commands.</para>
<table frame="topbot" xml:id="printref-16924">

<title>Quick Reference to LP Print
Service Commands</title>
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colname="column1" colwidth="108*"/>
<colspec colname="colspec1" colwidth="108.00*"/>
<colspec colname="colspec0" colwidth="108.00*"/>
<thead>
<row rowsep="1">
<entry>
<para>Command</para>
</entry>
<entry>
<para>Task</para>
</entry>
<entry>
<para>Man Page</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry>
<para>
<command>enable</command>
</para>
</entry>
<entry>
<para>Activate a printer</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2239" targetptr="enable-1">
<citerefentry>
<refentrytitle>enable</refentrytitle>
<manvolnum>
1
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>cancel</command>
</para>
</entry>
<entry>
<para>Cancel a print request</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2239" targetptr="cancel-1">
<citerefentry>
<refentrytitle>cancel</refentrytitle>
<manvolnum>
1
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>lp</command>
</para>
</entry>
<entry>
<para>Send one or more file or files to a printer</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2239" targetptr="lp-1">
<citerefentry>
<refentrytitle>lp</refentrytitle>
<manvolnum>
1
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>lpstat</command>
</para>
</entry>
<entry>
<para>Report the status of the LP print service</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2239" targetptr="lpstat-1">
<citerefentry>
<refentrytitle>lpstat</refentrytitle>
<manvolnum>
1
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>disable</command>
</para>
</entry>
<entry>
<para>Deactivate on or more printers</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2239" targetptr="enable-1">
<citerefentry>
<refentrytitle>enable</refentrytitle>
<manvolnum>
1
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>accept</command>
</para>
</entry>
<entry>
<para>Permit print requests to be queued for a specific destination</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2240" targetptr="accept-1m">
<citerefentry>
<refentrytitle>accept</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>reject</command>
</para>
</entry>
<entry>
<para>Prevent print requests from being queued for a specific destination</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2240" targetptr="accept-1m">
<citerefentry>
<refentrytitle>accept</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>lpadmin</command>
</para>
</entry>
<entry>
<para>Set up or change a printer configuration</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2240" targetptr="lpadmin-1m">
<citerefentry>
<refentrytitle>lpadmin</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>lpfilter</command>
</para>
</entry>
<entry>
<para>Set up or change filter definitions</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2240" targetptr="lpfilter-1m">
<citerefentry>
<refentrytitle>lpfilter</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>lpforms</command>
</para>
</entry>
<entry>
<para>Set up or change preprinted forms</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2240" targetptr="lpforms-1m">
<citerefentry>
<refentrytitle>lpforms</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>lpadmin</command>
</para>
</entry>
<entry>
<para>Mount a form</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2240" targetptr="lpadmin-1m">
<citerefentry>
<refentrytitle>lpadmin</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>lpmove</command>
</para>
</entry>
<entry>
<para>Move output requests from one destination to another destination</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2240" targetptr="lpmove-1m">
<citerefentry>
<refentrytitle>lpmove</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>lpsched</command>
</para>
</entry>
<entry>
<para>Start the LP print service scheduler</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2240" targetptr="lpsched-1m">
<citerefentry>
<refentrytitle>lpsched</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>lpshut</command>
</para>
</entry>
<entry>
<para>Stop the LP print service scheduler</para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2240" targetptr="lpshut-1m">
<citerefentry>
<refentrytitle>lpshut</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
<row>
<entry>
<para>
<command>lpusers</command>
</para>
</entry>
<entry>
<para>Set or change the default priority and priority limits that can be requested
of the LP print service by users </para>
</entry>
<entry>
<para>
<olink remap="external" targetdoc="819-2240" targetptr="lpusers-1m">
<citerefentry>
<refentrytitle>lpusers</refentrytitle>
<manvolnum>
1M
</manvolnum>
</citerefentry>
</olink>
</para>
</entry>
</row>
</tbody>
</tgroup>
</table>
</sect1>
<sect1 xml:id="printref-37">
<title>Functions of the LP Print Service</title>
<para>The LP print service performs the following functions:</para>
<itemizedlist>
<listitem>
<para>Administers files and schedules local print requests</para>
</listitem>
<listitem>
<para>Receives and schedules network requests</para>
</listitem>
<listitem>
<para>Filters files, if necessary, so they print properly</para>
</listitem>
<listitem>
<para>Starts programs that interface with the printers</para>
</listitem>
<listitem>
<para>Tracks the status of print jobs</para>
</listitem>
<listitem>
<para>Tracks forms that are mounted on the printer</para>
</listitem>
<listitem>
<para>Tracks print wheels that are currently mounted</para>
</listitem>
<listitem>
<para>Delivers alerts to mount new forms or different print wheels</para>
</listitem>
<listitem>
<para>Delivers alerts about printing problems</para>
</listitem>
</itemizedlist>
</sect1>
<sect1 xml:id="printref-38">
<title>How LP Administers Files and Schedules Local
Print Requests</title>
<para>
<indexterm xml:id="printref-ix194">
<primary>scheduler</primary>
<see>
print scheduler</see>
</indexterm>
<indexterm xml:id="printref-ix195">
<primary>LP print service scheduler</primary>
<see>
print scheduler</see>
</indexterm>
<indexterm xml:id="printref-ix196">
<primary>print scheduler</primary>
<secondary>updating LP system files</secondary>
</indexterm>
<indexterm xml:id="printref-ix197">
<primary>
<command>lpsched</command>
</primary>
<secondary>daemon</secondary>
</indexterm>
<indexterm xml:id="printref-ix198">
<primary>daemons</primary>
<secondary>
<command>lpsched</command>
</secondary>
</indexterm>The LP print service has a scheduler daemon called <command>lpsched</command>.
The scheduler daemon updates the LP system files with information about printer
setup and configuration.     </para>
<para>The <command>lpsched</command> daemon schedules all local print requests
on a print server, as shown in the following figure. Users can issue the requests
from an application or from the command line. Also, the scheduler tracks the
status of printers and filters on the print server. When a printer finishes
a request, the scheduler schedules the next request n the queue on the print
server, if a next request exists.</para>
<figure xml:id="printref-fig-39">

<title xml:id="printref-19817">The <command>lpsched</command> Daemon
Schedules Local Print Requests</title>
<mediaobject>
<imageobject>
<imagedata fileref="figures/print3.gif"/>
</imageobject>
<textobject>
<simpara>Illustration of lpsched command checking default printer,
filter, form, class, and configuration before scheduling a print request.</simpara>
</textobject>
</mediaobject>
</figure>
<para>Without rebooting the system, you can stop the scheduler with the <command>svcadm disable application/print/server</command> command. Then, restart the
scheduler with the <command>svcadm enable application/print/server</command> command.
The scheduler for each system manages requests that are issued to the system
by the <command>lp</command> command.</para>
</sect1>
<sect1 xml:id="printref-40">
<title>Scheduling Network Print Requests</title>
<indexterm xml:id="printref-ix201">
<primary>print requests</primary>
<secondary>scheduling</secondary>
</indexterm>
<para>Each print client communicates directly with a print sever over the
network. The communication is done between the requesting command, such as <command>lp</command>, <command>lpstat</command>, <command>cancel</command>, <command>lpr</command>, <command>lpq</command>, or <command>lprm</command>, and the print service on the print
server. This communication reduces the print system overhead on client–only
systems, improving scalability, performance and accuracy of data.</para>
<para>Print servers listen for print requests with the Internet services daemon
(<command>inetd</command>). Upon hearing a request for print service from
the network, the <command>inetd</command> daemon starts a program called the <emphasis>protocol adaptor</emphasis> (<command>in.lpd</command>). The protocol adaptor
translates the print request and communicates it to the print spooler, and
returns the results to the requester. This protocol adaptor starts on demand
and exits when it has serviced the network request. This process eliminates
idle system overhead for printing. This process also eliminates any additional
system configuration for network printing support as was the case in previous
versions of Solaris printing software.</para>
</sect1>
<sect1 xml:id="printref-53457">
<title>Filtering Print Files</title>
<para>
<indexterm xml:id="printref-ix202">
<primary>print filters</primary>
<secondary>defined</secondary>
</indexterm>Print filters are programs on the print server that convert the
content of a queued file from one format to another format. </para>
<para>
<indexterm xml:id="printref-ix203">
<primary>
<filename>/usr/lib/lp/postscript</filename> directory</primary>
</indexterm>A print filter can be as simple or as complex as needed. The Solaris
OS provides print filters in the <filename>/usr/lib/lp/postscript</filename> directory
that cover most situations where the destination printer requires the data
to be in PostScript format. If you need filters for nonPostScript printers,
you have to create the filters and add them to the systems that need filters. </para>
<para>
<indexterm xml:id="printref-ix204">
<primary>
<filename>/etc/lp/fd</filename> directory</primary>
</indexterm>A set of <emphasis>print filter descriptor files</emphasis> are
provided in the <filename>/etc/lp/fd</filename> directory. These descriptor
files describe the characteristics of the filter (for example, fast or slow
filter). These description files point to the filter program (for example,
to <filename>/usr/lib/lp/postscript/postdaisy</filename>). </para>
</sect1>
<sect1 xml:id="printref-41">
<title>What the Printer Interface Program Does</title>
<para>The LP print service interacts with other parts of the Solaris OS. The
print service uses a standard printer interface program to do the following:</para>
<itemizedlist>
<listitem>
<para>Initialize the printer port, if necessary. The standard printer
interface program uses the <filename>stty</filename> command to initialize
the printer port.</para>
</listitem>
<listitem>
<para>Initialize the printer. The standard printer interface program
uses the <filename>terminfo</filename> database and the <literal>TERM</literal> shell
variable to find the appropriate control sequences.</para>
</listitem>
<listitem>
<para>Print a banner page, if necessary.</para>
</listitem>
<listitem>
<para>Print the correct number of copies specified by the print
request.</para>
</listitem>
</itemizedlist>
<para>
<indexterm xml:id="printref-ix205">
<primary>printer interface program</primary>
</indexterm>
<indexterm xml:id="printref-ix206">
<primary>LP print service</primary>
<secondary>interface program</secondary>
</indexterm>
<indexterm xml:id="printref-ix207">
<primary>
<filename>/usr/lib/lp/model</filename> directory</primary>
</indexterm>The LP print service uses the standard interface program, found
in the <filename>/usr/lib/lp/model</filename> directory, unless you specify
a different program. You can create custom interface programs&gt; However, you
must make sure that the custom program does not terminate the connection to
the printer or interfere with proper printer initialization.   </para>
</sect1>
<sect1 xml:id="printref-42">
<title>How the <command>lpsched</command> Daemon Tracks
the Status of Print Requests</title>
<indexterm xml:id="printref-ix208">
<primary>daemons</primary>
<secondary>
<command>lpsched</command>
</secondary>
</indexterm>
<indexterm xml:id="printref-ix209">
<primary>
<command>lpsched</command>
</primary>
<secondary>daemon</secondary>
</indexterm>
<indexterm xml:id="printref-ix210">
<primary>print jobs</primary>
<see>
print requests</see>
</indexterm>
<para>
<indexterm xml:id="printref-ix211">
<primary>
<filename>/var/lp/logs/lpsched</filename> file</primary>
</indexterm>The <command>lpsched</command> daemon keeps a log file of each
print request that it processes and notes any errors that occur during the
printing process. This log file is kept in the <filename>/var/lp/logs/lpsched</filename> file.
Every night, the <literal>lp</literal> <filename>cron</filename> job renames
the <filename>/var/lp/logs/lpsched</filename> file to a new <filename>lpsched.</filename>
<replaceable>n</replaceable> file and starts a new log file. If errors occur or jobs disappear
from the print queue, you can use the log files to determine what the <command>lpsched</command> daemon has done with a printing job. </para>
</sect1>
<sect1 xml:id="printref-46">
<title>Cleaning Out Log Files</title>
<indexterm xml:id="printref-ix217">
<primary>log files</primary>
<secondary>cleaning out</secondary>
</indexterm>
<indexterm xml:id="printref-ix218">
<primary>print requests</primary>
<secondary>cleaning out from log file</secondary>
</indexterm>
<para>
<indexterm xml:id="printref-ix219">
<primary>
<command>lpsched</command>
</primary>
<secondary>log files</secondary>
</indexterm>
<indexterm xml:id="printref-ix220">
<primary>log files</primary>
</indexterm>
<indexterm xml:id="printref-ix222">
<primary>log files</primary>
</indexterm>
<indexterm xml:id="printref-ix223">
<primary>
<filename>requests</filename> log</primary>
</indexterm>
<indexterm xml:id="printref-ix224">
<primary>log files</primary>
<secondary>requests</secondary>
</indexterm>
<indexterm xml:id="printref-ix225">
<primary>
<filename>/var/lp/logs</filename>  directory</primary>
</indexterm>
<indexterm xml:id="printref-ix226">
<primary>
<filename>/var/spool/cron/crontabs/lp</filename> file</primary>
</indexterm>The <filename>lpsched</filename> and <filename>requests</filename> log
files in the <filename>/var/lp/logs</filename> directory grow as information
is appended. The LP print service uses a default  <command>cron</command> job
to clean out the log files. The <command>lp</command> <command>cron</command> job
is located in the <filename>/var/spool/cron/crontabs/lp</filename> file. The <command>cron</command> job periodically moves the contents of the log files. The contents
of <replaceable>log</replaceable> are moved to <replaceable>log</replaceable>.<filename>1</filename>, and the contents of <replaceable>log</replaceable>.<filename>1</filename> are
moved to <replaceable>log</replaceable>.<filename>2</filename>. The contents
of <replaceable>log</replaceable>.<filename>2</filename> are lost (that is,
replaced by the former contents of <replaceable>log</replaceable>.<filename>1</filename>)
when <replaceable>log</replaceable>.<filename>2</filename> gets overwritten.
      </para>
<sect2>
<title/>
<task id="printref-55">

<title>How to Change Frequency of Printer Request Log
Rotation</title>
<tasksummary>
<para>The <filename>requests</filename> log file on the printer server is
rotated weekly rather than daily. You can change the rotation interval back
to daily if the printer server is busy.</para>
</tasksummary>
<procedure>
<step xml:id="printref-step-61">
<para>Become superuser or <literal>lp</literal>,
or assume an equivalent role on the print server.</para>
</step>
<step xml:id="printref-step-57">
<para>Set the <literal>EDITOR</literal> environment
variable.</para>
<screen># <userinput>EDITOR=vi</userinput>
# <userinput>export EDITOR</userinput>
</screen>
</step>
<step xml:id="printref-step-58">
<para>Edit the <filename>lp</filename> <filename>crontab</filename> file.</para>
<screen># <userinput>crontab -e lp</userinput>
</screen>
</step>
<step xml:id="printref-step-59">
<para>Change the first line of the file that rotates
the <filename>requests</filename> log files every Sunday (<literal>0</literal>)
to an asterisk (<literal>*</literal>) for daily rotation:</para>
<screen>13 3 * * <userinput>*</userinput> cd /var/lp/logs; if [ -f requests ]; then if
[ -f requests.1 ]; then /bin/mv requests.1 requests.2; fi; /usr/bin/cp 
requests requests.1; &gt;requests; fi</screen>
</step>
<step xml:id="printref-step-60">
<para>Save the file and exit.</para>
</step>
</procedure>
</task>
</sect2>
<sect2 xml:id="printref-47">
<title>How Local Printing Works</title>
<para>
<indexterm xml:id="printref-ix227">
<primary>local printing</primary>
</indexterm>
<indexterm xml:id="printref-ix228">
<primary>printing</primary>
<secondary>local (diagram)</secondary>
</indexterm>The print request follows the same path it would if the client
and server were separate systems. Requests always flow from client to server
following the same path. </para>
<para>The following figure shows what happens when a user submits a request
to print a PostScript file on a <emphasis>local</emphasis> printer, which
is a printer connected to the user's system. The <command>lpsched</command> daemon
on the local system does all processing. This processing might include the
following:</para>
<itemizedlist>
<listitem>
<para>Matching the printer and content type</para>
</listitem>
<listitem>
<para>Identifying the default printer, filtering the request</para>
</listitem>
<listitem>
<para>Starting the specified printer interface program</para>
</listitem>
</itemizedlist>
<para>The printer interface program does the following:</para>
<itemizedlist>
<listitem>
<para>Prints the banner page.</para>
</listitem>
<listitem>
<para>Catches printer faults.</para>
</listitem>
<listitem>
<para>Determines the printer fault policy to either reset, continue,
or begin the print job over again.</para>
</listitem>
<listitem>
<para>Finally, the interface program uses the <command>lpcat</command> program
to download the print request to the local printer's serial port.</para>
</listitem>
</itemizedlist>
<figure xml:id="printref-fig-48">

<title xml:id="printref-64313">The Local Printing
Process</title>
<mediaobject>
<imageobject>
<imagedata fileref="figures/print4.gif"/>
</imageobject>
<textobject>
<simpara>The preceding text describes the graphic.</simpara>
</textobject>
</mediaobject>
</figure>
</sect2>
<sect2 xml:id="printref-49">
<title>How Remote Printing Works</title>
<indexterm xml:id="printref-ix230">
<primary>remote printing</primary>
<secondary>diagram of process</secondary>
</indexterm>
<indexterm xml:id="printref-ix231">
<primary>printing</primary>
<secondary>remote</secondary>
</indexterm>
<indexterm xml:id="printref-ix232">
<primary>printer</primary>
<secondary>remote</secondary>
</indexterm>
<para>The following figure shows what happens when a user on a Solaris print
client submits a print request to an lpd-based print server. The command opens
a connection and handles its own communications with the print server directly.</para>
<figure xml:id="printref-fig-50">

<title xml:id="printref-91479">Printing Between a
Solaris Print Client and a <command>lpd</command>-based Print Server</title>
<mediaobject>
<imageobject>
<imagedata fileref="figures/print5.gif"/>
</imageobject>
<textobject>
<simpara>Illustration of a Solaris print client sending a print
request to an lpd-based print server where it is accepted, spooled, and scheduled
for printing.</simpara>
</textobject>
</mediaobject>
</figure>
<para>The following figure shows an <command>lpd</command>-based print client
submitting a print request to a Solaris print server. The <literal>lpd</literal> daemon
handles the local part of the print request and the connection to the print
server. On the print server, the <literal>inetd</literal> process waits for
network printing requests and starts a protocol adaptor to service the request.
The protocol adaptor communicates with the <literal>lpsched</literal> daemon,
which processes the request on the print server.</para>
<figure xml:id="printref-fig-51">

<title xml:id="printref-28323">Printing Between an <command>lpd</command>-based Print Client and a Solaris Print Server</title>
<mediaobject>
<imageobject>
<imagedata fileref="figures/print6.gif"/>
</imageobject>
<textobject>
<simpara>The preceding text describes the graphic.</simpara>
</textobject>
</mediaobject>
</figure>
<para>The following figure shows what happens when a user on a Solaris print
client submits a print request to a Solaris print server. The print command
on the print client handles the local part of each print request by communicating
directly with the print server.</para>
<para>
<indexterm xml:id="printref-ix233">
<primary>daemons</primary>
<secondary>
<command>lpsched</command> (reference)</secondary>
</indexterm>
<indexterm xml:id="printref-ix234">
<primary>
<command>lpsched</command>
</primary>
<secondary>daemon (reference)</secondary>
</indexterm>The <command>inetd</command> process on the print server monitors
network printing requests and starts a protocol adaptor to communicate with
the <command>lpsched</command> daemon on the print server, which processes
the print request.  </para>
<figure xml:id="printref-fig-52">

<title xml:id="printref-77452">Printing Between a
Solaris Print Client and a Solaris Print Server</title>
<mediaobject>
<imageobject>
<imagedata fileref="figures/print7.gif"/>
</imageobject>
<textobject>
<simpara>The preceding text describes the graphic.</simpara>
</textobject>
</mediaobject>
</figure>
</sect2>
</sect1>
</chapter>
