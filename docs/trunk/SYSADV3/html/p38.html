<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p33.html#ipv6-config-tasks-1">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p37.html#ipv6-config-tasks-16">Configuring Tunnels for IPv6 Support</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p37.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p39.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ipv6-config-tasks-24"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Configure a 6to4 Tunnel</h3>
<p><A NAME="indexterm-772"></A><A NAME="indexterm-773"></A>If your IPv6 network needs to communicate with a remote IPv6 network,
consider using automatic, 6to4 tunnels. The process of configuring a 6to4
tunnel includes configuring the boundary router as a <b>6to4</b> router.
The 6to4 router functions as the endpoint of a 6to4 tunnel between your network
and an endpoint router at a remote IPv6 network. </p>
<h5>Before You Begin</h5><p>Before you configure 6to4 routing on an IPv6 network, you must have
done the following:</p>
<ul><li><p>Configured IPv6 on all appropriate nodes at the prospective
6to4 site, as described in <A HREF="p35.html#ipv6-config-tasks-6">Modifying an IPv6 Interface Configuration for Hosts and Servers</A>.</p>
</li>
<li><p>Selected at least one router with a connection to an IPv4
network to become the 6to4 router.</p>
</li>
<li><p>Configured a globally unique IPv4 address for the prospective
6to4 router's interface to the IPv4 network. The IPv4 address must be static.</p>
<p><hr size="1" noshade><p><b>Note - </b>Do not use a dynamically allocated IPv4 address, as described
in <A HREF="p65.html#dhcp-overview-1">Chapter&nbsp;12, About Solaris DHCP (Overview)</A>. Global dynamically allocated addresses might change over
time, which can adversely affect your IPv6 addressing plan.</p>
<hr size="1" noshade></p></li>
</ul>
<ol><li><p><b>Log in to the prospective 6to4 router as Primary Administrator
or as superuser.</b></p><p>The Primary Administrator role includes the Primary
Administrator profile. To create the role and assign the role to a user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<li><p><b><A NAME="indexterm-774"></A><A NAME="indexterm-775"></A><A NAME="indexterm-776"></A><A NAME="indexterm-777"></A>Configure a 6to4 pseudo-interface on the router by creating the <tt>/etc/hostname6.ip.6to4tun0</tt> file.</b></p><ul><li><p>If you plan to use the recommended convention of subnet ID=0
and host ID=1, use the short format for <tt>/etc/hostname6.ip.6to4tun0</tt>:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>tsrc <i>IPv4-address</i> up</pre>
</td></table><br></li>
<li><p>If you plan to use other conventions for the subnet ID and
host ID, use the long format for  <tt>/etc/hostname6.ip.6to4tun0</tt>:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>tsrc <i>IPv4-address</i> 2002:<i>IPv4-address</i>:<i>subnet-ID</i>:<i>interface-ID</i>:/64 up</pre>
</td></table><br></li>
</ul>
<p><A NAME="indexterm-778"></A>The required parameters for <tt>/etc/hostname6.ip.6to4tun0</tt> follow:</p>
<table border="0" cellspacing="5"><tr><td valign="top"><p><tt>tsrc</tt></p></td><td valign="top"><p>Indicates that this interface is used as a tunnel source.</p>
</td></tr><tr><td valign="top"><p><i>IPv4-address</i></p></td><td valign="top"><p>Specifies, in dotted-decimal format, the IPv4 address that
is configured on the physical interface to become the 6to4 pseudo-interface.</p>
</td></tr></table>
<p>The remaining parameters are optional. However, if you specify one optional
parameter, you must specify all optional parameters.</p>
<table border="0" cellspacing="5"><tr><td valign="top"><p><tt>2002</tt></p></td><td valign="top"><p>Specifies the 6to4 prefix.</p>
</td></tr><tr><td valign="top"><p><i>IPv4-address</i></p></td><td valign="top"><p>Specifies, in hexadecimal notation, the IPv4 address of the
pseudo-interface.</p>
</td></tr><tr><td valign="top"><p><i>subnet-ID</i></p></td><td valign="top"><p>Specifies, in hexadecimal notation, a subnet ID other than
0.</p>
</td></tr><tr><td valign="top"><p><i>interface-ID</i></p></td><td valign="top"><p>Specifies an interface ID other than 1.</p>
</td></tr><tr><td valign="top"><p><tt>/64</tt></p></td><td valign="top"><p>Indicates that the 6to4 prefix has a length of 64 bits.</p>
</td></tr><tr><td valign="top"><p><tt>up</tt></p></td><td valign="top"><p>Configures the 6to4 interface as "up."</p>
</td></tr></table>
<p><hr size="1" noshade><p><b>Note - </b>Two IPv6 tunnels on your network cannot have the same source address
and the same destination address. Packets are dropped as a result. This type
of event can happen if a 6to4 router also performs tunneling through the <tt>atun</tt> command. For information about <tt>atun</tt>, refer
to the <tt>tun</tt>(7M) man
page.</p>
<hr size="1" noshade></p></li>
<li><p><b>(Optional) Create additional 6to4 pseudo-interfaces on the router.</b></p><p>Each prospective 6to4 pseudo-interface must have an already configured,
globally unique IPv4 address. </p>
</li>
<A NAME="ipv6-config-tasks-step-118"></A><li><p><b>Reboot the 6to4 router.</b></p></li>
<li><p><b><A NAME="indexterm-779"></A>Verify the status of the interface.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig ip.6to4tun0 inet6</b></tt>
        </pre>
</td></table><br><p>If the interface is correctly configured, you receive output that is
similar to the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>ip.6to4tun0: flags=2200041&lt;UP,RUNNING,NONUD,IPv6>mtu 1480 index 11
        inet tunnel src 111.222.33.44 
        tunnel hop limit 60 
        inet6 2002:6fde:212c:10:/64 </pre>
</td></table><br></li>
<li><p><b><A NAME="indexterm-780"></A><A NAME="indexterm-781"></A>Edit the <tt>/etc/inet/ndpd.conf</tt> file to advertise
6to4 routing.</b></p><p><A NAME="indexterm-782"></A>For detailed information, refer to the <tt>ndpd.conf</tt>(4) man page.</p>
<ol Type="a"><li><p><b>Specify the subnet to receive the advertisement in the first line.</b></p><p>Create an <tt>if</tt> entry with the following format:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>if <i>subnet-interface</i> AdvSendAdvertisements 1</pre>
</td></table><br><p>For example, to advertise 6to4 routing to the subnet that is connected
to interface <tt>hme0</tt>, replace <i>subnet-interface</i> with <tt>hme0</tt>. </p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>if hme0 AdvSendAdvertisements 1</pre>
</td></table><br></li>
<li><p><b><A NAME="indexterm-783"></A>Add the 6to4 prefix as the second line of the advertisement.</b></p><p>Create a <tt>prefix</tt> entry with following format:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>prefix 2002:<i>IPv4-address</i>:<i>subnet-ID</i>::/64 <i>subnet-interface</i></pre>
</td></table><br></li>
</ol>
</li>
<li><p><b>Reboot the router.</b></p><p>Alternatively, you can issue a <tt>sighup</tt> to the <tt>/etc/inet/in.ndpd</tt> daemon to begin
sending router advertisements. The IPv6 nodes on each subnet to receive the
6to4 prefix now autoconfigure with new 6to4-derived addresses.</p>
</li>
<li><p><b>Add the new 6to4-derived addresses of the nodes to the name service
that is used at the 6to4 site.</b></p><p>For instructions, go to <A HREF="p39.html#ipv6-config-tasks-10">Configuring Name Service Support for IPv6</A>.</p>
</li>
</ol><A NAME="eojbe"></A><h5>Example 7-10 &nbsp;&nbsp;6to4 Router Configuration (Short Form)</h5>
<p><A NAME="indexterm-784"></A>The following is an example of the short form of <tt>/etc/hostname6.ip.6to4tun0</tt>:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cat</b></tt> <tt>/etc/hostname6.ip.6to4tun0</tt>
<tt><b>tsrc 111.222.33.44 up</b></tt></pre>
</td></table><br><A NAME="ekqvt"></A><h5>Example 7-11 &nbsp;&nbsp;6to4 Router Configuration (Long Form)</h5>
<p>Here is an example of the long form of <tt>/etc/hostname6.ip.6to4tun0</tt>:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cat</b></tt> <tt>/etc/hostname6.ip.6to4tun0</tt>
<tt><b>tsrc 111.222.33.44 2002:6fde:212c:20:1/64 up</b></tt></pre>
</td></table><br><A NAME="ekqvw"></A><h5>Example 7-12 &nbsp;&nbsp;<tt>ifconfig</tt> Output Showing 6to4 Pseudo-Interface</h5>
<p>The following sample shows output of the <tt>ifconfig</tt> command
for a 6to4 pseudo-interface:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig ip.6to4tun0 inet6</b></tt>
ip.6to4tun0: flags=2200041&lt;UP,RUNNING,NONUD,IPv6> mtu 1480 index 11
        inet tunnel src 192.168.87.188
        tunnel hop limit 60 
        inet6 2002:c0a8:57bc::1/64 </pre>
</td></table><br><A NAME="ekqwh"></A><h5>Example 7-13 &nbsp;&nbsp;6to4 Advertisements in<tt>/etc/inet/ndpd.conf</tt></h5>
<p>The following sample <tt>/etc/inet/ndpd.conf</tt> file advertises
6to4 routing on two subnets:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>if qfe0 AdvSendAdvertisements 1
prefix  2002:c0a8:57bc:10::/64 qfe0 

if qfe1 AdvSendAdvertisements 1
prefix  2002:c0a8:57bc:2::/64 qfe1</pre>
</td></table><br><h5>More Information<br>Configuring Multiple Routers at the 6to4 Site</h5>
<p>For a multiple router site, the routers behind the 6to4 router might
require further configuration to support 6to4. If your site uses RIP, you
must configure on each non-6to4 router the static routes to the 6to4 router.
If you use a commercial routing protocol, you do not need to create static
routes to the 6to4 router.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p37.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p39.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

