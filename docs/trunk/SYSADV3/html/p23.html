<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p17.html#ipconfig-1">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p22.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p24.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ipconfig-111"></A><h2>Monitoring and Modifying Transport Layer Services</h2>
<p><A NAME="indexterm-599"></A><A NAME="indexterm-600"></A><A NAME="indexterm-601"></A><A NAME="indexterm-602"></A><A NAME="indexterm-603"></A><A NAME="indexterm-604"></A><A NAME="indexterm-605"></A>The transport layer protocols TCP, SCTP, and UDP are part of the
standard Solaris OS package. These protocols typically need no intervention
to run properly. However, circumstances at your site might require you to
log or modify services that run over the transport layer protocols. Then,
you must modify the profiles for these services by using the Service Management
Facility (SMF), which is described in Chapter 14, "Managing Services (Overview)," in <i>System Administration Guide: Basic Administration</i>. </p>
<p>The <tt>inetd</tt> daemon is responsible for starting standard
Internet services when a system boots. These services include applications
that use TCP, SCTP, or UDP as their transport layer protocol. You can modify
existing Internet services or add new services using the SMF commands. For
more information about <tt>inetd</tt>, refer to <A HREF="p52.html#ipv6-ref-32"><tt>inetd</tt> Internet Services Daemon</A>.</p>
<p>Operations that involve the transport layer protocols include:</p>
<ul><li><p>Logging of all incoming TCP connections</p>
</li>
<li><p>Adding services that run over a transport layer protocol,
using SCTP as an example</p>
</li>
<li><p>Configuring the TCP wrappers facility for access control</p>
</li>
</ul>
<p>For detailed information on the <tt>inetd</tt> daemon refer
to the <tt>inetd</tt>(1M)man
page. </p>
<A NAME="ipconfig-6"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Log the IP Addresses of All Incoming TCP
Connections</h3>
<ol><A NAME="ipconfig-step-9"></A><li><p><b>On the local system, assume the Network Management
role or become superuser.</b></p><p>Roles contain authorizations and privileged
commands.    For more information about roles, see "Configuring RBAC (Task Map)" in <i>System Administration Guide: Security Services</i>.</p>
</li>
<A NAME="ipconfig-step-8"></A><li><p><b>Set TCP tracing to enabled for all services
managed by <tt>inetd</tt>.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>inetadm -M tcp_trace=TRUE</b></tt></pre>
</td></table><br></li>
</ol><A NAME="ermig"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Add Services That Use the SCTP Protocol</h3>
<A NAME="indexterm-606"></A><A NAME="indexterm-607"></A><A NAME="indexterm-608"></A><p>The SCTP transport protocol provides services to application layer protocols
in a fashion similar to TCP. However, SCTP enables communication between two
systems, either or both of which can be multihomed. The SCTP connection is
called an <b>association</b>. In an association, an application
divides the data to be transmitted into one or more message streams, or <b>multi-streamed</b>. An SCTP connection can go to endpoints with multiple
IP addresses, which is particularly important for telephony applications.
The multihoming capabilities of SCTP are a security consideration if your
site uses IP Filter or IPsec. Some of these considerations are described in
the <tt>sctp</tt>(7P) man page.</p>
<p>By default, SCTP is included in the Solaris OS and does not require
additional configuration. However, you might need to explicitly configure
certain application layer services to use SCTP. Some example applications
are <tt>echo</tt> and <tt>discard</tt>. The next procedure
shows how to add an echo service that uses an SCTP one-to-one style socket.</p>
<p><hr size="1" noshade><p><b>Note - </b>You can also use the following procedure to add services for the
TCP and UDP transport layer protocols.</p>
<hr size="1" noshade></p><p>The following task shows how to add an SCTP <tt>inet</tt> service
that is managed by the <tt>inetd</tt> daemon to the SMF repository.
The task then shows how to use the Service Management Facility (SMF) commands
to add the service.</p>
<ul><li><p>For information about SMF commands, refer to "SMF Command-Line Administrative Utilities" in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<li><p>For syntactical information, refer to the man pages for the
SMF commands, as cited in the procedure.</p>
</li>
<li><p>For detailed information about SMF refer to the <tt>smf</tt>(5) man page.</p>
</li>
</ul>
<h5>Before You Begin</h5><p>Before you perform the following procedure, create a manifest file for
the service. The procedure uses as an example a manifest for the <tt>echo</tt> service
that is called <tt>echo.sctp.xml</tt>.</p>
<ol><li><p><b>Log in to the local system with a user account that has write
privileges for system files.</b></p></li>
<li><p><b>Edit the <tt>/etc/services</tt> file and add a definition
for the new service.</b></p><p><A NAME="indexterm-609"></A>Use the following syntax for the service definition.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre><i>service-name |port/protocol | aliases</i></pre>
</td></table><br></li>
<li><p><b>Add the new service.</b></p><p>Go to the directory where the
service manifest is stored and type the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cd </tt><i>dir-name<tt></i></b></tt>
# <tt><b>svccfg import </tt><i>service-manifest-name<tt></i></b></tt></pre>
</td></table><br><p>For a complete syntax of <tt>svccfg</tt>, refer to the <tt>svccfg</tt>(1M) man page.</p>
<p>Suppose
you want to add a new SCTP <tt>echo</tt> service using the manifest <tt>echo.sctp.xml</tt> that is currently located in the <tt>service.dir</tt> directory.
You would type the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cd service.dir</b></tt>
# <tt><b>svccfg import echo.sctp.xml</b></tt></pre>
</td></table><br></li>
<li><p><b>Verify that the service manifest has been added:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>svcs </tt><i>FMRI<tt></i></b></tt></pre>
</td></table><br><p>For the <i>FMRI</i> argument, use the Fault Managed
Resource Identifier (FMRI) of the service manifest. For example, for the SCTP <tt>echo</tt> service, you would use the following command:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>svcs svc:/network/echo:sctp_stream</b></tt></pre>
</td></table><br><p>Your output should resemble the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>	STATE          STIME    FMRI
disabled       16:17:00 svc:/network/echo:sctp_stream</pre>
</td></table><br><p>For detailed information about the <tt>svcs</tt> command,
refer to the <tt>svcs</tt>(1) man
page.</p>
<p>The output indicates that the new service manifest is currently
disabled.</p>
</li>
<li><p><b>List the properties of the service to determine if you must make
modifications.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>inetadm -l </tt><i>FMRI<tt></i></b></tt></pre>
</td></table><br><p>For detailed information about the <tt>inetadm</tt> command,
refer to the<tt>inetadm</tt>(1M) man
page.</p>
<p>For example, for the SCTP <tt>echo</tt> service,
you would type the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>inetadm -l svc:/network/echo:sctp_stream</b></tt>
SCOPE    NAME=VALUE
	         name="echo"
	         endpoint_type="stream"
	         proto="sctp"
	         isrpc=FALSE
	         wait=FALSE
	         exec="/usr/lib/inet/in.echod -s"
         .
         .
         default  tcp_trace=FALSE
       	default  tcp_wrappers=FALSE</pre>
</td></table><br></li>
<li><p><b>Enable the new service:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>inetadm -e </tt><i>FMRI<tt></i></b></tt></pre>
</td></table><br></li>
<li><p><b>Verify that the service is enabled:</b></p><p>For example, for
the new <tt>echo</tt> service, you would type the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>inetadm | grep sctp_stream</b></tt>
.
.
	enabled   online         svc:/network/echo:sctp_stream</pre>
</td></table><br></li>
</ol><A NAME="erttc"></A><h5>Example 5-9 &nbsp;&nbsp;Adding a Service That Uses the SCTP Transport Protocol</h5>
<p>The following example shows the commands to use and the file entries
required to have the echo service use the SCTP transport layer protocol.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>$ <tt><b>cat /etc/services</b></tt>
.
.
echo            7/tcp
echo            7/udp
<tt><b>echo            7/sctp</b></tt>

# <tt><b>cd service.dir</b></tt>

	# <tt><b>svccfg import echo.sctp.xml</b></tt>

# <tt><b>svcs network/echo*</b></tt>
	STATE          STIME    FMRI
	disabled       15:46:44 svc:/network/echo:dgram
	disabled       15:46:44 svc:/network/echo:stream
	disabled       16:17:00 svc:/network/echo:sctp_stream

# <tt><b>inetadm -l svc:/network/echo:sctp_stream</b></tt>
	SCOPE    NAME=VALUE
	         name="echo"
	         endpoint_type="stream"
	         proto="sctp"
	         isrpc=FALSE
	         wait=FALSE
	         exec="/usr/lib/inet/in.echod -s"
	         user="root"
	default  bind_addr=""
	default  bind_fail_max=-1
	default  bind_fail_interval=-1
	default  max_con_rate=-1
	default  max_copies=-1
	default  con_rate_offline=-1
	default  failrate_cnt=40
	default  failrate_interval=60
	default  inherit_env=TRUE
	default  tcp_trace=FALSE
	default  tcp_wrappers=FALSE

# <tt><b>inetadm -e svc:/network/echo:sctp_stream</b></tt>

# <tt><b>inetadm | grep echo</b></tt>
	disabled  disabled       svc:/network/echo:stream
	disabled  disabled       svc:/network/echo:dgram
	enabled   online         svc:/network/echo:sctp_stream</pre>
</td></table><br>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p22.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p24.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

