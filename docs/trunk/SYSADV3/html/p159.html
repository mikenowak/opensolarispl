<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p156.html#mpoverview">30.&nbsp;&nbsp;Introducing IPMP (Overview)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p158.html#esqdy">IPMP and Dynamic Reconfiguration</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p158.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p160.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="esxiu"></A><h3>Attaching NICs</h3>
<A NAME="indexterm-2901"></A><A NAME="indexterm-2902"></A><A NAME="indexterm-2903"></A><p>You can add interfaces to an IPMP group at any time by using the <tt>ifconfig</tt> command, as explained in <A HREF="p161.html#emqul">How to Configure an IPMP Group With Multiple Interfaces</A>. Thus, any interfaces on system
components that you attach after system boot can be plumbed and added to an
existing IPMP group. Or, if appropriate, you can configure the newly added
interfaces into their own IPMP group. </p>
<p>These interfaces and the data addresses that are configured on them
are immediately available for use by the IPMP group.  However, for the system
to automatically configure and use the interfaces after a reboot, you must
create an <tt>/etc/hostname.</tt><i>interface</i> file
for each new interface. For instructions, refer to  <A HREF="p26.html#fpdcn">How to Configure a Physical Interface After System Installation</A>.</p>
<p>If an <tt>/etc/hostname.</tt><i>interface</i> file
already exists when the interface is attached, then RCM automatically configures
the interface according to the contents of this file.  Thus, the interface
receives the same configuration that it would have received after system boot.</p>
<A NAME="esxjb"></A><h3>Detaching NICs</h3>
<A NAME="indexterm-2904"></A><A NAME="indexterm-2905"></A><A NAME="indexterm-2906"></A><A NAME="indexterm-2907"></A><p>All requests to detach system components that contain NICs are first
checked to ensure that connectivity can be preserved.  For instance, by default
you cannot detach a NIC that is not in an IPMP group. You also cannot detach
a NIC that contains the only functioning interfaces in an IPMP group.  However,
if you must remove the system component, you can override this behavior by
using the <tt>-f</tt> option of <tt>cfgadm</tt>, as explained
in the <tt>cfgadm</tt>(1M) man
page.</p>
<p>If the checks are successful, the data addresses associated with the
detached NIC fail over to a functioning NIC in the same group, as if the NIC
being detached had failed.  When the NIC is detached, all test addresses on
the NIC's interfaces are unconfigured. Then, the NIC is unplumbed from the
system.  If any of these steps fail, or if the DR of other hardware on the
same system component fails, then the previous configuration is restored to
its original state. You should receive a status message regarding this event.
Otherwise, the detach request completes successfully. You can remove the component
from the system.  No existing connections are disrupted.</p>
<A NAME="esxja"></A><h3>Reattaching NICs</h3>
<A NAME="indexterm-2908"></A><A NAME="indexterm-2909"></A><A NAME="indexterm-2910"></A><A NAME="indexterm-2911"></A><A NAME="indexterm-2912"></A><p>RCM records the configuration information associated with any NIC's
that are detached from a running system.  As a result, RCM treats the reattachment
of a NIC that had been previously detached identically as it would to the
attachment of a new NIC. That is, RCM only performs plumbing.</p>
<p>However, reattached NICs typically have an existing <tt>/etc/hostname.</tt><i>interface</i> file.  In this case, RCM automatically
configures the interface according to the contents of the existing <tt>/etc/hostname.</tt><i>interface</i> file.  Additionally, RCM informs
the <tt>in.mpathd</tt> daemon of each data address that was originally
hosted on the reattached interface.  Thus, once the reattached interface is
functioning properly, all of its data addresses are failed back to the reattached
interface as if it had been repaired.</p>
<p>If the NIC being reattached does not have an <tt>/etc/hostname.</tt><i>interface</i> file, then no configuration information is available.
RCM has no information regarding how to configure the interface. One consequence
of this situation is that addresses that were previously failed over to another
interface are not failed back.</p>
<A NAME="esxji"></A><h3>NICs That Were Missing at System Boot</h3>
<A NAME="indexterm-2913"></A><A NAME="indexterm-2914"></A><A NAME="indexterm-2915"></A><A NAME="indexterm-2916"></A><p>NICs that are not present at system boot represent a special instance
of failure detection.  At boot time, the startup scripts track any interfaces
with <tt>/etc/hostname.</tt><i>interface</i> files
that cannot be plumbed.  Any data addresses in such an interface's <tt>/etc/hostname.</tt><i>interface</i> file are automatically hosted
on an alternative interface in the IPMP group.  </p>
<p>In such an event, you receive error messages similar to the following</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>moving addresses from failed IPv4 interfaces: hme0 (moved to hme1)
moving addresses from failed IPv6 interfaces: hme0 (moved to hme1)</pre>
</td></table><br><p>If no alternative interface exists, you receive error messages similar
to the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>moving addresses from failed IPv4 interfaces: hme0 (couldn't move; 
   no alternative interface) 
 moving addresses from failed IPv6 interfaces: hme0 (couldn't move; 
   no alternative interface) </pre>
</td></table><br><p><hr size="1" noshade><p><b>Note - </b>In this instance of failure detection, only data addresses that
are explicitly specified in the missing interface's <tt>/etc/hostname.</tt><i>interface</i> file move to an alternative interface. Any addresses
that are usually acquired through other means, such as through RARP or DHCP,
are not acquired or moved.   </p>
<hr size="1" noshade></p><p>If an interface with the same name as another interface that was missing
at system boot is reattached using DR, RCM automatically plumbs the interface.
Then, RCM configures the interface according to the contents of the interface's <tt>/etc/hostname.</tt><i>interface</i> file. Finally,
RCM fails back any data addresses, just as if the interface had been repaired.
Thus, the final network configuration is identical to the configuration that
would have been made if the system had been booted with the interface present.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p158.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p160.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

