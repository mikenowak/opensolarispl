<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p155.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p157.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="mpoverview"></A><b>Chapter&nbsp;30</b><h1>Introducing IPMP
(Overview)</h1>
<p>IP network multipathing (IPMP) provides physical interface failure 
detection and transparent network access failover for a system with multiple
interfaces on the same IP link. IPMP also provides  load spreading of packets
for systems with multiple interfaces.</p>
<p>This chapter contains the following information:</p>
<ul><li><p><A HREF="p156.html#chapter1-2">Why You Should Use IPMP</A></p>
</li>
<li><p><A HREF="p157.html#eyprl">Basic Requirements of IPMP</A></p>
</li>
<li><p><A HREF="p157.html#emqwq">IPMP Addressing</A></p>
</li>
<li><p><A HREF="p156.html#mpoverview-22">Solaris IPMP Components</A></p>
</li>
<li><p><A HREF="p157.html#eobra">IPMP Interface Configurations</A></p>
</li>
<li><p><A HREF="p157.html#emqqq">IPMP Failure Detection and Recovery Features</A></p>
</li>
<li><p><A HREF="p158.html#esqdy">IPMP and Dynamic Reconfiguration</A></p>
</li>
</ul>
<p>For IPMP configuration tasks, refer to <A HREF="p160.html#deploynetmult-56">Chapter&nbsp;31, Administering IPMP (Tasks)</A>.</p>
<A NAME="chapter1-2"></A><h2>Why You Should Use IPMP</h2>
<A NAME="indexterm-2807"></A><A NAME="indexterm-2808"></A><p>IPMP provides increased reliability, availability, and network performance
for systems with multiple physical interfaces. 	Occasionally, a physical
interface or the networking hardware attached to that interface might fail
or require maintenance. Traditionally, at that point, the system can no longer
be contacted through any of the IP addresses that are associated with the
failed interface.  Additionally, any existing connections to the system using
those IP addresses are disrupted.</p>
<p>By using IPMP, you can configure one or more physical interfaces into
an IP multipathing group, or <b>IPMP group</b>.  After configuring
IPMP, the system automatically monitors the interfaces in the IPMP group for
failure. If an interface in the group fails or is removed for maintenance,
IPMP automatically migrates, or <b>fails over</b>, the failed
interface's IP addresses. The recipient of these addresses is a functioning
interface in the failed interface's IPMP group. The failover feature of IPMP
preserves connectivity and prevents disruption of any existing connections.
 Additionally, IPMP improves  overall network performance by automatically
spreading out network traffic across the set of interfaces in the IPMP group.
This process is called <b>load spreading</b>.<A NAME="indexterm-2809"></A><A NAME="indexterm-2810"></A></p>
<A NAME="mpoverview-22"></A><h3>Solaris IPMP Components</h3>
<p><A NAME="indexterm-2811"></A>Solaris IPMP involves the following software:</p>
<ul><li><p>The <tt>in.mpathd</tt> daemon, which is explained
fully in the <tt>in.mpathd</tt>(1M) man
page.</p>
</li>
<li><p>The <tt>/etc/default/mpathd</tt> configuration
file, which is also described in the <tt>in.mpathd</tt>(1M) man
page.</p>
</li>
<li><p><tt>ifconfig</tt> options for IPMP configuration,
as described in the <tt>ifconfig</tt>(1M) man
page.<A NAME="indexterm-2812"></A></p>
</li>
</ul>
<A NAME="mpoverview-11"></A><h4>Multipathing Daemon, <tt>in.mpathd</tt></h4>
<A NAME="indexterm-2813"></A><A NAME="indexterm-2814"></A><A NAME="indexterm-2815"></A><p>The <tt>in.mpathd</tt> daemon detects interface failures,
and then implements various procedures for failover and failback. After <tt>in.mpathd</tt> detects a failure or a repair, the daemon sends an <tt>ioctl</tt> to perform the failover or failback. The <tt>ip</tt> kernel
module, which implements the <tt>ioctl</tt>, does the network access
failover transparently and automatically.</p>
<p><hr size="1" noshade><p><b>Note - </b>Do not use Alternate Pathing while using IPMP on the same set
of network interface cards. Likewise, you should not use IPMP while you are
using Alternate Pathing. You can use Alternate Pathing and IPMP at the same
time on different sets of interfaces. For more information about Alternate
Pathing, refer to the <i>Sun Enterprise Server Alternate Pathing 2.3.1
User Guide</i>.</p>
<hr size="1" noshade></p><p><A NAME="indexterm-2816"></A><A NAME="indexterm-2817"></A>The <tt>in.mpathd</tt> daemon detects failures and
repairs by sending out probes on all the interfaces that are part of an IPMP
group. The <tt>in.mpathd</tt> daemon also detects failures and
repairs by monitoring the <tt>RUNNING</tt> flag on each interface
in the group. Refer to the <tt>in.mpathd</tt>(1M) man
page for more information.</p>
<A NAME="mpoverview-2"></A><h3>IPMP Terminology and Concepts</h3>
<A NAME="indexterm-2818"></A><p>This section introduces terms and concepts that are used throughout <A HREF="p155.html#ipmptm-1">Part&nbsp;V, IPMP</A>.</p>
<A NAME="emjhn"></A><h4>IP Link</h4>
<A NAME="indexterm-2819"></A><A NAME="indexterm-2820"></A><p>In IPMP terminology, an <b>IP link</b> is a communication
facility or medium over which nodes can communicate at the data-link layer
of the Internet protocol suite. Types of IP links might include simple Ethernets,
bridged Ethernets, hubs, or Asynchronous Transfer Mode (ATM) networks. An
IP link can have one or more IPv4 subnet numbers, and, if applicable, one
or more IPv6 subnet prefixes. A subnet number or prefix cannot be assigned
to more than one IP link. In ATM LANE, an IP link is a single emulated local
area network (LAN). With the Address Resolution Protocol (ARP), the scope
of the ARP protocol is a single IP link.</p>
<p><hr size="1" noshade><p><b>Note - </b>Other IP-related documents, such as RFC 2460, <i>Internet
Protocol, Version 6 (IPv6)                              Specification</i>,
use the term <b>link</b> instead of <b>IP link</b>.
Part VI uses the term <b>IP link</b> to avoid confusion with
IEEE 802. In IEEE 802, <b>link</b> refers to a single wire from
an Ethernet network interface card (NIC) to an Ethernet switch.</p>
<hr size="1" noshade></p><A NAME="emjhd"></A><h4>Physical Interface</h4>
<A NAME="indexterm-2821"></A><p>The <b>physical interface</b> provides a system's attachment
to an IP link. This attachment is often implemented as a device driver and
a NIC. If a system has multiple interfaces attached to the same link, you
can configure IPMP to perform failover if one of the interfaces fails. For
more information on physical interfaces, refer to <A HREF="p157.html#eobra">IPMP Interface Configurations</A>.</p>
<A NAME="elfqr"></A><h4>Network Interface Card</h4>
<A NAME="indexterm-2822"></A><A NAME="indexterm-2823"></A><p>A <b>network interface card</b> is a network adapter that
can be built in to the system. Or, the NIC can be a  separate card that serves
as an interface from the system to an IP link. Some NICs can have multiple
physical interfaces. For example, a <tt>qfe</tt> NIC can have four
interfaces, <tt>qfe0</tt> through <tt>qfe3</tt>, and so
on. </p>
<A NAME="emjid"></A><h4>IPMP Group</h4>
<A NAME="indexterm-2824"></A><A NAME="indexterm-2825"></A><A NAME="indexterm-2826"></A><p>An IP multipathing group, or <b>IPMP</b> group, consists
of one or more physical interfaces on the same system that are configured
with the same IPMP group name. All interfaces in the IPMP group must be connected
to the same IP link. The same (non-null) character string IPMP group name
identifies all interfaces in the group. You can place interfaces from NICs
of different speeds within the same IPMP group, as long as the NICs are of
the same type. For example, you can configure the interfaces of 100-megabit
Ethernet NICs and the interfaces of one gigabit Ethernet NICs in the same
group.  As another example, suppose you have two 100-megabit Ethernet NICs.
You can configure one of the interfaces down to 10 megabits and still place
the two interfaces into the same IPMP group. </p>
<p>You cannot place two interfaces of different media types into an IPMP
group. For example, you cannot place an ATM interface in the same group as
an Ethernet interface.</p>
<A NAME="elfqt"></A><h4>Failure Detection and Failover</h4>
<A NAME="indexterm-2827"></A><A NAME="indexterm-2828"></A><A NAME="indexterm-2829"></A><p><b>Failure detection</b> is the process of detecting when
an interface or the path from an interface to an Internet layer device no
longer works. IPMP provides systems with the ability to detect when an interface
has failed. IPMP detects the following types of communication failures:</p>
<ul><li><p>The transmit or receive path of the interface has failed.</p>
</li>
<li><p>The attachment of the interface to the IP link is down.</p>
</li>
<li><p>The port on the switch does not transmit or receive packets.</p>
</li>
<li><p>The physical interface in an IPMP group is not present at
system boot.</p>
</li>
</ul>
<p>After detecting a failure, IPMP begins failover. <b>Failover</b> is
the automatic process of switching the network access from a failed interface
to a functioning physical interface in the same group. Network access includes
IPv4 unicast, multicast, and broadcast traffic, as well as IPv6 unicast and
multicast traffic. Failover can only occur when you have configured more than
one interface in the IPMP group. The failover process ensures uninterrupted
access to the network. <A NAME="indexterm-2830"></A><A NAME="indexterm-2831"></A></p>
<A NAME="elfre"></A><h4>Repair Detection and Failback</h4>
<A NAME="indexterm-2832"></A><A NAME="indexterm-2833"></A><A NAME="indexterm-2834"></A><A NAME="indexterm-2835"></A><p><b>Repair detection</b> is the process of detecting when
a NIC or the path from  a NIC to an Internet layer device starts operating
correctly after a failure. After detecting that a NIC has been repaired, IPMP
performs <b>failback</b>, the process of switching network access
back to the repaired interface. Repair detection assumes that you have enabled
failbacks. See <A HREF="p158.html#mpoverview-24">Detecting Physical Interface Repairs</A> for more information.</p>
<A NAME="epmpt"></A><h4>Target Systems</h4>
<A NAME="indexterm-2836"></A><A NAME="indexterm-2837"></A><p>Probe-based failure detection uses <b>target systems</b> to
determine the condition of an interface. Each target system must be attached
to the same IP link as the members of the  IPMP group. The <tt>in.mpathd</tt> daemon
on the local system sends ICMP probe messages to each target system. The probe
messages help to determine the health of each interface in the IPMP group. </p>
<p>For more information about target system use in probe-based failure
detection, refer to <A HREF="p158.html#emqra">Probe-Based Failure Detection</A>.</p>
<A NAME="emjif"></A><h4>Outbound Load Spreading</h4>
<A NAME="indexterm-2838"></A><p>With IPMP configured, outbound network packets are spread across multiple
NICs without affecting the ordering of packets. This process is known as <b>load spreading</b>. As a result of load spreading, higher throughput
is achieved. Load spreading occurs only when the network traffic is flowing
to multiple destinations that use multiple connections.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p155.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p157.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

