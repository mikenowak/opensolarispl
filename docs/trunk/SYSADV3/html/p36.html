<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p33.html#ipv6-config-tasks-1">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p35.html#ipv6-config-tasks-6">Modifying an IPv6 Interface Configuration for Hosts and Servers</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p35.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p37.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="gbvsf"></A><h3>Configuring an IPv6 Token</h3>
<p>The 64-bit interface ID of an IPv6 address is also referred to as a <b>token</b>, as introduced in <A HREF="p11.html#ipv6-overview-10">IPv6 Addressing Overview</A>. During address autoconfiguration, the token is
associated with the interface's MAC address. In most cases, nonrouting nodes,
that is IPv6 hosts and servers, should use their autoconfigured tokens.</p>
<p>However, using autoconfigured tokens can be a problem for servers whose
interfaces are routinely swapped as part of system maintenance. When the interface
card is changed, the MAC address is also changed. Servers that depend on having
stable IP addresses can experience problems as a result. Various parts of
the network infrastructure, such as DNS or NIS, might have stored specific
IPv6 addresses for the interfaces of the server.</p>
<p>To avoid address change problems, you can manually configure a token
to be used as the interface ID in an IPv6 address. To create the token, you
specify a hexadecimal number of 64 bits or less to occupy the interface ID
portion of the IPv6 address. During subsequent address autoconfiguration,
Neighbor Discovery does not create an interface ID that is based on the interface's
MAC address. Instead, the manually created token becomes the interface ID.
This token remains assigned to the interface, even when a card is replaced.</p>
<p><hr size="1" noshade><p><b>Note - </b>The difference between user-specified tokens and temporary addresses
is that temporary addresses are randomly generated, rather than explicitly
created by a user.</p>
<hr size="1" noshade></p><A NAME="ipv6-config-tasks-70"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Configure a User-Specified IPv6
Token</h4>
<A NAME="indexterm-751"></A><p>The next instructions are particularly useful for servers whose interfaces
are routinely replaced. They also are valid for configuring user-specified
tokens on any IPv6 node.</p>
<ol><li><p><b>Assume the Primary Administrator role or become superuser on the
node.</b></p><p>The Primary Administrator role includes the Primary Administrator
profile. To create the role and assign the role to a user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<A NAME="ipv6-config-tasks-step-74"></A><li><p><b>Verify that the interface you want
to configure with a token is plumbed.</b></p><p>An interface must be plumbed
before you can configure a token for its IPv6 address.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig</b></tt> <tt>-a6</tt></pre>
</td></table><br><table cellpadding="4" border="1" cols="1" width="100%"><td><pre>qfe0: flags=2000841 &lt;UP,RUNNING,MULTICAST,IPv6> mtu 1500 index 2
        ether 0:3:ba:13:14:e1 
        inet6 fe80::203:baff:fe13:14e1/10</pre>
</td></table><br><p>This output shows that the network interface <tt>qfe0</tt> is
plumbed and has the link-local address <tt>fe80::203:baff:fe13:14e1/10</tt>.
This address was automatically configured during installation. </p>
</li>
<li><p><b>Create one or more 64-bit hexadecimal numbers to be used as tokens
for the node's interfaces. For examples of tokens, refer to <A HREF="p12.html#ipv6-overview-15">Link-Local Unicast Address</A>.</b></p></li>
<A NAME="ipv6-config-tasks-step-78"></A><li><p><b>Configure each interface with a
token.</b></p><p>Use the following form of the <tt>ifconfig</tt> command
for each interface to have a user-specified interface ID (token):</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>ifconfig <i>interface</i> inet6  token <i>address/64</i></pre>
</td></table><br><p>For example, you would use the following command to configure interface <tt>qfe0</tt> with a token:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig qfe0 inet6 token ::1a:2b:3c:4d/64 </b></tt></pre>
</td></table><br><p>Repeat this step for every interface that will have a user-specified
token.</p>
</li>
<A NAME="ipv6-config-tasks-step-73"></A><li><p><b>(Optional) Make the new IPv6 address
persist across reboots.</b></p><ol Type="a"><li><p><b>Edit or create an <tt>/etc/hostname6.</tt><i>interface</i> file for each interface you configured with a token.</b></p></li>
<li><p><b>Add the following text at the bottom of each <tt>/etc/hostname.6</tt><i>interface</i> file:</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre><tt><b>token ::</b></tt><i>token-name</i>/64</pre>
</td></table><br><p>For example, you might add the following text to the bottom of an<tt>/etc/hostname6.</tt><i>interface</i> file:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>token ::1a:2b:3c:4d/64</pre>
</td></table><br></li>
</ol>
<p>After the system reboots, the token that you configured in an <tt>/etc/hostname6.</tt><i>interface</i> file is applied to the interface's
IPv6 address. This IPv6 address remains persistent across subsequent reboots.</p>
</li>
<A NAME="ipv6-config-tasks-step-76"></A><li><p><b>Update the IPv6 daemon with your
changes.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>pkill -HUP -in.ndpd</b></tt></pre>
</td></table><br></li>
</ol><A NAME="gbvqu"></A><h5>Example 7-6 &nbsp;&nbsp;Configuring a User-Specified Token on an IPv6 Interface</h5>
<p>In the following example, the interface <tt>bge0:1</tt> has
an autoconfigured IPv6 address. The subnet prefix <tt>2001:db8:3c4d:152:/64</tt> is
advertised by a router on the node's local link. The interface ID <tt>2c0:9fff:fe56:8255</tt> is generated from <tt>bge0:1</tt>'s MAC address.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig -a6</b></tt>
lo0: flags=2002000849 &lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv6,VIRTUAL> mtu 8252 index 1
        inet6 ::1/128
bge0: flags=2100801 &lt;UP,MULTICAST,IPv6> mtu 1500 index 5
        inet6 fe80::2c0:9fff:fe56:8255/10
        ether 0:c0:9f:56:82:55
bge0:1: flags=2180801 &lt;UP, MULTICAST,ADDRCONF,IPv6>mtu 1500 index 5
        inet6 2001:db8:3c4d:152:c0:9fff:fe56:8255/64
# <tt><b>ifconfig bge0 inet6 token ::1a:2b:3c:4d/64</b></tt>
# <tt><b>vi /etc/hostname6.bge0</b></tt>
token ::1a:2b:3c:4d/64
# <tt><b>pkill -HUP -in.ndpd</b></tt>
# <tt><b>ifconfig -a6</b></tt>
lo0: flags=2002000849 &lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv6,VIRTUAL> mtu 8252 index 1
        inet6 ::1/128
bge0: flags=2100801 &lt;UP,MULTICAST,IPv6> mtu 1500 index 5
        inet6 fe80::2c0:9fff:fe56:8255/10
        ether 0:c0:9f:56:82:55
bge0:1: flags=2180801 &lt;UP, MULTICAST,ADDRCONF,IPv6>mtu 1500 index 5
        inet6 2001:db8:3c4d:152:1a:2b:3c:4d/64</pre>
</td></table><br><p>After the token is configured, the global address on the second status
line of <tt>bge0:1</tt> now has <tt>1a:2b:3c:4d</tt>configured
for its interface ID.</p>
<h5>See Also</h5><ul><li><p>To update the name services with the IPv6 addresses of the
server, see <A HREF="p39.html#ipv6-config-tasks-10">Configuring Name Service Support for IPv6</A>.</p>
</li>
<li><p>To monitor server performance, see <A HREF="p41.html#ipv6-admintasks-1">Chapter&nbsp;8, Administering a TCP/IP Network (Tasks)</A>.</p>
</li>
</ul>
<A NAME="ipv6-config-tasks-53"></A><h3>Administering IPv6-Enabled Interfaces
on Servers</h3>
<A NAME="indexterm-752"></A><A NAME="indexterm-753"></A><p><A NAME="indexterm-754"></A><A NAME="indexterm-755"></A>When you plan for IPv6 on a server, you must make a few decisions
as you enable IPv6 on the server's interfaces. Your decisions affect the strategy
to use for configuring the interface IDs, also known as <b>tokens</b>,
of an interface's IPv6 address.</p>
<A NAME="gbwsg"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Enable IPv6 on a Server's Interfaces</h4>
<h5>Before You Begin</h5><p>The next procedure assumes the following:</p>
<ul><li><p>Solaris 10 OS is already installed on the server.</p>
</li>
<li><p>You enabled IPv6 on the server's interfaces either during
Solaris OS installation or later, using the procedures in <A HREF="p33.html#ipv6-config-tasks-64">Configuring an IPv6 Interface</A>.</p>
</li>
</ul>
<p>If applicable, upgrade the application software to support IPv6. Note
that many applications that run on the IPv4 protocol stack also successfully
run on IPv6. For more information, refer to <A HREF="p15.html#ipv6-planning-18">How to Prepare Network Services for IPv6 Support</A>.</p>
<ol><li><p><b>On the server, assume the Primary Administrator role or become
superuser.</b></p><p>The Primary Administrator role includes the Primary
Administrator profile. To create the role and assign the role to a user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<li><p><b>Ensure that an IPv6 subnet prefix is configured on a router on
the same link as the server. </b></p><p>For more information, refer to <A HREF="p34.html#ipv6-config-tasks-5">Configuring an IPv6 Router</A>.</p>
</li>
<li><p><b>Use the appropriate strategy for the interface ID for the server's
IPv6-enabled interfaces.</b></p><p>By default, IPv6 address autoconfiguration
uses the MAC address of an interface when creating the interface ID portion
of the IPv6 address. If the IPv6 address of the interface is well known, swapping
one interface for another interface can cause problems. The MAC address of
the new interface will be different. During address autoconfiguration, a new
interface ID is generated.</p>
<ul><li><p>For an IPv6-enabled interface that you do not plan to replace,
use the autoconfigured IPv6 address, as introduced in <A HREF="p12.html#chapter1-42">IPv6 Address Autoconfiguration</A>.</p>
</li>
<li><p>For IPv6-enabled interfaces that must appear anonymous outside
the local network, consider using a randomly generated token for the interface
ID. For instructions and an example, refer to <A HREF="p35.html#ipv6-config-tasks-106">How to Configure a Temporary Address</A>. </p>
</li>
<li><p>For IPv6-enabled interfaces that you plan to swap on a regular
basis, create tokens for the interface IDs. For instructions and an example,
refer to <A HREF="p36.html#ipv6-config-tasks-70">How to Configure a User-Specified IPv6 Token</A>.</p>
</li>
</ul>
</li>
</ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p35.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p37.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

