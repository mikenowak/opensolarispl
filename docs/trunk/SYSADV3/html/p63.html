<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p55.html#ipv6-ref-76">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p62.html#ipv6-ref-47">IPv6 Tunnels</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p62.html#ipv6-ref-50">6to4 Automatic Tunnels</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p62.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p64.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ipv6-ref-51"></A><h4>Topology of a 6to4 Tunnel</h4>
<p><A NAME="indexterm-1313"></A><A NAME="indexterm-1314"></A><A NAME="indexterm-1315"></A>The following figure shows a 6to4 tunnel between two 6to4 sites.</p>
<A NAME="ipv6-ref-fig-100"></A><p><b>Figure 11-6 </b>Tunnel Between Two 6to4 Sites</p>
<IMG src="figures/tun-6-4-sites.gif" class="figure" alt="The figure shows a 6to4 tunnel, which is described in
the following context." title="The figure shows a 6to4 tunnel, which is described in
the following context."><p><A NAME="indexterm-1316"></A>The figure depicts two isolated 6to4 networks, Site A and Site
B. Each site has configured a router with an external connection to an IPv4
network. A 6to4 tunnel across the IPv4 network connects the 6to4 sites.</p>
<p><A NAME="indexterm-1317"></A>Before an IPv6 site can become a 6to4 site, you must configure
at least one router interface for 6to4 support. This interface must provide
the external connection to the IPv4 network. The address that you configure
on <tt>qfe0</tt> must be globally unique. In this figure, boundary
Router A's interface <tt>qfe0</tt> connects Site A to the IPv4 network.
Interface <tt>qfe0</tt> must already be configured with an IPv4
address before you can configure <tt>qfe0</tt> as a 6to4 pseudo-interface. </p>
<p>In the figure, 6to4 Site A is composed of two subnets, which are connected
to interfaces <tt>hme0</tt> and <tt>hme1</tt> on Router
A. All IPv6 hosts on either subnet of Site A automatically reconfigure with
6to4-derived addresses on receipt of the advertisement from Router A.</p>
<p>Site B is the opposite endpoint of the tunnel from Site A. To correctly
receive traffic from Site A, a boundary router on Site B must be configured
for 6to4 support. Otherwise, packets that the router receives from Site A
are not recognized and dropped.</p>
<A NAME="ipv6-ref-55"></A><h4>Packet Flow Through the 6to4 Tunnel</h4>
<p><A NAME="indexterm-1318"></A><A NAME="indexterm-1319"></A><A NAME="indexterm-1320"></A><A NAME="indexterm-1321"></A>This section describes the path of packets from a host at one
6to4 site to a host in a remote 6to4 site. This scenario uses the topology
that is shown in <A HREF="p63.html#ipv6-ref-fig-100">Figure 11-6</A>.
Moreover, the scenario assumes that the 6to4 routers and 6to4 hosts are already
configured.</p>
<ol Type="1"><li><p>A host on Subnet 1 of 6to4 Site A sends a transmission, with
a host at 6to4 Site B as the destination. Each packet header in the flow has
a source 6to4-derived address and destination 6to4-derived address. </p>
</li>
<li><p>6to4 Router A receives the outgoing packets and creates a
tunnel over an IPv4 network to 6to4 Site B.</p>
</li>
<li><p>Site A's router encapsulates each 6to4 packet into an IPv4
header. Then the router uses standard IPv4 routing procedures to forward the
packet over the IPv4 network.</p>
</li>
<li><p>Any IPv4 routers that the packets encounter use the packets'
destination IPv4 address for forwarding. This address is the globally unique
IPv4 address of the interface on Router B, which also serves as the 6to4 pseudo-interface.</p>
</li>
<li><p>Packets from Site A arrive at Router B, which decapsulates
the IPv6 packets from the IPv4 header.</p>
</li>
<li><p>Router B then uses the destination address in the IPv6 packet
to forward the packets to the recipient host at Site B.</p>
</li>
</ol>
<A NAME="ipv6-ref-56"></A><h4>Considerations for Tunnels to a 6to4 Relay
Router</h4>
<A NAME="indexterm-1322"></A><p>6to4 relay routers function as endpoints for tunnels from 6to4 routers
that need to communicate with native IPv6, non-6to4 networks. Relay routers
are essentially bridges between the 6to4 site and native IPv6 sites. Because
this solution is very insecure, by default, the Solaris OS does not enable
6to4 relay router support. However, if your site requires such a tunnel, you
use the <tt>6to4relay</tt> command to enable the following tunneling
scenario.</p>
<A NAME="ipv6-ref-fig-101"></A><p><b>Figure 11-7 </b>Tunnel From a 6to4 Site to a 6to4 Relay
Router</p>
<IMG src="figures/tun-6-4-relay.gif" class="figure" alt="This figure shows a tunnel between a 6to4 router and
6to4 relay router. The following context further describes the figure." title="This figure shows a tunnel between a 6to4 router and
6to4 relay router. The following context further describes the figure."><p><A NAME="indexterm-1323"></A><A NAME="indexterm-1324"></A>In <A HREF="p63.html#ipv6-ref-fig-101">Figure 11-7</A>,
6to4 Site A needs to communicate with a node at the native IPv6 Site B. The
figure shows the path of traffic from Site A onto a 6to4 tunnel over an IPv4
network. The tunnel has 6to4 Router A and a 6to4 relay router as its endpoints.
Beyond the 6to4 relay router is the IPv6 network, to which IPv6 Site B is
connected. </p>
<A NAME="ipv6-ref-57"></A><h5>Packet Flow Between a 6to4 Site and Native
IPv6 Site</h5>
<p><A NAME="indexterm-1325"></A><A NAME="indexterm-1326"></A><A NAME="indexterm-1327"></A>This section describes the flow of packets from a 6to4 site to
a native IPv6 site. The text uses the scenario that is shown in <A HREF="p63.html#ipv6-ref-fig-101">Figure 11-7</A> as an example.</p>
<ol Type="1"><li><p>A host on 6to4 Site A sends a transmission that specifies
as the destination a host at native IPv6 Site B. Each packet header in the
flow has a 6to4-derived address as its source address. The destination address
is a standard IPv6 address.</p>
</li>
<li><p>6to4 Router A receives the outgoing packets and creates a
tunnel over an IPv4 network to a 6to4 relay router.</p>
<p>6to4 relay
routers that are part of the 6to4 relay router anycast group have the address <tt>192.88.99.1</tt>. This anycast address is the default address for 6to4
relay routers. If you need to use a specific 6to4 relay router, you can override
the default and specify that router's IPv4 address. </p>
</li>
<li><p>Site A's 6to4 router encapsulates each packet into a IPv4
header, which has the IPv4 address of the 6to4 relay router as its destination.
The 6to4 router uses standard IPv4 routing procedures to forward the packet
over the IPv4 network. Any IPv4 routers that the packets encounter forward
the packets to the 6to4 relay router.</p>
</li>
<li><p>The physically closest anycast 6to4 relay router to Site A
retrieves the packets that are destined for the <tt>192.88.99.</tt>1
anycast group. </p>
</li>
<li><p>The relay router decapsulates the IPv4 header from the 6to4
packets, revealing the native IPv6 destination address. </p>
</li>
<li><p>The relay router then sends the now IPv6-only packets onto
the IPv6 network, where the packets are ultimately retrieved by a router at
Site B. The router then forwards the packets to the destination IPv6 node.</p>
</li>
</ol>
<A NAME="ipv6-ref-64"></A><h2>IPv6 Extensions to Solaris Name Services</h2>
<p>This section describes naming changes that were introduced by the implementation
of IPv6. You can store IPv6 addresses in any of the Solaris naming services,
NIS, LDAP, DNS, and files. You can also use NIS over IPv6 RPC transports to
retrieve any NIS data.</p>
<A NAME="ipv6-ref-68"></A><h3>DNS Extensions for IPv6</h3>
<A NAME="indexterm-1328"></A><A NAME="indexterm-1329"></A><p>An IPv6-specific resource record, the AAAA resource record, has been
specified by in RFC 1886 <i>DNS Extensions to Support IP Version 6</i>.
This AAAA record maps a host name into a 128 bit IPv6 address. The PTR record
is still used with IPv6 to map IP addresses into host names. The 32 four bit
nibbles of the 128 bit address are reversed for an IPv6 address. Each nibble
is converted to its corresponding hexadecimal ASCII value. Then, <tt>ip6.int</tt> is appended.</p>
<A NAME="ipv6-ref-69"></A><h3>Changes to the <tt>nsswitch.conf</tt> File</h3>
<A NAME="indexterm-1330"></A><A NAME="indexterm-1331"></A><p>IPv6
support has been added to the NIS, LDAP, and DNS name services. Consequently,
the <tt>nsswitch.conf</tt> file has been modified to support IPv6
lookups. </p>
<p><A NAME="indexterm-1332"></A><A NAME="indexterm-1333"></A>The following diagram shows the new relationship between the <tt>nsswitch.conf</tt> file and the new name services databases for applications
that use the <tt>gethostbyname</tt> and <tt>getipnodebyname</tt> commands.
Items in italics are new. The <tt>gethostbyname</tt> command checks
only for IPv4 addresses that are stored in <tt>/etc/inet/hosts</tt>. If the lookup fails, then the command checks the database
that is specified in the <tt>hosts</tt> entry in the <tt>nsswitch.conf</tt> file.</p>
<A NAME="ipv6-ref-fig-102"></A><p><b>Figure 11-8 </b>Relationship Between <tt>nsswitch.conf</tt> and Name Services</p>
<IMG src="figures/NSCD-figure1.gif" class="figure" alt="Diagram shows the relationship between NIS, NIS+, Files,
and DNS database and the nsswitch.conf file." title="Diagram shows the relationship between NIS, NIS+, Files,
and DNS database and the nsswitch.conf file."><p>For more information on name services, see <i>System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</i>.</p>
<A NAME="ipv6-ref-70"></A><h3>Changes to Name Service Commands</h3>
<p><A NAME="indexterm-1334"></A>To support IPv6, you can look up IPv6 addresses with the existing
name service commands. For example, the <tt>ypmatch</tt> command
works with the new NIS maps. The <tt>nslookup</tt> command can look
up the new AAAA records in DNS.</p>
<A NAME="ipv6-ref-71"></A><h2>NFS and RPC IPv6 Support</h2>
<p>NFS software and Remote Procedure Call (RPC) software support IPv6 in
a seamless manner. Existing commands that are related to NFS services have
not changed. Most RPC applications also  run on IPv6 without any change. Some
advanced RPC applications with transport knowledge might require updates.</p>
<A NAME="ipv6-ref-103"></A><h2>IPv6 Over ATM Support</h2>
<A NAME="indexterm-1335"></A><A NAME="indexterm-1336"></A><p>The Solaris OS supports IPv6 over ATM,  permanent virtual circuits (PVC),
and static switched virtual circuits (SVC).  </p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p62.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p64.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

