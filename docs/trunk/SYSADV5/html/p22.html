<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>NIS Netgroups - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p21.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a> > <a href="p21.html#anis2-38485">Administering NIS Users</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p21.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p23.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="anis2-14244"></a><h4>NIS Netgroups</h4>
<a name="indexterm-326"></a><a name="indexterm-327"></a><a name="indexterm-328"></a><p>NIS netgroups are groups (sets) of users or machines that you define
for your administrative purposes. For example, you can create netgroups that
do the following.</p>
<ul><li><p>Define a set of users who can access a specific machine</p>
</li>
<li><p>Define a set of NFS client machines to be given some specific
file system access</p>
</li>
<li><p>Define a set of users who are to have administrator privileges
on all the machines in a particular NIS domain</p>
</li>
</ul>
<p>Each netgroup is given a netgroup name. Netgroups do not directly set
permissions or access rights. Instead, the netgroup names are used by other
NIS maps in places where a user name or machine name would normally be used.
For example, suppose you created a netgroup of network administrators called <tt>netadmins</tt>. To grant all members of the <tt>netadmins</tt> group
access to a given machine, you need only add a <tt>netadmin</tt> entry
to that machine's  <tt>/etc/passwd</tt> file. Netgroup names can
also be added to the <tt>/etc/netgroup</tt> file and propagated
to the NIS <tt>netgroup</tt> map. See <tt>netgroup</tt>(4) for more detailed information
on using netgroups.</p>
<p><a name="indexterm-329"></a><a name="indexterm-330"></a><a name="indexterm-331"></a>On a network using NIS, the <tt>netgroup</tt> input
file on the master NIS server is used for generating three maps: <tt>netgroup</tt>, <tt>netgroup.byuser</tt>, and <tt>netgroup.byhost</tt>.
The  <tt>netgroup</tt> map contains the basic information in the <tt>netgroup</tt> input file. The two other NIS maps contain information
in a format that speeds lookups of netgroup information, given the machine
or user.</p>
<p>Entries in the <tt>netgroup</tt> input file are in the format: <i>name ID</i>, where <i>name</i> is the name you
give to a netgroup, and <i>ID</i> identifies a machine
or user who belongs to the netgroup. You can specify as many IDs (members)
to a netgroup as you want, separated by commas. For example, to create a netgroup
with three members, the <tt>netgroup</tt> input file entry would
be in the format:  <i>name</i> <i>ID</i>, <i>ID</i>, <i>ID</i>. The member IDs in a <tt>netgroup</tt> input file entry are in the following format.</p>
<pre>([-|<i>machine</i>], [-|<i>user</i>], [<i>domain</i>])</pre><p>Where <i>machine</i> is a machine name, <i>user</i> is a user ID, and <i>domain</i> is the
machine or user's NIS domain. The <b>domain</b> element is optional
and should only be used to identify machines or users in some other NIS domain.
The <i>machine</i> and <i>user</i> element
of each member's entry are required, but a dash (<tt>-</tt>) is
used to denote a null. There is no necessary relationship between the machine
and user elements in an entry.</p>
<p><a name="indexterm-332"></a>The following are two sample <tt>netgroup</tt> input
file entries, each of which create a netgroup named <tt>admins</tt> composed
of the users <tt>hauri</tt> and <tt>juanita</tt> who is
in the remote domain <tt>sales</tt> and the machines <tt>altair</tt> and <tt>sirius</tt>.</p>
<pre>admins (altair, hauri), (sirius,juanita,sales)</pre><pre>admins (altair,-), (sirius,-), (-,hauri), (-,juanita,sales)</pre><p><a name="indexterm-333"></a><a name="indexterm-334"></a><a name="indexterm-335"></a>Various programs use the netgroup NIS maps for permission checking
during login, remote mount, remote login, and remote shell creation. These
programs include <tt>mountd</tt>, <tt>login</tt>, <tt>rlogin</tt>, and <tt>rsh</tt> . The <tt>login</tt> command
consults the netgroup maps for user classifications if it encounters netgroup
names in the <tt>passwd</tt> database. The <tt>mountd</tt> daemon
consults the netgroup maps for machine classifications if it encounters netgroup
names in the <tt>/etc/dfs/dfstab</tt> file. <tt>rlogin</tt> and <tt>rsh</tt> In fact, any program that uses the <tt>ruserok</tt> interface
consults the netgroup maps for both machine and user classifications if they
encounter netgroup names in the <tt>/etc/hosts.equiv</tt> or <tt>.rhosts</tt> files.</p>
<p>If you add a new NIS user or machine to your network, be sure to add
them to appropriate netgroups in the <tt>netgroup</tt> input file.
Then use the <tt>make</tt> and <tt>yppush</tt> commands
to create the netgroup maps and push them to all of your NIS servers. See <tt>netgroup</tt>(4) for detailed information on
using netgroups and netgroup input file syntax.</p>
<a name="anis2-11278"></a><h3>Working With NIS Maps</h3>
<a name="indexterm-336"></a><p>This section contains the following information:</p>
<ul><li><p><a href="p22.html#anis2-41232">Obtaining Map Information</a></p>
</li>
<li><p><a href="p22.html#anis2-42736">Changing a Map's Master Server</a></p>
</li>
<li><p><a href="p23.html">Modifying Configuration Files</a></p>
</li>
<li><p><a href="p23.html#anis2-20638">Modifying and Using the <tt>Makefile</tt></a></p>
</li>
</ul>
<a name="anis2-41232"></a><h4>Obtaining Map Information</h4>
<a name="indexterm-337"></a><p>Users can obtain information from and about the maps at any time by
using the <tt>ypcat</tt>, <tt>ypwhich</tt>, and <tt>ypmatch</tt> commands. In the examples that follow, <i>mapname</i> refers
both to the official name of a map and to its nickname, if any.</p>
<p>To list all the values in a map, type the following.</p>
<pre>% <tt><b>ypcat </tt><i>mapname</i><tt></b></tt></pre><p>To list both the keys and the values (if any) in a map, type the following.</p>
<pre>% <tt><b>ypcat</b></tt> <tt>-k</tt> <tt><b></tt><i>mapname</i><tt></b></tt></pre><p>To list all the map nicknames, type any of the following commands.</p>
<pre>% <tt><b>ypcat</b></tt> <tt>-x</tt><tt><b></b></tt>
% <tt><b>ypmatch</b></tt> <tt>-x</tt><tt><b></b></tt>
% <tt><b>ypwhich</b></tt> <tt>-x</tt><tt><b></b></tt></pre><p>To list all the available maps and their master(s), type the following.</p>
<pre>% <tt><b>ypwhich</b></tt> <tt>-m</tt><tt><b></b></tt></pre><p>To list the master server for a particular map, type the following.</p>
<pre>% <tt><b>ypwhich</b></tt> <tt>-m</tt> <tt><b></tt><i>mapname</i><tt></b></tt></pre><p>To match a key with an entry in a map, type the following.</p>
<pre>% <tt><b>ypmatch </tt><i>key</i><tt> </tt><i>mapname</i><tt></b></tt></pre><p>If the item you are looking for is not a key in a map, type the following.</p>
<pre>% <tt><b>ypcat </tt><i>mapname</i><tt> | grep </tt><i>item</i><tt></b></tt></pre><p>where <i>item</i> is the information for which you
are searching. To obtain information about other domains, use the <tt>-d
domainname</tt> options of these commands.</p>
<p>If the machine requesting information for a domain other than its default
does not have a binding for the requested domain, <tt>ypbind</tt>consults
the <tt>/var/yp/binding/</tt><i>domainname</i><tt>/ypservers</tt> file for a list of servers for that domain. If this
file does not exist it issues an RPC broadcast for a server. In this case,
there must be a server for the requested domain on the same subnet as the
requesting machine. </p>
<a name="anis2-42736"></a><h4>Changing a Map's Master Server</h4>
<a name="indexterm-338"></a><p><a name="indexterm-339"></a><a name="indexterm-340"></a>To change the master server for a selected map, you first have
to build the map on the new NIS master. Since the old master server name occurs
as a key-value pair in the existing map (this pair is inserted automatically
by <tt>makedbm</tt>), copying the map to the new master or transferring
a copy to the new master with <tt>ypxfr</tt> is insufficient. You
have to reassociate the key with the new master server name. If the map has
an ASCII source file, you should copy this file to the new master.</p>
<a name="anis2-proc-12"></a><h4><img src="graphics/procedure.gif"> How to Change a Map's Master Server</h4>
<ol><li><a name="anis2-step-1011"></a><b>On the new master, become superuser or assume
an equivalent role.</b><p>Roles contain authorizations and privileged
commands. For more information about roles, see Chapter 8, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i>.</p></li><li><a name="anis2-step-13"></a><b>Change directories.</b><pre>newmaster# <tt><b>cd /var/yp</b></tt></pre></li><li><a name="anis2-step-14"></a><b><a name="indexterm-341"></a>The <tt>Makefile</tt> must have an entry for the new
map before you specify the map to make. If this is not the case, edit the <tt>Makefile</tt> now, using a map called <tt>sites.byname</tt>.</b></li><li><a name="anis2-step-15"></a><b>To update or remake the map, type the following.</b><pre>newmaster# <tt><b>make sites.byname</b></tt></pre></li><li><a name="anis2-step-16"></a><b>If the old master remains an NIS server, remote
log in (<tt>rlogin</tt>) to the old master and edit <tt>Makefile</tt>.
Make sure you comment out the section of the <tt>Makefile</tt> that
made <tt>sites.byname</tt> so that it is no longer made there.</b></li><li><a name="anis2-step-17"></a><b><a name="indexterm-342"></a><a name="indexterm-343"></a><a name="indexterm-344"></a>If <tt>sites.byname</tt> only exists as an <tt>ndbm</tt> file,
remake it on the new master by disassembling a copy from any NIS server, then
running the disassembled version through <tt>makedbm</tt>.</b><pre>newmaster# <tt><b>cd /var/yp</b></tt>
newmaster# <tt><b>ypcat sites.byname | makedbm</b></tt> <tt>-</tt><i>domain</i><tt>-</tt><tt><b>/sites.byname</b></tt></pre><p><a name="indexterm-345"></a>After making the map on the new master, you must send a copy of
the new map to the other slave servers. Do not use <tt>yppush</tt>,
because the other slaves will try to get new copies from the old master, rather
than the new one. A typical method for circumventing this is to transfer a
copy of the map from the new master back to the old master. To do this, become
superuser, or assume an equivalent role, on the old master server and type
the following.</p><pre>oldmaster# <tt><b>/usr/lib/netsvc/yp/ypxfr</b></tt> <tt>-h</tt> <tt><b>newmaster sites.byname</b></tt></pre><p>Now it is safe to run <tt>yppush</tt>. Any remaining slave
servers still believe that the old master is the current master and will attempt
to get the current version of the map from the old master. When clients do
so, they will get the new map, which names the new master as the current master.</p><p><a name="indexterm-346"></a>If this method fails, you can log in as root on each NIS server
and execute the <tt>ypxfr</tt> command shown above.</p></li></ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p21.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p23.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

