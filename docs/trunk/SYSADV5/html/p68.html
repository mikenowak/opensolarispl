<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Principal Names and Netnames (NIS+ to LDAP) - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p61.html">16.&nbsp;&nbsp;Transitioning From NIS+ to LDAP</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p67.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p69.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="nisplus2ldap-56"></a><h3>Principal Names and Netnames (NIS+ to LDAP)</h3>
<p><a name="indexterm-585"></a><a name="indexterm-586"></a>NIS+ authentication relies on principal names (a user or host
name, qualified by the domain name) and netnames (the secure RPC equivalent
of principal names) to uniquely identify an entity (principal) that can be
authenticated. While RFC 2307 provides for storing the Diffie-Hellman keys
used for NIS+ authentication, there is no specified place for the principal
names or netnames.</p>
<p>The <tt>/var/nis/NIS+LDAPmapping.template</tt> file works
around this problem by deriving the domain portion of principal and netnames
from the owner name (itself a principal name) of the <tt>cred.org_dir</tt> table.
Hence, if the NIS+ domain is <tt>x.y.z.</tt>, and the owner of the <tt>cred.org_dir</tt> table is <tt>aaa.x.y.z.</tt>, all principal
names for NIS+ entries created from LDAP data will be of the following form.</p>
<p><tt><b></tt><i>user or system</i><tt>.x.y.z.</b></tt></p>
<p>Netnames are of the following form.</p>
<p><tt><b>unix.</tt><i>uid</i><tt>@x.y.z.</b></tt></p>
<p><tt><b>unix.</tt><i>nodename</i><tt>@x.y.z.</b></tt></p>
<p>While this method of constructing principal and netnames probably is
sufficient for most NIS+ installations, there are also some cases in which
it fails, as shown in the following.</p>
<ul><li><p>The owner name of the <tt>cred.org_dir</tt> table
belongs to a different domain than the one shared by the principal and netnames
in the <tt>cred.org_dir</tt> table. This could be the case for a <tt>cred.org_dir</tt> table in a subdomain, if the owner is a principal from
the parent domain.  You can fix this problem in one of the following ways.</p>
<ul><li><p><b>Change the owner of the</b> <tt>cred.org_dir</tt> <b>table to match the domain of the entries in the table.</b></p>
</li>
<li><p><b>Change the mapping rules for the</b> <tt>cred.org_dir</tt> <b>database IDs to use the owner of some other NIS+ object
(which could be created especially for that purpose, if no suitable object
already exists).</b></p>
<p>For example, if the <tt>cred.org_dir</tt> table in the domain <tt>sub.dom.ain.</tt> is owned by <tt>master.dom.ain.</tt>, but principal and netnames in <tt>cred.org_dir.sub.dom.ain.</tt> should belong to <tt>sub.dom.ain</tt>, you could create
a link object as follows.</p>
<pre># <tt><b>nisln cred.org_dir.sub.dom.ain. \</b></tt>
<tt><b>credname.sub.dom.ain.</b></tt></pre><p>Set the owner of the link object to an appropriate principal in the <tt>sub.dom.ain.</tt> as follows.</p>
<pre># <tt><b>nischown trusted.sub.dom.ain. credname.sub.dom.ain.</b></tt></pre><p>Edit the mapping file. Change</p>
<pre>(nis+:zo_owner[]cred.org_dir, "*.%s")), \</pre><p>to</p>
<pre>(nis+:zo_owner[]credname.sub.dom.ain., "*.%s")), \</pre><p>Note that the use of a link object called <tt>credname</tt> is
an example. Any valid object type (except an entry object) and object name
will do. The important point is to set the owner of the object to have the
correct domain name.</p>
</li>
<li><p>If you do not want to give ownership even of a special purpose
object to a principal from the domain used for the principal and netnames,
create <tt>nisplusPrincipalName</tt> and <tt>nisplusNetname</tt> attributes
as detailed below.</p>
</li>
</ul>
</li>
<li><p><b>The</b> <tt>cred.org_dir</tt> <b>table contains principal and netnames belonging to more than one domain.</b></p>
<p>Consult the documentation for your LDAP server, and create the <tt>nisplusPrincipalName</tt> and <tt>nisplusNetname</tt> attributes, as well as the <tt>nisplusAuthName</tt> object class. (The following is LDIF data for <tt>ldapadd</tt>. Attribute and object class OIDs are for illustration only.)</p>
<pre>dn: cn=schema
changetype: modify
add: attributetypes
attributetypes:	( 1.3.6.1.4.1.42.2.27.5.42.42.7.0 NAME 'nisplusPrincipalName' \
		  DESC 'NIS+ principal name' \
		  SINGLE-VALUE \
		  SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 )</pre><pre>attributetypes:	( 1.3.6.1.4.1.42.2.27.5.42.42.9.0 NAME 'nisplusNetname' \
		  DESC 'Secure RPC netname' \
		  SINGLE-VALUE \
		  SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 )

dn: cn=schema
changetype: modify
add: objectclasses
objectclasses:	( 1.3.6.1.4.1.42.2.27.5.42.42.10.0 NAME 'nisplusAuthName' \
		  SUP top AUXILLIARY DESC 'NIS+ authentication identifiers' \
		  MAY ( nisplusPrincipalName $ nisplusNetname ) )</pre><p>You now need to enable the <tt>cred.org_dir</tt> mapping
to use the newly created <tt>nisplusNetname</tt> and <tt>nisplusPrincipalName</tt> attributes. The template mapping file, <tt>/var/nis/NIS+LDAPmapping.template</tt>, contains commented-out lines for this purpose. See the <tt>nisplusObjectDN</tt> and <tt>nisplusLDAPattributeFromColumn</tt>/ 	<tt>nisplusLDAPcolumnFromAttribute</tt> attribute values for the  <tt>credlocal</tt>, <tt>creduser</tt>, and <tt>crednode</tt> database IDs. Once you have edited
your mapping file to this effect, restart the NIS+ service. Do
not forget to edit the <tt>/lib/svc/method/nisplus</tt> file to
include the <tt>-m</tt> and <tt>-Y</tt> options, or use the <tt>svcprop</tt> command, as appropriate. See <a href="p61.html#nisplus2ldap-66">NIS+ to LDAP Tools and the Service Management Facility</a> for more information.Do
not forget to add the <tt>-m</tt> option if your mapping file is not
the default, and the <tt>-Y</tt> option if the <tt>rpc.nisd</tt> daemon
should provide NIS (YP) emulation.</p>
<pre># <tt><b>svcadm restart network/rpc/nisplus:default</b></tt></pre><pre># <tt><b>pkill rpc.nisd</b></tt></pre></li>
</ul>
<a name="nisplus2ldap-57"></a><h3><tt>client_info</tt> and <tt>timezone</tt> Tables (NIS+ to LDAP)</h3>
<p>Because RFC 2307 does not provide schemas for the information kept in
the NIS+ <tt>client_info.org_dir</tt> and <tt>timezone.org_dir</tt> tables,
mapping of these tables is not enabled by default in the template mapping
file (<tt>/var/nis/NIS+LDAPmapping.template</tt>). If you want
to keep the <tt>client_info</tt> and<tt>timezone</tt> information
in LDAP, consult your LDAP server documentation, and create the new attributes
and object classes discussed in the following sections.</p>
<a name="nisplus2ldap-58"></a><h4><tt>client_info</tt> Attributes
and Object Class</h4>
<p>Create attributes and object class as below, and then create the 	container
for the client_info data. The suggested container name is <tt>ou=ClientInfo</tt>.
LDIF data is for <tt>ldapadd</tt>(1).
The attribute and object class OIDs used in the following are examples only.</p>
<pre>dn: cn=schema
changetype: modify
add: attributetypes
attributetypes:	( 1.3.6.1.4.1.42.2.27.5.42.42.12.0 \
		  NAME 'nisplusClientInfoAttr' \
		  DESC 'NIS+ client_info table client column' \
		  SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 SINGLE-VALUE )
attributetypes:	( 1.3.6.1.4.1.42.2.27.5.42.42.12.1 \
		  NAME 'nisplusClientInfoInfo' \
		  DESC 'NIS+ client_info table info column' \
		  SYNTAX 1.3.6.1.4.1.1466.115.121.1.26 SINGLE-VALUE )
attributetypes:	( 1.3.6.1.4.1.42.2.27.5.42.42.12.2 \
		  NAME 'nisplusClientInfoFlags' \
		  DESC 'NIS+ client_info table flags column' \
		  SYNTAX 1.3.6.1.4.1.1466.115.121.1.26 SINGLE-VALUE )

dn: cn=schema
changetype: modify
add: objectclasses
objectclasses:	( 1.3.6.1.4.1.42.2.27.5.42.42.13.0 \
		  NAME 'nisplusClientInfoData' \
		  DESC 'NIS+ client_info table data' \
		  SUP top STRUCTURAL MUST ( cn ) \
		  MAY ( nisplusClientInfoAttr $ nisplusClientInfoInfo $ nisplusClientInfoFlags ) )</pre><p>To create the container, put the following LDIF data in a file. Substitute
your actual search base for <tt></tt><i>searchBase</i><tt></tt>.</p>
<p><tt>dn: ou=ClientInfo,</tt> <i>searchBase</i></p>
<p><tt>objectClass: organizationalUnit</tt></p>
<p><tt>ou: ClientInfo</tt></p>
<p><tt>objectClass: top</tt></p>
<p>Use the above file as input to the <tt>ldapadd</tt> command
in order to create the <tt>ou=ClientInfo</tt> container. For example,
if your LDAP administrator DN is <tt>cn=directory manager</tt>,
and the file with the LDIF data is called <tt>cifile</tt>, do the
following.</p>
<pre># <tt><b>ldapadd</b></tt> <tt>-D</tt> <tt><b></tt><i>cn="directory manager"</i><tt></b></tt> <tt>-f</tt> <tt><b>cifile</b></tt></pre><p>Depending on the authentication required, the <tt>ldapadd</tt> command
might prompt for a password.</p>
<p>The <tt>/var/nis/NIS+LDAPmapping.template</tt> file contains
commented-out definitions for the <tt>client_info.org_dir</tt> table.
Copy these to the actual mapping file, enable by removing the comment character
'#', and restart the <tt>rpc.nisd</tt> daemon.</p>
<pre># <tt><b>svcadm restart network/rpc/nisplus:default</b></tt></pre><p>If necessary, synchronize NIS+ and LDAP data as described in <a href="p64.html#nisplus2ldap-21">NIS+ to LDAP Migration Scenarios</a>.</p>
<a name="nisplus2ldap-59"></a><h4><tt>timezone</tt> Attributes
and Object Class</h4>
<p>Create attributes and object class as below, and then create the container
for the timezone data. The suggested container name is <tt>ou=Timezone</tt>.
(The LDIF data is suitable for <tt>ldapadd</tt>(1). Attribute and object class
OIDs are examples only.)</p>
<pre>dn: cn=schema
changetype: modify
add: attributetypes
attributetypes:	( 1.3.6.1.4.1.42.2.27.5.42.42.15.0 NAME 'nisplusTimeZone' \
		  DESC 'tzone column from NIS+ timezone table' \
		  SYNTAX 1.3.6.1.4.1.1466.115.121.1.26 SINGLE-VALUE )

dn: cn=schema
changetype: modify
add: objectclasses
objectclasses:	( 1.3.6.1.4.1.42.2.27.5.42.42.16.0 NAME 'nisplusTimeZoneData' \
		  DESC 'NIS+ timezone table data' \
		  SUP top STRUCTURAL MUST ( cn ) \
		  MAY ( nisplusTimeZone $ description ) )</pre><p>To create the <tt>ou=Timezone</tt> container, put the following
LDIF data in a file. Substitute your actual search base for <i>searchBase</i>.</p>
<p><tt>dn: ou=Timezone,</tt><i>searchBase</i><tt></tt> <tt>ou: Timezone</tt> <tt>objectClass: top</tt></p>
<p><tt>objectClass: organizationalUnit</tt></p>
<p>Use the above file as input to <tt>ldapadd</tt>(1) in order to create the <tt>ou=Timezone</tt> container. For example, if your LDAP administrator DN is <tt>cn=directory
manager</tt>, and the file with the LDIF data is called <tt>tzfile</tt>.</p>
<pre># <tt><b>ldapadd</b></tt> <tt>-D</tt> <tt><b></tt><i>cn="directory manager"</i><tt></b></tt> <tt>-f</tt> <tt><b>tzfile</b></tt></pre><p>Depending on the authentication required, the <tt>ldapadd</tt> command
might prompt for a password.</p>
<p>The <tt>/var/nis/NIS+LDAPmapping.template</tt> file contains
commented-out definitions for the <tt>timezone.org_dir</tt> table.
Copy these to the actual mapping file, enable by removing the comment character
'#', and restart the <tt>rpc.nisd</tt> daemon.</p>
<pre># <tt><b>svcadm restart network/rpc/nisplus:default</b></tt></pre><p>If necessary, synchronize NIS+ and LDAP data as described in <a href="p64.html#nisplus2ldap-21">NIS+ to LDAP Migration Scenarios</a>.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p67.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p69.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

