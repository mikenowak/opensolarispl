<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Output Formatting - Solaris Dynamic Tracing Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2005-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >Solaris Dynamic Tracing Guide<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p26.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p28.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="chp-fmt"></a>Chapter&nbsp;12<h3>Output Formatting</h3><p>DTrace provides built-in formatting functions <tt>printf()</tt> and <tt>printa()</tt> that you can use from your D programs to format output. The D compiler provides features not found in the <tt>printf</tt>(3C) library routine, so you should read this chapter even if you are already familiar with <tt>printf()</tt>. This chapter also discusses the formatting behavior of the <tt>trace()</tt> function and the default output format used by <tt>dtrace</tt>(1M) to display aggregations.</p>
<a name="chp-fmt-1"></a><h3><tt>printf()</tt></h3>
<p><a name="indexterm-220"></a>The <tt>printf()</tt> function combines the ability to trace data, as if by the <tt>trace()</tt> function, with the ability to output the data and other text in a specific format that you describe. The <tt>printf()</tt> function tells DTrace to trace the data associated with each argument after the first argument, and then to format the results using the rules described by the first <tt>printf()</tt> argument, known as a format string.</p>
<p>The format string is a regular string that contains any number of format conversions, each beginning with the <tt>%</tt> character, that describe how to format the corresponding argument. The first conversion in the format string corresponds to the second <tt>printf()</tt> argument, the second conversion to the third argument, and so on. All of the text between conversions is printed verbatim. The character following the <tt>%</tt> conversion character describes the format to use for the corresponding argument.</p>
<p>Unlike <tt>printf</tt>(3C), DTrace <tt>printf()</tt> is a built-in function that is recognized by the D compiler. The D compiler provides several useful services for DTrace <tt>printf()</tt> that are not found in the C library <tt>printf()</tt>:</p>
<ul><li><p>The D compiler compares the arguments to the conversions in the format string. If an argument's type is incompatible with the format conversion, the D compiler provides an error message explaining the problem. </p>
</li>
<li><p>The D compiler does not require the use of size prefixes with <tt>printf()</tt> format conversions. The C <tt>printf()</tt> routine requires that you indicate the size of arguments by adding prefixes such as <tt>%ld</tt> for <tt>long</tt> or <tt>%lld</tt> for <tt>long long</tt>. The D compiler knows the size and type of your arguments, so these prefixes are not required in your D <tt>printf()</tt> statements.</p>
</li>
<li><p>DTrace provides additional format characters that are useful for debugging and observability. For example, the <tt>%a</tt> format conversion can be used to print a pointer as a symbol name and offset.</p>
</li>
</ul>
<p>In order to implement these features, the format string in the DTrace <tt>printf()</tt> function must be specified as a string constant in your D program. Format strings may not be dynamic variables of type <tt>string</tt>.</p>
<a name="chp-fmt-1.1"></a><h4>Conversion Specifications</h4>
<p><a name="indexterm-221"></a>Each conversion specification in the format string is introduced by the <tt>%</tt> character, after which the following information appears in sequence:</p>
<ul><li><p>Zero or more flags (in any order), that modify the meaning of the conversion specification as described in the next section.</p>
</li>
<li><p>An optional minimum field width. If the converted value has fewer bytes than the field width, the value will be padded with spaces on the left by default, or on the right if the left-adjustment flag (<tt>-</tt>) is specified. The field width can also be specified as an asterisk (<tt>*</tt>), in which case the field width is set dynamically based on the value of an additional argument of type <tt>int</tt>.</p>
</li>
<li><p>An optional precision that indicates the minimum number of digits to appear for the <tt>d</tt>, <tt>i</tt>, <tt>o</tt>, <tt>u</tt>, <tt>x</tt>, and <tt>X</tt> conversions (the field is padded with leading zeroes); the number of digits to appear after the radix character for the <tt>e</tt>, <tt>E</tt>, and <tt>f</tt> conversions, the maximum number of significant digits for the <tt>g</tt> and <tt>G</tt> conversions; or the maximum number of bytes to be printed from a string by the <tt>s</tt> conversion. The precision takes the form of a period (<tt>.</tt>) followed by either an asterisk (<tt>*</tt>), described below, or a decimal digit string.</p>
</li>
<li><p>An optional sequence of size prefixes that indicate the size of the corresponding argument, described in <a href="p27.html#chp-fmt-1.4">Size Prefixes</a>. The size prefixes are not necessary in D and are provided for compatibility with the C <tt>printf()</tt> function.</p>
</li>
<li><p>A conversion specifier that indicates the type of conversion to be applied to the argument.</p>
</li>
</ul>
<p>The <tt>printf</tt>(3C) function also supports conversion specifications of the form <tt>%</tt><i>n</i><tt>$</tt> where <i>n</i> is a decimal integer; DTrace <tt>printf()</tt> does not support this type of conversion specification.</p>
<a name="chp-fmt-1.2"></a><h4>Flag Specifiers</h4>
<p><a name="indexterm-222"></a>The <tt>printf()</tt> conversion flags are enabled by specifying one or more of the following characters, which may appear in any order:</p>
<dl><dt><tt>'</tt></dt>
<dd><p>The integer portion of the result of a decimal conversion (<tt>%i</tt>, <tt>%d</tt>, <tt>%u</tt>, <tt>%f</tt>, <tt>%g</tt>, or <tt>%G</tt>) is formatted with thousands grouping characters using the non-monetary grouping character. Some locales, including the POSIX C locale, do not provide non-monetary grouping characters for use with this flag.</p>
</dd>
<dt><tt>-</tt></dt>
<dd><p>The result of the conversion is left-justified within the field. The conversion is right-justified if this flag is not specified.</p>
</dd>
<dt><tt>+</tt></dt>
<dd><p>The result of signed conversion always begins with a sign (<tt>+</tt> or <tt>-</tt>). If this flag is not specified, the conversion begins with a sign only when a negative value is converted.</p>
</dd>
<dt><tt>space</tt></dt>
<dd><p>If the first character of a signed conversion is not a sign or if a signed conversion results in no characters, a space is placed before the result. If the <tt>space</tt> and <tt>+</tt> flags both appear, the space flag is ignored.</p>
</dd>
<dt><tt>#</tt></dt>
<dd><p>The value is converted to an alternate form if an alternate form is defined for the selected conversion. The alternate formats for conversions are described along with the corresponding conversion.</p>
</dd>
<dt><tt>0</tt></dt>
<dd><p>For <tt>d</tt>, <tt>i</tt>, <tt>o</tt>, <tt>u</tt>, <tt>x</tt>, <tt>X</tt>, <tt>e</tt>, <tt>E</tt>, <tt>f</tt>, <tt>g</tt>, and <tt>G</tt> conversions, leading zeroes (following any indication of sign or base) are used to pad to the field width. No space padding is performed. If the <tt>0</tt> and <tt>-</tt> flags both appear, the <tt>0</tt> flag is ignored. For <tt>d</tt>, <tt>i</tt>, <tt>o</tt>, <tt>u</tt>, <tt>x</tt>, and <tt>X</tt> conversions, if a precision is specified, the <tt>0</tt> flag is ignored. If the <tt>0</tt> and <tt>'</tt> flags both appear, the grouping characters are inserted before the zero padding.</p>
</dd>
</dl>
<a name="chp-fmt-1.3"></a><h4>Width and Precision Specifiers</h4>
<p><a name="indexterm-223"></a>The minimum field width can be specified as a decimal digit string following any flag specifier, in which case the field width is set to the specified number of columns. The field width can also be specified as asterisk (<tt>*</tt>) in which case an additional argument of type <tt>int</tt> is accessed to determine the field width. For example, to print an integer <tt>x</tt> in a field width determined by the value of the <tt>int</tt> variable <tt>w</tt>, you would write the D statement:</p>
<pre>printf("%*d", w, x);</pre><p>The field width can also be specified using a <tt>?</tt> character to indicate that the field width should be set based on the number of characters required to format an address in hexadecimal in the data model of the operating system kernel. The width is set to 8 if the kernel is using the 32&ndash;bit data model, or to 16 if the kernel is using the 64&ndash;bit data model.</p>
<p>The precision for the conversion can be specified as a decimal digit string following a period (<tt>.</tt>) or by an asterisk (<tt>*</tt>) following a period. If an asterisk is used to specify the precision, an additional argument of type <tt>int</tt> prior to the conversion argument is accessed to determine the precision. If both width and precision are specified as asterisks, the order of arguments to <tt>printf()</tt> for the conversion should appear in the following order: width, precision, value.</p>
<a name="chp-fmt-1.4"></a><h4>Size Prefixes</h4>
<p><a name="indexterm-224"></a>Size prefixes are required in ANSI-C programs that use <tt>printf</tt>(3C) in order to indicate the size and type of the conversion argument. The D compiler performs this processing for your <tt>printf()</tt> calls automatically, so size prefixes are not required. Although size prefixes are provided for C compatibility, their use is explicitly discouraged in D programs because they bind your code to a particular data model when using derived types. For example, if a <tt>typedef</tt> is redefined to different integer base types depending on the data model, it is not possible to use a single C conversion that works in both data models without explicitly knowing the two underlying types and including a cast expression, or defining multiple format strings. The D compiler solves this problem automatically by allowing you to omit size prefixes and automatically determining the argument size.</p>
<p>The size prefixes can be placed just prior to the format conversion name and after any flags, widths, and precision specifiers. The size prefixes are as follows:</p>
<ul><li><p>An optional <tt>h</tt> specifies that a following <tt>d</tt>, <tt>i</tt>, <tt>o</tt>, <tt>u</tt>, <tt>x</tt>, or <tt>X</tt> conversion applies to a <tt>short</tt> or <tt>unsigned short</tt>.</p>
</li>
<li><p>An optional <tt>l</tt> specifies that a following <tt>d</tt>, <tt>i</tt>, <tt>o</tt>, <tt>u</tt>, <tt>x</tt>, or <tt>X</tt> conversion applies to a <tt>long</tt> or <tt>unsigned long</tt>.</p>
</li>
<li><p>An optional <tt>ll</tt> specifies that a following <tt>d</tt>, <tt>i</tt>, <tt>o</tt>, <tt>u</tt>, <tt>x</tt>, or <tt>X</tt> conversion applies to a <tt>long long</tt> or <tt>unsigned long long</tt>.</p>
</li>
<li><p>An optional <tt>L</tt> specifies that a following <tt>e</tt>, <tt>E</tt>, <tt>f</tt>, <tt>g</tt>, or <tt>G</tt> conversion applies to a <tt>long double</tt>.</p>
</li>
<li><p>An optional <tt>l</tt> specifies that a following <tt>c</tt> conversion applies to a <tt>wint_t</tt> argument, and that a following <tt>s</tt> conversion character applies to a pointer to a<tt>wchar_t</tt> argument.</p>
</li>
</ul>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p26.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p28.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

