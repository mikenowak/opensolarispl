<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title><tt>sysinfo</tt> Provider - Solaris Dynamic Tracing Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2005-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >Solaris Dynamic Tracing Guide<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p43.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p45.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="chp-sysinfo"></a>Chapter&nbsp;23<h3><tt>sysinfo</tt> Provider</h3><p>The <tt>sysinfo</tt> provider makes available probes that correspond to kernel statistics classified by the name <tt>sys</tt>. Because these statistics provide the input for system monitoring utilities like <tt>mpstat</tt>(1M), the <tt>sysinfo</tt> provider enables quick exploration of observed aberrant behavior.</p>
<a name="chp-sysinfo-1"></a><h3>Probes</h3>
<p>The <tt>sysinfo</tt> provider makes available probes that correspond to the fields in the <tt>sys</tt> named kernel statistic: a probe provided by <tt>sysinfo</tt> fires immediately before the corresponding <tt>sys</tt> value is incremented. The following example shows how to display both the names and the current values of the <tt>sys</tt> named kernel statistic using the <tt>kstat</tt>(1M) command.</p>
<pre><tt><b>$ kstat -n sys</b></tt>
module: cpu                             instance: 0
name:   sys                             class:    misc
	bawrite                         123
	bread                           2899
	bwrite                          17995
	cpu_ticks_idle                  73743866
	cpu_ticks_kernel                2096277
	cpu_ticks_user                  1010122
	cpu_ticks_wait                  46413
...</pre><p>The <tt>sysinfo</tt> probes are described in <a href="p44.html#tbl-sysinfo">Table 23-1</a>.</p>
<a name="tbl-sysinfo"></a>Table 23-1 <tt>sysinfo</tt> Probes<table><tr><td><p><tt>bawrite</tt></p>
</td><td><p>Probe that fires whenever a buffer is about to be asynchronously written out to a device.</p>
</td></tr>
<tr><td><p><tt>bread</tt></p>
</td><td><p>Probe that fires whenever a buffer is physically read from a device. <tt>bread</tt> fires <b>after</b> the buffer has been requested from the device, but <b>before</b> blocking pending its completion.</p>
</td></tr>
<tr><td><p><tt>bwrite</tt></p>
</td><td><p>Probe that fires whenever a buffer is about to be written out to a device, whether synchronously <b>or</b> asynchronously.</p>
</td></tr>
<tr><td><p><tt>cpu_ticks_idle</tt></p>
</td><td><p>Probe that fires when the periodic system clock has made the determination that a CPU is <b>idle</b>. Note that this probe fires in the context of the system clock and therefore fires on the CPU running the system clock. The <tt>cpu_t</tt> argument (<tt>arg2</tt>) indicates the CPU that has been deemed idle. See <a href="p44.html#chp-sysinfo-args">Arguments</a> for details.</p>
</td></tr>
<tr><td><p><tt>cpu_ticks_kernel</tt></p>
</td><td><p>Probe that fires when the periodic system clock has made the determination that a CPU is executing in the <b>kernel</b>. This probe fires in the context of the system clock and therefore fires on the CPU running the system clock. The <tt>cpu_t</tt> argument (<tt>arg2</tt>) indicates the CPU that has been deemed to be executing in the kernel. See <a href="p44.html#chp-sysinfo-args">Arguments</a> for details.</p>
</td></tr>
<tr><td><p><tt>cpu_ticks_user</tt></p>
</td><td><p>Probe that fires when the periodic system clock has made the determination that a CPU is executing in <b>user mode</b>. This probe fires in the context of the system clock and therefore fires on the CPU running the system clock. The <tt>cpu_t</tt> argument (<tt>arg2</tt>) indicates the CPU that has been deemed to be running in user-mode. See <a href="p44.html#chp-sysinfo-args">Arguments</a> for details.</p>
</td></tr>
<tr><td><p><tt>cpu_ticks_wait</tt></p>
</td><td><p>Probe that fires when the periodic system clock has made the determination that a CPU is otherwise idle, but some threads are waiting for I/O on the CPU. This probe fires in the context of the system clock and therefore fires on the CPU running the system clock. The <tt>cpu_t</tt> argument (<tt>arg2</tt>) indicates the CPU that has been deemed waiting on I/O. See <a href="p44.html#chp-sysinfo-args">Arguments</a> for details.</p>
</td></tr>
<tr><td><p><tt>idlethread</tt></p>
</td><td><p>Probe that fires whenever a CPU enters the idle loop.</p>
</td></tr>
<tr><td><p><tt>intrblk</tt></p>
</td><td><p>Probe that fires whenever an interrupt thread blocks.</p>
</td></tr>
<tr><td><p><tt>inv_swtch</tt></p>
</td><td><p>Probe that fires whenever a running thread is forced to involuntarily give up the CPU.</p>
</td></tr>
<tr><td><p><tt>lread</tt></p>
</td><td><p>Probe that fires whenever a buffer is logically read from a device.</p>
</td></tr>
<tr><td><p><tt>lwrite</tt></p>
</td><td><p>Probe that fires whenever a buffer is logically written to a device</p>
</td></tr>
<tr><td><p><tt>modload</tt></p>
</td><td><p>Probe that fires whenever a kernel module is loaded.</p>
</td></tr>
<tr><td><p><tt>modunload</tt></p>
</td><td><p>Probe that fires whenever a kernel module is unloaded.</p>
</td></tr>
<tr><td><p><tt>msg</tt></p>
</td><td><p>Probe that fires whenever a <tt>msgsnd</tt>(2) or <tt>msgrcv</tt>(2) system call is made, but before the message queue operations have been performed.</p>
</td></tr>
<tr><td><p><tt>mutex_adenters</tt></p>
</td><td><p>Probe that fires whenever an attempt is made to acquire an owned adaptive lock. If this probe fires, one of the <tt>lockstat</tt> provider's <tt>adaptive-block</tt> or <tt>adaptive-spin</tt> probes will also fire. See <a href="p37.html">Chapter&nbsp;18, <tt>lockstat</tt> Provider</a> for details.</p>
</td></tr>
<tr><td><p><tt>namei</tt></p>
</td><td><p>Probe that fires whenever a name lookup is attempted in the filesystem.</p>
</td></tr>
<tr><td><p><tt>nthreads</tt></p>
</td><td><p>Probe that fires whenever a thread is created.</p>
</td></tr>
<tr><td><p><tt>phread</tt></p>
</td><td><p>Probe that fires whenever a raw I/O read is about to be performed.</p>
</td></tr>
<tr><td><p><tt>phwrite</tt></p>
</td><td><p>Probe that fires whenever a raw I/O write is about to be performed.</p>
</td></tr>
<tr><td><p><tt>procovf</tt></p>
</td><td><p>Probe that fires whenever a new process cannot be created because the system is out of process table entries.</p>
</td></tr>
<tr><td><p><tt>pswitch</tt></p>
</td><td><p>Probe that fires whenever a CPU switches from executing one thread to executing another.</p>
</td></tr>
<tr><td><p><tt>readch</tt></p>
</td><td><p>Probe that fires after each successful read, but before control is returned to the thread performing the read. A read may occur through the <tt>read</tt>(2), <tt>readv</tt>(2) or <tt>pread</tt>(2) system calls. <tt>arg0</tt> contains the number of bytes that were successfully read.</p>
</td></tr>
<tr><td><p><tt>rw_rdfails</tt></p>
</td><td><p>Probe that fires whenever an attempt is made to read-lock a readers/writer when the lock is either held by a writer, or desired by a writer. If this probe fires, the <tt>lockstat</tt> provider's <tt>rw-block</tt> probe will also fire. See <a href="p37.html">Chapter&nbsp;18, <tt>lockstat</tt> Provider</a> for details.</p>
</td></tr>
<tr><td><p><tt>rw_wrfails</tt></p>
</td><td><p>Probe that fires whenever an attempt is made to write-lock a readers/writer lock when the lock is held either by some number of readers or by another writer. If this probe fires, the <tt>lockstat</tt> provider's <tt>rw-block</tt> probe will also fire. See <a href="p37.html">Chapter&nbsp;18, <tt>lockstat</tt> Provider</a> for details.</p>
</td></tr>
<tr><td><p><tt>sema</tt></p>
</td><td><p>Probe that fires whenever a <tt>semop</tt>(2) system call is made, but before any semaphore operations have been performed.</p>
</td></tr>
<tr><td><p><tt>sysexec</tt></p>
</td><td><p>Probe that fires whenever an <tt>exec</tt>(2) system call is made.</p>
</td></tr>
<tr><td><p><tt>sysfork</tt></p>
</td><td><p>Probe that fires whenever a <tt>fork</tt>(2) system call is made.</p>
</td></tr>
<tr><td><p><tt>sysread</tt></p>
</td><td><p>Probe that fires whenever a <tt>read</tt>(2), <tt>readv</tt>(2), or <tt>pread</tt>(2) system call is made.</p>
</td></tr>
<tr><td><p><tt>sysvfork</tt></p>
</td><td><p>Probe that fires whenever a <tt>vfork</tt>(2) system call is made.</p>
</td></tr>
<tr><td><p><tt>syswrite</tt></p>
</td><td><p>Probe that fires whenever a <tt>write</tt>(2), <tt>writev</tt>(2), or <tt>pwrite</tt>(2) system call is made.</p>
</td></tr>
<tr><td><p><tt>trap</tt></p>
</td><td><p>Probe that fires whenever a processor trap occurs. Note that some processors, in particular UltraSPARC variants, handle some light-weight traps through a mechanism that does not cause this probe to fire.</p>
</td></tr>
<tr><td><p><tt>ufsdirblk</tt></p>
</td><td><p>Probe that fires whenever a directory block is read from the UFS file system. See <tt>ufs</tt>(7FS) for details on UFS.</p>
</td></tr>
<tr><td><p><tt>ufsiget</tt></p>
</td><td><p>Probe that fires whenever an inode is retrieved. See <tt>ufs</tt>(7FS) for details on UFS.</p>
</td></tr>
<tr><td><p><tt>ufsinopage</tt></p>
</td><td><p>Probe that fires after an in-core inode <b>without</b> any associated data pages has been made available for reuse. See <tt>ufs</tt>(7FS) for details on UFS.</p>
</td></tr>
<tr><td><p><tt>ufsipage</tt></p>
</td><td><p>Probe that fires after an in-core inode <b>with</b> associated data pages has been made available for reuse. This probe fires after the associated data pages have been flushed to disk. See <tt>ufs</tt>(7FS) for details on UFS.</p>
</td></tr>
<tr><td><p><tt>wait_ticks_io</tt></p>
</td><td><p>Probe that fires when the periodic system clock has made the determination that a CPU is otherwise idle but some threads are waiting for I/O on the CPU. This probe fires in the context of the system clock and therefore fires on the CPU running the system clock. The <tt>cpu_t</tt> argument (<tt>arg2</tt>) indicates the CPU that is described as waiting for I/O. See <a href="p44.html#chp-sysinfo-args">Arguments</a> for details on <tt>arg2</tt>. No semantic difference between <tt>wait_ticks_io</tt> and <tt>cpu_ticks_wait</tt>; <tt>wait_ticks_io</tt> exists solely for historical reasons.</p>
</td></tr>
<tr><td><p><tt>writech</tt></p>
</td><td><p>Probe that fires after each successful write, but before control is returned to the thread performing the write. A write may occur through the <tt>write</tt>(2), <tt>writev</tt>(2) or <tt>pwrite</tt>(2) system calls. <tt>arg0</tt> contains the number of bytes that were successfully written.</p>
</td></tr>
<tr><td><p><tt>xcalls</tt></p>
</td><td><p>Probe that fires whenever a cross-call is about to be made. A cross-call is the operating system's mechanism for one CPU to request immediate work of another CPU.</p>
</td></tr>
</table><a name="chp-sysinfo-args"></a><h3>Arguments</h3>
<p>The arguments to <tt>sysinfo</tt> probes are as follows:</p>
<table><tr><td><p><tt>arg0</tt></p>
</td><td><p>The value by which the statistic is to be incremented. For most probes, this argument is always 1, but for some probes this argument may take other values.</p>
</td></tr>
<tr><td><p><tt>arg1</tt></p>
</td><td><p>A pointer to the current value of the statistic to be incremented. This value is a 64&ndash;bit quantity that will be incremented by the value in <tt>arg0</tt>. Dereferencing this pointer enables consumers to determine the current count of the statistic corresponding to the probe.</p>
</td></tr>
<tr><td><p><tt>arg2</tt></p>
</td><td><p>A pointer to the <tt>cpu_t</tt> structure that corresponds to the CPU on which the statistic is to be incremented. This structure is defined in <tt>&lt;sys/cpuvar.h></tt>, but it is part of the kernel implementation and should be considered Private.</p>
</td></tr>
</table><p>The value of <tt>arg0</tt> is 1 for most <tt>sysinfo</tt> probes. However, the <tt>readch</tt> and <tt>writech</tt> probes set <tt>arg0</tt> to the number of bytes read or written, respectively. This features permits you to determine the size of reads by executable name, as shown in the following example:</p>
<pre><tt><b># dtrace -n readch'{@[execname] = quantize(arg0)}'</b></tt>
dtrace: description 'readch' matched 4 probes
<tt><b>^C</b></tt>
  xclock                                            
           value  ------------- Distribution ------------- count    
              16 |                                         0        
              32 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 1        
              64 |                                         0        

  acroread                                          
           value  ------------- Distribution ------------- count    
              16 |                                         0        
              32 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 3        
              64 |                                         0        

  FvwmAuto                                          
           value  ------------- Distribution ------------- count    
               2 |                                         0        
               4 |@@@@@@@@@@@@@                            13       
               8 |@@@@@@@@@@@@@@@@@@@@@                    21       
              16 |@@@@@                                    5        
              32 |                                         0        

  xterm                                             
           value  ------------- Distribution ------------- count    
              16 |                                         0        
              32 |@@@@@@@@@@@@@@@@@@@@@@@@                 19       
              64 |@@@@@@@@@                                7        
             128 |@@@@@@                                   5        
             256 |                                         0        

  fvwm2                                             
           value  ------------- Distribution ------------- count    
              -1 |                                         0        
               0 |@@@@@@@@@                                186      
               1 |                                         0        
               2 |                                         0        
               4 |@@                                       51       
               8 |                                         17       
              16 |                                         0        
              32 |@@@@@@@@@@@@@@@@@@@@@@@@@@               503      
              64 |                                         9        
             128 |                                         0        

  Xsun                                              
           value  ------------- Distribution ------------- count    
              -1 |                                         0        
               0 |@@@@@@@@@@@                              269      
               1 |                                         0        
               2 |                                         0        
               4 |                                         2        
               8 |@                                        31       
              16 |@@@@@                                    128      
              32 |@@@@@@@                                  171      
              64 |@                                        33       
             128 |@@@                                      85       
             256 |@                                        24       
             512 |                                         8        
            1024 |                                         21       
            2048 |@                                        26       
            4096 |                                         21       
            8192 |@@@@                                     94       
           16384 |                                         0</pre><p>The <tt>sysinfo</tt> provider sets <tt>arg2</tt> to be a pointer to a <tt>cpu_t</tt>, a structure internal to the kernel implementation. Most <tt>sysinfo</tt> probes fire on the CPU on which the statistic is being incremented, but some probes do not. The exceptional probes include <tt>cpu_ticks_idle</tt>, <tt>cpu_ticks_kernel</tt>, <tt>cpu_ticks_user</tt> and <tt>cpu_ticks_wait</tt>, which always fire on the CPU executing the system clock. Use the <tt>cpu_id</tt> member of the <tt>cpu_t</tt> structure to determine the CPU of interest. The following D script runs for about ten seconds and gives a quick snapshot of relative CPU behavior on a statistic-by-statistic basis:</p>
<pre>cpu_ticks_*
{
	@[probename] = lquantize(((cpu_t *)arg2)->cpu_id, 0, 1024, 1);
}

tick-1sec
/x++ >= 10/
{
	exit(0);
}</pre><p>Running the above script results in output similar to the following example:</p>
<pre><tt><b># dtrace -s ./tick.d</b></tt>
dtrace: script './tick.d' matched 5 probes
CPU     ID                    FUNCTION:NAME
 22  37588                       :tick-1sec 

  cpu_ticks_user                                    
           value  ------------- Distribution ------------- count    
              11 |                                         0        
              12 |@@@@@@@@                                 14       
              13 |@@@@                                     7        
              14 |@                                        3        
              15 |@                                        2        
              16 |@@                                       4        
              17 |@@@@@@                                   10       
              18 |                                         0        
              19 |@                                        2        
              20 |@@@                                      6        
              21 |@@@                                      5        
              22 |                                         1        
              23 |@@@@@@                                   10       
              24 |                                         0        

  cpu_ticks_wait                                    
           value  ------------- Distribution ------------- count    
              11 |                                         0        
              12 |@@@@@@@@@@@@@                            241      
              13 |@@@@@@@@@@@@@                            236      
              14 |                                         16       
              15 |@@@@@@@                                  132      
              16 |                                         11       
              17 |                                         10       
              18 |                                         7        
              19 |@                                        18       
              20 |                                         4        
              21 |                                         16       
              22 |                                         13       
              23 |                                         10       
              24 |                                         0        

  cpu_ticks_kernel                                  
           value  ------------- Distribution ------------- count    
              11 |                                         0        
              12 |@@@@@@@@                                 234      
              13 |@@@@@                                    159      
              14 |@@@                                      104      
              15 |@@@@                                     131      
              16 |@@                                       66       
              17 |@                                        40       
              18 |@                                        51       
              19 |@                                        36       
              20 |@@                                       56       
              21 |@                                        42       
              22 |@@@                                      96       
              23 |@@                                       57       
              24 |                                         0        

  cpu_ticks_idle                                    
           value  ------------- Distribution ------------- count    
              11 |                                         0        
              12 |@@                                       534      
              13 |@@                                       621      
              14 |@@@                                      900      
              15 |@@                                       758      
              16 |@@@                                      942      
              17 |@@@                                      963      
              18 |@@@                                      965      
              19 |@@@                                      967      
              20 |@@@                                      957      
              21 |@@@                                      960      
              22 |@@@                                      913      
              23 |@@@                                      946      
              24 |                                         0</pre><a name="chp-sysinfo-6"></a><h3>Example</h3>
<p>Examine the following output from <tt>mpstat</tt>(1M):</p>
<pre>CPU minf mjf xcal  intr ithr  csw icsw migr smtx  srw syscl  usr sys  wt idl
 12   90  22 5760   422  299  435   26   71  116   11  1372    5  19  17  60
 13   46  18 4585   193  162  431   25   69  117   12  1039    3  17  14  66
 14   33  13 3186   405  381  397   21   58  105   10   770    2  17  11  70
 15   34  19 4769   109   78  417   23   57  115   13   962    3  14  14  69
 16   74  16 4421   437  406  448   29   77  111    8  1020    4  23  14  59
 17   51  15 4493   139  110  378   23   62  109    9   928    4  18  14  65
 18   41  14 4204   494  468  360   23   56  102    9   849    4  17  12  68
 19   37  14 4229   115   87  363   22   50  106   10   845    3  15  14  67
 20   78  17 5170   200  169  456   26   69  108    9  1119    5  21  25  49
 21   53  16 4817    78   51  394   22   56  106    9   978    4  17  22  57
 22   32  13 3474   486  463  347   22   48  106    9   769    3  17  17  63
 23   43  15 4572    59   34  361   21   46  102   10   947    4  15  22  59</pre><p>From the above output, you might conclude that the <tt>xcal</tt> field seems too high, especially given the relative idleness of the system. <tt>mpstat</tt> determines the value in the <tt>xcal</tt> field by examining the <tt>xcalls</tt> field of the <tt>sys</tt> kernel statistic. This aberration can therefore be explored easily by enabling the <tt>xcalls</tt> <tt>sysinfo</tt> probe, as shown in the following example:</p>
<pre><tt><b># dtrace -n xcalls'{@[execname] = count()}'</b></tt>
dtrace: description 'xcalls' matched 4 probes
<tt><b>^C</b></tt>
  dtterm                                                            1
  nsrd                                                              1
  in.mpathd                                                         2
  top                                                               3
  lockd                                                             4
  java_vm                                                          10
  ksh                                                              19
  iCald.pl6+RPATH                                                  28
  nwadmin                                                          30
  fsflush                                                          34
  nsrindexd                                                        45
  in.rlogind                                                       56
  in.routed                                                       100
  dtrace                                                          153
  rpc.rstatd                                                      246
  imapd                                                           377
  sched                                                           431
  nfsd                                                           1227
  find                                                           3767</pre><p>The output shows where to look for the source of the cross-calls. Some number of <tt>find</tt>(1) processes are causing the majority of the cross-calls. The following D script can be used to understand the problem in further detail:</p>
<pre>syscall:::entry
/execname == "find"/
{
	self->syscall = probefunc;
	self->insys = 1;
}

sysinfo:::xcalls
/execname == "find"/
{
	@[self->insys ? self->syscall : "&lt;none>"] = count();
}

syscall:::return
/self->insys/
{
	self->insys = 0;
	self->syscall = NULL;
}</pre><p>This script uses the <tt>syscall</tt> provider to attribute cross-calls from <tt>find</tt> to a particular system call. Some cross-calls, such as those resulting from page faults, might not emanate from system calls. The script prints &ldquo;<tt>&lt;none></tt>&rdquo; in these cases. Running the script results in output similar to the following example:</p>
<pre><tt><b># dtrace -s ./find.d</b></tt>
 dtrace: script './find.d' matched 444 probes
<tt><b>^C</b></tt>
  &lt;none>                                                            2
  lstat64                                                        2433
  getdents64                                                    14873</pre><p>This output indicates that the majority of cross-calls induced by <tt>find</tt> are in turn induced by <tt>getdents</tt>(2) system calls. Further exploration would depend on the direction you want to explore. If you want to understand why <tt>find</tt> processes are making calls to <tt>getdents</tt>, you could write a D script to aggregate on <tt>ustack()</tt> when <tt>find</tt> induces a cross-call. If you want to understand why calls to <tt>getdents</tt> are inducing cross-calls, you could write a D script to aggregate on <tt>stack()</tt> when <tt>find</tt> induces a cross-call. Whatever your next step, the presence of the <tt>xcalls</tt> probe has enabled you to quickly discover the root cause of the unusual monitoring output.</p>
<a name="chp-sysinfo-stability"></a><h3>Stability</h3>
<p>The <tt>sysinfo</tt> provider uses DTrace's stability mechanism to describe its stabilities, as shown in the following table. For more information about the stability mechanism, see <a href="p64.html">Chapter&nbsp;39, Stability</a>.</p>
<table><tr><th><p>Element</p>
</th><th><p>Name stability</p>
</th><th><p>Data stability</p>
</th><th><p>Dependency class</p>
</th></tr>
<tr><td><p>Provider</p>
</td><td><p>Evolving</p>
</td><td><p>Evolving</p>
</td><td><p>ISA</p>
</td></tr>
<tr><td><p>Module</p>
</td><td><p>Private</p>
</td><td><p>Private</p>
</td><td><p>Unknown</p>
</td></tr>
<tr><td><p>Function</p>
</td><td><p>Private</p>
</td><td><p>Private</p>
</td><td><p>Unknown</p>
</td></tr>
<tr><td><p>Name</p>
</td><td><p>Evolving</p>
</td><td><p>Evolving</p>
</td><td><p>ISA</p>
</td></tr>
<tr><td><p>Arguments</p>
</td><td><p>Private</p>
</td><td><p>Private</p>
</td><td><p>ISA</p>
</td></tr>
</table>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p43.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p45.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

