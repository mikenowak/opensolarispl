<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Creating
PPPoE Tunnels for DSL Support - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p129.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p135.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p137.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="ppp.reference-45"></a><h3>Creating
PPPoE Tunnels for DSL Support</h3>
<p>By using PPPoE, you can provide
PPP over high-speed digital services
to multiple clients that are using
one or more DSL modems. PPPoE implements
these services by creating an Ethernet
tunnel through three participants:
the enterprise, the telephone company,
and the service provider.</p>
<ul><li><p>For an overview and
description of how PPPoE works, see <a href="p106.html#ppp.intro-20">PPPoE Overview</a>.</p>
</li>
<li><p>For tasks for setting
up PPPoE tunnels, see <a href="p122.html">Chapter&nbsp;20, Setting Up a PPPoE Tunnel (Tasks)</a>.</p>
</li>
</ul>
<p><a name="indexterm-2057"></a>This section contains
detailed information about PPPoE commands
and files, which is summarized in
the next table.</p>
<a name="ppp.intro-tbl-26"></a>Table 22-2 PPPoE
Commands and Configuration Files<table><tr><th><p>File or Command </p>
</th><th><p>Description</p>
</th><th><p>For Instructions</p>
</th></tr>
<tr><td><p><tt>/etc/ppp/pppoe</tt></p>
</td><td><p>A file that contains characteristics
that are applied by default to all
tunnels that were set up by PPPoE
on the system</p>
</td><td><p><a href="p136.html#ppp.reference-52"><tt>/etc/ppp/pppoe</tt> File</a></p>
</td></tr>
<tr><td><p><tt>/etc/ppp/pppoe.</tt><i>device</i></p>
</td><td><p>A file that contains characteristics
of a particular interface that is
used by PPPoE for a tunnel</p>
</td><td><p><a href="p137.html"><tt>/etc/ppp/pppoe.</tt><i>device</i> File</a></p>
</td></tr>
<tr><td><p><tt>/etc/ppp/pppoe.if</tt></p>
</td><td><p>File that lists the Ethernet
interface over which runs the tunnel
that is set up by PPPoE</p>
</td><td><p><a href="p136.html#ppp.reference-51"><tt>/etc/ppp/pppoe.if</tt> File</a></p>
</td></tr>
<tr><td><p><tt>/usr/sbin/sppptun</tt></p>
</td><td><p>Command for configuring the
Ethernet interfaces that are involved
in a PPPoE tunnel</p>
</td><td><p><a href="p136.html#ppp.reference-49"><tt>/usr/sbin/sppptun</tt> Command</a></p>
</td></tr>
<tr><td><p><tt>/usr/lib/inet/pppoed</tt> </p>
</td><td><p>Command and options for using
PPPoE to set up a tunnel</p>
</td><td><p><a href="p136.html#ppp.reference-48"><tt>/usr/lib/inet/pppoed</tt> Daemon</a></p>
</td></tr>
</table><a name="ppp.reference-50"></a><h4>Files
for Configuring Interfaces for PPPoE</h4>
<p>The interfaces that are used
at either end of the PPPoE tunnel
must be configured before the tunnel
can support PPP communications. Use <tt>/usr/sbin/sppptun</tt> and <tt>/etc/ppp/pppoe.if</tt> files
for this purpose. You must use these
tools to configure Ethernet interfaces
on all Solaris PPPoE clients and PPPoE
access servers.</p>
<a name="ppp.reference-51"></a><h5><tt>/etc/ppp/pppoe.if</tt> File</h5>
<p><a name="indexterm-2058"></a><a name="indexterm-2059"></a>The <tt>/etc/ppp/pppoe.if</tt> file lists the names of
all Ethernet interfaces on a host
to be used for the PPPoE tunnels.
This file is processed during system
boot when the interfaces that are
listed are plumbed for use in PPPoE
tunnels.</p>
<p>You need to create explicitly <tt>/etc/ppp/pppoe.if</tt>. Type
the name of one interface to be configured
for PPPoE on each line.</p>
<p><a name="indexterm-2060"></a>The following example
shows an <tt>/etc/ppp/pppoe.if</tt> file
for a server that offers three interfaces
for PPPoE tunnels.</p>
<pre># <tt><b>cat /etc/ppp/pppoe.if</b></tt>
hme1
hme2
hme3</pre><p>PPPoE clients usually have only
one interface that is listed in <tt>/etc/ppp/pppoe.if</tt>.</p>
<a name="ppp.reference-49"></a><h5><tt>/usr/sbin/sppptun</tt> Command</h5>
<p><a name="indexterm-2061"></a><a name="indexterm-2062"></a>You can use the <tt>/usr/sbin/sppptun</tt> command to manually plumb
and unplumb the Ethernet interfaces
to be used for PPPoE tunnels. By contrast, <tt>/etc/ppp/pppoe.if</tt> is only
read when the system boots. These
interfaces should correspond to the
interfaces that are listed in <tt>/etc/ppp/pppoe.if</tt>.</p>
<p><tt>sppptun</tt> plumbs
the Ethernet interfaces that are used
in PPPoE tunnels in a manner that
is similar to the <tt>ifconfig</tt> command.
Unlike <tt>ifconfig</tt>,
you must plumb interfaces twice to
support PPPoE because two Ethernet
protocol numbers are involved.</p>
<p>The basic syntax for <tt>sppptun</tt> is as follows:</p>
<pre><tt><b># /usr/sbin/sppptun plumb pppoed</b></tt> <i>device-name</i>
     <i>device-name</i>:pppoed
<tt><b># /usr/sbin/sppptun plumb pppoe</b></tt> <tt>device-name</tt>
     <i>device-name</i>:pppoe</pre><p>In this syntax, <i>device-name</i> is the name of the
device to be plumbed for PPPoE.</p>
<p>The first time that you issue
the <tt>sppptun</tt> command,
the discovery protocol <tt>pppoed</tt> is
plumbed on the interface. The second
time that you run <tt>sppptun</tt>,
the session protocol <tt>pppoe</tt> is
plumbed. <tt>sppptun</tt> prints
the name of the interface that was
just plumbed. You use this name to
unplumb the interface, when necessary.</p>
<p>For more information, refer
to the <tt>sppptun</tt>(1M) man
page.</p>
<a name="egjzz"></a><h5>Examples
of <tt>sppptun</tt> Commands
for Administering Interfaces</h5>
<p>The following example shows
how to manually plumb an interface
for PPPoE by using <tt>/usr/sbin/sppptun</tt>.</p>
<pre># <tt><b>/usr/sbin/sppptun plumb pppoed hme0</b></tt>
hme0:pppoed
# <tt><b>/dev/sppptun plumb pppoe hme0</b></tt>
 hme0:pppoe</pre><p>This example shows how to list
the interfaces on an access server
that was plumbed for PPPoE.</p>
<pre># <tt><b>/usr/sbin/sppptun query</b></tt>
hme0:pppoe
hme0:pppoed
hme1:pppoe
hme1:pppoed
hme2:pppoe
hme2:pppoed</pre><p>This example shows how to unplumb
an interface.</p>
<pre># <tt><b>sppptun unplumb hme0:pppoed</b></tt>
# <tt><b>sppptun unplumb hme0:pppoe</b></tt></pre><a name="ppp.reference-47"></a><h4>PPPoE
Access Server Commands and Files</h4>
<p><a name="indexterm-2063"></a>A service provider that
offers DSL services or support to
customers can use an access server
that is running Solaris PPPoE. The
PPPoE access server and client do
function in the traditional client-server
relationship. This relationship is
similar to the relationship of the
dial-out machine and dial-in server
on a dial-up link.  One PPPoE system
initiates communications and one PPPoE
system answers. By contrast, the PPP
protocol has no notion of the client-server
relationship.  PPP considers both
systems equal peers.</p>
<p>The commands and files that
set up a PPPoE access server include
the following: </p>
<ul><li><p><a href="p136.html#ppp.reference-49"><tt>/usr/sbin/sppptun</tt> Command</a></p>
</li>
<li><p><a href="p136.html#ppp.reference-48"><tt>/usr/lib/inet/pppoed</tt> Daemon</a></p>
</li>
<li><p><a href="p136.html#ppp.reference-52"><tt>/etc/ppp/pppoe</tt> File</a></p>
</li>
<li><p><a href="p137.html"><tt>/etc/ppp/pppoe.</tt><i>device</i> File</a></p>
</li>
<li><p><a href="p137.html#ppp.reference-63"><tt>pppoe.so</tt> Shared Object</a></p>
</li>
</ul>
<a name="ppp.reference-48"></a><h5><tt>/usr/lib/inet/pppoed</tt> Daemon</h5>
<p><a name="indexterm-2064"></a>The <tt>pppoed</tt> daemon
accepts broadcasts for services from
prospective PPPoE clients. Additionally, <tt>pppoed</tt> negotiates the server
side of the PPPoE tunnel and runs <tt>pppd</tt>, the PPP daemon, over
that tunnel. </p>
<p>You configure <tt>pppoed</tt> services
in the <tt>/etc/ppp/pppoe</tt> and <tt>/etc/ppp/pppoe.</tt><i>device</i> files. If <tt>/etc/ppp/pppoe</tt> exists when the system
boots, <tt>pppoed</tt> runs
automatically. You can also explicitly
run the <tt>pppoed</tt> daemon
on the command line by typing <tt>/usr/lib/inet/pppoed</tt>. </p>
<a name="ppp.reference-52"></a><h5><tt>/etc/ppp/pppoe</tt> File</h5>
<a name="indexterm-2065"></a><a name="indexterm-2066"></a><p>The <tt>/etc/ppp/pppoe</tt> file
describes the services that are offered
by an access server plus options that
define how PPP runs over the PPPoE
tunnel. You can define services for
individual interfaces, or globally,
that is, for all interfaces on the
access server. The access server sends
the information in the <tt>/etc/ppp/pppoe</tt> file in response to a
broadcast from a potential PPPoE client. </p>
<p><a name="indexterm-2067"></a>The following is the basic
syntax of <tt>/etc/ppp/pppoe</tt>:</p>
<pre><i>global-options</i>
<i>service</i> <i>service-name</i>
    <i>service-specific-options</i>
    <i>device</i> <i>interface-name</i>
  </pre><p>The parameters have the following
meanings.</p>
<dl><dt><i>global-options</i></dt>
<dd><p>Sets the default options
for the <tt>/etc/ppp/pppoe</tt> file.
These options can be any options that
are available through <tt>pppoed</tt> or <tt>pppd</tt>. For complete lists
of options, see the man pages <tt>pppoed</tt>(1M) and <tt>pppd</tt>(1M).</p>
<p>For example, you must list the
Ethernet interfaces that are available
for the PPPoE tunnel as part of <i>global options</i>. If you
do not define devices in <tt>/etc/ppp/pppoe</tt>, the services are not
offered on any interface.</p>
<p>To define <tt>devices</tt> as
a global option, use the following
form:</p>
<pre><i>device</i> <i>interface &lt;,interface></i></pre><p><i>interface</i> specifies
the interface where the service listens
for potential PPPoE clients. If more
than one interface is associated with
the service, separate each name with
a comma.</p>
</dd>
<dt><i>service</i> <i>service-name</i></dt>
<dd><p>Starts the definition
of the service <i>service-name</i>. <i>service-name</i> is a string
that can be any phrase that is appropriate
to the services that are provided.</p>
</dd>
<dt><i>service-specific-options</i></dt>
<dd><p>Lists the PPPoE and
PPP options specific to this service.</p>
</dd>
<dt><tt>device</tt> <i>interface-name</i></dt>
<dd><p>Specifies the interface
where the previously listed service
is available.</p>
</dd>
</dl>
<p>For additional options to <tt>/etc/ppp/pppoe</tt>, refer to
the <tt>pppoed</tt>(1M) and <tt>pppd</tt>(1M) man
pages.</p>
<p><a name="indexterm-2068"></a><a name="indexterm-2069"></a>A typical <tt>/etc/ppp/pppoe</tt> file might resemble the
following.</p>
<a name="ppp.reference-ex-10"></a>Example 22-2 Basic <tt>/etc/ppp/pppoe</tt> File<pre>device hme1,hme2,hme3
service internet
   pppd "name internet-server"
service intranet
   pppd "192.168.1.1:"
service debug
   device hme1
   pppd "debug name internet-server"</pre><p>In this file, the following
values apply.</p>
<dl><dt><tt>hme1,hme2,hme3</tt></dt>
<dd><p>Three interfaces on
the access server to be used for PPPoE
tunnels.</p>
</dd>
<dt><tt>service
internet</tt></dt>
<dd><p>Advertises a service
that is called <tt>internet</tt> to
prospective clients. The provider
that offers the service also determines
how <tt>internet</tt> is
defined. For example, a provider might
interpret <tt>internet</tt> to
mean various IP services, as well
as access to the Internet.</p>
</dd>
<dt><tt>pppd</tt></dt>
<dd><p>Sets the command-line
options that are used when the caller
invokes <tt>pppd</tt>. The
option <tt>"name internet-server"</tt> gives
the name of the local machine, the
access server, as <tt>internet-server</tt>.</p>
</dd>
<dt><tt>service
intranet</tt></dt>
<dd><p>Advertises another
service that is called <tt>intranet</tt> to
prospective clients.</p>
</dd>
<dt><tt>pppd
"192.168.1.1:"</tt></dt>
<dd><p>Sets the command-line
options that are used when the caller
invokes <tt>pppd</tt>. When
the caller invokes <tt>pppd</tt>,
192.168.1.1 is set as the IP address
for the local machine, the access
server.</p>
</dd>
<dt><tt>service
debug</tt></dt>
<dd><p>Advertises a third
service, debugging, on the interfaces
that are defined for PPPoE.</p>
</dd>
<dt><tt>device
hme1</tt></dt>
<dd><p>Restricts debugging
to PPPoE tunnels to <tt>hme1</tt>.</p>
</dd>
<dt><tt>pppd
"debug name internet-server"</tt></dt>
<dd><p>Sets the command-line
options that are used when the caller
invokes <tt>pppd</tt>, in
this instance, PPP debugging on <tt>internet-server</tt>, the local
machine.</p>
</dd>
</dl>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p135.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p137.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

