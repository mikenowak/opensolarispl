<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Controlling Uploads and Downloads on the FTP Server - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p158.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p162.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p164.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="wuftp-15"></a><h3>Controlling Uploads and Downloads on the FTP Server</h3>
<p>You can control uploads and downloads that are started to and from the
FTP server by setting permissions on directories on the server. By default,
uploads are not allowed for anonymous users. Be very careful when enabling
anonymous uploads.</p>
<a name="wuftp-85"></a><h4><img src="graphics/procedure.gif"> How to Control Uploads to the FTP Server</h4>
<p>Add the directives to the <tt>ftpaccess</tt> file to specify
upload permissions and error messages for upload failures.</p>
<ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="wuftp-step-88"></a><b>Add the following entries to the <tt>ftpaccess</tt> file.</b><p>To enable users to upload files, add the following
entry:</p><pre>upload [absolute|relative] [class=&lt;classname>]... [-] <i>root-dir</i> \
<i>dirglob</i> yes|no <i>owner</i> <i>group</i> <i>mode</i> [dirs|nodirs] [&lt;d_mode>]

path-filter <i>typelist</i> <i>mesg</i> <i>allowed-charset {disallowed regexp...}</i></pre><dl><dt><tt>upload</tt></dt>
<dd><p>Keyword that is applied to users who have a home directory
(the argument to <tt>chroot()</tt>) of the <i>root-dir</i>.
The <i>root-dir</i>  can be specified as  &ldquo;*&rdquo;
to match any home directory.</p>
</dd>
<dt><tt>absolute|relative</tt></dt>
<dd><p>Parameter that specifies whether the <i>root-dir</i> 
directory paths are interpreted as absolute or relative to the current <tt>chroot</tt> directory.</p>
</dd>
<dt><tt>class</tt></dt>
<dd><p>Keyword that is used to specify any number of <tt>class=&lt;classname></tt> restrictions. If restrictions are specified, the upload clause
only becomes effective if the current user is a member of one of the specified
classes.</p>
</dd>
<dt><i>root-dir</i></dt>
<dd><p>User's root directory and the home directory for anonymous
users.</p>
</dd>
<dt><i>dirglob</i></dt>
<dd><p>A pattern to match a directory name. An asterisk can be used
in any place or alone to signify any directory. </p>
</dd>
<dt><tt>yes|no</tt></dt>
<dd><p>Variable that allows or disallows upload to the FTP server.</p>
</dd>
<dt><i>owner</i></dt>
<dd><p>Owner of files that are uploaded into <tt>dirnames</tt>.</p>
</dd>
<dt><i>group</i></dt>
<dd><p>Group that is associated with files that are uploaded into <tt>dirnames</tt>.</p>
</dd>
<dt><i>mode</i></dt>
<dd><p>Parameter that is used to specify access permissions for uploaded
files. The default mode <tt>0440</tt> prevents the anonymous account
from reading uploaded files.</p>
</dd>
<dt><tt>dirs|nodirs</tt></dt>
<dd><p>Keyword that allows or disallows users to create subdirectories
in a directory that is listed in <tt>dirnames</tt>.</p>
</dd>
<dt><tt>d_mode</tt></dt>
<dd><p>Optional mode that determines the permissions for a newly
created directory.</p>
</dd>
<dt><tt>path-filter</tt></dt>
<dd><p>Keyword that controls the names of uploaded files.</p>
</dd>
<dt><i>typelist</i></dt>
<dd><p>A comma-separated list of any of the keywords <tt>anonymous</tt>, <tt>guest</tt>, and <tt>real</tt>.</p>
</dd>
<dt><i>mesg</i></dt>
<dd><p>Message file that is displayed fails to match the <tt>regexp</tt> criteria.</p>
</dd>
<dt><i>allowed-charset {disallowed regexp...}</i></dt>
<dd><p>Alphanumeric characters allowed or disallowed in file names.</p>
</dd>
</dl>
</li></ol>Example 28-13 Controlling Uploads to the FTP Server<pre>upload /export/home/ftp /incoming yes ftpadm ftpadmin 0440 nodirs
path-filter anonymous /etc/ftpd/filename.msg ^[-A-Za-z0-9._]*$ ^[.-]</pre><p>The preceding example states the following:</p>
<ul><li><p>FTP user accounts that use <tt>chroot</tt> to <tt>/export/home/ftp</tt> can upload to the <tt>/incoming</tt> directory.
Uploaded files are owned by user <tt>ftpadm</tt> and the group <tt>ftpadmin</tt>. The mode is set to <tt>0440</tt> with the <tt>nodirs</tt> keyword to prevent anonymous users from creating subdirectories.</p>
</li>
<li><p>For anonymous users, a file name is any
sequence of A-Z, a-z, 0-9, . (dot), - (dash), or _ (underline). File names
cannot start with a . (dot) or - (dash). If a file name fails this filter,
the <tt>/etc/ftpd/filename.msg</tt> message is displayed if the
FTP Administrator has created the message file. This message is followed by
an FTP server error message.</p>
</li>
</ul>
<p>Ownership
and permissions on a directory into which anonymous uploads are allowed should
be tightly controlled. The FTP Administrator should be the owner of all files
uploaded to the FTP server. You need to create an FTP Administrator when anonymous
users are allowed to upload files. The directory should be owned by the user <tt>ftpadm</tt> and group <tt>ftpadm</tt> with permissions set
to <tt>3773</tt>.</p>
<p>The access mode for files uploaded to the FTP server should be <tt>0440</tt>. The <tt>0440</tt> mode prevents the anonymous account
from reading uploaded files. This restriction protects your server from becoming
a staging area for third-party file distribution.</p>
<p>To make uploaded files available for distribution, the FTP Administrator
can move files to a public directory.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p162.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p164.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

