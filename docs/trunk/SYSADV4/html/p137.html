<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title><tt>/etc/ppp/pppoe.</tt><i>device</i> File - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p129.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a> > <a href="p136.html">Creating PPPoE Tunnels for DSL Support</a> > <a href="p136.html#ppp.reference-47">PPPoE Access Server Commands and Files</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p136.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p138.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="ppp.reference-56"></a><h5><tt>/etc/ppp/pppoe.</tt><i>device</i> File</h5>
<p><a name="indexterm-2070"></a><a name="indexterm-2071"></a>The <tt>/etc/ppp/pppoe.</tt><i>device</i> file
describes the services that are offered
on one interface of a PPPoE access
server. <tt>/etc/ppp/pppoe.</tt><i>device</i> also includes
options that define how PPP runs over
the PPPoE tunnel. <tt>/etc/ppp/pppoe.</tt><i>device</i> is
an optional file, which operates exactly
like the global <tt>/etc/ppp/pppoe</tt>.
However, if <tt>/etc/ppp/pppoe.</tt><i>device</i> is defined for
an interface, its parameters have
precedence for that interface over
the global parameters that are defined
in <tt>/etc/ppp/pppoe</tt>.</p>
<p><a name="indexterm-2072"></a>The basic syntax of <tt>/etc/ppp/pppoe.</tt><i>device</i> is as follows:</p>
<pre><tt><b>service</b></tt> <i>service-name</i>
     <i>service-specific-options</i>
<tt><b>service</b></tt> <i>another-service-name</i>
      <i>service-specific-options</i>    </pre><p>The only difference between
this syntax and the syntax of <tt>/etc/ppp/pppoe</tt> is that you cannot use
the <tt>device</tt> option
that is shown in <a href="p136.html#ppp.reference-52"><tt>/etc/ppp/pppoe</tt> File</a>. </p>
<a name="ppp.reference-59"></a><h5><tt>pppoe.so</tt> Plugin</h5>
<p><a name="indexterm-2073"></a><tt>pppoe.so</tt> is
the PPPoE shared object file that
must be invoked by PPPoE access servers
and clients. This file limits MTU
and MRU to 1492, filters packets from
the driver, and negotiates the PPPoE
tunnel, along with <tt>pppoed</tt>.
On the access server side, <tt>pppoe.so</tt> is automatically invoked
by the <tt>pppd</tt> daemon.</p>
<a name="ppp.reference-71"></a><h5>Using
PPPoE and PPP Files to Configure an
Access Server</h5>
<a name="indexterm-2074"></a><p>This section contains samples
of all files that are used to configure
an access server. The access server
is multihomed. The server is attached
to three subnets: <tt>green</tt>, <tt>orange</tt>, and <tt>purple</tt>. <tt>pppoed</tt> runs as <tt>root</tt> on
the server, which is the default.</p>
<p>PPPoE clients can access the <tt>orange</tt> and <tt>purple</tt> networks
through interfaces <tt>hme0</tt> and <tt>hme1</tt>. Clients log in to
the server by using the standard UNIX
login. The server authenticates the
clients by using PAP.</p>
<p><a name="indexterm-2075"></a>The <tt>green</tt> network
is not advertised to clients. The
only way clients can access <tt>green</tt> is by directly specifying &ldquo;<tt>green-net</tt>&rdquo; and supplying
CHAP authentication credentials. Moreover,
only clients <tt>joe</tt> and <tt>mary</tt> are allowed to access
the <tt>green</tt> network
by using  static IP addresses.</p>
<a name="ppp.reference-ex-11"></a>Example 22-3 <tt>/etc/ppp/pppoe</tt> File
for an Access Server<pre>service orange-net
     device hme0,hme1
     pppd "require-pap login name orange-server orange-server:"
service purple-net
     device hme0,hme1 
     pppd "require-pap login name purple-server purple-server:"
service green-net
     device hme1 
     pppd "require-chap name green-server green-server:"
     nowildcard</pre><p>This sample describes the services
that are available from the access
server. The first service section
describes the services of the <tt>orange</tt> network.</p>
<pre>service orange-net
     device hme0,hme1
     pppd "require-pap login name orange-server orange-server:"</pre><p>Clients access the <tt>orange</tt> network
over interfaces <tt>hme0</tt> and <tt>hme1</tt>. The options that are
given to the <tt>pppd</tt> command
force the server to require PAP credentials
from potential clients. The <tt>pppd</tt> options also set the server's
name to <tt>orange-server</tt>,
as used in the <tt>pap-secrets</tt> file.</p>
<p>The service section for the <tt>purple</tt> network is identical
to the service section of the <tt>orange</tt> network except for the
network and server names.</p>
<p>The next section describes the
services of the <tt>green</tt> network:</p>
<pre>service green-net
     device hme1 
     pppd "require-chap name green-server green-server:"
     nowildcard</pre><p>This section restricts client
access to interface <tt>hme1</tt>.
Options that are given to the <tt>pppd</tt> command force the server
to require CHAP credentials from prospective
clients. The <tt>pppd</tt> options
also set the server name to <tt>green-server</tt>, to be used in the <tt>chap-secrets</tt> file. The <tt>nowildcard</tt> option
specifies that the existence of the
green network is not advertised to
clients.</p>
<p><a name="indexterm-2076"></a><a name="indexterm-2077"></a>For this access server
scenario just discussed, you might
set up the following <tt>/etc/ppp/options</tt> file.</p>
<a name="ppp.reference-ex-12"></a>Example 22-4 <tt>/etc/ppp/options</tt> File
for an Access Server<pre> 	auth
 	proxyarp
 	nodefaultroute
 	name no-service	# don't authenticate otherwise</pre><p><a name="indexterm-2078"></a><a name="indexterm-2079"></a><a name="indexterm-2080"></a>The option <tt>name
no-service</tt> overrides the
server name that is normally searched
for during PAP or CHAP authentication.
The server's default name is  the
one found by the <tt>/usr/bin/hostname</tt> command. The <tt>name</tt> option
in the previous example changes the
server's name to <tt>no-service</tt>.
The name <tt>no-service</tt> is
not likely to be found in a <tt>pap</tt> or <tt>chap-secrets</tt> file. This
action prevents a random user from
running <tt>pppd</tt> and
overriding the <tt>auth</tt> and <tt>name</tt> options that are set
in <tt>/etc/ppp/options</tt>. <tt>pppd</tt> then fails because
no secrets can be found for the client
with a server name of <tt>no-service</tt>.</p>
<p>The access server scenario uses
the following <tt>/etc/hosts</tt> file.</p>
<a name="ppp.reference-ex-13"></a>Example 22-5 <tt>/etc/hosts</tt> File
for an Access Server<pre>     172.16.0.1	orange-server
     172.17.0.1	purple-server
     172.18.0.1	green-server
     172.18.0.2	joes-pc
     172.18.0.3	marys-pc</pre><p><a name="indexterm-2081"></a><a name="indexterm-2082"></a>Here is the <tt>/etc/ppp/pap-secrets</tt> file that is used for
PAP authentication for clients that
attempt to access the <tt>orange</tt> and <tt>purple</tt> networks.</p>
<a name="ppp.reference-ex-14"></a>Example 22-6 <tt>/etc/ppp/pap-secrets</tt> File
for an Access Server<pre>* orange-server "" 172.16.0.2/16+
* purple-server "" 172.17.0.2/16+</pre><p><a name="indexterm-2083"></a><a name="indexterm-2084"></a>Here is the <tt>/etc/ppp/chap-secrets</tt> file that is used for
CHAP authentication. Note that only
clients <tt>joe</tt> and <tt>mary</tt> are listed in the file.</p>
<a name="ppp.reference-ex-15"></a>Example 22-7 <tt>/etc/ppp/chap-secrets</tt> File
for an Access Server<pre> joe green-server "joe's secret" joes-pc
mary green-server "mary's secret" marys-pc</pre><a name="ppp.reference-55"></a><h4>PPPoE
Client Commands and Files</h4>
<p><a name="indexterm-2085"></a><a name="indexterm-2086"></a>To run PPP over a DSL
modem, a machine must become a PPPoE
client. You have to plumb an interface
to run PPPoE, and then use the <tt>pppoec</tt> utility to &ldquo;discover&rdquo;
the existence of an access server.
Thereafter, the client can create
the PPPoE tunnel over the DSL modem
and run PPP.</p>
<p>The PPPoE client relates to
the access server in the traditional
client-server model. The PPPoE tunnel
is not a dial-up link, but the tunnel
is configured and operated in much
the same manner. </p>
<p>The commands and files that
set up a PPPoE client include the
following:</p>
<ul><li><p><a href="p136.html#ppp.reference-49"><tt>/usr/sbin/sppptun</tt> Command</a></p>
</li>
<li><p><a href="p137.html#ppp.reference-58"><tt>/usr/lib/inet/pppoec</tt> Utility</a></p>
</li>
<li><p><a href="p137.html#ppp.reference-63"><tt>pppoe.so</tt> Shared Object</a></p>
</li>
<li><p><a href="p131.html#pppsvrconfig.reference-56"><tt>/etc/ppp/peers/</tt><i>peer-name</i> File</a></p>
</li>
<li><p><a href="p130.html#pppsvrconfig.reference-46"><tt>/etc/ppp/options</tt> Configuration File</a></p>
</li>
</ul>
<a name="ppp.reference-58"></a><h5><tt>/usr/lib/inet/pppoec</tt> Utility</h5>
<p><a name="indexterm-2087"></a>The <tt>/usr/lib/inet/pppoec</tt> utility is responsible
for negotiating the client side of
a PPPoE tunnel. <tt>pppoec</tt> is
similar to the Solaris PPP 4.0 <tt>chat</tt> utility. You do not invoke <tt>pppoec</tt> directly. Rather,
you start <tt>/usr/lib/inet/pppoec</tt> as
an argument to the <tt>connect</tt> option
of <tt>pppd</tt>.</p>
<a name="ppp.reference-63"></a><h5><tt>pppoe.so</tt> Shared Object</h5>
<p><a name="indexterm-2088"></a><tt>pppoe.so</tt> is
the PPPoE shared object that must
be loaded by PPPoE to provide PPPoE
capability to access servers and clients.
The <tt>pppoe.so</tt> shared
object limits MTU and MRU to 1492,
filters packets from the driver, and
handles runtime PPPoE messages.</p>
<p>On the client side, <tt>pppd</tt> loads <tt>pppoe.so</tt> when the user
specifies the <tt>plugin pppoe.so</tt> option.</p>
<a name="ppp.reference-46"></a><h5><tt>/etc/ppp/peers/</tt><i>peer-name</i> File for Defining an
Access Server Peer</h5>
<p><a name="indexterm-2089"></a><a name="indexterm-2090"></a><a name="indexterm-2091"></a>When you define an access
server to be discovered by <tt>pppoec</tt>, you use options that apply
to both <tt>pppoec</tt> and
the <tt>pppd</tt> daemon.
An <tt>/etc/ppp/peers/</tt><i>peer-name</i> file for an
access server requires the following
parameters:</p>
<ul><li><p><tt>sppptun</tt> &ndash;
Name for the serial device that is
used by the PPPoE tunnel.</p>
</li>
<li><p><tt>plugin pppoe.so</tt> &ndash;
Instructs <tt>pppd</tt> to
load the <tt>pppoe.so</tt> shared
object.</p>
</li>
<li><p><tt>connect "/usr/lib/inet/pppoec</tt> <i>device</i><tt>"</tt> &ndash; Starts a connection. <tt>connect</tt> then invokes the <tt>pppoec</tt> utility over <i>device</i>, the interface
that is plumbed for PPPoE.</p>
</li>
</ul>
<p>The remaining parameters in
the <tt>/etc/ppp/peers/</tt><i>peer-name</i> file should
apply to the PPP link on the server.
Use the same options that you would
for <tt>/etc/ppp/peers/</tt><i>peer-name</i> on a dial-out
machine. Try to limit the number of
options to the minimum you need for
the PPP link.</p>
<p>The following example is introduced
in <a href="p122.html#ppp.pppoe-56">How to Define a PPPoE Access Server Peer</a>.</p>
<a name="ppp.reference-ex-16"></a>Example 22-8 <tt>/etc/ppp/peers/</tt><i>peer-name</i> to Define
a Remote Access Server<pre># <tt><b>cat /etc/ppp/peers/dslserve</b></tt>
sppptun
plugin pppoe.so
connect "/usr/lib/inet/pppoec hme0"
noccp
noauth
user Red
password redsecret
noipdefault
defaultroute</pre><p>This file defines parameters
to be used when setting up a PPPoE
tunnel and PPP link to access server <tt>dslserve</tt>. The options that
are included are as follows.</p>
<table><tr><th><p>Option</p>
</th><th><p>Description</p>
</th></tr>
<tr><td><p><tt>sppptun</tt></p>
</td><td><p>Defines <tt>sppptun</tt> as
the name of the serial device.</p>
</td></tr>
<tr><td><p><tt>plugin pppoe.so</tt></p>
</td><td><p>Instructs <tt>pppd</tt> to
load the <tt>pppoe.so</tt> shared
object.</p>
</td></tr>
<tr><td><p><tt>connect "/usr/lib/inet/pppoec
hme0"</tt></p>
</td><td><p>Runs <tt>pppoec</tt> and
designates <tt>hme0</tt> as
the interface for the PPPoE tunnel
and PPP link.</p>
</td></tr>
<tr><td><p><tt>noccp</tt></p>
</td><td><p>Turns off CCP compression on
the link.</p>
<hr>
<p><b>Note - </b>Many ISPs use only proprietary
compression algorithms. Turning off
the publicly available CCP algorithm
saves negotiation time and avoids
very occasional interoperability problems.</p>
<hr>
</td></tr>
<tr><td><p><tt>noauth</tt></p>
</td><td><p>Stops <tt>pppd</tt> from
demanding authentication credentials
from the access server. Most ISPs
do not provide authentication credentials
to customers.</p>
</td></tr>
<tr><td><p><tt>user Red</tt></p>
</td><td><p>Sets the name <tt>Red</tt> as
the user name for the client, which
is required for PAP authentication
by the access server.</p>
</td></tr>
<tr><td><p><tt>password redsecret</tt></p>
</td><td><p>Defines <tt>redsecret</tt> as
the password to be provided to the
access server for PAP authentication.</p>
</td></tr>
<tr><td><p><tt>noipdefault</tt></p>
</td><td><p>Assigns 0.0.0.0 as the initial
IP address.</p>
</td></tr>
<tr><td><p><tt>defaultroute</tt></p>
</td><td><p>Tells <tt>pppd</tt> to
install a default IPv4 route after
IPCP negotiation. You should include <tt>defaultroute</tt> in <tt>/etc/ppp/peers/</tt><i>peer-name</i> when
the link is the system's link to the
Internet, which is true for a PPPoE
client.</p>
</td></tr>
</table>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p136.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p138.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

