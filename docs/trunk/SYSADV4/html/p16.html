<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>How to Enable WebNFS Access - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p15.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a> > <a href="p15.html#rfsadmin-56">Automatic File-System Sharing</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p15.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p17.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="rfsadmin-112"></a><h4><img src="graphics/procedure.gif"> How to Enable WebNFS Access</h4>
<a name="indexterm-171"></a><a name="indexterm-172"></a><p>Note the following:</p>
<ul><li><p>Starting with the Solaris 2.6 release, by default all file
systems that are available for NFS mounting are automatically available for
WebNFS access. The only condition that requires the use of this procedure
is one of the following:</p>
<ul><li><p>To allow NFS mounting on a server that does not currently
allow NFS mounting</p>
</li>
<li><p>To reset the public file handle to shorten NFS URLs by using
the <tt>public</tt> option with the <tt>share</tt> command</p>
</li>
<li><p>To force a specific HTML file to be loaded by using the <tt>index</tt> option with the <tt>share</tt> command</p>
</li>
</ul>
</li>
<li><p>Starting with the Solaris Express, Developer Edition 2/07
release, you can do the following:</p>
<ul><li><p>Use the <tt>sharemgr</tt> utility to share file
systems, set property values for the shared file systems, and perform related
tasks. For information about <tt>sharemgr</tt>, including descriptions
of subcommands and properties, see the <tt>sharemgr</tt>(1M) man page and <a href="p38.html"><tt>sharemgr</tt> Command</a>.</p>
</li>
<li><p>Use the <tt>sharectl</tt> utility to configure file-sharing
protocols, such as NFS. See the <tt>sharectl</tt>(1M) man page and <a href="p43.html"><tt>sharectl</tt> Command</a>.</p>
</li>
</ul>
<hr>
<p><b>Note - </b>When you use <tt>sharemgr</tt>, you do not need to use
the <tt>share</tt>, <tt>shareall</tt>,  and <tt>unshare</tt> commands.
Also, you do not need to edit the <tt>/etc/dfs/dfstab</tt> file.</p>
<hr>
</li>
</ul>
<p>See <a href="p22.html#rfsadmin-111">Planning for WebNFS Access</a> for
a list of issues to consider before starting the WebNFS service.</p>
<p>The following procedure uses the <tt>sharemgr</tt> utility.
If you prefer to use the <tt>share</tt> and <tt>shareall</tt> utilities,
see the example that follows this procedure.</p>
<ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="rfsadmin-step-114"></a><b>Use the <tt>sharemgr</tt> utility
to assign property values to the file system to be shared by the WebNFS service.</b><ol><li><b>Use the following syntax to create a share group with the desired
property value.</b><pre># sharemgr create [-P protocol] [-p property=value] share-group</pre><p>For example:</p>
<ul><li><p>To create a share group that forces a specific HTML file to
be loaded, you can use the index property:</p>
<pre># sharemgr create [-P protocol] -p index=[file-path.html] share-group</pre></li>
<li><p>To create a share group that moves the location of the public
file handle from <tt>root</tt> (<tt>/</tt>) to an
exported directory for WebNFS-enabled browsers and clients, you can use the
following:</p>
<pre># sharemgr set -P nfs -p public=true -s share-path share-group</pre><p>Note that the <tt>public</tt> property moves the location
of a public file handle from <tt>root</tt> (<tt>/</tt>)
to an exported directory for WebNFS-enabled browsers and clients. However,
only one file system (or share) on each server can use this property. Because
a share-group can consist of more than one file system, this property is not
accepted by a share group. For more information, see the <tt>share_nfs</tt>(1M) man page.</p>
</li>
</ul>
</li><li><b>Use the following syntax to add shares to the share group.</b><pre># sharemgr add-share -s share-path [-t] [-d description] [-r resource-name] share-group</pre></li><li>(Optional) <b>If necessary, use the following syntax
to set more property values to an existing share group.</b><pre># sharemgr set [-P protocol] [-S security-mode] [-p property=value] share-group</pre><hr>
<p><b>Note - </b>You do not need to repeat this command-line syntax for each additional
property value. You can use the <tt>-p</tt> option multiple times to
define multiple properties on the same command line.</p>
<hr>
</li></ol></li><li><a name="rfsadmin-step-116"></a><b>Use the <tt>sharemgr</tt> utility
to verify what you have created.</b><pre># sharemgr show [-v] [-p] [-x] [share-group...]</pre></li></ol><a name="gedgg"></a>Example 5-2 How to Use the <tt>share</tt> and <tt>shareall</tt> Commands
to Enable WebNFS Access<ol><li><p>Become superuser or assume an equivalent role.</p>
<p>Roles
contain authorizations and privileged commands. For more information about
roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>.
To configure a role with the Primary Administrator    profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<li><p>Add entries for each file system to be shared by using the
WebNFS service.</p>
<p><a name="indexterm-173"></a><a name="indexterm-174"></a><a name="indexterm-175"></a><a name="indexterm-176"></a>Edit <tt>/etc/dfs/dfstab</tt>. Add one entry to the
file for every file system. The <tt>public</tt> and <tt>index</tt> tags that are shown in the following example
are optional. </p>
<pre>share -F nfs -o ro,public,index=index.html /export/ftp</pre><p>See the <tt>dfstab</tt>(4) man
page for a description of <tt>/etc/dfs/dfstab</tt> and the <tt>share_nfs</tt>(1M) man page
for a complete list of options.</p>
</li>
<li><p>Share the file system.</p>
<p><a name="indexterm-177"></a><a name="indexterm-178"></a>After the entry is in <tt>/etc/dfs/dfstab</tt>, you
can share the file system by either rebooting the system or by using the <tt>shareall</tt> command.</p>
<pre># <tt><b>shareall</b></tt></pre></li>
<li><p>Verify that the information is correct.</p>
<p>Run the <tt>share</tt> command to check that the correct options are listed:</p>
<pre># <tt><b>share</b></tt>
-        /export/share/man   ro   ""
-        /usr/src     rw=eng   ""
-        /export/ftp    ro,public,index=index.html  ""</pre></li>
</ol>
<a name="rfsadmin-101"></a><h4><img src="graphics/procedure.gif"> How to Enable NFS Server Logging</h4>
<a name="indexterm-179"></a><a name="indexterm-180"></a><p>Starting with the Solaris Express, Developer Edition 2/07 release, you
can do the following:</p>
<ul><li><p>Use the <tt>sharemgr</tt> utility to share file
systems, set property values for the shared file systems, and perform related
tasks. For information about <tt>sharemgr</tt>, including descriptions
of subcommands and properties, see the <tt>sharemgr</tt>(1M) man page and <a href="p38.html"><tt>sharemgr</tt> Command</a>.</p>
</li>
<li><p>Use the <tt>sharectl</tt> utility to configure file-sharing
protocols, such as NFS. See the <tt>sharectl</tt>(1M) man page and <a href="p43.html"><tt>sharectl</tt> Command</a>.</p>
</li>
</ul>
<hr>
<p><b>Note - </b>When you use <tt>sharemgr</tt>, you do not need to use
the <tt>share</tt>, <tt>shareall</tt>,  and <tt>unshare</tt> commands.
Also, you do not need to edit the <tt>/etc/dfs/dfstab</tt> file.</p>
<hr>
<p>The following procedure uses the <tt>sharemgr</tt> utility.
If you prefer to use the <tt>share</tt> and <tt>shareall</tt> utilities,
see the example that follows this procedure.</p>
<ol><li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information
about roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>. To configure
a role with the Primary Administrator profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="rfsadmin-step-264"></a>(Optional) <b>Change file-system
configuration settings.</b><p>In <tt>/etc/nfs/nfslog.conf</tt>,
you can change the settings in one of two ways. You can edit the default settings
for all file systems by changing the data that is associated with the <tt>global</tt> tag. Alternately, you can add a new tag for this file system. If
these changes are not needed, you do not need to change this file. The format
of <tt>/etc/nfs/nfslog.conf</tt> is described in the <tt>nfslog.conf</tt>(4) man page. </p></li><li><a name="rfsadmin-step-65"></a><b>Use the <tt>sharemgr</tt> utility
to assign property values to the file system to be     shared by using NFS
server logging.</b><ol><li><b>Use the following syntax to create a share group with the desired
property value.</b><pre># sharemgr create [-P protocol] [-p property=value] share-group</pre><p>For example:</p><pre># <tt><b>sharemgr create -p log=global my-group</b></tt></pre><p>This example uses the default settings associated with the global tag.
Note that the tag assigned to the log property must also exist in the <tt>/etc/nfs/nfslog.conf</tt> file.</p></li><li><b>Use the following syntax to add shares to the share group.</b><pre># sharemgr add-share -s share-path [-t] [-d description] [-r resource-name] share-group</pre></li><li>(Optional) <b>If necessary, use the following syntax
to set more property values to an existing share group.</b><pre># sharemgr set [-P protocol] [-S security-mode] [-p property=value] share-group</pre><p>For example:</p><pre># <tt><b>sharemgr set -p ro=true my-group</b></tt></pre><p>In this example the permissions for <tt>my-group</tt> are
set to read-only.</p><hr>
<p><b>Note - </b>You do not need to repeat this command-line syntax for each additional
property value. You can use the <tt>-p</tt> option multiple times to
define multiple properties on the same command line.</p>
<hr>
</li></ol></li><li><a name="rfsadmin-step-67"></a><b>Use the following syntax to verify what
you have created.</b><pre># sharemgr show [-v] [-p] [-x] [share-group...]</pre></li><li><a name="rfsadmin-step-68"></a><b>Check if <tt>nfslogd</tt>, the
NFS log daemon, is running.</b><pre># <tt><b>ps -ef | grep nfslogd</b></tt></pre></li><li>(Optional) <b>Start <tt>nfslogd</tt>, if it
is not running.</b><pre># <tt><b>svcadm restart network/nfs/server:default</b></tt></pre></li></ol><a name="gecrn"></a>Example 5-3 How to Use the <tt>share</tt> and <tt>shareall</tt> Commands
to Enable NFS Server Logging<ol><li><p>Become superuser or assume an equivalent role.</p>
<p>Roles
contain authorizations and privileged commands. For more information about
roles, see Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i>.
To configure a role with the Primary Administrator    profile, see Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<li><p>(Optional) Change file-system configuration settings.</p>
<p><a name="indexterm-181"></a><a name="indexterm-182"></a>In <tt>/etc/nfs/nfslog.conf</tt>, you can change the
settings in one of two ways. You can edit the default settings for all file
systems by changing the data that is associated with the <tt>global</tt> tag.
Alternately, you can add a new tag for this file system. If these changes
are not needed, you do not need to change this file. The format of <tt>/etc/nfs/nfslog.conf</tt> is described in <tt>nfslog.conf</tt>(4). </p>
</li>
<li><p>Add entries for each file system to be shared by using NFS
server logging.</p>
<p><a name="indexterm-183"></a><a name="indexterm-184"></a><a name="indexterm-185"></a>Edit <tt>/etc/dfs/dfstab</tt>. Add one entry to the
file for the file system on which you are enabling NFS server logging. The
tag that is used with the <tt>log=</tt><i>tag</i> option
must be entered in <tt>/etc/nfs/nfslog.conf</tt>. This example
uses the default settings in the <tt>global</tt> tag.</p>
<pre>share -F nfs -o ro,log=global /export/ftp</pre><p>See the <tt>dfstab</tt>(4) man
page for a description of <tt>/etc/dfs/dfstab</tt> and the <tt>share_nfs</tt>(1M) man page
for a complete list of options.</p>
</li>
<li><p>Share the file system.</p>
<p>After the entry is in <tt>/etc/dfs/dfstab</tt>, you can share the file system by either rebooting
the system or by using the <tt>shareall</tt> command.</p>
<pre># <tt><b>shareall</b></tt></pre></li>
<li><p>Verify that the information is correct.</p>
<p><a name="indexterm-186"></a><a name="indexterm-187"></a>Run the <tt>share</tt> command to check that the correct options are listed:</p>
<pre># <tt><b>share</b></tt>
-        /export/share/man   ro   ""
-        /usr/src     rw=eng   ""
-        /export/ftp    ro,log=global  ""</pre></li>
<li><p>Check if <tt>nfslogd</tt>, the NFS log daemon, is
running.</p>
<pre># <tt><b>ps -ef | grep nfslogd</b></tt></pre></li>
<li><p><a name="indexterm-188"></a>(Optional) Start <tt>nfslogd</tt>, if it is not running
already.</p>
<ul><li><p>(Optional) If <tt>/etc/nfs/nfslogtab</tt> is present,
start the NFS log daemon by typing the following:</p>
<pre># <tt><b>svcadm restart network/nfs/server:default</b></tt></pre></li>
<li><p>(Optional) If <tt>/etc/nfs/nfslogtab</tt> is not
present, run any of the <tt>share</tt> commands to create the file
and then start the daemon.</p>
<pre># <tt><b>shareall</b></tt>
# <tt><b>svcadm restart network/nfs/server:default</b></tt></pre></li>
</ul>
</li>
</ol>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p15.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p17.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

