<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Maintaining Disk Sets</title><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="Solaris Volume Manager Administration Guide"><link rel="up" href="ch19.html" title="Chapter 19. Disk
Sets (Tasks)"><link rel="prev" href="ch19s03.html" title="Expanding Disk Sets"><link rel="next" href="ch19s05.html" title="Importing Disk Sets"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Maintaining Disk Sets</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch19s03.html">Prev</a> </td><th width="60%" align="center">Chapter 19. Disk
Sets (Tasks)</th><td width="20%" align="right"> <a accesskey="n" href="ch19s05.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tasks-disksets-45"></a>Maintaining Disk Sets</h2></div></div></div>

<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1766242"></a></h3></div></div></div>

<div class="task"><a name="maintaintasksnew-23499"></a><p class="title"><b>How to Check the Status of a Disk
Set</b></p><a class="indexterm" name="maintaintasksnew-ix205"></a><a class="indexterm" name="indexterm-173"></a><a class="indexterm" name="indexterm-174"></a><div class="procedure"><ul><li><a name="tasks-disksets-step-59a"></a>
<p>Use one of the following methods
to check the status of a disk set.</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>From the Enhanced Storage tool within the Solaris Management Console, open the Disk Sets node. Click the right
mouse button on the Disk Set you want to monitor. Then choose Properties from
the menu. For more information, see the online help.</p>
</li><li>
<p>Use the following form of the <span><strong class="command">metaset</strong></span> command
to view disk set status.</p>
<pre class="screen"># <strong class="userinput"><code>metaset -s <em class="replaceable"><code>diskset-name</code></em>
</code></strong>
</pre>
<p>See the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">metaset</span>
(
1M
)
</span>
</span> man
page for more information.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>Disk set ownership is only shown on the owning host.</p>
</div>
</li></ul></div>
</li></ul></div><div class="example"><a name="egjvu"></a><p class="title"><b>Example 19.6. Checking the Status of a Specified Disk Set</b></p>


<p>The following example shows the <span><strong class="command">metaset</strong></span> command with
the <code class="option">
s</code> option followed by the name of the disk set, <code class="filename">blue</code>. The output from this command displays status information for
that disk set. The output indicates that <code class="literal">host1</code> is the disk
set owner. The <span><strong class="command">metaset</strong></span> command also displays the disks
in the disk set.</p>
<pre class="screen">red# <strong class="userinput"><code>metaset -s blue</code></strong>


Set name = blue, Set number = 1

Host                Owner
  host1             Yes 

Drive               Dbase
  c1t6d0             Yes 
  c2t6d0             Yes </pre>
<p>
<a class="indexterm" name="maintaintasksnew-ix208"></a>The <span><strong class="command">metaset</strong></span> command by itself displays the
status of all disk sets.</p>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1766508"></a></h3></div></div></div>

<div class="task"><a name="tasks-disksets-67"></a><p class="title"><b>How to Delete Disks From a Disk Set</b></p><a class="indexterm" name="indexterm-175"></a><a class="indexterm" name="indexterm-176"></a><a class="indexterm" name="indexterm-177"></a><div class="procedure"><ol type="1"><li>
<p>To delete a disk from a disk set, use one of the following methods:</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>From the Enhanced Storage tool within the Solaris Management Console, open the Disk Sets node. Click the right
mouse on the Disk Set that you want to release. Then choose Properties from
the menu. Click the Disks tab. Follow the instructions in the online help.</p>
</li><li>
<p>Use the following form of the <span><strong class="command">metaset</strong></span> command
to delete a disk from a disk set.</p>
<pre class="screen"># <strong class="userinput"><code>metaset -s <em class="replaceable"><code>diskset-name</code></em> -d <em class="replaceable"><code>disk-name</code></em>
</code></strong>
</pre>
<div class="variablelist"><dl><dt><span class="term">
<code class="option">
s</code> <em class="replaceable"><code>diskset-name</code></em>
</span></dt><dd>
<p>Specifies the name of a disk set on which to delete the disk.</p>
</dd><dt><span class="term">
<code class="option">
d</code> <em class="replaceable"><code>disk-name</code></em>
</span></dt><dd>
<p>Specifies the disks to delete from the disk set. Disk names
are in the form <code class="literal">c</code>
<em class="replaceable"><code>x</code></em>
<code class="literal">t</code>
<em class="replaceable"><code>x</code></em>
<code class="literal">d</code>
<em class="replaceable"><code>x</code></em>. The &#8220;s<em class="replaceable"><code>x</code></em>&#8221; slice identifiers are not included when deleting a
disk from a disk set.</p>
</dd></dl></div>
<p>See the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">metaset</span>
(
1M
)
</span>
</span> man
page for more information.</p>
</li></ul></div>
</li><li><a name="tasks-disksets-step-69"></a>
<p>Verify that the disk has been deleted
from the disk.</p>
<pre class="screen"># <strong class="userinput"><code>metaset -s <em class="replaceable"><code>diskset-name</code></em>
</code></strong>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>To delete a disk set, you must first delete all the disks from
the disk set.</p>
</div>
</li></ol></div><div class="example"><a name="egjwv"></a><p class="title"><b>Example 19.7. Deleting a Disk from a Disk Set</b></p>


<p>The following example shows the deletion of the disk, <code class="literal">c1t6d0</code> from
the disk set, <code class="filename">blue</code>.</p>
<pre class="screen">host1# <strong class="userinput"><code>metaset -s blue -d c1t6d0</code></strong>
host1# <strong class="userinput"><code>metaset -s blue</code></strong>
 
Set name = blue, Set number = 1

Host                Owner
  host1            
	host2 

Drive               Dbase
  c2t6d0             Yes 
 </pre>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1766842"></a></h3></div></div></div>

<div class="task"><a name="tasks-disksets-3"></a><p class="title"><b>How to Take a Disk Set</b></p><a class="indexterm" name="indexterm-178"></a><a class="indexterm" name="indexterm-179"></a><a class="indexterm" name="indexterm-180"></a><div class="tasksummary">
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>This option is not available for multi-owner disk sets.</p>
</div>
</div><div class="procedure"><ul><li><a name="tasks-disksets-step-60"></a>
<p>Use one of the following methods to
take a disk set:</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>From the Enhanced Storage tool within the Solaris Management Console, open the Disk Sets node. Click the right
mouse on the disk set you want to take. Then, hen choose Take Ownership from
the menu. For more information, see the online help.</p>
</li><li>
<p>Use the following form of the <span><strong class="command">metaset</strong></span> command.</p>
<pre class="screen"># <strong class="userinput"><code>metaset -s <em class="replaceable"><code>diskset-name</code></em> -t -f </code></strong>
</pre>
</li></ul></div>
<div class="variablelist"><dl><dt><span class="term">
<code class="option">
s</code> <em class="replaceable"><code>diskset-name</code></em>
</span></dt><dd>
<p>Specifies the name of a disk set to take.</p>
</dd><dt><span class="term">
<code class="option">
t</code>
</span></dt><dd>
<p>Specifies to take the disk set.</p>
</dd><dt><span class="term">
<code class="option">
f</code>
</span></dt><dd>
<p>Specifies to take the disk set forcibly.</p>
</dd></dl></div>
<p>See the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">metaset</span>
(
1M
)
</span>
</span> man
page for more information.</p>
<p>Only one host at a time can own a disk
set. When one host in a disk set takes the disk set, the other host in the
disk set cannot access data on the disks in the disk set. </p>
<p>The
default behavior of the <span><strong class="command">metaset</strong></span> command is to allow your
host to take the disk set only if a release is possible on the host that has
ownership of the disk set. Use the <code class="option">
f</code> option to forcibly take
the disk set. This option takes the disk set whether or not another host currently
has the set. Use this method when a host in the disk set is down or not communicating.
If the other host had the disk set taken at this point, it would panic when
it attempts to perform an I/O operation on the disk set.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>Disk set ownership is only shown on the owning host.</p>
</div>
</li></ul></div><div class="example"><a name="egjxa"></a><p class="title"><b>Example 19.8. Taking a Disk Set</b></p>


<p>In the following example, the host, <code class="filename">host1</code>, communicates
with the host, <code class="filename">host2</code>. This communication ensures that
the host <code class="filename">host2</code> has released the disk set before the host, <code class="filename">host1</code>, attempts to take the disk set.</p>
<pre class="screen">host1# <strong class="userinput"><code>metaset</code></strong>
...
Set name = blue, Set number = 1
 
Host                Owner
  host1
  host2
...
host1# <strong class="userinput"><code>metaset -s blue -t</code></strong>
host2# <strong class="userinput"><code>metaset</code></strong>
...
Set name = blue, Set number = 1
 
Host                Owner
  host1                Yes
  host2
...</pre>
<p>If <code class="filename">host2</code> owned the disk set, <code class="filename">blue</code>,
the &#8220;Owner&#8221; column in the preceding output would still have been
blank. The <span><strong class="command">metaset</strong></span> command only shows whether the host
issuing the command owns the disk set.</p>
</div><div class="example"><a name="egjxb"></a><p class="title"><b>Example 19.9. Taking a Disk Set Forcibly</b></p>


<p>
<a class="indexterm" name="indexterm-181"></a>In the following example, the host that is taking the disk set
does not communicate with the other host. Instead, the <code class="option">
f</code> option
allows the disks in the disk set to be forcibly taken without warning. If
the other host had owned the disk set, that host would panic when it attempted
an I/O operation on the disk set.</p>
<pre class="screen"># <strong class="userinput"><code>metaset -s blue -t -f</code></strong>
</pre>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1767252"></a></h3></div></div></div>

<div class="task"><a name="tasks-disksets-6"></a><p class="title"><b>How to Release a Disk Set</b></p><a class="indexterm" name="indexterm-182"></a><a class="indexterm" name="indexterm-183"></a><a class="indexterm" name="indexterm-184"></a><div class="tasksummary">
<p>Releasing a disk set is useful when you perform maintenance on the physical
disks in the disk set. When a disk set is released, it cannot be accessed
by the host. If both hosts in a disk set release the set, neither host in
the disk set can access directly the volumes or hot spare pools that are defined
in the disk set . However, if both hosts release the disk set, the hosts can
access the disks directly through their <code class="literal">c*t*d*</code> names.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>This option is not available for multi-owner disk sets.</p>
</div>
</div><div class="taskprerequisites">

<p>Check <span class="olink">Guidelines for Working With Disk Sets</span>.</p>
</div><div class="procedure"><ol type="1"><li><a name="tasks-disksets-step-75"></a>
<p>Use one of the following methods to
release a disk set:</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>From the Enhanced Storage tool within the Solaris Management Console, open the Disk Sets node. Click the right
mouse on the disk set that you want to release. Then choose Release Ownership
from the menu. For more information, see the online help.</p>
</li><li>
<p>To release ownership of the disk set, use the following form
of the <span><strong class="command">metaset</strong></span> command:</p>
<pre class="screen"># <strong class="userinput"><code>metaset -s <em class="replaceable"><code>diskset-name</code></em> -r</code></strong>
</pre>
<div class="variablelist"><dl><dt><span class="term">
<code class="option">
s</code> <em class="replaceable"><code>diskset-name</code></em>
</span></dt><dd>
<p>Specifies the name of a disk set on which the <span><strong class="command">metaset</strong></span> command
will work.</p>
</dd><dt><span class="term">
<code class="option">
r</code>
</span></dt><dd>
<p>Releases ownership of a disk set. The reservation of all the
disks within the disk set is removed. The volumes within the disk set are
no longer accessible.</p>
</dd></dl></div>
<p>See the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">metaset</span>
(
1M
)
</span>
</span> man
page for more information.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>Disk set ownership is only shown on the owning host.</p>
</div>
</li></ul></div>
</li><li><a name="tasks-disksets-step-10"></a>
<p>Verify that the disk set has been
released on this host.</p>
<pre class="screen"># <strong class="userinput"><code>metaset</code></strong>
</pre>
</li></ol></div><div class="example"><a name="egjwf"></a><p class="title"><b>Example 19.10. Releasing a Disk Set</b></p>


<p>The following example shows the release of the disk set, <code class="filename">blue</code>.
Note that there is no owner of the disk set. Viewing status from the host <code class="filename">host1</code> could be misleading. A host can only determine if it does
or does not own a disk set. For example, if he host, <code class="filename">host2</code>,
were to take ownership of the disk set, the ownership would not appear from
the host, <code class="filename">host1</code>. Only the host, <code class="filename">host2</code>,
would display that <code class="filename">host2</code> has ownership of the disk set.</p>
<pre class="screen">host1# <strong class="userinput"><code>metaset -s blue -r</code></strong>
host1# <strong class="userinput"><code>metaset -s blue</code></strong>
 
Set name = blue, Set number = 1

Host                Owner
  host1            
	host2

Drive               Dbase
  c1t6d0             Yes 
  c2t6d0             Yes 
 </pre>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id1767645"></a></h3></div></div></div>

<div class="task"><a name="tasks-disksets-71"></a><p class="title"><b>How to Delete a Host or Disk Set</b></p><a class="indexterm" name="indexterm-185"></a><a class="indexterm" name="indexterm-186"></a><a class="indexterm" name="indexterm-187"></a><a class="indexterm" name="indexterm-188"></a><a class="indexterm" name="indexterm-189"></a><a class="indexterm" name="indexterm-190"></a><div class="tasksummary">
<p>Deleting a disk set requires that the disk set contains no disks and
that no other hosts are attached to the disk set. Deleting the last host destroys
the disk set.</p>
</div><div class="procedure"><ol type="1"><li><a name="tasks-disksets-step-76"></a>
<p>Use one of the following methods to
delete a host from a disk set, or to delete a disk set:</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>From the Enhanced Storage tool within the Solaris Management Console, open the Disk Sets node. Click the right
mouse on the disk set you want to release, then choose Delete from the menu.
Follow the instructions in the online help.</p>
</li><li>
<p>To delete the host use the following form of the <span><strong class="command">metaset</strong></span> command. </p>
<pre class="screen">
<span><strong class="command">metaset <code class="option">
s</code> <em class="replaceable"><code>diskset-name</code></em> <code class="option">
d</code> <code class="option">
h</code> <em class="replaceable"><code>hostname</code></em>
</strong></span>
</pre>
<div class="variablelist"><dl><dt><span class="term">
<code class="option">
s</code> <em class="replaceable"><code>diskset-name</code></em>
</span></dt><dd>
<p>Specifies the name of a disk set on which the <span><strong class="command">metaset</strong></span> command
will work.</p>
</dd><dt><span class="term">
<code class="option">
d</code>
</span></dt><dd>
<p>Deletes a host from a disk set.</p>
</dd><dt><span class="term">
<code class="option">
h</code> <em class="replaceable"><code>hostname</code></em>
</span></dt><dd>
<p>Specifies the name of the host to delete.</p>
</dd></dl></div>
<p>Use the same form of the preceding <span><strong class="command">metaset</strong></span> command
to delete a disk set. Deleting a disk set requires that the disk set contains
no disks and that no other hosts own the disk set. Deleting the last host
destroys the disk set.</p>
<p>See the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">metaset</span>
(
1M
)
</span>
</span> man page for more information.</p>
</li></ul></div>
</li><li><a name="tasks-disksets-step-73"></a>
<p>Verify that the host has been deleted
from the disk set by using the <span><strong class="command">metaset</strong></span> command. Note that
only the current (owning) host is shown. Other hosts have been deleted.</p>
<pre class="screen"># <strong class="userinput"><code>metaset -s <em class="replaceable"><code>disk-set</code></em>
</code></strong>
</pre>
</li></ol></div><div class="example"><a name="eyprk"></a><p class="title"><b>Example 19.11. Deleting a Host From a Disk Set</b></p>


<p>The following example shows the deletion of the host, <code class="filename">host2</code> from
the disk set, <code class="filename">blue</code>.</p>
<pre class="screen"># <strong class="userinput"><code>metaset -s blue</code></strong>
Set name = blue, Set number = 1

Host                Owner
  host1            Yes 
..host2

Drive               Dbase
  c1t2d0             Yes 
  c1t3d0             Yes 
  c1t4d0             Yes 
  c1t5d0             Yes 
  c1t6d0             Yes 
  c2t1d0             Yes</pre>
<pre class="screen"># <strong class="userinput"><code>metaset -s blue -d -h host2</code></strong>
</pre>
<pre class="screen"># <strong class="userinput"><code>metaset -s blue</code></strong>
Set name = blue, Set number = 1

Host                Owner
  host1            Yes 

Drive               Dbase
  c1t2d0             Yes 
  c1t3d0             Yes 
  c1t4d0             Yes 
  c1t5d0             Yes 
  c1t6d0             Yes 
  c2t1d0             Yes</pre>
</div><div class="example"><a name="egjwl"></a><p class="title"><b>Example 19.12. Deleting the Last Host from a Disk Set</b></p>


<p>The following example shows the deletion of the last host from the disk
set, <code class="filename">blue</code>.</p>
<pre class="screen">host1# <strong class="userinput"><code>metaset -s blue -d -h host1</code></strong>
host1# <strong class="userinput"><code>metaset -s blue</code></strong>
 
metaset: host: setname "blue": no such set </pre>
</div></div>
</div>
</div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch19s03.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch19.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch19s05.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Expanding Disk Sets </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Importing Disk Sets</td></tr></table></div></body></html>
