<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Resource Management
Configuration Example - System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Solaris Containers-Resource Management and Solaris Zones<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p47.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p49.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="rmconfig-1"></a>Chapter&nbsp;14<h3>Resource Management
Configuration Example</h3><p>This chapter reviews the resource management framework and describes a hypothetical
server consolidation project.</p>
<p>The following topics are covered in this chapter:</p>
<ul><li><p><a href="p48.html#rmconfig-2">Configuration to Be Consolidated</a></p>
</li>
<li><p><a href="p48.html#rmconfig-3">Consolidation Configuration</a></p>
</li>
<li><p><a href="p48.html#rmconfig-4">Creating the Configuration</a></p>
</li>
<li><p><a href="p49.html">Viewing the Configuration</a></p>
</li>
</ul>
<a name="rmconfig-2"></a><h3>Configuration to Be Consolidated</h3>
<p>In this example, five applications are being consolidated onto a single system.
The target applications have resource requirements that vary, different user populations,
and different architectures. Currently, each application exists on a dedicated server
that is designed to meet the requirements of the application. The applications and
their characteristics are identified in the following table.</p>
<table><tr><th><p>Application Description</p>
</th><th><p>Characteristics</p>
</th></tr>
<tr><td><p>Application server</p>
</td><td><p>Exhibits negative scalability beyond 2 CPUs</p>
</td></tr>
<tr><td><p>Database instance for application server</p>
</td><td><p>Heavy transaction processing</p>
</td></tr>
<tr><td><p>Application server in test and development environment</p>
</td><td><p> GUI-based, with untested code execution</p>
</td></tr>
<tr><td><p>Transaction processing server</p>
</td><td><p>Primary concern is response time</p>
</td></tr>
<tr><td><p>Standalone database instance</p>
</td><td><p>Processes a large number of transactions and serves multiple time zones</p>
</td></tr>
</table><a name="rmconfig-3"></a><h3>Consolidation Configuration</h3>
<p>The following configuration is used to consolidate the applications onto a single
system that has the resource pools and the dynamic resource pools facilities enabled.</p>
<ul><li><p>The application server has a two&ndash;CPU processor set.</p>
</li>
<li><p>The database instance for the application server and the standalone
database instance are consolidated onto a single processor set of at least four CPUs.
The standalone database instance is guaranteed 75 percent of that resource.</p>
</li>
<li><p>The test and development application server requires the IA scheduling
class to ensure UI responsiveness. Memory limitations are imposed to lessen the effects
of bad code builds.</p>
</li>
<li><p>The transaction processing server is assigned a dedicated processor
set of at least two CPUs, to minimize response latency.</p>
</li>
</ul>
<p>This configuration covers known applications that are executing and consuming
processor cycles in each resource set. Thus, constraints can be established that allow
the processor resource to be transferred to sets where the resource is required.</p>
<ul><li><p>The <tt>wt-load</tt> objective is set to allow resource
sets that are highly utilized to receive greater resource allocations than sets that
have low utilization.</p>
</li>
<li><p>The <tt>locality</tt> objective is set to <tt>tight</tt>, which is used to maximize processor locality.</p>
</li>
</ul>
<p>An additional constraint to prevent utilization from exceeding 80 percent of
any resource set is also applied. This constraint ensures that applications get access
to the resources they require. Moreover, for the transaction processor set, the objective
of maintaining utilization below 80 percent is twice as important as any other objectives
that are specified. This importance will be defined in the configuration.</p>
<a name="rmconfig-4"></a><h3>Creating the Configuration</h3>
<p>Edit the <tt>/etc/project</tt> database file. Add entries to implement
the required resource controls and to map users to resource pools, then view the file.</p>
<pre># <tt><b>cat /etc/project</b></tt>
.
.
.
user.app_server:2001:Production Application Server:::project.pool=appserver_pool
user.app_db:2002:App Server DB:::project.pool=db_pool;project.cpu-shares=(privileged,1,deny)
development:2003:Test and development::staff:project.pool=dev_pool;
process.max-address-space=(privileged,536870912,deny)keep with previous line
user.tp_engine:2004:Transaction Engine:::project.pool=tp_pool
user.geo_db:2005:EDI DB:::project.pool=db_pool;project.cpu-shares=(privileged,3,deny)
.
.
.</pre><hr>
<p><b>Note - </b>The development team has to execute tasks in the development project because
access for this project is based on a user's group ID (GID).</p>
<hr>
<p>Create an input file named <tt>pool.host</tt>, which will be used
to configure the required resource pools. View the file.</p>
<pre># <tt><b>cat pool.host</b></tt>
create system host
create pset dev_pset (uint pset.min = 0; uint pset.max = 2)
create pset tp_pset (uint pset.min = 2; uint pset.max=8)
create pset db_pset (uint pset.min = 4; uint pset.max = 6)
create pset app_pset (uint pset.min = 1; uint pset.max = 2)
create pool dev_pool (string pool.scheduler="IA")
create pool appserver_pool (string pool.scheduler="TS")
create pool db_pool (string pool.scheduler="FSS")
create pool tp_pool (string pool.scheduler="TS")
associate pool dev_pool (pset dev_pset)
associate pool appserver_pool (pset app_pset)
associate pool db_pool (pset db_pset)
associate pool tp_pool (pset tp_pset)
modify system tester (string system.poold.objectives="wt-load")
modify pset dev_pset (string pset.poold.objectives="locality tight; utilization &lt; 80")
modify pset tp_pset (string pset.poold.objectives="locality tight; 2: utilization &lt; 80")
modify pset db_pset (string pset.poold.objectives="locality tight;utilization &lt; 80")
modify pset app_pset (string pset.poold.objectives="locality tight; utilization &lt; 80")</pre><p>Update the configuration using the <tt>pool.host</tt> input file.</p>
<pre># <tt><b>poolcfg -f pool.host</b></tt></pre><p>Make the configuration active.</p>
<pre># <tt><b>pooladm -c</b></tt></pre><p>The framework is now functional on the system.</p>
<p>Enable DRP.</p>
<pre># <tt><b>svcadm enable pools/dynamic:default</b></tt></pre>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p47.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p49.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

