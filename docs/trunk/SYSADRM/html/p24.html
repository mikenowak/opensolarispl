<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>FSS and Processor Sets - System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Solaris Containers-Resource Management and Solaris Zones<?GenHTML /ReferencePage> > <a href="p22.html">8.&nbsp;&nbsp;Fair Share Scheduler (Overview)</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p23.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p25.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="rmfss-19"></a><h3>FSS and Processor Sets</h3>
<p><a name="indexterm-69"></a>The FSS can be used in conjunction with
processor sets to provide more fine-grained controls over allocations of CPU
resources among projects that run on each processor set than would be available
with processor sets alone. The FSS scheduler treats processor sets as entirely
independent partitions, with each processor set controlled independently with
respect to CPU allocations.</p>
<p>The CPU allocations of projects running in one processor set are not
affected by the CPU shares or activity of projects running in another processor
set because the projects are not competing for the same resources. Projects
only compete with each other if they are running within the same processor
set.</p>
<p>The number of shares allocated to a project is system wide. Regardless
of which processor set it is running on, each portion of a project is given
the same amount of shares.</p>
<p>When processor sets are used, project CPU allocations are calculated
for active projects that run within each processor set.</p>
<p>Project partitions that run on different processor sets might have different
CPU allocations. The CPU allocation for each project partition in a processor
set depends only on the allocations of other projects that run on the same
processor  set.</p>
<p>The performance and availability of applications that run within the
boundaries of their processor sets are not affected by the introduction of
new processor sets. The applications are also not affected by changes that
are made to the share allocations of projects that run on other processor
sets.</p>
<p>Empty processor sets (sets without processors in them) or processor
sets without processes bound to them do not have any impact on the FSS scheduler
behavior.</p>
<a name="rmfss-16"></a><h4>FSS and Processor Sets Examples</h4>
<p>Assume that a server with eight CPUs is running several CPU-bound applications
in projects <i>A</i>, <i>B</i>, and <i>C</i>. Project <i>A</i> is allocated one share,
project <i>B</i> is allocated two shares, and project <i>C</i> is allocated three shares.</p>
<p>Project <i>A</i> is running only on processor set
1. Project <i>B</i> is running on processor sets 1 and
2. Project <i>C</i> is running on processor sets 1, 2,
and 3. Assume that each project has enough processes to utilize all available
CPU power. Thus, there is always competition for CPU resources on each processor
set.</p>
<img src="figures/rmfss.gif" alt=""></img><p>The total system-wide project CPU allocations on such a system are shown
in the following table.</p>
<table><tr><th><p>Project</p>
</th><th><p>Allocation</p>
</th></tr>
<tr><td><p>Project A</p>
</td><td><p>4% = (1/6 X 2/8)<sub>pset1</sub></p>
</td></tr>
<tr><td><p>Project B</p>
</td><td><p>28% = (2/6 X 2/8)<sub>pset1</sub>+ (2/5 * 4/8)<sub>pset2</sub></p>
</td></tr>
<tr><td><p>Project C</p>
</td><td><p>67% = (3/6 X 2/8)<sub>pset1</sub>+ (3/5 X 4/8)<sub>pset2</sub>+
(3/3 X 2/8)<sub>pset3</sub></p>
</td></tr>
</table><p>These percentages do not match the corresponding amounts of CPU shares
that are given to projects. However, within each processor set, the per-project
CPU allocation ratios are proportional to their respective shares.</p>
<p>On the same system <b>without</b> processor sets, the
distribution of CPU resources would be different, as shown in the following
table.</p>
<table><tr><th><p>Project</p>
</th><th><p>Allocation</p>
</th></tr>
<tr><td><p>Project A</p>
</td><td><p>16.66% = (1/6)</p>
</td></tr>
<tr><td><p>Project B</p>
</td><td><p>33.33% = (2/6)</p>
</td></tr>
<tr><td><p>Project C</p>
</td><td><p>50% = (3/6)</p>
</td></tr>
</table><a name="rmfss-17"></a><h3>Combining FSS With Other Scheduling Classes</h3>
<p><a name="indexterm-70"></a>By default,
the FSS scheduling class uses the same range of priorities (0 to 59) as the
timesharing (TS), interactive (IA), and fixed priority (FX) scheduling classes.
Therefore, you should avoid having processes from these scheduling classes
share <b>the same</b> processor set. A mix of processes in the
FSS, TS, IA, and FX classes could result in unexpected scheduling behavior.</p>
<p>With the use of processor sets, you can mix TS, IA, and FX with FSS
in one system. However, all the processes that run on each processor set must
be in <b>one</b> scheduling class, so they do not compete for
the same CPUs. The FX scheduler in particular should not be used in conjunction
with the FSS scheduling class unless processor sets are used. This action
prevents applications in the FX class from using priorities high enough to
starve applications in the FSS class.</p>
<p>You can mix processes in the TS and IA classes in the same processor
set, or on the same system without processor sets.</p>
<p>The Solaris system also offers a real-time (RT) scheduler to users with
superuser privileges. By default, the RT scheduling class uses system priorities
in a different range (usually from 100 to 159) than FSS. Because RT and FSS
are using <b>disjoint</b>, or non-overlapping, ranges of priorities,
FSS can coexist with the RT scheduling class within the same processor set.
However, the FSS scheduling class does not have any control over processes
that run in the RT class.</p>
<p>For example, on a four-processor system, a single-threaded RT process
can consume one entire processor if the process is CPU bound. If the system
also runs FSS, regular user processes compete for the three remaining CPUs
that are not being used by the RT process. Note that the RT process might
not use the CPU continuously. When the RT process is idle, FSS utilizes all
four processors.</p>
<p>You can type the following command to find out which scheduling classes
the processor sets are running in and ensure that each processor set is configured
to run either TS, IA, FX, or FSS processes.</p>
<pre>$ <tt><b>ps -ef -o pset,class | grep -v CLS | sort | uniq</b></tt>
1 FSS
1 SYS
2 TS
2 RT
3 FX</pre><a name="rmfss-21"></a><h3>Setting the Scheduling Class for the System</h3>
<p>To set the default scheduling class for the system, see <a href="p25.html#rmfss.task-6">How to Make FSS the Default Scheduler Class</a>, <a href="p55.html#gejen">Scheduling Class</a>, and <tt>dispadmin</tt>(1M). To move running processes
into a different scheduling class, see <a href="p25.html#rmfss.task-5">Configuring the FSS</a> and <tt>priocntl</tt>(1).</p>
<a name="rmfss-22"></a><h3>Scheduling Class on a System with Zones Installed</h3>
<p>Non-global zones use the default scheduling class for  the system. If
the system is updated with a new default  scheduling class setting, non-global
zones obtain the new setting when booted or rebooted.</p>
<p>The preferred way to use FSS in this case is to set FSS to be the system
default scheduling class with the <tt>dispadmin</tt> command. All
zones then benefit from getting a fair share of the system CPU resources.
See <a href="p55.html#gejen">Scheduling Class</a> for more information
on scheduling class when zones are in use.</p>
<p>For information about moving running processes into a different scheduling
class  without changing the default scheduling class and rebooting, see <a href="p103.html#z.admin.ov-tbl-34">Table 26-5</a> and the <tt>priocntl</tt>(1) man page.</p>
<a name="rmfss-20"></a><h3>Commands Used With FSS</h3>
<p><a name="indexterm-71"></a>The commands that are shown in the following
table provide the primary administrative interface to the fair share scheduler.</p>
<table><tr><th><p>Command Reference</p>
</th><th><p>Description</p>
</th></tr>
<tr><td><p><tt>priocntl</tt>(1)</p>
</td><td><p>Displays or sets scheduling parameters of specified processes, moves
running processes into a different scheduling class.</p>
</td></tr>
<tr><td><p><tt>ps</tt>(1)</p>
</td><td><p>Lists information about running processes, identifies in which scheduling
classes processor sets are running.</p>
</td></tr>
<tr><td><p><tt>dispadmin</tt>(1M)</p>
</td><td><p>Sets the default scheduler for the system. Also used to examine and
tune the FSS scheduler's time quantum value.</p>
</td></tr>
<tr><td><p><tt>FSS</tt>(7)</p>
</td><td><p>Describes the fair share scheduler (FSS).</p>
</td></tr>
</table>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p23.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p25.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

