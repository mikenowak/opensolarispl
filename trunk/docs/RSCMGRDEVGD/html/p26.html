<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Configuration Examples - Solaris Containers: Resource Management and Solaris Zones Developer's Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >Solaris Containers: Resource Management and Solaris Zones Developer's Guide<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p25.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="idx-1.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="faate"></a>Chapter&nbsp;8<h3>Configuration Examples</h3><p>This chapter show example configurations for the <tt>/etc/project</tt> file.</p>
<ul><li><p><a href="p26.html#fair-share-sched-1">Configure Resource Controls</a></p>
</li>
<li><p><a href="p26.html#fair-share-sched-2">Configure Resource Pools</a></p>
</li>
<li><p><a href="p26.html#fair-share-sched-3">Configure FSS <tt>project.cpu-shares</tt> for a Project</a></p>
</li>
<li><p><a href="p26.html#fair-share-sched-4">Configure Five Applications with Different Characteristics</a></p>
</li>
</ul>
<a name="faave"></a><h3><tt>/etc/project</tt> Project File</h3>
<p>The project file is a local source of  project  information. The  project
file can be used in conjunction with other project sources, including the
NIS maps <tt>project.byname</tt> and <tt>project.bynumber</tt> and
the LDAP database project. Programs use the <tt>getprojent</tt>(3PROJECT)
routines to access this information.</p>
<a name="faauc"></a><h4><a name="config-examples-100"></a>Define Two Projects</h4>
<p><tt>/etc/project</tt> defines two projects: <tt>database</tt> and <tt>appserver</tt>. The <b>user</b> defaults are <tt>user.database</tt> and <tt>user.appserver</tt>. The <b>admin</b> default
can switch between <tt>user.database</tt> or <tt>user.appserver</tt>.</p>
<p><tt>hostname#</tt> <tt><b>cat /etc/project</b></tt></p>
<pre>.
.
.
user.database:2001:Database backend:admin::
user.appserver:2002:Application Server frontend:admin::
.
.</pre><a name="fair-share-sched-1"></a><h4>Configure Resource Controls</h4>
<p>The <tt>/etc/project</tt> file shows the resource controls
for the application.</p>
<p><tt>hostname#</tt> <tt><b>cat /etc/project</b></tt></p>
<pre>.
.
.
development:2003:Developers:::task.ax-lwps=(privileged,10,deny);
process.max-addressspace=(privileged,209715200,deny)
.
.</pre><a name="fair-share-sched-2"></a><h4>Configure Resource Pools</h4>
<p>The <tt>/etc/project</tt> file shows the resource pools
for the application.</p>
<p><tt>hostname#</tt> <tt><b>cat /etc/project</b></tt></p>
<pre>.
.
.
batch:2001:Batch project:::project.pool=batch_pool
process:2002:Process control:::project.pool=process_pool
.
.
.</pre><a name="fair-share-sched-3"></a><h4>Configure FSS <tt>project.cpu-shares</tt> for
a Project</h4>
<p>Set up FSS for two projects: <b>database</b> and <b>appserver</b>. The <b>database</b> project has 20 CPU shares.
The <b>appserver</b> project has 10 CPU shares.</p>
<p><tt>hostname#</tt> <tt><b>cat /etc/project</b></tt></p>
<pre>.
.
.
user.database:2001:database backend:admin::project.cpu-shares=(privileged,
     20,deny)
user.appserver:2002:Application Server frontend:admin::project.cpu-shares=
     (privileged,10,deny)
.
.
.</pre><hr>
<p><b>Note - </b>The line break in the lines that precede  &ldquo;20,deny&rdquo;
and &ldquo;(privileged,&rdquo; is  not valid in an <tt>/etc/project</tt> file.
The line breaks are shown here only to allow the example to display on a printed
or displayed page. Each entry in the <tt>/etc/project</tt> file
must be on a single line.</p>
<hr>
<p>If the FSS is enabled but each user and application is not assigned
to a unique project, then the users and applications will all run in the same
project. By running in the same project, all compete for the same share, in
a timeshare fashion. This occurs because shares are assigned to projects,
not to users or processes. To take advantage of the FSS scheduling capabilities,
assign each user and application to a unique project.</p>
<p>To configure a project, see Local /etc/project File
Format in <i>System Administration Guide:
Solaris Containers-Resource Management and Solaris Zones</i>.</p>
<a name="fair-share-sched-4"></a><h4>Configure Five Applications with Different
Characteristics</h4>
<p>The following example configures five applications with different characteristics.</p>
<a name="fair-share-sched-tbl-5"></a>Table 8-1 Target Applications
and Characteristics<table><tr><th><p>Application Type and Name</p>
</th><th><p>Characteristics</p>
</th></tr>
<tr><td><p>Application server, <tt>app_server</tt>.</p>
</td><td><p>Negative scalability beyond two CPUs. Assign a two-CPU processor set
to <tt>app_server</tt>. Use TS scheduling class.</p>
</td></tr>
<tr><td><p>Database instance, <tt>app_db</tt>.</p>
</td><td><p>Heavily multithreaded. Use FSS scheduling class.</p>
</td></tr>
<tr><td><p>Test and development, <tt>development</tt>.</p>
</td><td><p>Motif based. Hosts untested code execution. Interactive scheduling class
ensures user interface responsiveness. Use <tt>process.max-address-space</tt> to
impose memory limitations and minimize the effects of antisocial processing.</p>
</td></tr>
<tr><td><p>Transaction processing engine, <tt>tp_engine</tt>.</p>
</td><td><p>Response time is paramount. Assign a dedicated set of at least two CPUs
to ensure response latency is kept to a minimum. Use timeshare scheduling
class.</p>
</td></tr>
<tr><td><p>Standalone database instance, <tt>geo_db</tt>.</p>
</td><td><p>Heavily multithreaded. Serves multiple time zones. Use FSS scheduling
class.</p>
</td></tr>
</table><hr>
<p><b>Note - </b>Consolidate database applications (<tt>app.db</tt> and <tt>geo_db</tt>) onto a single processor set of at least four CPUs. Use FSS
scheduling class. Application <tt>app_db</tt> gets 25% of the <tt>project.cpu-shares</tt>. Application <tt>geo_db</tt> gets 75%
of the <tt>project.cpu-shares</tt>.</p>
<hr>
<p>Edit the <tt>/etc/project</tt> file. Map users to resource
pools for the <tt>app_server</tt>, <tt>app_db</tt>, <tt>development</tt>, <tt>tp_engine</tt>, and <tt>geo_db</tt> project
entries. </p>
<p><tt>hostname#</tt> <tt><b>cat /etc/project</b></tt></p>
<pre>.
.
.
user.app_server:2001:Production Application Server::
     project.pool=appserver_pool
user.app_db:2002:App Server DB:::project.pool=db_pool,
     project.cpu-shares=(privileged,1,deny)
development:2003:Test and delopment::staff:project.pool=dev.pool,
     process.max-addressspace=(privileged,536870912,deny)
user.tp_engine:Transaction Engine:::project.pool=tp_pool
user.geo_db:EDI DB:::project.pool=db_pool;
     project.cpu-shares=(privileged,3,deny)</pre><hr>
<p><b>Note - </b>The line break in the lines that begin  with  &ldquo;project.pool&rdquo;
, &ldquo;project.cpu-shares=&rdquo;, &ldquo;process.max-addressspace&rdquo;,
and &ldquo;project.cpu-shares=&rdquo; is  not valid in a project file. The
line breaks are shown here only to allow the example to display on a  printed
 or  displayed page. Each entry must be on one and only one line.</p>
<hr>
<p>Create the <tt>pool.host</tt> script and add entries for
resource pools.</p>
<p><tt>hostname#</tt> <tt><b>cat pool.host</b></tt></p>
<pre>create system host
create pset dev_pset (uint pset.max = 2)
create pset tp_pset (uint pset.min = 2; uint pset.max = 2)
create pset db_pset (uint pset.min = 4; uint pset.max = 6)
create pset app_pset (uint pset.min = 1; uint pset.max = 2)
create pool dev_pool (string pool.scheduler="IA")
create pool appserver_pool (string pool.scheduler="TS")
create pool db_pool (string pool.scheduler="FSS")
create pool tp_pool (string pool.scheduler="TS")
associate pool pool_default (pset pset_default)
associate pool dev_pool (pset dev_pset)
associate pool appserver_pool (pset app_pset)
associate pool db_pool (pset db_pset)
associate pool tp_pool (pset tp_pset)</pre><p>Run the <tt>pool.host</tt> script and modify the configuration
as specified in the <tt>pool.host</tt> file.</p>
<p><tt>hostname#</tt> <tt><b>poolcfg &mdash;f pool.host</b></tt></p>
<p>Read the <tt>pool.host</tt> resource pool configuration
file and initialize the resource pools on the system.</p>
<p><tt>hostname#</tt> <tt><b>pooladm &mdash;c</b></tt></p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p25.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="idx-1.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

