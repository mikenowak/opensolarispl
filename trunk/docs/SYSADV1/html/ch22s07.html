<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Managing Patches by Using the Command-Line
Interface (Task Map)</title><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="System Administration Guide: Basic Administration"><link rel="up" href="ch22.html" title="Chapter 22. Managing Solaris Patches by Using Sun Patch
Manager (Tasks)"><link rel="prev" href="ch22s06.html" title="Configuring Your Patch Management
Environment by Using the Command-Line Interface (Task Map)"><link rel="next" href="ch22s08.html" title="Tuning Your Patch Management Environment
by Using the Command-Line Interface (Task Map)"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Managing Patches by Using the Command-Line
Interface (Task Map)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch22s06.html">Prev</a> </td><th width="60%" align="center">Chapter 22. Managing Solaris Patches by Using Sun Patch
Manager (Tasks)</th><td width="20%" align="right"> <a accesskey="n" href="ch22s08.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="managepatchesclitaskmap"></a>Managing Patches by Using the Command-Line
Interface (Task Map)</h2></div></div></div>

<a class="indexterm" name="indexterm-491"></a>
<p>Use the <span><strong class="command">smpatch</strong></span> command to perform most of the common
patch management tasks described in the following table. See the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">smpatch</span>
(
1M
)
</span>
</span> man page.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>You can use the Sun Update Connection, System Edition software
to manage patches and updates on your Solaris system. The Sun Update Connection
software has the same functionality as the Sun Patch Manager 2.0 tools, with
the addition of some new features and enhancements. For more information,
see <span class="olink">Chapter 16, Managing Software (Overview)</span>.</p>
</div>
<div class="informaltable">
<table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>
<p>Task</p>
</th><th>
<p>Description</p>
</th><th>
<p>For Instructions</p>
</th></tr></thead><tbody><tr><td>
<p>Analyze your system to determine the list of patches.</p>
</td><td>
<p>You want to analyze your system to obtain the list of appropriate patches.
Based on the analysis, you can update your system with one or more patches
in the list.</p>
</td><td>
<p>
<span class="olink">How to Analyze Your System to Obtain the List of Patches to Apply (Command Line)</span>
</p>
</td></tr><tr><td>
<p>Automatically update your system with one or more patches in a single
procedure.</p>
</td><td>
<p>You want to automatically download and apply the patches that are appropriate
for your system. The list of patches is determined by having Patch Manager
analyze your system.</p>
</td><td>
<p>
<span class="olink">How to Update Your System With Patches (Command Line)</span>
</p>
</td></tr><tr><td>
<p>
<a class="indexterm" name="indexterm-492"></a>
<a class="indexterm" name="indexterm-493"></a>Apply patches to your system.</p>
</td><td>
<p>After you have determined the patches to apply and have downloaded them
to your system, you can apply them.</p>
</td><td>
<p>
<span class="olink">How to Apply Patches to Your System (Command Line)</span>
</p>
</td></tr><tr><td>
<p>
</p>
</td><td>
<p>Some patches should be applied while the system is in single-user mode
because they might cause the system to become unstable. Such patches are associated
with the <code class="literal">singleuser</code> patch property. In single-user mode,
you must use the <span><strong class="command">smpatch add</strong></span> command to apply patches.</p>
</td><td>
<p>
<span class="olink">How to Apply Patches to Your System (Command Line)</span>
</p>
</td></tr><tr><td>
<p>
</p>
</td><td>
<p>Some patches are nonstandard and must be applied manually.</p>
</td><td>
<p>
<span class="olink">How to Apply a Nonstandard Patch (Command Line)</span>
</p>
<p>
<span class="olink">How to Download and Apply a Solaris Patch</span>
</p>
</td></tr><tr><td>
<p>
</p>
</td><td>
<p>Determine whether the patches you want to apply depend on others being
applied first. This task is optional.</p>
</td><td>
<p>
<span class="olink">How to Resolve a List of Patches (Command Line)</span>
</p>
</td></tr><tr><td>
<p>Remove patches from your system.</p>
</td><td>
<p>You want to remove, or back out, patches that you applied to your system.</p>
</td><td>
<p>
<span class="olink">How to Remove Patches From Your System (Command Line)</span>
</p>
</td></tr><tr><td>
<p>View patch management tool log entries. This task is optional.</p>
</td><td>
<p>View Patch Manager log entries in the system log file to identify problems
with installing patch management tools or applying patches.</p>
</td><td>
<p>
<span class="olink">How to View Patch Manager Log Entries (Command Line)</span>
</p>
</td></tr><tr><td>
<p>Apply patches to an inactive boot environment on your system by using <span><strong class="command">luupgrade</strong></span>.</p>
</td><td>
<p>You want to use Solaris Live Upgrade to apply patches to a system that
has more than one boot environment.</p>
</td><td>
<p>
<span class="olink">How to Use <span><strong class="command">luupgrade</strong></span> to Apply a List of Patches to an Inactive Boot Environment (Command Line)</span>
</p>
</td></tr></tbody></table>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>The following procedures and examples show how to run the local
mode <span><strong class="command">smpatch</strong></span> command, which is run by default. To run the
remote mode version, use any of the authentication options (except for <code class="option">
L</code>)
or the remote options. See the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">smpatch</span>
(
1M
)
</span>
</span> man
page.</p>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2147793"></a></h3></div></div></div>

<div class="task"><a name="analyzecliproc"></a><p class="title"><b>How to Analyze Your System to Obtain the
List of Patches to Apply (Command Line)</b></p><a class="indexterm" name="indexterm-494"></a><a class="indexterm" name="indexterm-495"></a><a class="indexterm" name="indexterm-496"></a><a class="indexterm" name="indexterm-497"></a><a class="indexterm" name="indexterm-498"></a><div class="tasksummary">
<p>You can perform an analysis of your system to determine the list of
appropriate patches. The list is in an order that can be used to apply patches.
You can also supply a list of one or more patches as input to restrict the
analysis to just those patches. In addition to performing the analysis, you
can save the patch list for modification or later use.</p>
<p>The system analysis writes the list of patches to standard output, so
you can save the contents of the patch list to a file by redirecting standard
output to a file.</p>
<p>Each line in a patch list has two columns. The first column is the patch
ID, and the second column is a synopsis of that patch.</p>
<p>If you supply a list of one or more patches to the <span><strong class="command">smpatch
analyze</strong></span> command, the list of patches is augmented with any patches
that are required as dependencies.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Become an appropriately authorized user or assume a role that includes the Software Installation profile or the <code class="literal">solaris.admin.patchmgr.*</code> authorization.</p>
<p>The System Administrator profile includes the appropriate profiles. To create the role and assign the role to a user, see <span class="olink">
<em class="citetitle">Configuring RBAC</em> in <em class="citetitle">System Administration Guide: Security Services</em>
</span>.</p>
</li><li>
<p>Perform a patch analysis of your system and optionally save the
list of patches in a file.</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>To create a list of all the appropriate patches for your system,
type:</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze</code></strong>
</pre>
</li><li>
<p>To create a list of particular patches for your system based
on a patch list, type:</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze -x idlist=<em class="replaceable"><code>patch-list-file</code></em>
</code></strong>
</pre>
</li><li>
<p>To create a list of particular patches for your system, type:</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze -i <em class="replaceable"><code>patch-id</code></em>...</code></strong>
</pre>
</li></ul></div>
</li></ol></div><div class="example"><a name="analyzesystemcliexample"></a><p class="title"><b>Example 22.3. Analyzing Your System to Obtain the List of Patches to Apply</b></p>


<p>The following example shows how to analyze a system to create a list
of all appropriate patches. The list is written to the <code class="filename">/tmp/patch.all</code> file.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze &gt; /tmp/patch.all</code></strong>
</pre>
<p>The following example shows how to create a list of patches, <code class="filename">plist</code>, modify it, and resolve the patch dependencies. The list is written
to the <code class="filename">/tmp/patch.plist</code> file.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze &gt; plist</code></strong>
# <strong class="userinput"><code>vi plist</code></strong>
.
.
.
# <strong class="userinput"><code>smpatch analyze -x idlist=plist &gt; /tmp/patch.plist</code></strong>
</pre>
<p>The following example shows how to resolve patch dependencies for patch
112785-28 and write the resulting patch list to a file called <code class="filename">/tmp/patch.out</code>. Patch 112785-28 depends on patch 113096-03. After running the <span><strong class="command">smpatch analyze</strong></span> command, the <code class="filename">patch.out</code> file
contains this ordered list: 113096-03 and 112785-28.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze -i 112785-28 &gt; /tmp/patch.out</code></strong>
</pre>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2148168"></a></h3></div></div></div>

<div class="task"><a name="updatecliproc"></a><p class="title"><b>How to Update Your System With Patches (Command
Line)</b></p><a class="indexterm" name="indexterm-499"></a><a class="indexterm" name="indexterm-500"></a><a class="indexterm" name="indexterm-501"></a><a class="indexterm" name="indexterm-502"></a><a class="indexterm" name="indexterm-503"></a><div class="tasksummary">
<p>An update of a system performs the entire patch management process in
one step. First, the analysis determines the appropriate patches for your
system. Next, those patches are downloaded to your system. Finally, the patches
are applied to your system. <a class="indexterm" name="indexterm-504"></a>
</p>
<p>All standard patches are applied by an update. You can configure your
system to apply some nonstandard patches by changing the default policy for
applying patches. To change the policy for your system, see <span class="olink">How to Change the Policy for Applying Patches (Command Line)</span>.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Become an appropriately authorized user or assume a role that includes the Software Installation profile or the <code class="literal">solaris.admin.patchmgr.*</code> authorization.</p>
<p>The System Administrator profile includes the appropriate profiles. To create the role and assign the role to a user, see <span class="olink">
<em class="citetitle">Configuring RBAC</em> in <em class="citetitle">System Administration Guide: Security Services</em>
</span>.</p>
</li><li>
<p>Update the system with patches in one of the following ways:</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>To update your system with all appropriate patches, type:</p>
<pre class="screen"># <strong class="userinput"><code>smpatch update</code></strong>
</pre>
</li><li>
<p>To update your system with all patches listed in a file, first
create a patch list (see <span class="olink">How to Analyze Your System to Obtain the List of Patches to Apply (Command Line)</span>),
then type:</p>
<pre class="screen"># <strong class="userinput"><code>smpatch update -x idlist=<em class="replaceable"><code>patch-list-file</code></em>
</code></strong>
</pre>
</li><li>
<p>To update your system with particular patches, type:</p>
<pre class="screen"># <strong class="userinput"><code>smpatch update -i <em class="replaceable"><code>patch-id</code></em> -i <em class="replaceable"><code>patch-id</code></em> ...</code></strong>
</pre>
</li></ul></div>
<p>If you specify particular patches by using the <code class="option">
i</code> or <code class="option">
x idlist=</code> options, the list is augmented with patches on which they
depend before the update occurs.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>Any patches that cannot be applied to the system are listed in
a patch list file called <code class="filename">disallowed_patch_list</code>, which
is located in the download directory. You can use this file as input to the <span><strong class="command">smpatch add</strong></span> command. <a class="indexterm" name="indexterm-505"></a>
</p>
<p>For example, you might bring your system to single-user
mode and apply the patches listed in the <code class="filename">disallowed_patch_list</code> file
by typing the following:</p>
<pre class="screen"># <strong class="userinput"><code>init S</code></strong>
# <strong class="userinput"><code>smpatch add -x idlist=/var/sadm/spool/disallowed_patch_list</code></strong>
</pre>
<p>See <span class="olink">How to Apply Patches to Your System (Command Line)</span> for more information.</p>
</div>
</li></ol></div><div class="example"><a name="updatesystemcliexample"></a><p class="title"><b>Example 22.4. Updating Your System With Patches</b></p>


<p>The following example shows how to update a system with patch 112622-12
and 112771-17.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch update -i 112622-12 -i 112771-17</code></strong>
</pre>
<p>The following example shows how to update a system by using a list of
patches, named <code class="filename">plist</code>, as input. It then shows how to
create a patch list and modify it to contain only the patches that you want
to apply to your system. Then, use the <span><strong class="command">smpatch update</strong></span> command
to apply the patches and update the system.</p>
<div class="orderedlist"><ol type="1"><li>
<p>Create a list of patches by performing an analysis.</p>
</li><li>
<p>Edit the patch list to include only the patches that you want
to apply.</p>
</li><li>
<p>Run the <span><strong class="command">smpatch update</strong></span> command to apply
the patches.</p>
<p>For example:</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze &gt; plist</code></strong>
.
.
.
# <strong class="userinput"><code>vi plist</code></strong>
.
.
.
# <strong class="userinput"><code>smpatch update -x idlist=plist</code></strong>
.
.
.</pre>
</li></ol></div>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2148676"></a></h3></div></div></div>

<div class="task"><a name="applycliproc"></a><p class="title"><b>How to Apply Patches to Your System (Command
Line)</b></p><a class="indexterm" name="indexterm-506"></a><a class="indexterm" name="indexterm-507"></a><a class="indexterm" name="indexterm-508"></a><div class="tasksummary">
<p>You can use the <span><strong class="command">smpatch add</strong></span> command to apply one
or more downloaded patches to your system.</p>
<p>You can use the local mode version of the <span><strong class="command">smpatch</strong></span> command
to apply one or more downloaded patches while your system is in single-user
mode or in multiuser mode.</p>
<div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Caution</h3>

<p>The <span><strong class="command">smpatch add</strong></span> command ignores the policy
for applying patches and does not resolve dependencies when applying patches.</p>
</div>
</div><div class="procedure"><ol type="1"><li>
<p>Become an appropriately authorized user or assume a role that includes the Software Installation profile or the <code class="literal">solaris.admin.patchmgr.*</code> authorization.</p>
<p>The System Administrator profile includes the appropriate profiles. To create the role and assign the role to a user, see <span class="olink">
<em class="citetitle">Configuring RBAC</em> in <em class="citetitle">System Administration Guide: Security Services</em>
</span>.</p>
</li><li>
<p>Apply the downloaded patches to your system.</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>To apply all patches listed in a file, type:</p>
<pre class="screen"># <strong class="userinput"><code>smpatch add -x idlist=<em class="replaceable"><code>patch-list-file</code></em>
</code></strong>
</pre>
</li><li>
<p>To apply particular patches, type:</p>
<pre class="screen"># <strong class="userinput"><code>smpatch add -i <em class="replaceable"><code>patch-id</code></em> -i <em class="replaceable"><code>patch-id</code></em> ...</code></strong>
</pre>
</li><li>
<p>To apply particular patches that have the <code class="literal">singleuser</code> property,
you must first bring the system to single-user mode. Type:</p>
<pre class="screen"># <strong class="userinput"><code>init S</code></strong>
# <strong class="userinput"><code>smpatch add -i <em class="replaceable"><code>patch-id</code></em> -i <em class="replaceable"><code>patch-id</code></em> ...</code></strong>
</pre>
</li><li>
<p>To apply the list of patches that could not be applied by
the <span><strong class="command">smpatch update</strong></span> command, you must first bring the system
to single-user mode. Type:</p>
<pre class="screen"># <strong class="userinput"><code>init S</code></strong>
# <strong class="userinput"><code>smpatch add -x idlist=/var/sadm/spool/disallowed_patch_list</code></strong>
</pre>
</li></ul></div>
</li></ol></div><div class="example"><a name="applypatchplcliexample"></a><p class="title"><b>Example 22.5. Applying Patches to Your System</b></p>


<div class="itemizedlist"><ul type="disc"><li>
<p>The following example shows how to apply the patches listed
in the file <code class="filename">plist</code> while the system is in single-user
mode.</p>
<pre class="screen">Requesting System Maintenance Mode
SINGLE USER MODE

Root password for system maintenance (control-d to bypass): <strong class="userinput"><code>xxxxxxx</code></strong>
single-user privilege assigned to /dev/console.
Entering System Maintenance Mode Entering System Maintenance Mode
.
.
.
# <strong class="userinput"><code>smpatch add -x idlist=plist</code></strong>
</pre>
</li><li>
<p>The following example shows how to apply patch 112662-12 while
the system is in single-user mode.</p>
<pre class="screen">Requesting System Maintenance Mode
SINGLE USER MODE

Root password for system maintenance (control-d to bypass): <strong class="userinput"><code>xxxxxxx</code></strong>
single-user privilege assigned to /dev/console.
Entering System Maintenance Mode Entering System Maintenance Mode
.
.
.
# <strong class="userinput"><code>smpatch add -i 112662-12</code></strong>
</pre>
</li></ul></div>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2149096"></a></h3></div></div></div>

<div class="task"><a name="applynonstandardpatchcliproc"></a><p class="title"><b>How to Apply a Nonstandard
Patch (Command Line)</b></p><a class="indexterm" name="indexterm-509"></a><a class="indexterm" name="indexterm-510"></a><a class="indexterm" name="indexterm-511"></a><div class="tasksummary">
<p>You cannot use <span><strong class="command">smpatch</strong></span> to apply nonstandard patches
that have the <code class="literal">interactive</code> property set. To apply the patch,
review the information in the Special Installation Instructions section of
the patch's README file.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Become superuser or assume an equivalent role.</p>
<p>Roles
contain authorizations and privileged commands. For more information about
roles, see <span class="olink">
<em class="citetitle">Configuring RBAC (Task Map)</em> in <em class="citetitle">System Administration Guide: Security Services</em>
</span>.</p>
</li><li>
<p>In the download directory, find the nonstandard patch that you
want to apply.</p>
<pre class="screen"># <strong class="userinput"><code>cd /var/sadm/spool; ls</code></strong>
</pre>
</li><li>
<p>To access the patch README file, do one of the following:</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>View the patch README file from the Sun patch server at <a href="http://sunsolve.sun.com" target="_top">
</a>.</p>
</li><li>
<p>To extract the patch README file from the <span class="acronym">JAR</span> archive,
do the following:</p>
<div class="orderedlist"><ol type="1"><li>
<p>Identify the name of the README file.</p>
</li><li>
<p>Extract the README file.</p>
</li><li>
<p>View the README file.</p>
</li></ol></div>
</li></ul></div>
</li><li>
<p>Follow the instructions in the Special Installation Instructions
section of the README file to apply the patch.</p>
</li></ol></div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2149330"></a></h3></div></div></div>

<div class="task"><a name="resolvecliproc"></a><p class="title"><b>How to Resolve a List of Patches (Command
Line)</b></p><a class="indexterm" name="indexterm-512"></a><a class="indexterm" name="indexterm-513"></a><div class="tasksummary">
<p>Sometimes a patch depends on another patch, that is, the first patch
cannot be applied to the system until the other patch is applied. The first
patch is said to have a dependency on the second patch.</p>
<p>If you specify a list of patches to apply, you can resolve the list
for patch dependencies. The resulting list might include additional patches
that you must apply before applying the patches you specified.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Become an appropriately authorized user or assume a role that includes the Software Installation profile or the <code class="literal">solaris.admin.patchmgr.*</code> authorization.</p>
<p>The System Administrator profile includes the appropriate profiles. To create the role and assign the role to a user, see <span class="olink">
<em class="citetitle">Configuring RBAC</em> in <em class="citetitle">System Administration Guide: Security Services</em>
</span>.</p>
</li><li>
<p>Resolve the list of patches.</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>Resolve a list of patches specified one at a time on the command
line.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze -i <em class="replaceable"><code>patch-id</code></em> -i <em class="replaceable"><code>patch-id</code></em> ...</code></strong>
</pre>
</li><li>
<p>Resolve a list of patches specified in a file.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze -x idlist=<em class="replaceable"><code>patch-list-file</code></em>
</code></strong>
</pre>
</li></ul></div>
</li></ol></div><div class="example"><a name="resolvesystemcliexample"></a><p class="title"><b>Example 22.6. Resolving a List of Patches</b></p>


<p>The following example shows how to resolve patch dependencies for patch
112785-28 and write the resulting patch list to a file called <code class="filename">/tmp/patch.out</code>. Patch 112785-28 depends on patch 113096-03. After running the <span><strong class="command">smpatch analyze</strong></span> command, the <code class="filename">patch.out</code> file
contains this ordered list: 113096-03 and 112785-28.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze -i 112785-28 &gt; /tmp/patch.out</code></strong>
</pre>
<p>The following example shows how to take a modified list of patches, <code class="filename">plist</code>, and resolve the patch dependencies. The list is written
to the <code class="filename">/tmp/patch.plist</code> file.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze -x idlist=plist &gt; /tmp/patch.plist</code></strong>
</pre>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2149585"></a></h3></div></div></div>

<div class="task"><a name="applypatchlucliproc"></a><p class="title"><b>How to Use <span><strong class="command">luupgrade</strong></span> to
Apply a List of Patches to an Inactive Boot Environment (Command Line)</b></p><a class="indexterm" name="indexterm-514"></a><a class="indexterm" name="indexterm-515"></a><div class="tasksummary">
<p>A patch list that is created by the <span><strong class="command">smpatch</strong></span> command
can be used by <span><strong class="command">luupgrade</strong></span> to apply patches to an inactive
boot environment. You can also use the <span><strong class="command">luupgrade</strong></span> command
to remove patches from an inactive boot environment based on <span><strong class="command">showrev</strong></span> information.
See the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">luupgrade</span>
(
1M
)
</span>
</span> and <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">showrev</span>
(
1M
)
</span>
</span> man pages.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>

<p>This procedure assumes that you have created a second boot environment
that is a duplicate of the active boot environment. See the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">lumake</span>
(
1M
)
</span>
</span> man page for information
about creating boot environments.</p>
</div>
</div><div class="procedure"><ol type="1"><li>
<p>Become an appropriately authorized user or assume a role that includes the Software Installation profile or the <code class="literal">solaris.admin.patchmgr.*</code> authorization.</p>
<p>The System Administrator profile includes the appropriate profiles. To create the role and assign the role to a user, see <span class="olink">
<em class="citetitle">Configuring RBAC</em> in <em class="citetitle">System Administration Guide: Security Services</em>
</span>.</p>
</li><li>
<p>Perform a patch analysis on the active boot environment to obtain
the list of appropriate patches to apply to the inactive boot environment,
and remove the synopsis for each patch entry.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze | sed 's/ .*//' &gt; <em class="replaceable"><code>patch-list-file</code></em>
</code></strong>
</pre>
<p>The modified file will be a list of patches, one <span class="olink">
<span class="emphasis"><em>patch ID</em></span>
</span> per line.</p>
</li><li>
<p>Download the patches from a patch list to your system.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch download -x idlist=<em class="replaceable"><code>patch-list-file</code></em>
</code></strong>
</pre>
</li><li>
<p>Apply patches from a patch list to the inactive boot environment.</p>
<pre class="screen"># <strong class="userinput"><code>luupgrade -t -n <em class="replaceable"><code>BE-name</code></em> -s <em class="replaceable"><code>dir-name</code></em> `cat <em class="replaceable"><code>patch-list-file</code></em>`</code></strong>
</pre>
<p>You must specify the name of the inactive boot environment to update, <em class="replaceable"><code>BE-name</code></em>, and the directory where the patches are stored, <em class="replaceable"><code>dir-name</code></em>.</p>
</li><li>
<p>(Optional) To remove a patch from the inactive boot environment,
use the following command:</p>
<pre class="screen"># <strong class="userinput"><code>luupgrade -T -n <em class="replaceable"><code>BE-name</code></em> <em class="replaceable"><code>patch-id</code></em>
</code></strong>
</pre>
<p>You must specify the name of the inactive boot environment to update, <em class="replaceable"><code>BE-name</code></em>, and the patch to be removed, <em class="replaceable"><code>patch-id</code></em>.</p>
</li></ol></div><div class="example"><a name="luupgradecliexample"></a><p class="title"><b>Example 22.7. Using <span>luupgrade</span> to Apply a List of Patches to an
Inactive Boot Environment</b></p>


<div class="itemizedlist"><ul type="disc"><li>
<p>The following example shows how to use Patch Manager and Solaris
Live Upgrade commands to apply a list of patches to an inactive boot environment.
For this example, a duplicate boot environment, <code class="literal">be2</code>, of
the active boot environment has been created.</p>
<p>First, use the <span><strong class="command">smpatch analyze</strong></span> and <span><strong class="command">sed</strong></span> commands to analyze the
active boot environment and create a patch list, <code class="filename">plist</code>,
that includes one patch ID per line. The <span><strong class="command">sed</strong></span> command removes
the synopsis from each patch entry. Use the <span><strong class="command">smpatch download</strong></span> command
to download the patches in the list. Then, use the <span><strong class="command">luupgrade</strong></span> command
to apply the list of patches to the inactive boot environment of the system.
The inactive boot environment is called <code class="literal">be2</code>, and the directory
where the patches reside is <code class="filename">/var/sadm/spool</code> on the active
boot environment.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch analyze | sed 's/ .*//' &gt; plist</code></strong>
.
.
.
# <strong class="userinput"><code>smpatch download -x idlist=plist</code></strong>
.
.
.
# <strong class="userinput"><code>luupgrade -t -n be2 -s /var/sadm/spool `cat plist`</code></strong>
.
.
.</pre>
</li><li>
<p>The following example shows how to use Patch Manager and the
Solaris Live Upgrade commands to remove a patch from an inactive boot environment.
For this example, a duplicate boot environment, <code class="literal">be2</code>, of
the active boot environment has been created.</p>
<p>Use the <span><strong class="command">luupgrade</strong></span> command to remove patch 107058-01 from the inactive boot environment
of the system, <code class="literal">be2</code>.</p>
<pre class="screen"># <strong class="userinput"><code>luupgrade -T -n be2 107058-01</code></strong>
.
.
.</pre>
</li></ul></div>
</div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2150150"></a></h3></div></div></div>

<div class="task"><a name="removecliproc"></a><p class="title"><b>How to Remove Patches From Your System (Command
Line)</b></p><a class="indexterm" name="indexterm-516"></a><a class="indexterm" name="indexterm-517"></a><div class="tasksummary">
<p>You can remove only one patch at a time.</p>
<p>If your system has more than one boot environment, you can use the <span><strong class="command">luupgrade</strong></span> command to remove a list of patches from an inactive boot
environment. See <span class="olink">How to Use <span><strong class="command">luupgrade</strong></span> to Apply a List of Patches to an Inactive Boot Environment (Command Line)</span>.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Identify the patch that you want to remove.</p>
</li><li>
<p>Become an appropriately authorized user or assume a role that includes the Software Installation profile or the <code class="literal">solaris.admin.patchmgr.*</code> authorization.</p>
<p>The System Administrator profile includes the appropriate profiles. To create the role and assign the role to a user, see <span class="olink">
<em class="citetitle">Configuring RBAC</em> in <em class="citetitle">System Administration Guide: Security Services</em>
</span>.</p>
</li><li>
<p>Remove the patch from your system.</p>
<pre class="screen"># <strong class="userinput"><code>smpatch remove -i <em class="replaceable"><code>patch-id</code></em>
</code></strong>
</pre>
</li></ol></div></div>
</div>
<div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2150336"></a></h3></div></div></div>

<div class="task"><a name="viewpatchtoollogscli"></a><p class="title"><b>How to View Patch Manager Log Entries
(Command Line)</b></p><a class="indexterm" name="indexterm-518"></a><a class="indexterm" name="indexterm-519"></a><div class="tasksummary">
<p>Patch Manager writes to the system log file <code class="filename">/var/adm/messages</code>.</p>
</div><div class="procedure"><ol type="1"><li>
<p>Choose which method to use to see information about a failed installation
of a patch.</p>
<div class="itemizedlist"><ul type="disc"><li>
<p>
<code class="filename">/var/adm/messages</code> <span class="strong"><strong>&#8211;</strong></span> Identifies problems that are found when applying a patch to a
system by using Patch Manager.</p>
</li><li>
<p>
<span class="strong"><strong>Solaris WBEM log &#8211;</strong></span> To
view this log from the command line, use the <span><strong class="command">smlog view</strong></span> command.
See the <span class="olink">
<span class="citerefentry">
<span class="refentrytitle">smlog</span>
(
1M
)
</span>
</span> man
page.</p>
</li></ul></div>
</li><li>
<p>View log entries from the appropriate log file.</p>
</li></ol></div></div>
</div>
</div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch22s06.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch22.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch22s08.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Configuring Your Patch Management
Environment by Using the Command-Line Interface (Task Map) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Tuning Your Patch Management Environment
by Using the Command-Line Interface (Task Map)</td></tr></table></div></body></html>
