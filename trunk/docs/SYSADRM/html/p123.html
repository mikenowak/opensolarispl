<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Configuring the <tt>lx</tt> Branded
Zone (Tasks) - System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Solaris Containers-Resource Management and Solaris Zones<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p122.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p124.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="gdajn"></a>Chapter&nbsp;31<h3>Configuring the <tt>lx</tt> Branded
Zone (Tasks)</h3><p>This chapter describes how to configure an <tt>lx</tt> branded
zone on your x64 or x86 based system. The process is basically the same as
the procedure to configure a Solaris Zone. A few of the properties are not
needed to configure a branded zone.</p>
<a name="gdbjd"></a><h3>Planning and Configuring an <tt>lx</tt> Branded
Zone (Task Map)</h3>
<p><a name="indexterm-380"></a><a name="indexterm-381"></a>Before
you set up your system to use zones, you must first collect information and
make decisions about how to configure the zones. The following task map summarizes
how to plan and configure an <tt>lx</tt> zone.</p>
<table><tr><th><p>Task</p>
</th><th><p>Description</p>
</th><th><p>For Instructions</p>
</th></tr>
<tr><td><p>Plan your zone strategy.</p>
</td><td><ul><li><p>Determine which applications you want to run in zones.</p>
</li>
<li><p>Assess the availability of disk space to hold the files in
the zone.</p>
</li>
<li><p>If you are also using resource management features, determine
how to align the zone with the resource management boundaries.</p>
</li>
<li><p>If you are using resource pools, configure the pools if necessary.</p>
</li>
</ul>
</td><td><p>See <a href="p117.html#gcxax">System and Space Requirements</a> and <a href="p33.html#rmpool-114">Resource Pools Used in Zones</a>.</p>
</td></tr>
<tr><td><p>Determine the name and the path for the zone.</p>
</td><td><p>Decide what to call the zone based on the naming conventions. A path
on a Zetabyte File System (ZFS) is recommended. When the source <tt>zonepath</tt> and the target <tt>zonepath</tt> both reside on ZFS and
are in the same pool, the <tt>zoneadm</tt> <tt>clone</tt> command
automatically uses ZFS to clone the zone.</p>
</td><td><p>See <a href="p121.html#gdahx">Resource and Property Types</a> and <i>Solaris ZFS Administration Guide</i>.</p>
</td></tr>
<tr><td><p>Obtain or configure IP addresses for the zone.</p>
</td><td><p>Depending on your configuration, you must obtain at least one IP address
for each non-global zone that you want to have network access.</p>
</td><td><p>See <a href="p62.html">Determine the Zone Host Name and Obtain the Network Address</a> and <i>System Administration Guide: IP Services</i>.</p>
</td></tr>
<tr><td><p>Determine if you want to mount file systems in the zone.</p>
</td><td><p>Review your application requirements.</p>
</td><td><p>See <a href="p56.html">File Systems Mounted in Zones</a> for
more information.</p>
</td></tr>
<tr><td><p>Determine which network interfaces should be made available in the zone.</p>
</td><td><p>Review your application requirements.</p>
</td><td><p>See <a href="p98.html#z.admin.ov-12">Shared-IP Network Interfaces</a> for
more information.</p>
</td></tr>
<tr><td><p>Determine whether you must alter the default set of non-global zone
permissions.</p>
</td><td><p>Check the set of privileges: default, privileges that can be added and
removed, and privileges that cannot be used at this time.</p>
</td><td><p>See <a href="p121.html#gdahx">Resource and Property Types</a> and <a href="p100.html#z.admin.ov-18">Privileges in a Non-Global Zone</a>.</p>
</td></tr>
<tr><td><p>Configure the zone.</p>
</td><td><p> Use <tt>zonecfg</tt> to create a configuration for the zone.</p>
</td><td><p>See <a href="p123.html#gdbji">How to Configure, Verify, and Commit the <tt>lx</tt> Branded Zone</a>.</p>
</td></tr>
<tr><td><p>Verify and commit the configured zone.</p>
</td><td><p>Determine whether the resources and properties specified are valid on
a hypothetical system.</p>
</td><td><p>See <a href="p123.html#gdbji">How to Configure, Verify, and Commit the <tt>lx</tt> Branded Zone</a>.</p>
</td></tr>
</table><a name="gcziw"></a><h3>How to Configure the <tt>lx</tt> Branded
Zone</h3>
<p><a name="indexterm-382"></a>You use the <tt>zonecfg</tt> command described
in the <tt>zonecfg</tt>(1M) man page to perform the following actions.</p>
<ul><li><p>Create the zone configuration</p>
</li>
<li><p>Verify that all required information is present</p>
</li>
<li><p>Commit the non-global zone configuration</p>
</li>
</ul>
<hr>
<p><b>Tip - </b>If you know you will be using CDs or DVDs to install applications
in an <tt>lx</tt> branded zone, use <tt>add</tt> <tt>fs</tt> to
add read-only access to CD or DVD media in the global zone when you initially
configure the branded zone. A CD or DVD can then be used to install a product
in the branded zone. </p>
<hr>
<p>While configuring a zone with the <tt>zonecfg</tt> utility,
you can use the <tt>revert</tt> subcommand to undo the setting for
a resource. See <a href="p66.html#z.conf.start-30">How to Revert a Zone Configuration</a>.</p>
<p>A script to configure multiple zones on your system is provided in <a href="p124.html#gdbkd">Script to Configure Multiple <tt>lx</tt> Branded Zones</a>.</p>
<p>To display a non-global zone's configuration, see <a href="p124.html#gdbiv">How to Display the Configuration of a Branded Zone</a>.</p>
<hr>
<p><b>Tip - </b>After you have configured the branded zone, it is a good idea to
make a copy of the zone's configuration. You can use this backup to restore
the zone in the future. As superuser or Primary Administrator, print the configuration
for the zone <tt>lx-zone</tt> to a file. This example uses a file
named <tt>lx-zone.config</tt>.</p>
<pre>global# <tt><b>zonecfg -z lx-zone export > lx-zone.config</b></tt></pre><p>See <a href="p112.html#gbrmi">How to Restore an Individual Non-Global Zone</a> for more information.</p>
<hr>
<a name="gdbji"></a><h4><img src="graphics/procedure.gif"> How to Configure, Verify, and Commit the <tt>lx</tt> Branded
Zone</h4>
<p>Note that you cannot use <tt>lx</tt> branded zones on a Trusted
Solaris system where labels are enabled. The <tt>zoneadm</tt> command
will not verify the configuration.</p>
<p>You must be the global administrator in the global zone to perform this
procedure.</p>
<ol><li><a name="gdbkr"></a><b>Become superuser, or assume the Primary Administrator
role.</b><p>To create the role and assign the role to a user, see Using
the Solaris Management Tools With RBAC (Task Map) in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="gdbjf"></a><b>Set up a zone configuration with the zone name you
have chosen.</b><p>The name <tt>lx-zone</tt> is used in this
example procedure.</p><pre>global# <tt><b>zonecfg -z lx-zone</b></tt></pre><p>If this is the first time you have configured this zone, you will see
the following system message:</p><pre>lx-zone: No such zone configured
Use 'create' to begin configuring a new zone.</pre></li><li><a name="gdbkv"></a><b>Create the new <tt>lx</tt> zone configuration
by using the <tt>SUNWlx</tt> template.</b><pre>zonecfg:lx-zone> <tt><b>create -t SUNWlx</b></tt></pre><p>Alternatively, you can create a blank zone and explicitly set the brand:</p><pre>zonecfg:lx-zone> <tt><b>create -b</b></tt>
zonecfg:lx-zone> <tt><b>set brand=lx</b></tt></pre></li><li><a name="gdbiy"></a><b>Set the zone path, <tt>/export/home/lx-zone</tt> in
this procedure.</b><pre>zonecfg:lx-zone> <tt><b>set zonepath=/export/home/lx-zone</b></tt></pre></li><li><a name="gdbjn"></a><b>Set the autoboot value.</b><p>If set to <tt>true</tt>, the zone is automatically booted when the global zone is booted.
Note that for the zones to autoboot, the zones service <tt>svc:/system/zones:default</tt> must also be enabled. The default value is <tt>false</tt>.</p><pre>zonecfg:lx-zone> <tt><b>set autoboot=true</b></tt></pre></li><li><b>Set persistent boot arguments for a zone.</b><pre>zonecfg:lx-zone> <tt><b>set bootargs="-i=</tt><i>altinit</i><tt>"</b></tt></pre></li><li><a name="gdbiu"></a><b>If resource pools are enabled on your system, associate
a pool with the zone.</b><p>This example uses the default pool, named <tt>pool_default</tt>.</p><pre>zonecfg:lx-zone> <tt><b>set pool=pool_default</b></tt></pre><p>Because a resource pool can have an optional scheduling class assignment,
you can use the pools facility to set a default scheduler other than the system
default for a non-global zone. For instructions, see <a href="p43.html#rmpool.task-22">How to Associate a Pool With a Scheduling Class</a> and <a href="p48.html#rmconfig-4">Creating the Configuration</a>.</p></li><li><b>Revise the default set of privileges.</b><pre>zonecfg:lx-zone> <tt><b>set limitpriv="default,proc_priocntl"</b></tt></pre><p>The <tt>proc_priocntl</tt> privilege is used to run processes
in the real-time class.</p></li><li><b>Set five CPU shares.</b><pre>zonecfg:lx-zone> <tt><b>set cpu-shares=5</b></tt></pre></li><li><b>Add a memory cap.</b><pre>zonecfg:lx-zone> <tt><b>add capped-memory</b></tt></pre><ol><li><b>Set the  memory cap.</b><pre>zonecfg:lx-zone:capped-memory> <tt><b>set =50m</b></tt></pre></li><li><b>Set the swap memory cap.</b><pre>zonecfg:lx-zone:capped-memory> <tt><b>set swap=100m</b></tt></pre></li><li><b>Set the locked memory cap.</b><pre>zonecfg:lx-zone:capped-memory> <tt><b>set locked=30m</b></tt></pre></li><li><b>End the specification.</b><pre>zonecfg:lx-zone:capped-memory> <tt><b>end</b></tt></pre></li></ol></li><li><a name="gdbjg"></a><b>Add a file system.</b><pre>zonecfg:lx-zone> <tt><b>add fs</b></tt></pre><ol><li><a name="gdbjw"></a><b>Set the mount point for the file system, <tt>/export/linux/local</tt> in this procedure.</b><pre>zonecfg:lx-zone:fs> <tt><b>set dir=/export/linux/local</b></tt></pre></li><li><a name="gdbjh"></a><b>Specify that <tt>/opt/local</tt> in the global
zone is to be mounted as <tt>/usr/local</tt> in the zone being configured.</b><pre>zonecfg:lx-zone:fs> <tt><b>set special=/opt/local</b></tt></pre><p>In the non-global zone, the <tt>/usr/local</tt> file system
will be readable and writable.</p></li><li><a name="gdbkf"></a><b>Specify the file system type, <tt>lofs</tt> in
this procedure.</b><pre>zonecfg:lx-zone:fs> <tt><b>set type=lofs</b></tt></pre><p>The type indicates how the kernel interacts with the file system.</p></li><li><a name="gdbkp"></a><b>End the file system specification.</b><pre>zonecfg:lx-zone:fs> <tt><b>end</b></tt></pre></li></ol><p>This step can be performed more than once to add more than one file
system.</p></li><li><a name="gdbjk"></a><b>Add a network interface.</b><pre>zonecfg:lx-zone> <tt><b>add net</b></tt></pre><ol><li><a name="gdbix"></a><b>Set the IP address in the form <i>ip address
of zone</i><tt>/</tt><i>netmask</i>.
In this procedure, <i>10.6.10.233/24</i> is used.</b><pre>zonecfg:lx-zone:net> <tt><b>set address=10.6.10.233/24</b></tt></pre></li><li><a name="gdbjq"></a><b>Set the physical device type for the network interface,
the <tt>bge</tt> device in this procedure.</b><pre>zonecfg:lx-zone:net> <tt><b>set physical=bge0</b></tt></pre></li><li><a name="gdbjj"></a><b>End the specification.</b><pre>zonecfg:lx-zone:net> <tt><b>end</b></tt></pre></li></ol><p>This step can be performed more than once to add more than one network
interface.</p></li><li><a name="gdbkm"></a><b>Enable an audio device present in the global zone in
this zone by using the <tt>attr</tt> resource type.</b><pre>zonecfg:lx-zone> <tt><b>add attr</b></tt></pre><ol><li><a name="gdbkq"></a><b>Set the name to <tt>audio</tt>.</b><pre>zonecfg:lx-zone:attr> <tt><b>set name=audio</b></tt></pre></li><li><a name="gdbjo"></a><b>Set the type to <tt>boolean</tt>.</b><pre>zonecfg:lx-zone:attr> <tt><b>set type=boolean</b></tt></pre></li><li><a name="gdbiw"></a><b>Set the value to <tt>true</tt>.</b><pre>zonecfg:lx-zone:attr> <tt><b>set value=true</b></tt></pre></li><li><a name="gdbjs"></a><b>End the <tt>attr</tt> resource type specification.</b><pre>zonecfg:lx-zone:attr> <tt><b>end</b></tt></pre></li></ol></li><li><a name="gdbkc"></a><b>Verify the zone configuration for the zone.</b><pre>zonecfg:lx-zone> <tt><b>verify</b></tt></pre></li><li><a name="gdbiz"></a><b>Commit the zone configuration for the zone.</b><pre>zonecfg:lx-zone> <tt><b>commit</b></tt></pre></li><li><a name="gdbka"></a><b>Exit the <tt>zonecfg</tt> command.</b><pre>zonecfg:lx-zone> <tt><b>exit</b></tt></pre><p>Note that even if you did not explicitly type <tt>commit</tt> at
the prompt, a <tt>commit</tt> is automatically attempted when you
type <tt>exit</tt> or an EOF occurs.</p></li></ol><h6><h6>More Information</h6>Using Multiple Subcommands From the Command Line<hr>
<p><b>Tip - </b>The <tt>zonecfg</tt> command also supports multiple subcommands,
quoted and separated by semicolons, from the same shell invocation.</p>
<pre>global# <tt><b>zonecfg -z lx-zone "create -t SUNWlx; set zonepath=/export/home/lx-zone"</b></tt></pre><hr>
</h6>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p122.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p124.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

