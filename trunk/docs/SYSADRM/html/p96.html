<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Process ID Visibility in Zones - System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Solaris Containers-Resource Management and Solaris Zones<?GenHTML /ReferencePage> > <a href="p95.html">26.&nbsp;&nbsp;Solaris Zones Administration (Overview)</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p95.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p97.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="z.admin.ov-22"></a><h3>Process ID Visibility in Zones</h3>
<p>Only processes in the same zone will be visible through system call
interfaces that take process IDs, such as the <tt>kill</tt> and <tt>priocntl</tt> commands. For information, see the <tt>kill</tt>(1) and the <tt>priocntl</tt>(1) man
pages.</p>
<a name="z.admin.ov-24"></a><h3>System Observability in Zones</h3>
<p>The <tt>ps</tt> command has the following modifications:</p>
<ul><li><p>The <tt>-o</tt> option is used to specify output format.
This option allows you to print the zone ID of a process or the name of the
zone in which the process is running.</p>
</li>
<li><p>The <tt>-z</tt> <i>zonelist</i> option
is used to list only processes in the specified zones. Zones can be specified
either by zone name or by zone ID. This option is only useful when the command
is executed in the global zone.</p>
</li>
<li><p>The <tt>-Z</tt> option is used to print the name of
the zone associated with the process. The name is printed under the column
heading <tt>ZONE</tt>.</p>
</li>
</ul>
<p>For more information, see the <tt>ps</tt>(1) man
page.</p>
<p>A <tt>-z</tt> <i>zonename</i> option has
been added to the following Solaris utilities. You can use this option to
filter the information to include only the zone or zones specified.</p>
<ul><li><p><tt>ipcs</tt> (see the <tt>ipcs</tt>(1) man page)</p>
</li>
<li><p><tt>pgrep</tt> (see the <tt>pgrep</tt>(1) man page)</p>
</li>
<li><p><tt>ptree</tt> (see the <tt>proc</tt>(1) man page)</p>
</li>
<li><p><tt>prstat</tt> (see the <tt>prstat</tt>(1M) man page)</p>
</li>
</ul>
<p>See <a href="p103.html#z.admin.ov-tbl-34">Table 26-5</a> for
the full list of changes made to commands.</p>
<a name="z.admin.ov-11"></a><h3>Non-Global Zone Node Name</h3>
<p><a name="indexterm-312"></a>The node name
in <tt>/etc/nodename</tt> returned by <tt>uname</tt> <tt>-n</tt> can be set by the zone administrator. The node name must be unique.</p>
<a name="z.admin.ov-2"></a><h3>File Systems and Non-Global Zones</h3>
<p>This section provides information about file system issues on a Solaris
system with zones installed. Each zone has its own section of the file system
 hierarchy, rooted at a directory known as the zone <tt>root</tt>.
Processes in the zone can access only files in the part of the hierarchy that
is located under the zone root. The <tt>chroot</tt> utility can
be used in a zone, but only to restrict the process to a root path within
the zone. For more information about <tt>chroot</tt>, see <tt>chroot</tt>(1M).</p>
<a name="z.admin.ov-23"></a><h4>The <tt>-o</tt> <tt>nosuid</tt> Option</h4>
<p>The <tt>-o</tt> <tt>nosuid</tt> option to the <tt>mount</tt> utility has the following functionality:</p>
<ul><li><p>Processes from a <tt>setuid</tt> binary located
on a file system that is mounted using the <tt>nosetuid</tt> option
do not run with the privileges of the <tt>setuid</tt> binary. The
processes run with the privileges of the user that executes the binary.</p>
<p>For example, if a user executes a <tt>setuid</tt> binary that
is owned by <tt>root</tt>, the processes run with the privileges
of the user.</p>
</li>
<li><p>Opening device-special entries in the file system is not allowed.
This behavior is equivalent to specifying the <tt>nodevices</tt> option.</p>
</li>
</ul>
<p>This file system-specific option is available to all Solaris file systems
that can be mounted with <tt>mount</tt> utilities, as described
in the <tt>mount</tt>(1M) man
page. In this guide, these file systems are listed in <a href="p96.html#z.admin.ov-26">Mounting File Systems in Zones</a>. Mounting
capabilities are also described. For more information about the <tt>-o</tt> <tt>nosuid</tt> option, see &ldquo;Accessing Network File Systems  (Reference)&rdquo;
in <i>System Administration
Guide: Network Services</i>.</p>
<a name="z.admin.ov-26"></a><h4>Mounting File Systems in Zones</h4>
<p>When file systems are mounted from within a zone, the <tt>nodevices</tt> option
applies. For example, if a zone is granted access to a block device (<tt>/dev/dsk/c0t0d0s7</tt>) and a raw device (<tt>/dev/rdsk/c0t0d0s7</tt>) corresponding
to a UFS file system, the file system is automatically mounted <tt>nodevices</tt> when mounted from within a zone. This rule does not apply to mounts
specified through a <tt>zonecfg</tt> configuration.</p>
<p>Options for mounting file systems in non-global zones are described
in the following table. Procedures for these mounting alternatives are provided
in <a href="p63.html">Configuring, Verifying, and Committing a Zone</a> and <a href="p106.html">Mounting File Systems in Running Non-Global Zones</a>.</p>
<p>Any file system type not listed in the table can be specified in the
configuration if it has a mount binary in <tt>/usr/lib/</tt><i>fstype</i><tt>/mount</tt>.</p>
<table><tr><th><p>File System</p>
</th><th><p>Mounting Options in a Non-Global Zone</p>
</th></tr>
<tr><td><p>AutoFS</p>
</td><td><p>Cannot be mounted using <tt>zonecfg</tt>, cannot be manually
mounted from the global zone into a non-global zone. Can be mounted from within
the zone.</p>
</td></tr>
<tr><td><p>CacheFS</p>
</td><td><p>Cannot be used in a non-global zone.</p>
</td></tr>
<tr><td><p>FDFS</p>
</td><td><p>Can be mounted using <tt>zonecfg</tt>, can be manually mounted
from the global zone into a non-global zone, can be mounted from within the
zone.</p>
</td></tr>
<tr><td><p>HSFS</p>
</td><td><p>Can be mounted using <tt>zonecfg</tt>, can be manually mounted
from the global zone into a non-global zone, can be mounted from within the
zone.</p>
</td></tr>
<tr><td><p>LOFS</p>
</td><td><p>Can be mounted using <tt>zonecfg</tt>, can be manually mounted
from the global zone into a non-global zone, can be mounted from within the
zone.</p>
</td></tr>
<tr><td><p>MNTFS</p>
</td><td><p>Cannot be mounted using <tt>zonecfg</tt>, cannot be manually
mounted from the global zone into a non-global zone. Can be mounted from within
the zone.</p>
</td></tr>
<tr><td><p>NFS</p>
</td><td><p>Cannot be mounted using <tt>zonecfg</tt>. V2, V3, and V4,
which are the versions currently supported in zones, can be mounted from within
the zone.</p>
</td></tr>
<tr><td><p>PCFS </p>
</td><td><p>Can be mounted using <tt>zonecfg</tt>, can be manually mounted
from the global zone into a non-global zone, can be mounted from within the
zone.</p>
</td></tr>
<tr><td><p>PROCFS</p>
</td><td><p>Cannot be mounted using <tt>zonecfg</tt>, cannot be manually
mounted from the global zone into a non-global zone. Can be mounted from within
the zone.</p>
</td></tr>
<tr><td><p>TMPFS</p>
</td><td><p>Can be mounted using <tt>zonecfg</tt>, can be manually mounted
from the global zone into a non-global zone, can be mounted from within the
zone.</p>
</td></tr>
<tr><td><p>UDFS</p>
</td><td><p>Can be mounted using <tt>zonecfg</tt>, can be manually mounted
from the global zone into a non-global zone, can be mounted from within the
zone.</p>
</td></tr>
<tr><td><p>UFS</p>
</td><td><p>Can be mounted using <tt>zonecfg</tt>, can be manually mounted
from the global zone into a non-global zone, can be mounted from within the
zone.</p>
</td></tr>
<tr><td><p>XMEMFS</p>
</td><td><p>Support for this file system has been removed from Solaris with this
release.</p>
</td></tr>
<tr><td><p>ZFS</p>
</td><td><p>Can be mounted using the <tt>zonecfg</tt> <tt>dataset</tt> and <tt>fs</tt> resource types.</p>
</td></tr>
</table><p>For more information, see <a href="p63.html#z.conf.start-29">How to Configure the Zone</a>, <a href="p106.html">Mounting File Systems in Running Non-Global Zones</a>, and the <tt>mount</tt>(1M) man page.</p>
<a name="gafnf"></a><h4>Unmounting File Systems in Zones</h4>
<p>The ability to unmount a file system will depend on who performed the
initial mount. If a file system is specified as part of the zone's configuration
using the <tt>zonecfg</tt> command, then the global zone owns this
mount and the non-global zone administrator cannot unmount the file system.
If the file system is mounted from within the non-global zone, for example,
by specifying the mount in the zone's <tt>/etc/vfstab</tt> file,
then the non-global zone administrator can unmount the file system.</p>
<a name="z.admin.ov-7"></a><h4>Security Restrictions and File System Behavior</h4>
<p>There are security restrictions on mounting certain file systems from
within a zone. Other file systems exhibit special behavior when mounted in
a zone. The list of modified file systems follows.</p>
<dl><dt>AutoFS</dt>
<dd><p>Autofs is a client-side service that automatically mounts
the appropriate file system. When a client attempts to access a file system
that is not presently mounted, the AutoFS file system intercepts the request
and calls <tt>automountd</tt> to mount the requested directory.
AutoFS mounts established within a zone are local to that zone. The mounts
cannot be accessed from other zones, including the global zone. The mounts
are removed when the zone is halted or rebooted. For more information on AutoFS,
see How Autofs Works in <i>System Administration
Guide: Network Services</i>.</p>
<p>Each zone runs its own copy of <tt>automountd</tt>. The auto
maps and timeouts are controlled by the zone administrator. You cannot trigger
a mount in another zone by crossing an AutoFS mount point for a non-global
zone from the global zone.</p>
<p>Certain AutoFS mounts are created in the kernel when another mount is
triggered. Such mounts cannot be removed by using the regular <tt>umount</tt> interface
because they must be mounted or unmounted as a group. Note that this functionality
is provided for zone shutdown.</p>
</dd>
<dt>MNTFS</dt>
<dd><p>MNTFS is a virtual file system that provides read-only access
to the table of mounted file systems for the local system. The set of file
systems visible by using <tt>mnttab</tt> from within a non-global
zone is the set of file systems mounted in the zone, plus an entry for  root
(<tt>/</tt>) . Mount points with a special device that is not accessible
from within the zone, such as <tt>/dev/rdsk/c0t0d0s0</tt>, have
their special device set to the same as the mount point. All mounts in the
system are visible from the global zone's <tt>/etc/mnttab</tt> table.
For more information on MNTFS, see Chapter 18, Mounting
and Unmounting File Systems (Tasks), in <i>System
Administration Guide: Devices and File Systems</i>.</p>
</dd>
<dt>NFS</dt>
<dd><p>NFS mounts established within a zone are local to that zone.
The mounts cannot be accessed from other zones, including the global zone.
The mounts are removed when the zone is halted or rebooted.</p>
<p>As documented in the <tt>mount_nfs</tt>(1M) man
page, an NFS server should not attempt to mount its own file systems. Thus,
a zone should not NFS mount a file system exported by the global zone. Zones
cannot be NFS servers. From within a zone, NFS mounts behave as though mounted
with the <tt>nodevices</tt> option.</p>
<p>The <tt>nfsstat</tt> command output only pertains to the zone
in which the command is run. For example, if the command is run in the global
zone, only information about the global zone is reported. For more information
about the <tt>nfsstat</tt> command, see <tt>nfsstat</tt>(1M).</p>
<p>The <tt>zlogin</tt> command will fail if any of its open files
or any portion of its address space reside on NFS. For more information, see <a href="p75.html#z.login.ov-2"><tt>zlogin</tt> Command</a>.</p>
</dd>
<dt>PROCFS</dt>
<dd><p>The <tt>/proc</tt> file system, or PROCFS, provides
process visibility and access restrictions as well as information about the
zone association of processes. Only processes in the same zone are visible
through <tt>/proc</tt>.</p>
<p>Processes in the global zone can observe processes and other objects
in non-global zones. This allows such processes to have system-wide observability.</p>
<p>From within a zone, <tt>procfs</tt> mounts behave as though
mounted with the <tt>nodevices</tt> option. For more information
about <tt>procfs</tt>, see the <tt>proc</tt>(4) man page.</p>
</dd>
<dt>LOFS</dt>
<dd><p>The scope of what can be mounted through LOFS is limited to
the portion of the file system that is visible to the zone. Hence, there are
no restrictions on LOFS mounts in a zone.</p>
</dd>
<dt>UFS, UDFS, PCFS, and other storage-based file systems</dt>
<dd><p>When using the <tt>zonecfg</tt> command to configure
storage-based file systems that have an <tt>fsck</tt> binary, such
as UFS, the zone administrator must specify a <tt>raw</tt> parameter.
The parameter indicates the raw (character) device, such as <tt>/dev/rdsk/c0t0d0s7</tt>. <tt>zoneadmd</tt> automatically runs the <tt>fsck</tt> command
in non-interactive check-only mode (<tt>fsck</tt> <tt>-m</tt>)
on this device before it mounts the file system. If the <tt>fsck</tt> fails, <tt>zoneadmd</tt> cannot bring the zone to the ready state. The path specified
by <tt>raw</tt> cannot be a relative path.</p>
<p>It is an error to specify a device to <tt>fsck</tt> for a
file system that does not provide an <tt>fsck</tt> binary in <tt>/usr/lib/fs/</tt><i>fstype</i><tt>/fsck</tt>.  It is
also an error if you do not specify a device to <tt>fsck</tt> if
an <tt>fsck</tt> binary exists for that file system.</p>
<p>For more information, see <a href="p68.html">The <tt>zoneadmd</tt> Daemon</a> and the <tt>fsck</tt>(1M)</p>
</dd>
<dt>ZFS</dt>
<dd><p>You can add a ZFS dataset to a non-global zone by using the <tt>zonecfg</tt> command with the <tt>add dataset</tt> resource.
The dataset will be visible and mounted in the non-global zone and no longer
visible in the global zone. The zone administrator can create and destroy
file systems within that dataset, and modify the properties of the dataset.</p>
<p>The <tt>zoned</tt> attribute of <tt>zfs</tt> indicates
whether a dataset has been added to a non-global zone.</p>
<pre># <tt><b>zfs get zoned tank/sales</b></tt>
NAME          PROPERTY    VALUE      SOURCE
tank/sales    zoned       on         local</pre><p>If you want to share a dataset from the global zone, you can add an
LOFS-mounted ZFS file system by using the <tt>zonecfg</tt> command
with the <tt>add</tt> <tt>fs</tt> subcommand. The global
administrator is responsible for setting and controlling the properties of
the dataset.</p>
<p>For more information on ZFS, see Chapter 8, ZFS Advanced Topics, in <i>Solaris ZFS Administration Guide</i>.</p>
</dd>
</dl>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p95.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p97.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

