<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Installing, Booting, Halting, Uninstalling,
 and Cloning Non-Global Zones (Tasks) - System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Solaris Containers-Resource Management and Solaris Zones<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p69.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p71.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="z.inst.task-1"></a>Chapter&nbsp;20<h3>Installing, Booting, Halting, Uninstalling,
 and Cloning Non-Global Zones (Tasks)</h3><p>This chapter describes how to install and boot a non-global zone. A
method for using cloning to install a zone on the same system is also provided.
Other tasks associated with installation, such as halting, rebooting, and
uninstalling zones, are addressed. The procedure to completely delete a zone
from a system is also included.</p>
<p>For general information about zone installation and related operations,
see <a href="p67.html">Chapter&nbsp;19, About Installing, Halting, Cloning, and Uninstalling Non-Global Zones (Overview)</a>.</p>
<p>For information about <tt>lx</tt> branded zone installation
and cloning, see <a href="p125.html">Chapter&nbsp;32, About Installing, Booting, Halting, Cloning, and Uninstalling <tt>lx</tt> Branded Zones (Overview)</a> and <a href="p128.html">Chapter&nbsp;33, Installing, Booting, Halting, Uninstalling and Cloning <tt>lx</tt> Branded Zones (Tasks)</a>.</p>
<a name="z.inst.task-51"></a><h3>Zone Installation (Task Map)</h3>
<table><tr><th><p>Task</p>
</th><th><p>Description</p>
</th><th><p>For Instructions</p>
</th></tr>
<tr><td><p>(Optional) Verify a configured zone prior to installing the zone.</p>
</td><td><p>Ensure that a zone meets the requirements for installation. If you skip
this procedure, the verification is performed automatically when you install
the zone.</p>
</td><td><p><a href="p70.html#z.inst.task-6">(Optional) How to Verify a Configured Zone Before It Is Installed</a></p>
</td></tr>
<tr><td><p>Install a configured zone.</p>
</td><td><p>Install a zone that is in the configured state.</p>
</td><td><p><a href="p70.html#z.inst.task-7">How to Install a Configured Zone</a></p>
</td></tr>
<tr><td><p>Obtain the universally unique identifier (UUID) for the zone.</p>
</td><td><p>This separate identifier, assigned when the zone is installed, is an
alternate way to identify a zone.</p>
</td><td><p><a href="p70.html#gdhcr">How to Obtain the UUID of an Installed Non-Global Zone</a></p>
</td></tr>
<tr><td><p>(Optional) Transition an installed zone to the ready state.</p>
</td><td><p>You can skip this procedure if you want to boot the zone and use it
immediately.</p>
</td><td><p><a href="p71.html#z.inst.task-12">(Optional) How to Transition the Installed Zone to the Ready State</a></p>
</td></tr>
<tr><td><p>Boot a zone.</p>
</td><td><p>Booting a zone places the zone in the running state. A zone can be booted
from the ready state or from the installed state. Note that you must perform
the internal zone configuration when you log in to the zone after booting
it for the first time.</p>
</td><td><p><a href="p71.html#z.inst.task-13">How to Boot a Zone</a>, <a href="p75.html#z.login.ov-14">Internal Zone Configuration</a>, <a href="p77.html#z.login.task-31">Performing the Initial Internal Zone Configuration</a></p>
</td></tr>
<tr><td><p>Boot a zone in single-user mode.</p>
</td><td><p>Boots only to milestone <tt>svc:/milestone/single-user:default</tt>.
This milestone is equivalent to <tt>init</tt> level <tt>s</tt>.
See the <tt>init</tt>(1M) and <tt>svc.startd</tt>(1M) man pages.</p>
</td><td><p><a href="p71.html#fnjyv">How to Boot a Zone in Single-User Mode</a></p>
</td></tr>
</table><a name="z.inst.task-2"></a><h3>Installing and Booting Zones</h3>
<p><a name="indexterm-248"></a><a name="indexterm-249"></a>Use
the <tt>zoneadm</tt> command described in the <tt>zoneadm</tt>(1M) man
page to perform installation tasks for a non-global zone. You must be the
global administrator to perform the zone installation. The examples in this
chapter use the zone name and zone path established in <a href="p63.html">Configuring, Verifying, and Committing a Zone</a>.</p>
<a name="z.inst.task-6"></a><h4><img src="graphics/procedure.gif"> (Optional) How to Verify a Configured Zone
Before It Is Installed</h4>
<p><a name="indexterm-250"></a><a name="indexterm-251"></a>You
can verify a zone prior to installing it. One of the checks performed is a
check for sufficient disk size. If you skip this procedure, the verification
is performed automatically when you install the zone.</p>
<p>You must be the global administrator in the global zone to perform this
procedure.</p>
<ol><li><a name="z.inst.task-step-4"></a><b>Become superuser, or assume the Primary
Administrator role.</b><p>To create the role and assign the role to
a user, see Using the Solaris Management Tools With RBAC (Task Map) in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="z.inst.task-step-5"></a><b>Verify a configured zone named <tt>my-zone</tt> by using the <tt>-z</tt> option with the name of the zone
and the <tt>verify</tt> subcommand.</b><pre>global# <tt><b>zoneadm -z my-zone verify</b></tt></pre><p>This message regarding verification of the zone path will be displayed:</p><pre>Warning: /export/home/my-zone does not exist, so it cannot be verified.
When 'zoneadm install' is run, 'install' will try to create
/export/home1/my-zone, and 'verify' will be tried again,
but the 'verify' may fail if:
the parent directory of /export/home/my-zone is group- or other-writable
or
/export/home1/my-zone overlaps with any other installed zones.</pre><p>However, if an error message is displayed and the zone fails to verify,
make the corrections specified in the message and try the command again.</p><p>If no error messages are displayed, you can install the zone.</p></li></ol><a name="z.inst.task-7"></a><h4><img src="graphics/procedure.gif"> How to Install a Configured Zone</h4>
<p><a name="indexterm-252"></a><a name="indexterm-253"></a><a name="indexterm-254"></a><a name="indexterm-255"></a><a name="indexterm-256"></a><a name="indexterm-257"></a>This procedure is used
to install a configured non-global zone.</p>
<p>You must be the global administrator in the global zone to perform this
procedure.</p>
<hr>
<p><b>Note - </b>In Step 2, <b>if</b> the <tt>zonepath</tt> is
on ZFS, the <tt>zoneadm</tt> <tt>install</tt> command
automatically creates a ZFS file system (dataset) for the <tt>zonepath</tt> when
the zone is installed. You can block this action by including the <tt>-x</tt> <tt>nodataset</tt> parameter.</p>
<hr>
<ol><li><a name="z.inst.task-step-9"></a><b>Become superuser, or assume the Primary
Administrator role.</b><p>To create the role and assign the role to
a user, see Using the Solaris Management Tools With RBAC (Task Map) in <i>System Administration Guide: Basic Administration</i>.</p></li><li><a name="z.inst.task-step-10"></a><b>Install the configured zone <tt>my-zone</tt> by using the <tt>zoneadm</tt> command with the <tt>install</tt> option.</b><ul><li><b>Install the zone, automatically creating a ZFS file system if
the <tt>zonepath</tt> is on ZFS.</b><pre>global# <tt><b>zoneadm -z my-zone install</b></tt></pre><p>The system will display:</p><pre>A ZFS file systm has been created for this zone.</pre></li><li><b>Install the zone that has a <tt>zonepath</tt> on ZFS,
but do <b>not</b> automatically create the ZFS file system.</b><pre>global# <tt><b>zoneadm -z my-zone install -x nodataset</b></tt></pre></li></ul><p>You will see various messages as the files and directories needed for
the zone's root file system are installed under the zone's root path.</p></li><li><b>(Optional) If an error message is displayed and the zone fails
to install, type the following to get the zone state:</b><pre>global# <tt><b>zoneadm -z my-zone list -v</b></tt></pre><ul><li><p>If the state is listed as configured, make the corrections
specified in the message and try the <tt>zoneadm</tt> <tt>install</tt> command
again.</p>
</li>
<li><p>If the state is listed as incomplete, first execute this command:</p>
<pre>global# <tt><b>zoneadm -z my-zone uninstall</b></tt></pre><p>Then make the corrections  specified in the message, and try the <tt>zoneadm</tt> <tt>install</tt> command again.</p>
</li>
</ul>
</li><li><a name="z.inst.task-step-11"></a><b>When the installation completes, use
the <tt>list</tt> subcommand with the <tt>-i</tt> and <tt>-v</tt> options
to list the installed zones and verify the status.</b><pre>global# <tt><b>zoneadm list -iv</b></tt></pre><p>You will see a display that is similar to the following:</p><pre>ID  NAME     STATUS       PATH                           BRAND      IP
 0  global   running      /                              native     shared
 -  my-zone  installed    /export/home/my-zone           native     shared</pre></li></ol><h6>Troubleshooting</h6><p>If a zone installation is interrupted or fails, the zone is left in
the incomplete state. Use <tt>uninstall</tt> <tt>-F</tt> to
reset the zone to the configured state.</p>
<h6>Next Steps</h6><p>This zone was installed with the minimal network configuration described
in Chapter 15, Managing Services (Tasks), in <i>System Administration Guide: Basic Administration</i> by default.
You can switch to the open network configuration, or enable or disable individual
services, when you log in to the zone. See <a href="p79.html#gdpau">Switching the Non-Global Zone to a Different Networking Service Configuration</a> for
details.</p>
<a name="gdhcr"></a><h4><img src="graphics/procedure.gif"> How to Obtain the UUID of an Installed Non-Global
Zone</h4>
<p><a name="indexterm-258"></a>A
universally unique identifier (UUID) is assigned to a zone when it is installed.
The UUID can be obtained by using <tt>zoneadm</tt> with the <tt>list</tt> subcommand and the <tt>-p</tt> option. The UUID is the fifth
field of the display.</p>
<ol><li><b>View the UUIDs for zones that have been installed.</b><pre>global# <tt><b>zoneadm list -p</b></tt></pre><p>You will see a display similar to the following:</p><pre>0:global:running:/:native
6:my-zone:running:/export/home/my-zone:61901255-35cf-40d6-d501-f37dc84eb504:native</pre></li></ol><a name="gdhzf"></a>Example 20-1 How to Use the Zone UUID in a Command<pre>global# <tt><b>zoneadm -z my-zone -u 61901255-35cf-40d6-d501-f37dc84eb504 list -v</b></tt></pre><p>If both <tt>-u</tt> <i>uuid-match</i> and <tt>-z</tt> <i>zonename</i> are present, the match is done
based on the UUID first. If a zone with the specified UUID is found, that
zone is used, and the <tt>-z</tt> parameter is ignored. If no zone
with the specified UUID is found, then the system searches by the zone name.</p>
<h6><h6>More Information</h6>About the UUID<p>Zones can be uninstalled and reinstalled under the same name with different
contents. Zones can also be renamed without the contents being changed. For
these reasons, the UUID is a more reliable handle than the zone name.</p>
</h6><h6>See Also</h6><p>For more information, see <tt>zoneadm</tt>(1M) and <tt>libuuid</tt>(3LIB).</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p69.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p71.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

