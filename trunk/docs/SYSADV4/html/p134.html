<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>What Happens During PAP Authentication - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p129.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a> > <a href="p133.html#pppsvrconfig.reference-17">Authenticating Callers on a Link</a> > <a href="p133.html#pppsvrconfig.intro-8">Password Authentication Protocol (PAP)</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p133.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p135.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="pppsvrconfig.reference-18"></a><h5>What Happens During PAP Authentication</h5>
<p><a name="indexterm-2034"></a><a name="indexterm-2035"></a>PAP authentication occurs
in the following sequence.</p>
<a name="pppsvrconfig.reference-fig-19"></a>Figure 22-1 PAP Authentication Process<img src="figures/PAP-auth-pro.gif" alt=""></img><ol><li><p>The caller (authenticatee)
calls the remote peer (authenticator)
and provides its PAP user name and
password as part of link negotiation.</p>
</li>
<li><p>The peer verifies
the identity of the caller in its <tt>/etc/ppp/pap-secrets</tt> file.
If the peer uses the <tt>login</tt> option
of PAP, the peer verifies the caller's
user name and password in its password
database.</p>
</li>
<li><p>If authentication
is successful, the peer continues
link negotiation with the caller.
If authentication fails, the link
is dropped.</p>
</li>
<li><p>(Optional) If the
caller authenticates responses from
remote peers, the remote peer must
send its own PAP credentials to the
caller. Thus, the remote peer becomes
the authenticatee and the caller the
authenticator. </p>
</li>
<li><p>(Optional) The original
caller reads its own <tt>/etc/ppp/pap-secrets</tt> to verify the identity
of the remote peer.</p>
<hr>
<p><b>Note - </b>If the original caller
does require authentication credentials
from the remote peer, Step 1 and Step
4 happen in parallel.</p>
<hr>
<p>If the peer is authenticated,
negotiation continues. Otherwise,
the link is dropped.</p>
</li>
<li><p>Negotiation between
caller and peer continues until the
link is successfully established.</p>
</li>
</ol>
<a name="pppsvrconfig.reference-20"></a><h5>Using the <tt>login</tt> Option
With <tt>/etc/ppp/pap-secrets</tt></h5>
<a name="indexterm-2036"></a><a name="indexterm-2037"></a><a name="indexterm-2038"></a><p>You can add the <tt>login</tt> option
for authenticating PAP credentials
to any PPP configuration file. When <tt>login</tt> is specified, for
example, in <tt>/etc/ppp/options</tt>, <tt>pppd</tt> verifies that the caller's
PAP credentials exist in the Solaris
password database. The following shows
the format of a <tt>/etc/ppp/pap-secrets</tt> file with the <tt>login</tt> option.</p>
<pre>joe    *  ""  *
sally  *  ""  *
sue    *  ""  *</pre><p>The parameters have the following
meanings.</p>
<dl><dt>Caller</dt>
<dd><p><tt>joe</tt>, <tt>sally</tt>, and <tt>sue</tt> are
the names of the authorized callers.</p>
</dd>
<dt>Server</dt>
<dd><p>Asterisk (*), which
indicates that any server name is
valid. The <tt>name</tt> option
is not required in the PPP configuration
files.</p>
</dd>
<dt>Password</dt>
<dd><p>Double quotes, which
indicate that any password is valid.</p>
<p>If a password is in this column,
then the password from the peer must
match both the PAP password and the
UNIX <tt>passwd</tt> database.</p>
</dd>
<dt>IP Addresses</dt>
<dd><p>Asterisk (*), which
indicates that any IP address is allowed.</p>
</dd>
</dl>
<a name="pppsvrconfig.reference-21"></a><h4>Challenge-Handshake Authentication
Protocol (CHAP)</h4>
<p><a name="indexterm-2039"></a>CHAP authentication uses
the notion of the <b>challenge</b> and <b>response</b>, which means that
the peer (authenticator) challenges
the caller (authenticatee) to prove
its identity. The challenge includes
a random number and a unique ID that
is generated by the authenticator.
The caller must use the ID, random
number, and its CHAP security credentials
to generate the proper response (handshake)
to send to the peer.</p>
<p>CHAP security credentials include
a CHAP user name and a CHAP &ldquo;secret.&rdquo;
The CHAP secret is
an arbitrary string that is known
to both the caller and the peer before
they negotiate a PPP link. You configure
CHAP security credentials in the CHAP
database, <tt>/etc/ppp/chap-secrets</tt>. </p>
<a name="pppsvrconfig.reference-250"></a><h5><tt>/etc/ppp/chap-secrets</tt> File</h5>
<p><a name="indexterm-2040"></a><a name="indexterm-2041"></a>The CHAP database is implemented
in the <tt>/etc/ppp/chap-secrets</tt> file.
Machines on both sides of the PPP
link must have each others' CHAP credentials
in their <tt>/etc/ppp/chap-secrets</tt> files
for successful authentication. </p>
<hr>
<p><b>Note - </b>Unlike PAP, the shared
secret must be in the clear on both
peers. You cannot use crypt, PAM,
or the PPP login option with CHAP.</p>
<hr>
<p>The <tt>/etc/ppp/chap-secrets</tt> file has the following
syntax.</p>
<pre>myclient myserver secret5748 *</pre><p>The parameters have the following
meanings:</p>
<dl><dt><tt>myclient</tt></dt>
<dd><p>CHAP user name of
the caller. This name can be the same
as or different from the caller's
UNIX user name.</p>
</dd>
<dt><tt>myserver</tt></dt>
<dd><p>Name of the remote
machine, often a dial-in server.</p>
</dd>
<dt><tt>secret5748</tt></dt>
<dd><p>Caller's CHAP secret.</p>
<hr>
<p><b>Note - </b>Unlike PAP passwords,
CHAP secrets are never sent over the
link. Rather, CHAP secrets are used
when the local machines compute the
response.</p>
<hr>
</dd>
<dt><tt>*</tt></dt>
<dd><p>IP address that is
associated with the caller. Use an
asterisk (*) to indicate any IP address.</p>
</dd>
</dl>
<a name="pppsvrconfig.reference-22"></a><h5>What Happens During CHAP Authentication</h5>
<p>CHAP authentication occurs in
the following sequence.</p>
<a name="pppsvrconfig.reference-fig-23"></a>Figure 22-2 CHAP Authentication Sequence<a name="indexterm-2042"></a><img src="figures/CHAP-auth-pro.gif" alt=""></img><ol><li><p>Two peers that are
about to initiate communications agree
on a secret to be used for authentication
during negotiation of a PPP link. </p>
</li>
<li><p><a name="indexterm-2043"></a>The administrators of
both machines add the secret, CHAP
user names, and other CHAP credentials
to the <tt>/etc/ppp/chap-secrets</tt> database
of their respective machines.</p>
</li>
<li><p>The caller (authenticatee)
calls the remote peer (authenticator).</p>
</li>
<li><p>The authenticator
generates a random number and an ID,
and sends this data to the authenticatee
as a challenge. </p>
</li>
<li><p>The authenticatee
looks up the peer's name and secret
in its <tt>/etc/ppp/chap-secrets</tt> database.</p>
</li>
<li><p>The authenticatee
calculates a response by applying
the MD5 computational algorithm to
the secret and the peer's random number
challenge. Then the authenticatee
sends the results as its response
to the authenticator.</p>
</li>
<li><p>The authenticator
looks up the authenticatee's name
and secret in its <tt>/etc/ppp/chap-secrets</tt> database.</p>
</li>
<li><p>The authenticator
calculates its own figure by applying
MD5 to the number that was generated
as the challenge and the secret for
the authenticatee in <tt>/etc/ppp/chap-secrets</tt>.</p>
</li>
<li><p>The authenticator
compares its results with the response
from the caller. If the two numbers
are the same, the peer has successfully
authenticated the caller, and link
negotiation continues. Otherwise the
link is dropped.</p>
</li>
</ol>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p133.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p135.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

