<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>KERB Authentication - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p31.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a> > <a href="p47.html#rfsrefer-45">How the NFS Service Works</a> > <a href="p51.html#rfsrefer-59">Secure RPC</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p51.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p53.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="rfsrefer-61"></a><h5>KERB Authentication</h5>
<p>Kerberos is an authentication system that was developed at MIT. Kerberos
offers a variety of encryption types, including DES. Kerberos support is no
longer supplied as part of Secure RPC, but starting in the Solaris 9 release
a server-side and client-side implementation is included. See Chapter 20, Introduction to the Kerberos Service, in <i>System Administration Guide: Security Services</i> for more information about the
implementation of Kerberos authentication.</p>
<a name="rfsrefer-62"></a><h5>Using Secure RPC With NFS</h5>
<p><a name="indexterm-759"></a><a name="indexterm-760"></a><a name="indexterm-761"></a>Be aware of the following points if you plan to use Secure RPC:
  </p>
<ul><li><p><a name="indexterm-762"></a><a name="indexterm-763"></a><a name="indexterm-764"></a><a name="indexterm-765"></a><a name="indexterm-766"></a><a name="indexterm-767"></a>If a server crashes when no one is around (after a power failure,
for example), all the secret keys that are stored on the system are deleted.
Now no process can access secure network services or mount an NFS file system.
The important processes during a reboot are usually run as <tt>root</tt>.
Therefore, these processes would work if root's secret key were stored away,
but nobody is available to type the password that decrypts it. <tt>keylogin
-r</tt> allows <tt>root</tt> to store the clear secret key
in <tt>/etc/.rootkey</tt>, which <tt>keyserv</tt> reads. </p>
</li>
<li><p><a name="indexterm-768"></a>Some systems boot in single-user mode, with a root login shell
on the console and no password prompt. Physical security is imperative in
such cases. </p>
</li>
<li><p><a name="indexterm-769"></a><a name="indexterm-770"></a>Diskless computer booting is not totally secure. Somebody could
impersonate the boot server and boot a devious kernel that, for example, makes
a record of your secret key on a remote computer. The Secure NFS system provides
protection only after the kernel and the key server are running. Otherwise,
no way exists to authenticate the replies that are given by the boot server.
This limitation could be a serious problem, but the limitation requires a
sophisticated attack, using kernel source code. Also, the crime would leave
evidence. If you polled the network for boot servers, you would discover the
devious boot server's location. </p>
</li>
<li><p><a name="indexterm-771"></a>Most setuid programs are owned by <tt>root</tt>. If
the secret key for <tt>root</tt> is stored in <tt>/etc/.rootkey</tt>,
these programs behave as they always have. If a setuid program is owned by
a user, however, the setuid program might not always work. For example, suppose
that a setuid program is owned by <tt>dave</tt> and <tt>dave</tt> has
not logged into the computer since it booted. The program would not be able
to access secure network services. </p>
</li>
<li><p><a name="indexterm-772"></a><a name="indexterm-773"></a><a name="indexterm-774"></a><a name="indexterm-775"></a><a name="indexterm-776"></a>If you log in to a remote computer (using <tt>login</tt>, <tt>rlogin</tt>, or <tt>telnet</tt>) and use <tt>keylogin</tt> to
gain access, you give access to your account. The reason is that your secret
key is passed to that computer's key server, which then stores your secret
key. This process is only a concern if you do not trust the remote computer.
If you have doubts, however, do not log in to a remote computer if the remote
computer requires a password. Instead, use the NFS environment to mount file
systems that are shared by the remote computer. As an alternative, you can
use <tt>keylogout</tt> to delete the secret key from the key server.</p>
</li>
<li><p><a name="indexterm-777"></a><a name="indexterm-778"></a><a name="indexterm-779"></a>If a home directory is shared with the <tt>-o sec=dh</tt> option,
remote logins can be a problem. If the <tt>/etc/hosts.equiv</tt> or <tt>~/.rhosts</tt> files are not set to prompt for a password, the login
succeeds. However, the users cannot access their home directories because
no authentication has occurred locally. If the user is prompted for a password,
the user has access to his or her home directory if the password matches the
network password. </p>
</li>
</ul>
<a name="rfsrefer-66"></a><h3>Autofs Maps</h3>
<p>Autofs uses three types of maps:</p>
<ul><li><p>Master map</p>
</li>
<li><p>Direct maps </p>
</li>
<li><p>Indirect maps</p>
</li>
</ul>
<a name="rfsrefer-67"></a><h4>Master Autofs Map</h4>
<p><a name="indexterm-780"></a><a name="indexterm-781"></a><a name="indexterm-782"></a><a name="indexterm-783"></a><a name="indexterm-784"></a><a name="indexterm-785"></a><a name="indexterm-786"></a><a name="indexterm-787"></a><a name="indexterm-788"></a><a name="indexterm-789"></a>The <tt>auto_master</tt> map associates a directory
with a map. The map is a master list that specifies all the maps that autofs
should check. The following example shows what an <tt>auto_master</tt> file
could contain. </p>
<a name="rfsrefer-ex-68"></a>Example 6-3 Sample <tt>/etc/auto_master</tt> File<pre># Master map for automounter 
# 
+auto_master 
/net            -hosts           -nosuid,nobrowse 
/home           auto_home        -nobrowse 
/-              auto_direct     -ro  </pre><p><a name="indexterm-790"></a>This example shows the generic <tt>auto_master</tt> file
with one addition for the <tt>auto_direct</tt> map. Each line in
the master map <tt>/etc/auto_master</tt> has the following syntax: </p>
<p><i>mount-point map-name</i> <tt>[</tt> <i>mount-options</i> <tt>]</tt></p>
<dl><dt><i>mount-point</i></dt>
<dd><p><a name="indexterm-791"></a><a name="indexterm-792"></a><a name="indexterm-793"></a><a name="indexterm-794"></a><i>mount-point</i> is the full (absolute)
path name of a directory. If the directory does not exist, autofs creates
the directory if possible. If the directory exists and is not empty, mounting
on the directory hides its contents. In this situation, autofs issues a warning.</p>
<p>The notation <tt>/-</tt> as a mount point indicates that this
particular map is a direct map. The notation also means that no particular
mount point is associated with the map. </p>
</dd>
<dt><i>map-name</i></dt>
<dd><p><a name="indexterm-795"></a><a name="indexterm-796"></a><i>map-name</i> is the map autofs uses to
find directions to locations, or mount information. If the name is preceded
by a slash (/), autofs interprets the name as a local file. Otherwise, autofs
searches for the mount information by using the search that is specified in
the name-service switch configuration file (<tt>/etc/nsswitch.conf</tt>).
Special maps are also used for <tt>/net</tt>. See <a href="p52.html#rfsrefer-70">Mount Point <tt>/net</tt></a> for more information. </p>
</dd>
<dt><i>mount-options</i></dt>
<dd><p><i>mount-options</i> is an optional, comma-separated
list of options that apply to the mounting of the entries that are specified
in map-name, unless the entries in map-name list other options. Options for
each specific type of file system are listed in the mount man page for that
file system. For example, see the <tt>mount_nfs</tt>(1M) man page for NFS-specific
mount options. For NFS-specific mount points, the <tt>bg</tt> (background)
and <tt>fg</tt> (foreground) options do not apply.</p>
</dd>
</dl>
<p><a name="indexterm-797"></a><a name="indexterm-798"></a><a name="indexterm-799"></a><a name="indexterm-800"></a><a name="indexterm-801"></a><a name="indexterm-802"></a>A line that begins with <tt>#</tt> is a comment. All
the text that follows until the end of the line is ignored.      </p>
<p><a name="indexterm-803"></a><a name="indexterm-804"></a><a name="indexterm-805"></a>To split long lines into shorter ones, put a backslash (<tt>\</tt>)
at the end of the line. The maximum number of characters of an entry is 1024.
  </p>
<hr>
<p><b>Note - </b>If the same mount point is used in two entries, the first entry
is used by the <tt>automount</tt> command. The second entry is ignored.</p>
<hr>
<a name="rfsrefer-69"></a><h5>Mount Point <tt>/home</tt></h5>
<p><a name="indexterm-806"></a><a name="indexterm-807"></a><a name="indexterm-808"></a>The mount point <tt>/home</tt> is the directory under
which the entries that are listed in <tt>/etc/auto_home</tt> (an
indirect map) are to be mounted.   </p>
<hr>
<p><b>Note - </b><a name="indexterm-809"></a><a name="indexterm-810"></a><a name="indexterm-811"></a>Autofs runs on all computers and supports <tt>/net</tt> and <tt>/home</tt> (automounted home directories) by default. These defaults
can be overridden by entries in the NIS <tt>auto.master</tt> map
or NIS+ <tt>auto_master</tt> table, or by local editing of the <tt>/etc/auto_master</tt> file.</p>
<hr>
<a name="rfsrefer-70"></a><h5>Mount Point <tt>/net</tt></h5>
<p><a name="indexterm-812"></a><a name="indexterm-813"></a>Autofs mounts under the directory <tt>/net</tt> all
the entries in the special map  <tt>-hosts</tt>. The map is a built-in
map that uses only the hosts database. Suppose that the computer <tt>gumbo</tt> is
in the hosts database and it exports any of its file systems. The following
command changes the current directory to the root directory of the computer <tt>gumbo</tt>.</p>
<pre>% <tt><b>cd /net/gumbo</b></tt></pre><p>Autofs can mount only the <b>exported</b> file systems
of host <tt>gumbo</tt>, that is, those file systems on a server
that are available to network users instead of those file systems on a local
disk. Therefore, all the files and directories on <tt>gumbo</tt> might
not be available through <tt>/net/gumbo</tt>. </p>
<p>With the <tt>/net</tt> method of access, the server name
is in the path and is location dependent. If you want to move an exported
file system from one server to another, the path might no longer work. Instead,
you should set up an entry in a map specifically for the file system you want
rather than use <tt>/net</tt>. </p>
<hr>
<p><b>Note - </b><a name="indexterm-814"></a>Autofs checks the server's export list only at mount time. After
a server's file systems are mounted, autofs does not check with the server
again until the server's file systems are automatically unmounted. Therefore,
newly exported file systems are not &ldquo;seen&rdquo; until the file systems
on the client are unmounted and then remounted.</p>
<hr>
<a name="rfsrefer-72"></a><h4>Direct Autofs Maps</h4>
<p><a name="indexterm-815"></a><a name="indexterm-816"></a><a name="indexterm-817"></a>A direct map is an automount point. With a direct map, a direct
association exists between a mount point on the client and a directory on
the server. Direct maps have a full path name and indicate the relationship
explicitly. The following is a typical <tt>/etc/auto_direct</tt> map: </p>
<pre>/usr/local          -ro \
   /bin                   ivy:/export/local/sun4 \
   /share                 ivy:/export/local/share \
   /src                   ivy:/export/local/src
/usr/man            -ro   oak:/usr/man \
                          rose:/usr/man \
                          willow:/usr/man 
/usr/games          -ro   peach:/usr/games 
/usr/spool/news     -ro   pine:/usr/spool/news \
                          willow:/var/spool/news </pre><p><a name="indexterm-818"></a>Lines in direct maps have the following syntax: </p>
<p><i>key</i> <tt>[</tt> <i>mount-options</i> <tt>]</tt> <i>location</i></p>
<dl><dt><i>key</i></dt>
<dd><p><i>key</i> is the path name of the mount
point in a direct map. </p>
</dd>
<dt><i>mount-options</i></dt>
<dd><p><i>mount-options</i> is the options that
you want to apply to this particular mount. These options are required only
if the options differ from the map default. Options for each specific type
of file system are listed in the mount man page for that file system. For
example, see the <tt>mount_cachefs</tt>(1M) man page for CacheFS specific mount options. For information
about using CacheFS options with different versions of NFS, see <a href="p24.html">Accessing NFS File Systems Using CacheFS</a>.</p>
</dd>
<dt><i>location</i></dt>
<dd><p><i>location</i> is the location of the
file system. One or more file systems are  specified as <i>server</i>:<i>pathname</i> for NFS file systems or :<i>devicename</i> for
High Sierra file systems (HSFS). </p>
<hr>
<p><b>Note - </b>The <i>pathname</i> should not include an
automounted mount point. The <i>pathname</i> should be
the actual absolute path to the file system. For instance, the location of
a home directory should be listed as <i>server</i><tt>:/export/home/</tt><i>username</i>, not as <i>server</i><tt>:/home/</tt><i>username</i>.</p>
<hr>
</dd>
</dl>
<p><a name="indexterm-819"></a><a name="indexterm-820"></a><a name="indexterm-821"></a><a name="indexterm-822"></a><a name="indexterm-823"></a><a name="indexterm-824"></a><a name="indexterm-825"></a><a name="indexterm-826"></a><a name="indexterm-827"></a>As in the master map, a line that begins with <tt>#</tt> is
a comment. All the text that follows until the end of the line is ignored.
Put a backslash at the end of the line to split long lines into shorter ones. </p>
<p>Of all the maps, the entries in a direct map most closely resemble the
corresponding entries in <tt>/etc/vfstab</tt>. An entry might
appear in <tt>/etc/vfstab</tt> as follows: </p>
<pre>dancer:/usr/local - /usr/local/tmp nfs - yes ro </pre><p>The equivalent entry appears in a direct map as follows:  </p>
<pre>/usr/local/tmp     -ro     dancer:/usr/local</pre><hr>
<p><b>Note - </b>No concatenation of options occurs between the automounter maps.
Any options that are added to an automounter map override all options that
are listed in maps that are searched earlier. For instance, options that are
included in the <tt>auto_master</tt> map would be overridden by
corresponding entries in any other map.</p>
<hr>
<p><a name="indexterm-828"></a><a name="indexterm-829"></a><a name="indexterm-830"></a>See <a href="p54.html#rfsrefer-86">How Autofs Selects the Nearest Read-Only Files for Clients (Multiple Locations)</a> for other important
features that are associated with this type of map.   </p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p51.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p53.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

