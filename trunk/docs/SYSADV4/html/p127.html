<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Common
Chat Script Problems - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Network Services<?GenHTML /ReferencePage> > <a href="p124.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a> > <a href="p125.html">Solving PPP-Related and PPPoE-Related Problems</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p126.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p128.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="ppp.trouble-111"></a><h4>Common
Chat Script Problems</h4>
<p><a name="indexterm-1939"></a>Chat scripts are trouble-prone
areas for dial-up links. The following
table lists common chat script errors
and gives suggestions for fixing the
errors. For procedural information,
refer to <a href="p126.html#ppp.trouble-44">How to Obtain Debugging Information for Chat Scripts</a>.</p>
<a name="ppp.trouble-tbl-49"></a>Table 21-5 Common
Chat Script Problems<table><tr><th><p>Symptom</p>
</th><th><p>Problem</p>
</th><th><p>Solution</p>
</th></tr>
<tr><td><p><tt>pppd debug</tt> output
contains <tt>Connect script failed</tt> </p>
</td><td><p>Your chat script supplies a
user name and ssword.</p>
<pre>ogin: <i>user-name</i>
ssword: <i>password</i></pre><p>However, the peer that you intended
to connect to does not prompt for
this information.</p>
</td><td><ol><li><p>Delete the login and
password from the chat script.</p>
</li>
<li><p>Try to call the peer
again.</p>
</li>
<li><p>If you still get the
message, call the ISP.  Ask the ISP
for the correct login sequence.</p>
</li>
</ol>
</td></tr>
<tr><td><p>The <tt>/usr/bin/chat
-v</tt> log contains <tt>"expect
(login:)" alarm read timed out</tt></p>
</td><td><p>Your chat script supplies a
user name and ssword.</p>
<pre>ogin: pppuser
ssword: \q\U</pre><p>However, the peer that you intend
to connect to does not prompt for
this information.</p>
</td><td><ol><li><p>Delete the login and
password from the chat script.</p>
</li>
<li><p>Try to call the peer
again.</p>
</li>
<li><p>If you still get the
message, call the ISP. Ask the ISP
for the correct login sequence.</p>
</li>
</ol>
</td></tr>
<tr><td><p><tt>pppd debug</tt> output
contains <tt>possibly looped-back</tt> </p>
</td><td><p>The local machine or its peer
is hanging at the command line and
not running PPP. An incorrectly configured
login name and password are in the
chat script.</p>
</td><td><p></p>
<ol><li><p>Delete the login and
password from the chat script.</p>
</li>
<li><p>Try to call the peer
again.</p>
</li>
<li><p>If you still get the
message, call the ISP.  Ask for the
correct login sequence.</p>
</li>
</ol>
</td></tr>
<tr><td><p><a name="indexterm-1940"></a><tt>pppd debug</tt> output
shows that LCP activates, but the
link terminates soon afterward.</p>
</td><td><p>The password in the chat script
might be incorrect.</p>
</td><td><p></p>
<ol><li><p>Ensure that you have
the correct password for the local
machine.</p>
</li>
<li><p>Check the password
in the chat script.  Fix the password
 if  incorrect.</p>
</li>
<li><p>Try to call the peer
again.</p>
</li>
<li><p>If you still get the
message, call the ISP. Ask the ISP
for the correct login sequence.</p>
</li>
</ol>
</td></tr>
<tr><td><p>Text from the peer begins with
a tilde (~).</p>
</td><td><p>Your chat script supplies a
user name and ssword.</p>
<pre>ogin: pppuser
ssword: \q\U</pre><p>However, the peer that  you
intend to connect to does not prompt
for this information.</p>
</td><td><p></p>
<ol><li><p>Delete the login and
password  from the chat script.</p>
</li>
<li><p>Try to call the peer
again.</p>
</li>
<li><p>If you still get the
message, call the ISP. Request the
correct login sequence.</p>
</li>
</ol>
</td></tr>
<tr><td><p>The modem hangs.</p>
</td><td><p>Your chat script contains the
following line to force the local
machine to wait for the <tt>CONNECT</tt> message
from the peer:</p>
<pre>CONNECT &rdquo;</pre></td><td><p>Use the following line when
you want the chat script to wait for
CONNECT from the peer:</p>
<pre>CONNECT \c</pre><p>End the chat script with <tt>~
\c</tt>. </p>
</td></tr>
<tr><td><p><tt>pppd debug</tt> output
contains LCP: timeout
sending Config-Requests</p>
</td><td><p>Your chat script contains the
following line to force the local
machine to wait for the <tt>CONNECT</tt> message
from the peer:</p>
<pre>CONNECT &rdquo;</pre></td><td><p>Use the following line when
you want the chat script to wait for
CONNECT from the peer:</p>
<pre>CONNECT \c</pre><p>End the chat script with <tt>~
\c</tt>.</p>
</td></tr>
<tr><td><p><a name="indexterm-1941"></a><tt>pppd debug</tt> output
contains Serial link
is not 8-bit clean</p>
</td><td><p>Your chat script contains the
following line to force the local
machine to wait for the <tt>CONNECT</tt> message
from the peer:</p>
<pre>CONNECT &rdquo;</pre></td><td><p>Use the following line when
you want the chat script to wait for
CONNECT from the peer:</p>
<pre>CONNECT \c</pre><p>End the chat script with <tt>~
\c</tt>. </p>
</td></tr>
<tr><td><p><tt>pppd debug</tt> output
contains  Loopback
detected</p>
</td><td><p>Your chat script contains the
following line to force the local
machine to wait for the <tt>CONNECT</tt> message
from the peer:</p>
<pre>CONNECT &rdquo;</pre></td><td><p>Use the following line when
you want the chat script to wait for
CONNECT from the peer:</p>
<pre>CONNECT \c</pre><p>End the chat script with <tt>~
\c</tt>. </p>
</td></tr>
<tr><td><p><tt>pppd debug</tt> output
contains SIGHUP</p>
</td><td><p>Your chat script contains the
following line to force the local
machine to wait for the <tt>CONNECT</tt> message
from the peer:</p>
<pre>CONNECT &rdquo;</pre></td><td><p>Use the following line when
you want the chat script to wait for
CONNECT from the peer:</p>
<pre>CONNECT \c</pre><p>End the chat script with <tt>~
\c</tt>. </p>
</td></tr>
</table><a name="ppp.trouble-35"></a><h4><img src="graphics/procedure.gif"> How
to Diagnose and Fix Serial-Line Speed
Problems</h4>
<p><a name="indexterm-1942"></a><a name="indexterm-1943"></a><a name="indexterm-1944"></a>Dial-in servers can experience
problems because of conflicting speed
settings. The following procedure
helps you to isolate the cause of
the link problem to conflicting serial-line
speeds.</p>
<p>The following behaviors cause
speed problems:</p>
<ul><li><p>You invoked PPP through
a program such as <tt>/bin/login</tt> and
specified the speed of the line.</p>
</li>
<li><p>You started PPP from <tt>mgetty</tt> and accidentally
supplied the bit rate.</p>
</li>
</ul>
<p>pppd changes the speed that
was originally set for the line to
the speed that was set by <tt>/bin/login</tt> or <tt>mgetty</tt>.
 As a result, the line fails.</p>
<ol><li><a name="ppp.trouble-step-71"></a><b>Log
in to the dial-in server. Call the
peer with debugging enabled.</b><p>If you need instructions, see <a href="p124.html#ppp.trouble-21">How to Turn on PPP Debugging</a>.</p></li><li><a name="ppp.trouble-step-37"></a><b>Display
the resulting <tt>/var/log/pppdebug</tt> log.</b><p>Check
the output for the following message:</p><pre>LCP too many configure requests</pre><p>This message indicates that
the speeds of serial lines that were
configured for PPP might potentially
be in conflict.</p></li><li><a name="ppp.trouble-step-39"></a><b>Check
if PPP is invoked through a program
such as <tt>/bin/login</tt> and
the line speed that was set.</b><p>In such a situation, <tt>pppd</tt> changes
the originally configured line speed
to the speed that is specified in <tt>/bin/login</tt>.</p></li><li><a name="ppp.trouble-step-40"></a><b>Check
if a user started PPP from the <tt>mgetty</tt> command and accidentally
specified a bit rate.</b><p>This
action also causes serial-line speeds
to conflict.</p></li><li><a name="ppp.trouble-step-41"></a><b>Fix
the conflicting serial-line speed
problem as follows:</b><ol><li><a name="ppp.trouble-step-72"></a><b>Lock
the DTE rate on the modem.</b></li><li><a name="ppp.trouble-step-42"></a><b>Do
not use autobaud.</b></li><li><a name="ppp.trouble-step-43"></a><b>Do
not change the line speed after configuration.</b></li></ol></li></ol><a name="ppp.trouble-56"></a><h4><img src="graphics/procedure.gif"> How
to Obtain Diagnostic Information for
PPPoE</h4>
<p><a name="indexterm-1945"></a><a name="indexterm-1946"></a>You can use PPP and standard
UNIX utilities to identify problems
with PPPoE. When you suspect that
PPPoE is the cause of problems on
a link, use the following diagnostic
tools to obtain troubleshooting information.</p>
<ol><li><a name="ppp.trouble-step-73"></a><b>Become
superuser on the machine that runs
the PPPoE tunnel, either PPPoE client
or PPPoE access server.</b></li><li><a name="ppp.trouble-step-58"></a><b>Turn
on debugging, as explained in the
procedure <a href="p124.html#ppp.trouble-21">How to Turn on PPP Debugging</a>.</b></li><li><a name="ppp.trouble-step-59"></a><b>View
the contents of the log file <tt>/var/log/pppdebug</tt>.</b><p><a name="indexterm-1947"></a><a name="indexterm-1948"></a>The following example
shows part of a log file that was
generated for a link with a PPPoE
tunnel.</p><pre>Sep  6 16:28:45 enyo pppd[100563]: [ID 702911 daemon.info] Plugin 
  pppoe.so loaded.
Sep  6 16:28:45 enyo pppd[100563]: [ID 860527 daemon.notice] pppd 
  2.4.0b1 (Sun Microsystems, Inc.,
Sep  5 2001 10:42:05) started by troot, uid 0
Sep  6 16:28:46 enyo pppd[100563]: [ID 702911 daemon.debug] connect option:
   '/usr/lib/inet/pppoec 
-v hme0' started (pid 100564)
Sep  6 16:28:46 enyo pppd[100563]: [ID 702911 daemon.info] Serial connection established.
Sep  6 16:28:46 enyo pppd[100563]: [ID 702911 daemon.info] Using interface sppp0
Sep  6 16:28:46 enyo pppd[100563]: [ID 702911 daemon.notice] Connect: sppp0
   &lt;--> /dev/sppptun
Sep  6 16:28:46 enyo pppd[100563]: [ID 702911 daemon.debug] /etc/ppp/pap-secrets
  is apparently empty
Sep  6 16:28:46 enyo pppd[100563]: [ID 702911 daemon.debug] /etc/ppp/chap-secrets
  is apparently empty
Sep  6 16:28:46 enyo pppd[100563]: [ID 702911 daemon.debug] sent 
  [LCP ConfReq id=0xef &lt;mru 1492> 
asyncmap 0x0 &lt;magic 0x77d3e953>&lt;pcomp>&lt;acomp>
Sep  6 16:28:46 enyo pppd[100563]: [ID 702911 daemon.debug] rcvd 
  [LCP ConfReq id=0x2a &lt;mru 1402>
asyncmap 0x0 &lt;magic 0x9985f048>&lt;pcomp>&lt;acomp </pre><p><a name="indexterm-1949"></a>If the debugging output
does not help you isolate the problem,
continue with this procedure.</p></li><li><a name="ppp.trouble-step-61"></a><b><a name="indexterm-1950"></a><a name="indexterm-1951"></a>Get diagnostic messages
from PPPoE.</b><pre># pppd connect "/usr/lib/inet/pppoec -v <i>interface-name</i><tt><b>"</b></tt></pre><p><tt>pppoec</tt> sends
diagnostic information to the <tt>stderr</tt>. If you run <tt>pppd</tt> in
the foreground, the output appears
on the screen. If <tt>pppd</tt> runs
in the background, the output is sent
to <tt>/etc/ppp/connect-errors</tt>. </p><p>The next example shows
the messages that are generated as
the PPPoE tunnel is negotiated.</p><pre>Connect option: '/usr/lib/inet/pppoec -v hme0' started (pid 100564)
/usr/lib/inet/pppoec: PPPoE Event Open (1) in state Dead (0): action SendPADI (2)
/usr/lib/inet/pppoec: Sending PADI to ff:ff:ff:ff:ff:ff: 18 bytes
/usr/lib/inet/pppoec: PPPoE State change Dead (0) -> InitSent (1)
/usr/lib/inet/pppoec: Received Active Discovery Offer from 8:0:20:cd:c1:2/hme0:pppoed
/usr/lib/inet/pppoec: PPPoE Event rPADO+ (5) in state InitSent (1): action SendPADR+ (5)
/usr/lib/inet/pppoec: Sending PADR to 8:0:20:cd:c1:2: 22 bytes
/usr/lib/inet/pppoec: PPPoE State change InitSent (1) -> ReqSent (3)
/usr/lib/inet/pppoec: Received Active Discovery Session-confirmation from
   8:0:20:cd:c1:2/hme0:pppoed
/usr/lib/inet/pppoec: PPPoE Event rPADS (7) in state ReqSent (3): action Open (7)
/usr/lib/inet/pppoec: Connection open; session 0002 on hme0:pppoe
/usr/lib/inet/pppoec: PPPoE State change ReqSent (3) -> Convers (4)
/usr/lib/inet/pppoec: connected</pre><p>If the diagnostic messages do
not help you isolate the problem,
continue with this procedure.</p></li><li><a name="ppp.trouble-step-63"></a><b><a name="indexterm-1952"></a>Run <tt>snoop</tt>.
 Then save the trace to a file.</b><p>For information about <tt>snoop</tt>, refer to the <tt>snoop</tt>(1M) man
page.</p><pre># snoop -o <i>pppoe-trace-file</i></pre></li><li><a name="ppp.trouble-step-64"></a><b><a name="indexterm-1953"></a><a name="indexterm-1954"></a>View the <tt>snoop</tt> trace
file.</b><pre># snoop -i <i>pppoe-trace-file</i> -v pppoe</pre><pre>ETHER: ----- Ether Header -----
ETHER:
ETHER: Packet 1 arrived at 6:35:2.77
ETHER: Packet size = 32 bytes
ETHER: Destination = ff:ff:ff:ff:ff:ff, (broadcast)
ETHER: Source      = 8:0:20:78:f3:7c, Sun
ETHER: Ethertype = 8863 (PPPoE Discovery)
ETHER:
PPPoE: ----- PPP Over Ethernet -----
PPPoE:
PPPoE: Version = 1
PPPoE: Type = 1
PPPoE: Code = 9 (Active Discovery Initiation)
PPPoE: Session Id = 0
PPPoE: Length = 12 bytes
PPPoE:
PPPoE: ----- Service-Name -----
PPPoE: Tag Type = 257
PPPoE: Tag Length = 0 bytes
PPPoE:
PPPoE: ----- Host-Uniq -----
PPPoE: Tag Type = 259
PPPoE: Tag Length = 4 bytes
PPPoE: Data = Ox00000002
PPPoE:
.
.
.
ETHER: ----- Ether Header -----
ETHER:
ETHER: Packet 5 arrived at 6:35:2.87
ETHER: Packet size = 60 bytes
ETHER: Destination = 8:0:20:78:f3:7c, Sun)
ETHER: Source      = 0:2:fd:39:7f:7, 
ETHER: Ethertype = 8864 (PPPoE Session)
ETHER:
PPPoE: ----- PPP Over Ethernet -----
PPPoE:
PPPoE: Version = 1
PPPoE: Type = 1
PPPoE: Code = 0 (PPPoE Session)
PPPoE: Session Id = 24383
PPPoE: Length = 20 bytes
PPPoE:
PPP: ----- Point-to-Point Protocol -----
PPP:
PPP-LCP: ----- Link Control Protocol -----
PPP-LCP:
PPP-LCP: Code = 1 (Configure Request)
PPP-LCP: Identifier = 80
PPP-LCP: Length = 18</pre></li></ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p126.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p128.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

