<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p173.html#ipqos-config-planning-1">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p173.html#ipqos-config-planning-7">Planning the Quality-of-Service Policy</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p175.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p177.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ipqos-config-planning-45"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Plan Forwarding Behavior</h3>
<p>Forwarding behavior determines the priority and drop precedence of traffic
flows that are about to be forwarded to the network. You can choose two major
forwarding behaviors: prioritize the flows of a class in relationship to other
traffic classes or drop the flows entirely. </p>
<p>The Diffserv model uses the marker to assign the chosen forwarding behavior
to traffic flows. IPQoS offers the following marker modules.</p>
<ul><li><p><A NAME="indexterm-3079"></A><tt>dscpmk</tt> - Used to mark the DS field of
an IP packet with a DSCP</p>
</li>
<li><p><tt>dlcosmk</tt> - Used to mark the VLAN tag
of a datagram with a class-of-service (CoS) value</p>
</li>
</ul>
<p><hr size="1" noshade><p><b>Note - </b><A NAME="indexterm-3080"></A>The suggestions in this section refer specifically to IP packets.
If your IPQoS system includes a VLAN device, you can use the <tt>dlcosmk</tt> marker
to mark forwarding behaviors for datagrams. For more information, refer to <A HREF="p190.html#ipqos-reference-110">Using the <tt>dlcosmk</tt> Marker With VLAN Devices</A>.</p>
<hr size="1" noshade></p><p>To prioritize IP traffic, you need to assign a DSCP to each packet.
The <tt>dscpmk</tt> marker marks the DS field of the packet with
the DSCP. You choose the DSCP for a class from a group of well-known codepoints
that are associated with the forwarding behavior type. These well-known codepoints
are 46 (101110) for the EF PHB and a range of codepoints for the AF PHB. For
overview information on DSCP and forwarding, refer to <A HREF="p171.html#ipqos-intro-54">Traffic Forwarding on an IPQoS-Enabled Network</A>.</p>
<h5>Before You Begin</h5><p>The next steps assume that you have defined classes and filters for
the QoS policy. Though you often use the meter with the marker to control
traffic, you can use the marker alone to define a forwarding behavior.</p>
<ol><A NAME="ipqos-config-planning-step-50"></A><li><p><b>Review the classes that you
have created thus far and the priorities that you have assigned to each class.</b></p><p>Not all traffic classes need to be marked. </p>
</li>
<A NAME="ipqos-config-planning-step-49"></A><li><p><b><A NAME="indexterm-3081"></A>Assign the EF per-hop behavior to the class with the highest priority.</b></p><p>The EF PHB guarantees that packets with the EF DSCP 46  (101110)
are released onto the network before packets with any AF PHBs. Use the EF
PHB for your highest-priority traffic. For more information about EF, refer
to <A HREF="p189.html#ipqos-reference-140">Expedited Forwarding (EF) PHB</A>.</p>
</li>
<A NAME="ipqos-config-planning-step-47"></A><li><p><b>Assign forwarding behaviors
to classes that have traffic to be metered.</b></p></li>
<A NAME="ipqos-config-planning-step-480"></A><li><p><b>Assign DS codepoints to the
remaining classes in agreement with the priorities that you have assigned
to the classes.</b></p></li>
</ol><A NAME="eupqz"></A><h5>Example 33-3 &nbsp;&nbsp;QoS Policy for a Games Application</h5>
<p>Traffic is generally metered for the following reasons:</p>
<ul><li><p>An SLA guarantees packets of this class greater service or
lesser service when the network is heavily used.</p>
</li>
<li><p>A class with a lower priority might have a tendency to flood
the network.</p>
</li>
</ul>
<p>You use the marker with the meter to provide differentiated services
and bandwidth management to these classes. For example, the following table
shows a portion of a QoS policy. This policy defines a class for a popular
games application that generates a high level of traffic.</p>

<table cellspacing="5" border="1">
<tr><th scope="col"><p>Class</p></th><th scope="col"><p>Priority</p></th><th scope="col"><p>Filter</p></th><th scope="col"><p>Selector</p></th><th scope="col"><p>Rate</p></th><th scope="col"><p>Forwarding?</p></th></tr>
<tr><td><p><tt>games_app</tt></p></td><td><p>9</p></td><td><p><tt>games_in</tt></p></td><td><p><tt>sport 6080</tt></p></td><td><p>N/A</p></td><td><p>N/A</p></td></tr>
<tr><td><p><tt>games_app</tt></p></td><td><p>9</p></td><td><p><tt>games_out</tt></p></td><td><p><tt>dport 6081</tt></p></td><td><p>meter=<tt>tokenmt</tt></p><p>committed rate=5000000</p><p>committed burst =5000000</p><p>peak rate =10000000</p><p>peak burst=15000000</p><p>green precedence=continue processing</p><p>yellow precedence=mark yellow PHB</p><p>red precedence=drop</p></td><td><p>green =AF31</p><p>yellow=AF42</p><p>red=drop</p></td></tr>
</table><p>The forwarding behaviors assign low-priority DSCPs to <tt>games_app</tt> traffic
that conforms to its committed rate or is under the peak rate. When <tt>games_app</tt> traffic exceeds peak rate, the QoS policy indicates that packets
from <tt>games_app</tt> are to be dropped. All AF codepoints are
listed in <A HREF="p189.html#ipqos-reference-tbl-16">Table 37-2</A>.</p>
<h5>See Also</h5><ul><li><p>To plan for flow accounting of certain types of traffic, refer
to <A HREF="p176.html#ipqos-config-planning-18">How to Plan for Flow Accounting</A>.</p>
</li>
<li><p>To add more classes to the QoS policy, refer to <A HREF="p174.html#ipqos-config-planning-14">How to Define the Classes for Your QoS Policy</A>.</p>
</li>
<li><p>To add more filters to the QoS policy, refer to <A HREF="p175.html#ipqos-config-planning-42">How to Define Filters in the QoS Policy</A>.</p>
</li>
<li><p>To define a flow-control scheme, refer to <A HREF="p175.html#ipqos-config-planning-16">How to Plan Flow Control</A>.</p>
</li>
<li><p>To define additional forwarding behaviors for flows as the
packets return to the network stream, refer to <A HREF="p176.html#ipqos-config-planning-45">How to Plan Forwarding Behavior</A>.</p>
</li>
<li><p>To create an IPQoS configuration file, refer to <A HREF="p179.html#ipqos-policy-planning-32">How to Create the IPQoS Configuration File and Define Traffic Classes</A>.</p>
</li>
</ul>
<A NAME="ipqos-config-planning-18"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Plan for Flow Accounting</h3>
<p>You use the IPQoS <tt>flowacct</tt> module to track traffic
flows for billing or network management purposes. Use the following procedure
to determine if your QoS policy should include flow accounting.</p>
<ol><A NAME="ipqos-config-planning-step-60"></A><li><p><b>Does your company offer SLAs
to customers?</b></p><p>If the answer is yes, then you should use flow accounting.
Review the SLAs to determine what types of network traffic your company wants
to bill customers for. Then, review your QoS policy to determine which classes
select traffic to be billed.</p>
</li>
<A NAME="ipqos-config-planning-step-57"></A><li><p><b>Are there applications that
might need monitoring or testing to avoid network problems?</b></p><p>If
the answer is yes, consider using flow accounting to observe the behavior
of these applications. Review your QoS policy to determine the classes that
you have assigned to traffic that requires monitoring.</p>
</li>
<A NAME="ipqos-config-planning-step-58"></A><li><p><b>Mark Y in the flow-accounting
column for each class that requires flow accounting in your QoS planning table.</b></p></li>
</ol><h5>See Also</h5><ul><li><p>To add more classes to the QoS policy, refer to <A HREF="p174.html#ipqos-config-planning-14">How to Define the Classes for Your QoS Policy</A>.</p>
</li>
<li><p>To add more filters to the QoS policy, refer to <A HREF="p175.html#ipqos-config-planning-42">How to Define Filters in the QoS Policy</A>.</p>
</li>
<li><p>To define a flow-control scheme, refer to <A HREF="p175.html#ipqos-config-planning-16">How to Plan Flow Control</A>.</p>
</li>
<li><p>To define forwarding behaviors for flows as the packets return
to the network stream, refer to <A HREF="p176.html#ipqos-config-planning-45">How to Plan Forwarding Behavior</A>.</p>
</li>
<li><p>To plan for additional flow accounting of certain types of
traffic, refer to <A HREF="p176.html#ipqos-config-planning-18">How to Plan for Flow Accounting</A>.</p>
</li>
<li><p>To create the IPQoS configuration file, refer to <A HREF="p179.html#ipqos-policy-planning-32">How to Create the IPQoS Configuration File and Define Traffic Classes</A>.</p>
</li>
</ul>
<A NAME="ipqos-config-planning-13"></A><h2>Introducing the IPQoS Configuration
Example</h2>
<A NAME="indexterm-3082"></A><p>Tasks in the remaining chapters of the guide use the example IPQoS configuration
that is introduced in this section. The example shows the differentiated services
solution on the public intranet of BigISP, a fictitious service provider.
BigISP offers services to  large companies that reach BigISP through leased
lines. Individuals who dial in from modems can also buy services from BigISP.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p175.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p177.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

