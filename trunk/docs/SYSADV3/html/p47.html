<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p41.html#ipv6-admintasks-1">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p46.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p48.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ipv6-admintasks-43"></A><h2>Administering Default Address Selection</h2>
<A NAME="indexterm-899"></A><A NAME="indexterm-900"></A><A NAME="indexterm-901"></A><p>The Solaris OS enables a single interface to have multiple IP addresses.
For example, technologies, such as network multipathing (IPMP) enable multiple
network interface cards (NICs) to connect to the same IP link layer. That
link can have one or more IP addresses. Additionally, interfaces on IPv6-enabled
systems have a link-local IPv6 address, at least one IPv6 routing address,
and an IPv4 address for at least one interface. </p>
<p>When the system initiates a transaction, an application makes a call
to the <tt>getaddrinfo</tt> socket. <tt>getaddrinfo</tt> discovers
the possible address in use on the destination system. The kernel then prioritizes
this list to find the best destination to use for the packet. This process
is called <b>destination address ordering</b>. The Solaris kernel
then selects the appropriate format for the source address, given the best
destination address for the packet. The process is known as <b>address
selection</b>. For more information on destination address ordering,
see the <tt>getaddrinfo</tt>(3SOCKET) man page.</p>
<p>Both IPv4-only and dual-stack IPv4/IPv6 systems must perform default
address selection. In most circumstances, you do not need to change the default
address selection mechanisms. However, you might need to change the priority
of address formats to support IPMP or to prefer 6to4 address formats, for
example. </p>
<A NAME="ipv6-admintasks-77"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Administer the IPv6 Address Selection
Policy Table</h3>
<A NAME="indexterm-902"></A><p>The following procedure explains how to modify the address selection
policy table. For conceptual information about IPv6 default address selection,
refer to <A HREF="p57.html#ipv6-ref-108"><tt>ipaddrsel</tt> Command</A>.</p>
<hr size="1" noshade><p><IMG ALT="Caution" src="graphics/caution.gif">  <b>Caution - </b>Do not change the IPv6 address selection policy table, except
for the reasons shown in the next task. You can cause problems on the network
with a badly constructed policy table. Be sure to save a backup copy of the
policy table, as is done in the next procedure.</p><hr size="1" noshade><ol><li><p><b>Assume the Primary Administrator role, or become superuser.</b></p><p>The Primary Administrator role includes the Primary Administrator profile.
To create the role and assign the role to a user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<A NAME="ipv6-admintasks-step-79"></A><li><p><b>Review the current IPv6 address selection
policy table.<A NAME="indexterm-903"></A><A NAME="indexterm-904"></A><A NAME="indexterm-905"></A></b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipaddrsel</b></tt>
# Prefix                  Precedence Label
::1/128                           50 Loopback
::/0                              40 Default
2002::/16                         30 6to4
::/96                             20 IPv4_Compatible
::ffff:0.0.0.0/96                 10 IPv4</pre>
</td></table><br></li>
<A NAME="ipv6-admintasks-step-80"></A><li><p><b>Make a backup copy of the default
address policy table.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cp /etc/inet/ipaddrsel.conf /etc/inet/ipaddrsel.conf.orig</b></tt></pre>
</td></table><br></li>
<A NAME="ipv6-admintasks-step-81"></A><li><p><b>Use a text editor to add your customizations
to <tt>/etc/inet/ipaddrsel.conf</tt>. </b></p><p>Use the following
syntax for entries in <tt>/etc/inet/ipaddrsel</tt>:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre><i>prefix/prefix-length precedence label [# comment ]</i> </pre>
</td></table><br><p>Here are some common modifications that you might want to make to your
policy table:</p>
<ul><li><p>Give the highest priority to 6to4 addresses.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>2002::/16                         50 6to4
::1/128                           45 Loopback</pre>
</td></table><br><p>The 6to4 address format now has the highest priority, 50. Loopback,
which previously had a 50 precedence, now has a 45 precedence. The other addressing
formats remain the same.</p>
</li>
<li><p>Designate a specific source address to be used in communications
with a specific destination address.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>::1/128                           50 Loopback
2001:1111:1111::1/128             40 ClientNet
2001:2222:2222::/48               40 ClientNet
::/0                              40 Default</pre>
</td></table><br><p>This particular entry is useful for hosts with only one physical interface.
Here <tt>2001:1111:1111::1/128</tt> is preferred as the source address
on all packets that are bound for destinations within network <tt>2001:2222:2222::/48</tt>. The 40 priority gives higher precedence to the source address <tt>2001:1111:1111::1/128</tt> than to other address formats configured for
the interface.</p>
</li>
<li><p>Favor IPv4 addresses over IPv6 addresses.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>::ffff:0.0.0.0/96                 60 IPv4
::1/128                           50 Loopback
.
.</pre>
</td></table><br><p>The IPv4 format <tt>::ffff:0.0.0.0/96</tt> has its precedence
changed from the default 10 to 60, the highest priority in the table.</p>
</li>
</ul>
</li>
<A NAME="ipv6-admintasks-step-82"></A><li><p><b>Load the modified policy table into
the kernel.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre><tt><b>ipaddrsel -f /etc/inet/ipaddrsel.conf</b></tt></pre>
</td></table><br></li>
<A NAME="ipv6-admintasks-step-85"></A><li><p><b>If the modified policy table has
problems, restore the default IPv6 address selection policy table.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipaddrsel -d</b></tt></pre>
</td></table><br></li>
</ol><A NAME="ipv6-admintasks-87"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Modify the IPv6 Address Selection
Table for the Current Session Only</h3>
<p>When you edit the <tt>/etc/inet/ipaddrsel.conf,</tt> file,
any modifications that you make persist across reboots. If you want the modified
policy table to exist only in the current session, follow this procedure.</p>
<ol><li><p><b>Assume the Primary Administrator role, or become superuser.</b></p><p>The Primary Administrator role includes the Primary Administrator profile.
To create the role and assign the role to a user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<li><p><b>Copy the contents of <tt>/etc/inet/ipaddrsel</tt> into <i>filename</i>, where <i>filename</i> represents
a name of your choice.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cp</b></tt> <tt>/etc/inet/ipaddrsel</tt> <i>filename</i></pre>
</td></table><br></li>
<A NAME="ipv6-admintasks-step-84"></A><li><p><b>Edit the policy table in <i>filename</i> to your specifications. </b></p></li>
<A NAME="ipv6-admintasks-step-86"></A><li><p><b>Load the modified policy table into
the kernel.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre><tt><b># ipaddrsel -f </tt><i>filename<tt></i></b></tt></pre>
</td></table><br><p>The kernel uses the new policy table until you reboot the system.</p>
</li>
</ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p46.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p48.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

