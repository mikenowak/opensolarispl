<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p89.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p91.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="eyatl"></A><b>Chapter&nbsp;16</b><h1>Configuring and Administering  DHCP Clients</h1>
<p><A NAME="indexterm-1510"></A>This chapter discusses the Dynamic Host Configuration Protocol
(DHCP) client DHCPv4, which enables DHCP servers to pass configuration parameters
such as IPv4 network addresses to IPv4 nodes. The chapter explains how the
client works, and how you can affect the behavior of the client. </p>
<p>This chapter contains the following information:</p>
<ul><li><p><A HREF="p90.html#geflo">About the Solaris DHCP Client</A></p>
</li>
<li><p><A HREF="p90.html#dhcp-config-67">Enabling and Disabling a Solaris DHCP Client</A></p>
</li>
<li><p><A HREF="p91.html#dhcp-overview-33a">DHCP Client Administration</A></p>
</li>
<li><p><A HREF="p91.html#dhcp-overview-35a">DHCP Client Systems With Multiple Network Interfaces</A></p>
</li>
<li><p><A HREF="p91.html#eyhuv">DHCP Client Host Names</A></p>
</li>
<li><p><A HREF="p92.html#dhcp-overview-5">DHCP Client Systems and Name Services</A></p>
</li>
<li><p><A HREF="p93.html#extkj">DHCP Client Event Scripts</A></p>
</li>
</ul>
<A NAME="geflo"></A><h2>About the Solaris DHCP Client</h2>
<p>The Solaris DHCP client is the <tt>dhcpagent</tt> daemon,
which is part of the Solaris Operating System (Solaris OS). When you install
the Solaris OS, you are prompted to use DHCP to configure network interfaces.
If you specify Yes, the DHCP client software is enabled on your system during
Solaris installation. You do not need to do anything else with the Solaris
client to use DHCP. The DHCP server's configuration determines what information
is given to DHCP client systems that use the DHCP service.</p>
<p>If a client system is already running the Solaris OS, but not using
DHCP, you can reconfigure the client system to use DHCP. You can also reconfigure
a DHCP client system so that it stops using DHCP and uses static network information
that you provide. See <A HREF="p90.html#dhcp-config-67">Enabling and Disabling a Solaris DHCP Client</A> for more information.</p>
<A NAME="gefmi"></A><h3>Logical Interfaces</h3>
<p>In the DHCPv4 client, each logical interface is independent and is an
administrative unit.  In addition to the zeroth logical interface (which defaults
to the interface MAC address as an identifier), the user may configure specific
logical interfaces to run DHCP by specifying a CLIENT_ID in the dhcpagent
configuration file.  For example:</p>
<p><tt>hme0:1.CLIENT_ID=orangutan</tt></p>
<A NAME="dhcp-overview-31a"></A><h3>DHCP Client Startup</h3>
<p><A NAME="indexterm-1511"></A><A NAME="indexterm-1512"></A>The <tt>dhcpagent</tt> daemon obtains configuration
information that is needed by other processes involved in booting the system.
For this reason, the system startup scripts start <tt>dhcpagent</tt> early
in the boot process and wait until the network configuration information from
the DHCP server arrives.</p>
<p><A NAME="indexterm-1513"></A>The presence of the file <tt>/etc/dhcp.</tt><i>interface<tt></i></tt> (for
example, <tt>/etc/dhcp.ce0</tt> on a Sun Fire&#153; 880
system) indicates to the startup scripts that DHCP is to be used on the specified
interface. Upon finding a <tt>dhcp.</tt><i>interface<tt></i></tt> file,
the startup scripts start <tt>dhcpagent</tt>.</p>
<p>After startup, <tt>dhcpagent</tt> waits until it receives
instructions to configure a network interface. The startup scripts issue the <tt>ifconfig <i>interface</i> dhcp start</tt> command,
which instructs <tt>dhcpagent</tt> to start DHCP as described in <A HREF="p65.html#dhcp-overview-3">How DHCP Works</A>. If commands are contained
within the <tt>dhcp.</tt><i>interface<tt></i></tt> file,
they are appended to the <tt>dhcp start</tt> option of <tt>ifconfig</tt>. See the <tt>ifconfig</tt>(1M) man
page for more information about options used with the <tt>ifconfig <i>interface</i> dhcp</tt> command.</p>
<A NAME="dhcp-overview-32a"></A><h3>How the DHCP Client Manages Network Configuration
Information</h3>
<p><A NAME="indexterm-1514"></A>After the information packet is obtained from a DHCP server, <tt>dhcpagent</tt> configures the network interface and brings up the interface.
The daemon controls the interface for the duration of the lease time for the
IP address, and maintains the configuration data in an internal table. The
system startup scripts use the <tt>dhcpinfo</tt> command to extract
configuration option values from the internal table. The values are used to
configure the system and enable it to communicate on the network.</p>
<p>The <tt>dhcpagent</tt> daemon waits passively until a period
of time elapses, usually half the lease time. The daemon then requests an
extension of the lease from a DHCP server. If <tt>dhcpagent</tt> finds
that the interface is down or that the IP address has changed, the daemon
does not control the interface until instructed by the <tt>ifconfig</tt> command
to do so. If <tt>dhcpagent</tt> finds that the interface is up and
the IP address hasn't changed, the daemon sends a request to the server for
a lease renewal. If the lease cannot be renewed, <tt>dhcpagent</tt> takes
down the interface at the end of the lease time.</p>
<p>Each time <tt>dhcpagent</tt> performs an action related to
the lease, the daemon looks for an executable file called <tt>/etc/dhcp/eventhook</tt>. If an executable file with this name is found, <tt>dhcpagent</tt> invokes
the executable. See <A HREF="p93.html#extkj">DHCP Client Event Scripts</A> for more information about using the event executable.</p>
<A NAME="dhcp-overview-34a"></A><h3>DHCP Client Shutdown</h3>
<p><A NAME="indexterm-1515"></A>When the DHCP client system shuts down normally, <tt>dhcpagent</tt> writes
the current configuration information to the file <tt>/etc/dhcp/</tt><i>interface<tt></i>.dhc</tt>. The lease is dropped rather than released,
so the DHCP server does not know that the IP address is not in active use.</p>
<p>If the lease is still valid when the system reboots, <tt>dhcpagent</tt> sends
an abbreviated request to use the same IP address and network configuration
information. If the DHCP server permits this request, <tt>dhcpagent</tt> can
use the information that it wrote to disk when the system shut down. If the
server does not permit the client to use the information, <tt>dhcpagent</tt> initiates
the DHCP protocol sequence described in <A HREF="p65.html#dhcp-overview-3">How DHCP Works</A>. As a result, the client obtains new network configuration
information.</p>
<A NAME="dhcp-config-67"></A><h2>Enabling and Disabling a Solaris DHCP Client</h2>
<p>To enable the DHCP client on a system that is already running the Solaris
OS and is not using DHCP, you must first unconfigure the system. When the
system boots, you must issue some commands to set up the system and enable
the DHCP client.</p>
<p>If your DHCP client is not a Solaris DHCP client, consult the client
documentation for instructions.</p>
<p><hr size="1" noshade><p><b>Note - </b>Routers, NIS or NIS+ servers, DNS servers, and other hosts that
are critical to the network should <b>not</b> be DHCP clients.
Hosts that provide services to the network should not rely on the network
to obtain their IP addresses. Hosts that are print servers or file servers
should have consistent IP addresses as well. However, print servers and file
servers can become DHCP clients to receive their network configurations through
DHCP. You can configure the DHCP server to provide consistent IP addresses
to such DHCP clients, as described in <A HREF="p82.html#dhcp-admin-161">Assigning a Reserved IP Address to a DHCP Client</A>.</p>
<hr size="1" noshade></p><A NAME="dhcp-config-105"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Enable the Solaris DHCP Client</h3>
<A NAME="indexterm-1516"></A><p>This procedure is necessary only if DHCP was not enabled during Solaris
installation.</p>
<ol><A NAME="dhcp-config-step-73"></A><li><p><b>Become superuser on the client system.</b></p></li>
<A NAME="dhcp-config-step-11"></A><li><p><b>If this system uses preconfiguration
instead of interactive configuration, edit the <tt>sysidcfg</tt> file.
Add the <tt>dhcp</tt> subkey to the <tt>network_interface</tt> keyword
in the <tt>sysidcfg</tt> file.</b></p><p>For example, <tt>network_interface=hme0
{dhcp}</tt>. See the <tt>sysidcfg</tt>(4) man
page for more information.</p>
</li>
<A NAME="dhcp-config-step-67"></A><li><p><b><A NAME="indexterm-1517"></A>Unconfigure and shut down the system.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>sys-unconfig</b></tt></pre>
</td></table><br><p>See the <tt>sys-unconfig</tt>(1M) man page for more information about the configuration
information that is removed by this command.</p>
</li>
<A NAME="dhcp-config-step-80"></A><li><p><b>Reboot the system after shutdown is complete.</b></p><p>If the system uses preconfiguration, the <tt>dhcp</tt> subkey
in the <tt>sysidcfg</tt> file configures the system to use the
DHCP client as the system boots.</p>
<p>If the system does not use preconfiguration,
you are prompted for system configuration information by <tt>sysidtool</tt> programs
when the system reboots. See the <tt>sysidtool</tt>(1M) man page for more information. </p>
</li>
<A NAME="dhcp-config-step-92"></A><li><p><b>When prompted to use DHCP to configure
network interfaces, specify Yes.</b></p></li>
</ol><A NAME="dhcp-config-104"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Disable a Solaris DHCP Client</h3>
<A NAME="indexterm-1518"></A><A NAME="indexterm-1519"></A><ol><A NAME="dhcp-config-step-85"></A><li><p><b>Become superuser on the client system.</b></p></li>
<A NAME="dhcp-config-step-120"></A><li><p><b>If you used a <tt>sysidcfg</tt> file
to preconfigure the system, remove the <tt>dhcp</tt> subkey from
the <tt>network_interface</tt> keyword.</b></p></li>
<A NAME="dhcp-config-step-79"></A><li><p><b><A NAME="indexterm-1520"></A>Unconfigure and shut down the system.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>sys-unconfig</b></tt></pre>
</td></table><br><p>See the <tt>sys-unconfig</tt>(1M) man page for more information about the configuration
information that is removed by this command.</p>
</li>
<A NAME="dhcp-config-step-91"></A><li><p><b>Reboot the system after shutdown is complete.</b></p><p>If the system uses preconfiguration, you are not prompted for
configuration information, and the DHCP client is not configured.</p>
<p>If
the system does not use preconfiguration, you are prompted for system configuration
information by <tt>sysidtool</tt> programs when the system reboots.
See the <tt>sysidtool</tt>(1M) man
page for more information.</p>
</li>
<A NAME="dhcp-config-step-93"></A><li><p><b>When prompted to use DHCP to configure
network interfaces, specify No.</b></p></li>
</ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p89.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p91.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

