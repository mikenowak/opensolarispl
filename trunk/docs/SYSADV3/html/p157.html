<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p156.html#mpoverview">30.&nbsp;&nbsp;Introducing IPMP (Overview)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p156.html#chapter1-2">Why You Should Use IPMP</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p156.html#mpoverview-2">IPMP Terminology and Concepts</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p156.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p158.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="emjim"></A><h4>Dynamic Reconfiguration</h4>
<A NAME="indexterm-2839"></A><A NAME="indexterm-2840"></A><A NAME="indexterm-2841"></A><p><b>Dynamic reconfiguration</b> (DR) is the ability to
reconfigure a system while the system is running, with little or no impact
on existing operations.  Not all Sun platforms support DR. Some Sun platforms
might only support DR of certain types of hardware.  On platforms that support
DR of NIC's, IPMP can be used to transparently fail over network access, providing
	uninterrupted network access to the system.</p>
<p>For more information on how IPMP supports DR, refer to <A HREF="p158.html#esqdy">IPMP and Dynamic Reconfiguration</A>.</p>
<A NAME="eyprl"></A><h2>Basic Requirements of IPMP</h2>
<A NAME="indexterm-2842"></A><A NAME="indexterm-2843"></A><A NAME="indexterm-2844"></A><p>IPMP is built into the Solaris Operating System (Solaris OS) and does
not require any special hardware.  Any interface that is supported by the
Solaris OS can be used with IPMP.  However,  IPMP does impose the following
requirements on your network configuration and topology:  </p>
<ul><li><p>All interfaces in an IPMP group must have unique MAC addresses. </p>
<p>Note that by default, the network interfaces on SPARC based systems
all share a single MAC address.  Thus, you must explicitly change the default
in order to use IPMP on SPARC based systems.  For more information, refer
to <A HREF="p160.html#emyil">How to Plan for an IPMP Group</A>.</p>
</li>
<li><p>All interfaces in an IPMP group must be of the same media
type. For more information, refer to <A HREF="p156.html#emjid">IPMP Group</A>.</p>
</li>
<li><p>All interfaces in an IPMP group must be on the same IP link.
For more information, refer to <A HREF="p156.html#emjid">IPMP Group</A>.</p>
</li>
<li><p>Depending on your failure detection requirements, you might
need to either use specific types of network interfaces or configure additional
IP addresses on each network interface.  Refer to <A HREF="p158.html#mpoverview-23">Link-Based Failure Detection</A> and <A HREF="p158.html#emqra">Probe-Based Failure Detection</A>.</p>
</li>
</ul>
<A NAME="emqwq"></A><h2>IPMP Addressing</h2>
<p>You can configure IPMP failure detection on both IPv4 networks and dual-stack,
IPv4 and IPv6 networks. Interfaces that are configured with IPMP support two
types of addresses: data addresses and test addresses.</p>
<A NAME="emqwg"></A><h3>Data Addresses</h3>
<A NAME="indexterm-2845"></A><A NAME="indexterm-2846"></A><A NAME="indexterm-2847"></A><p><b>Data addresses</b> are the conventional IPv4 and IPv6
addresses that are assigned to an interface of a NIC at boot time or manually,
through the <tt>ifconfig</tt> command. The standard IPv4 and, if
applicable, IPv6 packet traffic through an interface is considered to be <b>data traffic</b>.</p>
<A NAME="emqvv"></A><h3>Test Addresses</h3>
<A NAME="indexterm-2848"></A><A NAME="indexterm-2849"></A><p><A NAME="indexterm-2850"></A><b>Test addresses</b> are IPMP-specific addresses
that are used by the <tt>in.mpathd</tt> daemon. For an interface
to use probe-based failure and repair detection, that interface must be configured
with at least one test address.</p>
<p><hr size="1" noshade><p><b>Note - </b>You need to configure test addresses only if you want to use probe-based
failure detection.</p>
<hr size="1" noshade></p><p><A NAME="indexterm-2851"></A><A NAME="indexterm-2852"></A><A NAME="indexterm-2853"></A><A NAME="indexterm-2854"></A>The <tt>in.mpathd</tt> daemon uses test addresses to
exchange ICMP probes, also called <b>probe traffic</b>, with
other targets on the IP link. Probe traffic helps to determine the status
of the interface and its NIC, including whether an interface has failed. The
probes verify that the send and receive path to the interface is working correctly. </p>
<p>Each interface can be configured with an IP test address. For an interface
on a dual-stack network, you can configure an IPv4 test address, an IPv6 test
address, or both IPv4 and IPv6 test addresses.</p>
<p>After an interface fails, the test addresses remain on the failed interface
so that <tt>in.mpathd</tt> can continue to send probes to check
for subsequent repair. You must specifically configure test addresses so that
applications do not accidentally use them. For more information, refer to <A HREF="p157.html#emycj">Preventing Applications From Using Test Addresses</A>.</p>
<p>For more information on probe-based failure detection, refer to <A HREF="p158.html#emqra">Probe-Based Failure Detection</A>.</p>
<A NAME="emqyk"></A><h4>IPv4 Test Addresses</h4>
<p><A NAME="indexterm-2855"></A><A NAME="indexterm-2856"></A><A NAME="indexterm-2857"></A>In general, you can use any IPv4 address on your subnet as a test
address. IPv4 test addresses do not need to be routeable. Because IPv4 addresses
are a limited resource for many sites, you might want to use non-routeable
RFC 1918 private addresses as test addresses. Note that the <tt>in.mpathd</tt> daemon
exchanges only ICMP probes with other hosts on the same subnet as the test
address.  If you do use RFC 1918-style test addresses, be sure to configure
other systems, preferably routers, on the IP link with addresses on the appropriate
RFC 1918 subnet. The <tt>in.mpathd</tt> daemon can then successfully
exchange probes with target systems.  </p>
<p>The IPMP examples use RFC 1918 addresses from the <tt>192.168.0/24</tt> network
as IPv4 test addresses.  For more information about RFC 1918 private addresses,
refer to <A  HREF="http://www.ietf.org/rfc/rfc1918.txt?number=1918">RFC 1918, Address Allocation for Private Internets.</A></p>
<p>To configure IPv4 test addresses, refer to the task <A HREF="p161.html#emqul">How to Configure an IPMP Group With Multiple Interfaces</A>.</p>
<A NAME="emqxv"></A><h4>IPv6 Test Addresses</h4>
<A NAME="indexterm-2858"></A><A NAME="indexterm-2859"></A><p>The only valid IPv6 test address is the link-local address of a physical
interface. You do not need a separate IPv6 address to serve as an IPMP test
address. The IPv6 link-local address is based on the Media Access Control
(MAC ) address of the interface. Link-local addresses are automatically configured
when the interface becomes IPv6-enabled at boot time or when the interface
is manually configured through <tt>ifconfig</tt>. </p>
<p>To identify the link-local address of an interface, run the <tt>ifconfig</tt> <i>interface</i> command on an IPv6-enabled
node. Check the output for the address that begins with the prefix <tt>fe80</tt>,
the link-local prefix. The <tt>NOFAILOVER</tt> flag in the following <tt>ifconfig</tt> output indicates that the link-local address <tt>fe80::a00:20ff:feb9:17fa/10</tt> of  the <tt>hme0</tt> interface is used as the test address. </p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>hme0: flags=a000841&lt;UP,RUNNING,MULTICAST,IPv6,NOFAILOVER> mtu 1500 index 2
        	inet6 fe80::a00:20ff:feb9:17fa/10 </pre>
</td></table><br><p>For more information on link-local addresses, refer to <A HREF="p12.html#ipv6-overview-15">Link-Local Unicast Address</A>.</p>
<p>When an IPMP group has both IPv4 and IPv6 plumbed on all the group's
interfaces, you do not need to configure separate IPv4 test addresses. The <tt>in.mpathd</tt> daemon can use the IPv6 link-local addresses as test
addresses.</p>
<p>To create an IPv6 test address, refer to the task <A NAME="indexterm-2860"></A><A HREF="p161.html#emqul">How to Configure an IPMP Group With Multiple Interfaces</A>.</p>
<A NAME="emycj"></A><h3>Preventing Applications From Using Test Addresses</h3>
<A NAME="indexterm-2861"></A><p><A NAME="indexterm-2862"></A><A NAME="indexterm-2863"></A>After you have configured a test address, you need to ensure that
this address is not used by applications. Otherwise, if the interface fails,
the application is no longer reachable because test addresses do not fail
over during the failover operation. To ensure that IP does not choose the
test address for normal applications, mark the test address as <tt>deprecated</tt>.</p>
<p>IPv4 does not use a deprecated address as a source address for any communication,
unless an application explicitly binds to the address. The <tt>in.mpathd</tt> daemon
explicitly binds to such an address in order to send and receive probe traffic.</p>
<p>Because IPv6 link-local addresses are usually not present in a name
service, DNS and NIS applications do not use link-local addresses for communication.
Consequently, you must not mark IPv6 link-local addresses as <tt>deprecated</tt>.</p>
<p>IPv4 test addresses should not be placed in the DNS and NIS name service
tables. In IPv6, link-local addresses  are not normally placed in the name
service tables.</p>
<A NAME="eobra"></A><h2>IPMP Interface Configurations</h2>
<A NAME="indexterm-2864"></A><p><A NAME="indexterm-2865"></A>An IPMP configuration typically consists of two or more physical
interfaces  on the same system that are attached to the same IP link. These
physical interfaces might or might not be on the same NIC. The interfaces
are configured as members of the same IPMP group.   If the system has additional
interfaces on a second IP link, you  must configure these interfaces as another
IPMP group.</p>
<p>A single interface can be configured in its own IPMP group. The single
interface IPMP group has the same behavior as an IPMP group with multiple
interfaces. However, failover and failback cannot occur  for an IPMP group
with only one interface.</p>
<A NAME="emylr"></A><h3>Standby Interfaces in an IPMP Group</h3>
<A NAME="indexterm-2866"></A><A NAME="indexterm-2867"></A><A NAME="indexterm-2868"></A><p>The <b>standby interface</b> in an IPMP group is not used
for data traffic unless some other interface in the group fails. When a failure
occurs, the data addresses on the failed interface migrate to the standby
interface. Then, the standby interface is treated the same as other active
interfaces until the failed interface is repaired. Some failovers might not
choose a standby interface. Instead, these failovers might choose an active
interface with fewer data addresses that are configured as UP than the standby
interface. </p>
<p><A NAME="indexterm-2869"></A><A NAME="indexterm-2870"></A>You should configure only test addresses on a standby interface.
IPMP does not permit you to add a data address to an interface that is configured
through the <tt>ifconfig</tt> command as <tt>standby</tt>.
Any attempt to create this type of configuration will fail. Similarly, if
you configure as <tt>standby</tt> an interface that
already has data addresses, these addresses automatically fail over to another
interface in the IPMP group.  Due to these restrictions, you must use 	the <tt>ifconfig</tt> command to mark any test addresses as <tt>deprecated</tt> and <tt>-failover</tt> prior to setting the interface as <tt>standby</tt>. To configure standby interfaces, refer to <A HREF="p162.html#enfiu">How to Configure a Standby Interface for an IPMP Group</A>.<A NAME="indexterm-2871"></A><A NAME="indexterm-2872"></A></p>
<A NAME="emrap"></A><h3>Common IPMP Interface Configurations</h3>
<p>As mentioned in <A HREF="p157.html#emqwq">IPMP Addressing</A>, interfaces
in an IPMP group handle regular data traffic and probe traffic, depending
on the interfaces' configuration. You use IPMP options of the <tt>ifconfig</tt> command
to create the configuration. </p>
<p>An <b>active interface</b> is a physical interface that
transmits both data traffic and probe traffic. You configure the interface
as "active" by performing either the task <A HREF="p161.html#emqul">How to Configure an IPMP Group With Multiple Interfaces</A> or the task <A HREF="p163.html#enfoy">How to Configure a Single Interface IPMP Group</A>.</p>
<p>The following are two common types of IPMP configurations:</p>
<table border="0" cellspacing="5"><tr><td valign="top"><p><b>Active-active configuration</b></p></td><td valign="top"><p>A two interface IPMP group where both interfaces are "active,"
that is they might be transmitting both probe and data traffic at all times.<A NAME="indexterm-2873"></A><A NAME="indexterm-2874"></A></p>
</td></tr><tr><td valign="top"><p><b>Active-standby configuration</b></p></td><td valign="top"><p><A NAME="indexterm-2875"></A><A NAME="indexterm-2876"></A>A two interface IPMP group where one interface is configured as "standby."</p>
</td></tr></table>
<A NAME="eojdb"></A><h4>Checking the Status of an Interface</h4>
<A NAME="indexterm-2877"></A><A NAME="indexterm-2878"></A><p>You can check the status of an interface by issuing the <tt>ifconfig</tt> <i>interface</i> command. For general information on <tt>ifconfig</tt> status
reporting, refer to <A HREF="p41.html#ipconfig-46">How to Get Information About a Specific Interface</A>. </p>
<p>For example, you can use the <tt>ifconfig</tt> command to
obtain the status of a standby interface. When the standby interface is not
hosting any data address, the interface has the <tt>INACTIVE</tt> flag
for its status. You can observe this flag in the status lines for the interface
in the <tt>ifconfig</tt> output. </p>
<A NAME="emqqq"></A><h2>IPMP Failure Detection and Recovery Features</h2>
<p><A NAME="indexterm-2879"></A><A NAME="indexterm-2880"></A>The <tt>in.mpathd</tt> daemon handles the following
types of failure detection:</p>
<ul><li><p>Link-based failure detection, if supported by the NIC driver</p>
</li>
<li><p>Probe-based failure detection, when test addresses are configured</p>
</li>
<li><p>Detection of interfaces that were missing at boot time</p>
</li>
</ul>
<p>The <tt>in.mpathd</tt>(1M) man
page completely describes how the <tt>in.mpathd</tt> daemon handles
the detection of interface failures.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p156.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p158.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

