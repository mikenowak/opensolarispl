<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p115.html#ipsecref-1">21.&nbsp;&nbsp;IP Security Architecture (Reference)</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p115.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p117.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="ipsecref-24"></A><h2>Security Associations Database for IPsec</h2>
<A NAME="indexterm-1924"></A><A NAME="indexterm-1925"></A><A NAME="indexterm-1926"></A><A NAME="indexterm-1927"></A><p>Information on key material for IPsec security services is maintained
in a security associations database (<A HREF="p193.html#glossary-58">SADB</A>).
Security associations (SAs) protect inbound packets and outbound packets.
The SADBs are maintained by a user process, or possibly multiple cooperating
processes, that send messages over a special kind of socket. This method of
maintaining SADBs is analogous to the method that is described in the <tt>route</tt>(7P) man page. Only superuser
or a user who has assumed an equivalent role can access the database.</p>
<p>The <tt>in.iked</tt> daemon and the <tt>ipseckey</tt> command
use the <tt>PF_KEY</tt> socket interface to maintain SADBs. For more information
on how SADBs handle requests and messages, see the <tt>pf_key</tt>(7P) man page.</p>
<A NAME="ipsecref-25"></A><h2>Utilities for Key Generation in IPsec</h2>
<A NAME="indexterm-1928"></A><A NAME="indexterm-1929"></A><A NAME="indexterm-1930"></A><A NAME="indexterm-1931"></A><A NAME="indexterm-1932"></A><A NAME="indexterm-1933"></A><p>The IKE protocol provides automatic key management for IPv4 and IPv6
addresses. See <A HREF="p119.html#ike-task-1">Chapter&nbsp;23, Configuring IKE (Tasks)</A> for instructions on how to set up IKE. The manual keying
utility is the <tt>ipseckey</tt> command, which is described in
the <tt>ipseckey</tt>(1M) man
page.</p>
<p>You use the <tt>ipseckey</tt> command to manually populate
the security association databases (SADBs) when automated key management is
not used. When you invoke the <tt>ipseckey</tt> command with no
arguments, the command enters an interactive mode and displays a prompt that
enables you to make entries. Some commands require an explicit security association
(SA) type, while others permit you to specify the SA type and act on all SA
types.</p>
<p>While the <tt>ipseckey</tt> command has only a limited number
of general options, the command supports a rich command language. You can
specify that requests be delivered by means of a programmatic interface specific
for manual keying. For additional information, see the <tt>pf_key</tt>(7P) man page.</p>
<A NAME="ipsecref-41"></A><h3>Security Considerations for <tt>ipseckey</tt></h3>
<p><A NAME="indexterm-1934"></A><A NAME="indexterm-1935"></A><A NAME="indexterm-1936"></A>The <tt>ipseckey</tt> command enables superuser or a
role with the Network Security profile to enter sensitive cryptographic keying
information. If an adversary gains access to this information, the adversary
can compromise the security of IPsec traffic. You should consider the following
issues when you handle keying material and use the <tt>ipseckey</tt> command:</p>
<ul><li><p>Have you refreshed the keying material? Periodic key refreshment
is a fundamental security practice. Key refreshment guards against potential
weaknesses of the algorithm and keys, and limits the damage of an exposed
key.</p>
</li>
<li><p>Is the TTY going over a network? Is the <tt>ipseckey</tt> command
in interactive mode?</p>
<ul><li><p>In interactive mode, the security of the keying material is
the security of the network path for this TTY's traffic. You should avoid
using the <tt>ipseckey</tt> command over a clear-text telnet or
rlogin session.</p>
</li>
<li><p>Even local windows might be vulnerable to attacks by a concealed
program that reads window events.</p>
</li>
</ul>
</li>
<li><p>Have you used the <tt>-f</tt> option? Is the file being
accessed over the network? Can the file be read by the world?</p>
<ul><li><p>An adversary can read a network-mounted file as the file is
being read. You should avoid using a world-readable file that contains keying
material.</p>
</li>
<li><p>Protect your naming system. If the following two conditions
are met, then your host names are no longer trustworthy:</p>
<ul><li><p>Your source address is a host that can be looked up over the
network.</p>
</li>
<li><p>Your naming system is compromised.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Security weaknesses often arise from the misapplication of tools, not
from the actual tools. You should be cautious when using the <tt>ipseckey</tt> command.
Use a console or other hard-connected TTY for the safest mode of operation.</p>
<A NAME="ipsecref-26"></A><h2><tt>snoop</tt> Command and IPsec</h2>
<p><A NAME="indexterm-1937"></A><A NAME="indexterm-1938"></A><A NAME="indexterm-1939"></A><A NAME="indexterm-1940"></A><A NAME="indexterm-1941"></A>The <tt>snoop</tt> command can parse AH and ESP headers.
Because ESP encrypts its data, the <tt>snoop</tt> command cannot
see encrypted headers that are protected by ESP. AH does not encrypt data.
Therefore, traffic that is protected by AH can be inspected with the <tt>snoop</tt> command. The <tt>-V</tt> option to the command shows when
AH is in use on a packet. For more details, see the <tt>snoop</tt>(1M) man page.</p>
<p>For a sample of verbose <tt>snoop</tt> output on a protected
packet, see <A HREF="p110.html#ipsec-mgtasks-11">How to Verify That Packets Are Protected With IPsec</A>.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p115.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p117.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

