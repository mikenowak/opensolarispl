<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p132.html#ipfilter-admin-1">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p133.html#eubbd">Working With Solaris IP Filter Rule Sets</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p133.html#ezsvx">How to View the Active Packet Filtering Rule Set</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p133.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p135.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="fahqf"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to View the Inactive Packet Filtering Rule Set</h4>
<A NAME="indexterm-2369"></A><A NAME="indexterm-2370"></A><A NAME="indexterm-2371"></A><A NAME="indexterm-2372"></A><A NAME="indexterm-2373"></A><A NAME="indexterm-2374"></A><ol><li><p><b>Assume a role that includes the IP Filter Management rights profile,
or become superuser.</b></p><p>You can assign the IP Filter Management rights
profile to a role that you create. To create the role and assign the role
to a user, see "Configuring RBAC (Task Map)" in <i>System Administration Guide: Security Services</i>.</p>
</li>
<li><p><b>View the inactive packet filtering rule set.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipfstat -I -io</b></tt></pre>
</td></table><br></li>
</ol><A NAME="fahqh"></A><h5>Example 26-2 &nbsp;&nbsp;Viewing the Inactive Packet Filtering Rule Set</h5>
<p>The following example shows output from the inactive packet filtering
rule set.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipfstat -I -io</b></tt>
pass out quick on dmfe1 all
pass in quick on dmfe1 all</pre>
</td></table><br><A NAME="ettmd"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Activate a Different or Updated Packet Filtering
Rule Set</h4>
<A NAME="indexterm-2375"></A><A NAME="indexterm-2376"></A><A NAME="indexterm-2377"></A><A NAME="indexterm-2378"></A><A NAME="indexterm-2379"></A><A NAME="indexterm-2380"></A><A NAME="indexterm-2381"></A><p>Use the following procedure if you want to perform either of the following
tasks:</p>
<ul><li><p>Activate a packet filtering rule set other than the one that
is currently in use by Solaris IP Filter.</p>
</li>
<li><p>Reload the same filtering rule set that has been newly updated.</p>
</li>
</ul>
<ol><li><p><b>Assume a role that includes the IP Filter Management rights profile,
or become superuser.</b></p><p>You can assign the IP Filter Management rights
profile to a role that you create. To create the role and assign the role
to a user, see "Configuring RBAC (Task Map)" in <i>System Administration Guide: Security Services</i>.</p>
</li>
<li><p><b>Choose one of the following steps:</b></p><ul><li><p>Create a new rule set in a separate file of your choice if
you want to activate an entirely different rule set.</p>
</li>
<li><p>Update the current rule set by editing the configuration file
that contains that rule set.</p>
</li>
</ul>
</li>
<li><p><b>Remove the current rule set and load the new rule set.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipf -Fa -f </tt><i>filename<tt></i></b></tt></pre>
</td></table><br><p>The <i>filename</i> can either be the new file with
the new rule set or the updated file that contains the active rule set.</p>
<p>The active rule set is removed from the kernel. The rules in the <i>filename</i> file become the active rule set.</p>
<p><hr size="1" noshade><p><b>Note - </b>You still need to issue the command even if you are reloading
the current configuration file. Otherwise, the old rule set continues to be
operative, and the modified rule set in the updated configuration file is
not applied.</p>
<p>Do not use commands such as <tt>ipf <tt>-D</tt></tt> or <tt>svcadm restart</tt> to load the updated rule set. Such commands expose
your network by disabling the firewall first before loading the new rule set.</p>
<hr size="1" noshade></p></li>
</ol><A NAME="fahsf"></A><h5>Example 26-3 &nbsp;&nbsp;Activating a Different Packet Filtering Rule Set</h5>
<p>The following example shows how to replace one packet filtering rule
set with another packet filtering rule set in a separate configuration file, <tt>/etc/ipf/ipf.conf</tt>.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipfstat -io</b></tt>
empty list for ipfilter(out)
pass in quick on dmfe all
# <tt><b>ipf -Fa -f /etc/ipf/ipf.conf</b></tt>
# <tt><b>ipfstat -io</b></tt>
empty list for ipfilter(out)
block in log quick from 10.0.0.0/8 to any</pre>
</td></table><br><A NAME="gdltk"></A><h5>Example 26-4 &nbsp;&nbsp;Reloading an Updated Packet Filtering Rule Set</h5>
<p>The following example shows how to reload a packet filtering rule set
that is currently active and which is then updated. In this example, the file
in use is <tt>/etc/ipf/ipf.conf</tt>.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipfstat -io</b></tt> (Optional)
empty list for ipfilter (out)
block in log quick from 10.0.0.0/8 to any

(Edit the <tt>/etc/ipf/ipf.conf</tt> configuration file.)

# <tt><b>ip -Fa -f /etc/ipf/ipf.conf</b></tt>
# <tt><b>ipfstat -io</b></tt> (Optional)
empty list for ipfilter (out)
block in log quick from 10.0.0.0/8 to any
block in quick on elx10 from 192.168.0.0/12 to any</pre>
</td></table><br><A NAME="faaff"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Remove a Packet Filtering Rule Set</h4>
<A NAME="indexterm-2382"></A><A NAME="indexterm-2383"></A><A NAME="indexterm-2384"></A><ol><li><p><b>Assume a role that includes the IP Filter Management rights profile,
or become superuser.</b></p><p>You can assign the IP Filter Management rights
profile to a role that you create. To create the role and assign the role
to a user, see "Configuring RBAC (Task Map)" in <i>System Administration Guide: Security Services</i>.</p>
</li>
<li><p><b>Remove the rule set.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipf -F [a|i|o]</b></tt></pre>
</td></table><br><table border="0" cellspacing="5"><tr><td valign="top"><p><tt>-a</tt></p></td><td valign="top"><p>Removes all filtering rules from the rule set.</p>
</td></tr><tr><td valign="top"><p><tt>-i</tt></p></td><td valign="top"><p>Removes the filtering rules for incoming packets.</p>
</td></tr><tr><td valign="top"><p><tt>-o</tt></p></td><td valign="top"><p>Removes the filtering rules for outgoing packets.</p>
</td></tr></table>
</li>
</ol><A NAME="fahsh"></A><h5>Example 26-5 &nbsp;&nbsp;Removing a Packet Filtering Rule Set</h5>
<p>The following example shows how to remove all filtering rules from the
active filtering rule set.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipfstat -io</b></tt>
block out log on dmf0 all
block in log quick from 10.0.0.0/8 to any
# <tt><b>ipf -Fa</b></tt>
# <tt><b>ipfstat -io</b></tt>
empty list for ipfilter(out)
empty list for ipfilter(in)</pre>
</td></table><br><A NAME="ettmc"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Append Rules to the Active Packet Filtering
Rule Set</h4>
<A NAME="indexterm-2385"></A><A NAME="indexterm-2386"></A><A NAME="indexterm-2387"></A><A NAME="indexterm-2388"></A><ol><li><p><b>Assume a role that includes the IP Filter Management rights profile,
or become superuser.</b></p><p>You can assign the IP Filter Management rights
profile to a role that you create. To create the role and assign the role
to a user, see "Configuring RBAC (Task Map)" in <i>System Administration Guide: Security Services</i>.</p>
</li>
<li><p><b>Use one of the following methods to append rules to the active
rule set:</b></p><ul><li><p>Append rules to the rule set at the command line using the <tt>ipf <tt>-f</tt> -</tt> command.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>echo "block in on dmfe1 proto tcp from 10.1.1.1/32 to any" | ipf -f -</b></tt></pre>
</td></table><br></li>
<li><p>Perform the following commands:</p>
<ol Type="a"><li><p>Create a rule set in a file of your choice.</p>
</li>
<li><p>Add the rules you have created to the active rule set.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipf -f </tt><i>filename<tt></i></b></tt></pre>
</td></table><br><p>The rules in <i>filename</i> are added to the end
of the active rule set. Because Solaris IP Filter uses a "last matching rule"
algorithm, the added rules determine filtering priorities, unless you use
the <tt>quick</tt> keyword. If the packet matches a rule containing
the <tt>quick</tt> keyword, the action for that rule is taken, and
no subsequent rules are checked.</p>
</li>
</ol>
</li>
</ul>
</li>
</ol><A NAME="fahsj"></A><h5>Example 26-6 &nbsp;&nbsp;Appending Rules to the Active Packet Filtering Rule Set</h5>
<p>The following example shows how to add a rule to the active packet filtering
rule set from the command line.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ipfstat -io</b></tt>
empty list for ipfilter(out)
block in log quick from 10.0.0.0/8 to any
# <tt><b>echo "block in on dmfe1 proto tcp from 10.1.1.1/32 to any" | ipf -f -</b></tt>
# <tt><b>ipfstat -io</b></tt>
empty list for ipfilter(out)
block in log quick from 10.0.0.0/8 to any
block in on dmfe1 proto tcp from 10.1.1.1/32 to any</pre>
</td></table><br>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p133.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p135.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

