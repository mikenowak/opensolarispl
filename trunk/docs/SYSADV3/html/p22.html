<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p17.html#ipconfig-1">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p20.html#gcvjj">Packet Forwarding and Routing on IPv4 Networks</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p21.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p23.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="gcvjx"></A><h3>Configuring Routing for Single-Interface Systems</h3>
<p><A NAME="indexterm-585"></A>Single-interface
hostsneed to implement
some form of routing. If the host is to obtain its routes from one or more local default routers, then you must configure the host to use static routing. Otherwise, 
dynamic routing is recommended
for the host. The following procedures contain the instructions for enabling both routing types.</p>
<A NAME="ipconfig-125"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Enable Static Routing on a Single-Interface
Host</h4>
<p><A NAME="indexterm-586"></A><A NAME="indexterm-587"></A>This procedure enables static routing on a single-interface host. Hosts that use static routing
do not run a
dynamic routing protocolsuch as RIP. Instead, the host must rely
on the services of a default router for routing information. The figure <A HREF="p20.html#gcxjg">IPv4 Autonomous System Topology</A> shows several default routers and their client
hosts. If you supplied the name of a default router when you installed a particular host, 
that host is already configured to use static routing. </p>
<p><hr size="1" noshade><p><b>Note - </b>You can also use the following procedure to configure static routing
on a multihomed host.</p>
<hr size="1" noshade></p><p>For  information about the <tt>/etc/defaultrouter</tt> file, see <A HREF="p50.html#ipconfig-17"><tt>/etc/defaultrouter</tt> File</A>.
For information about static routing and the routing table, refer to <A HREF="p21.html#gdyen"> Routing Tables and Routing Types</A>.</p>
<ol><li><p><b>On the single interface host, assume the Primary Administrator
role, or become superuser.</b></p><p>The Primary Administrator role includes
the Primary Administrator profile. To create the role and assign the role
to a user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<li><p><b>Verify whether
the <tt>/etc/defaultrouter </tt>file is present on the host.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cd /etc</b></tt>
# <tt><b>ls | grep defaultrouter</b></tt></pre>
</td></table><br></li>
<li><p><b>Open a text editor to create
or modify the <tt>/etc/defaultrouter</tt> file </b></p></li>
<A NAME="ipconfig-step-14"></A><li><p><b>Add an entry for thedefault router.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>vi  /etc/defaultrouter</b></tt>
<i>router-IP</i>
       </pre>
</td></table><br><p><A NAME="indexterm-588"></A><A NAME="indexterm-589"></A><A NAME="indexterm-590"></A>where <i>router-IP</i> indicates
the IP address of the default router for the host to use.</p>
</li>
<li><p><b>Verify that
routing and packet forwarding are not running on the host.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>routeadm</b></tt>
   Configuration   Current              Current
                     Option   Configuration        System State
---------------------------------------------------------------
               IPv4 routing   disabled             disabled
               IPv6 routing   disabled             disabled
            IPv4 forwarding   disabled            disabled
            IPv6 forwarding   disabled             disabled

           Routing services   "route:default ripng:default"</pre>
</td></table><br></li>
<li><p><b>Add an entry for the default router in the local <tt>/etc/inet/hosts</tt> file.</b></p><p>For information about configuring <tt>/etc/inet/hosts</tt>,
refer to <A HREF="p19.html#gbwxb">How to Change the IPv4 Address and Other Network Configuration Parameters</A>.</p>
</li>
</ol><A NAME="geegq"></A><h5>Example 5-7 &nbsp;&nbsp;Configuring a Default Router and Static Routing for a Single-Interface
Host</h5>
<p><A NAME="indexterm-591"></A>The following example shows how to configure static routing for <tt>hostb</tt>, a single-interface host on the network <tt>172.20.1.0</tt> that
is shown in <A HREF="p20.html#gdcvl">Figure 5-2</A>. <tt>hostb</tt> needs
to use Router 2 as its default router.</p>
<p>First, you would log in to <tt>hostb</tt> as superuser, or
assume an equivalent role. Then, you would determine whether the <tt>/etc/defaultrouter</tt> file is present on the host:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cd /etc</b></tt>
# <tt><b>ls | grep defaultrouter</b></tt></pre>
</td></table><br><p>No response from <tt>grep</tt> indicates that you need to
create the <tt>/etc/defaultrouter</tt> file.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>vi /etc/defaultrouter</b></tt>
<tt><b>172.20.1.10</b></tt></pre>
</td></table><br><p>The entry in the <tt>/etc/defaultrouter</tt> file is the
IP address of the interface on Router 2, which is attached to the <tt>172.20.1.0</tt> network. Next, you verify whether the host currently enables packet
forwarding or routing.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>routeadm</b></tt>
   Configuration   Current              Current
                     Option   Configuration        System State
---------------------------------------------------------------
               IPv4 routing   disabled             disabled
               IPv6 routing   disabled             disabled
            IPv4 forwarding   enabled              enabled
            IPv6 forwarding   disabled             disabled

           Routing services   "route:default ripng:default"</pre>
</td></table><br><p>Packet forwarding is enabled for this particular host. You would turn
it off as follows:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>svcadm disable ipv4-forwarding</b></tt></pre>
</td></table><br><p>Lastly, you would make sure that the host's <tt>/etc/inet/hosts</tt> file
has an entry for the new default router.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>vi /etc/inet/hosts</b></tt>
127.0.0.1           localhost
172.20.1.18         host2    #primary network interface for host2
<tt><b>172.20.1.10         router2  #default router for host2</b></tt></pre>
</td></table><br><A NAME="ipconfig-15"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Enable Dynamic Routing on a Single-Interface
Host</h4>
<p><A NAME="indexterm-592"></A>Dynamic routing is the easiest way
to manage routing on a host. Hosts that use dynamic routing
run the routing protocols provided by the <tt>in.routed</tt> daemon for IPv4
or <tt>in.ripngd</tt> daemon for IPv6. Use the next procedure
to enable IPv4 dynamic
routing on a single interface
host. For more information about dynamic routing, refer
to <A HREF="p20.html#gcvjj">Packet Forwarding and Routing on IPv4 Networks</A>.</p>
<ol><li><p><b>On the host, assume the Primary Administrator role or become superuser.</b></p><p>The Primary Administrator role includes the Primary Administrator profile.
To create the role and assign the role to a user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<A NAME="ipconfig-step-18"></A><li><p><b><A NAME="indexterm-593"></A><A NAME="indexterm-594"></A><A NAME="indexterm-595"></A><A NAME="indexterm-596"></A>Verify whether the <tt>/etc/defaultrouter</tt> file exists.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cd /etc</b></tt>
# <tt><b>ls | grep defaultrouter</b></tt></pre>
</td></table><br></li>
<li><p><b>If <tt>/etc/defaultrouter</tt> exists, delete any entry that you find there.</b></p><p>An empty <tt>/etc/defaultrouter</tt> file forces the host to use dynamic routing.</p>
</li>
<li><p><b>Verify whether packet forwarding and routing are enabled
on the host.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>routeadm</b></tt>
   Configuration   Current              Current
                     Option   Configuration        System State
---------------------------------------------------------------
               IPv4 routing   disabled             disabled
               IPv6 routing   disabled             disabled
            IPv4 forwarding   enabled              enabled
            IPv6 forwarding   disabled             disabled

           Routing services   "route:default ripng:default"</pre>
</td></table><br></li>
<li><p><b>If packet forwarding is enabled, turn it off </b></p><p>Use
either of the following commands:</p>
<ul><li><p>For the <tt>routeadm</tt> command, type the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>routeadm -d ipv4-forwarding -u</b></tt></pre>
</td></table><br></li>
<li><p>To use SMF, type the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>svcadm disable ipv4-forwarding</b></tt></pre>
</td></table><br></li>
</ul>
</li>
<li><p><b>Enable routing protocols on the host.<A NAME="indexterm-597"></A></b></p><p>Use either of the following commands:</p>
<ul><li><p>For the <tt>routeadm</tt> command, type the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>routeadm -e ipv4-routing -u</b></tt></pre>
</td></table><br></li>
<li><p>To use SMF, type the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre>#<tt><b>svcadm enable route:default</b></tt> </pre>
</td></table><br></li>
</ul>
<p>Now IPv4 dynamic routing is enabled. The host's routing table is dynamically maintained by
the <tt>in.routed</tt> daemon.</p>
</li>
</ol><A NAME="geekw"></A><h5>Example 5-8 &nbsp;&nbsp;Running Dynamic Routing on a Single-Interface Host</h5>
<p><A NAME="indexterm-598"></A>The following example shows how to configure dynamic routing for <tt>hosta</tt>, a single-interface host on the network <tt>192.168.5.0</tt> that
is shown in <A HREF="p20.html#gdcvl">Figure 5-2</A>. <tt>hosta</tt> currently
uses Router 1 as its default router. However, <tt>hosta</tt> now
needs to run dynamic routing.</p>
<p>First, you would log in to <tt>hosta</tt> as superuser or
assume an equivalent role. Then, you would determine whether the <tt>/etc/defaultrouter</tt> file is present on the host:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>cd /etc</b></tt>
# <tt><b>ls | grep defaultrouter</b></tt>
defaultrouter</pre>
</td></table><br><p>The response from <tt>grep</tt> indicates that a <tt>/etc/defaultrouter</tt> file exists for <tt>hosta</tt>. </p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>vi /etc/defaultrouter</b></tt>
192.168.5.10</pre>
</td></table><br><p>The file has the entry <tt>192.168.5.10</tt>, which is the
IP address for Router 1. You would delete this entry to enable static routing.
Next, you would need to verify whether packet forwarding and routing are already
enabled for the host.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>routeadm</b></tt>   Configuration   Current              Current
                     Option   Configuration        System State
---------------------------------------------------------------
               IPv4 routing   disabled             disabled
               IPv6 routing   disabled             disabled
            IPv4 forwarding   disabled             disabled
            IPv6 forwarding   disabled             disabled

           Routing services   "route:default ripng:default"</pre>
</td></table><br><p>Both routing and packet forwarding are turned off for <tt>hosta</tt>.
Turn on routing to complete the configuration of dynamic routing for <tt>hosta</tt>, as follows:</p>
<p>#<tt><b>svcadm enable route:default</b></tt></p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p21.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p23.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

