<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@16097-->
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=iso-8859-1">
<title>System Administration Guide: IP Services</title>
<link rel="stylesheet" type="text/css" href="css/default.css">
<!--stopindex-->
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<A href="toc.html">System Administration Guide: IP Services</A> <font color="red">&gt;&gt;</font> <nobr><A HREF="p160.html#deploynetmult-56">31.&nbsp;&nbsp;Administering IPMP (Tasks)</A></nobr> <font color="red">&gt;&gt;</font> <nobr><A HREF="p160.html#deploynetmult-57">Configuring IPMP Groups</A></nobr>&nbsp;
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="grey1"><td></td><td align="right"><A HREF="p162.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p164.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<A NAME="mpoverview-10"></A><h3>Configuring IPMP Groups With a Single Physical
Interface</h3>
<A NAME="indexterm-2960"></A><p>When you have only one interface in an IPMP group, failover is not possible.
However, you can enable failure detection on that interface by assigning the
interface to an IPMP group. You do not have to configure a dedicated test
IP address to establish failure detection for a single interface IPMP group.
You can use a single IP address for sending data and detecting failure. </p>
<A NAME="enfoy"></A><h4><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Configure a Single Interface IPMP Group</h4>
<ol><li><p><b>On the system with the prospective single interface IPMP group,
assume the Primary Administrator role or become superuser.</b></p><p>The
Primary Administrator role includes the Primary Administrator profile. To
create the role and assign the role to a user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<li><p><b>For IPv4, create the single interface IPMP group.</b></p><p>You
can use either of the following methods:</p>
<ul><li><p>Use the following syntax to assign the single interface to
an IPMP group.</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># ifconfig <i>interface</i> -failover group <i>group-name</i></pre>
</td></table><br><p>The following example assigns the interface <tt>hme0</tt> into
the IPMP group <tt>v4test</tt>:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig hme0  -failover group v4test</b></tt></pre>
</td></table><br><p>Unlike the multiple physical interface configuration, you would not
mark a single physical interface as <tt>deprecated</tt>. </p>
<p>This
example includes the use of the <tt>-failover</tt> option of the <tt>ifconfig</tt> command to create an <tt>IFF_NOFAILOVER</tt> flag
for the interface. Consider using <tt>-failover</tt> if you might later
add more interfaces to the group. The <tt>in.mpathd</tt> daemon
sends probe packets by using that address. Later, when you add more interfaces,
the configuration should work properly.</p>
</li>
<li><p>Alternatively, you can use the following syntax to add a single
physical interface to an IPMP group:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># ifconfig <i>interface</i> group <i>group-name</i></pre>
</td></table><br><p>When you use this configuration, <tt>in.mpathd</tt> chooses
a data address to send probe packets. </p>
</li>
</ul>
</li>
<li><p><b>For IPv6, create the single interface IPMP group.</b></p><p>Use
either of the following two methods:</p>
<ul><li><p>Use the following syntax to assign the single interface to
an IPMP group:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># ifconfig <i>interface</i> inet6 -failover group <i>group-name</i></pre>
</td></table><br><p>For example, you would type the following to add the single interface <tt>hme0</tt> into the IPMP group <tt>v6test</tt>:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig hme0  inet6 -failover group v6test</b></tt></pre>
</td></table><br></li>
<li><p>Use the following syntax if you do not want to set the <tt>NOFAILOVER</tt> flag:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># ifconfig <i>interface</i> inet6 group <i>group-name</i></pre>
</td></table><br><p>When the <tt>in.mpathd</tt> daemon detects failures, the interface
is marked and logged appropriately on the console.</p>
</li>
</ul>
<p>In a single physical interface configuration, you cannot verify whether
the target system that is being probed has failed or whether the interface
has failed. The target system can be probed through only one physical interface.
If only one default router is on the subnet, turn off IPMP if a single physical
interface is in the group. If a separate IPv4 and IPv6 default router exists,
or multiple default routers exist, more than one target system needs to be
probed. Hence, you can safely turn on IPMP.</p>
</li>
</ol><A NAME="enflg"></A><h2>Maintaining IPMP Groups</h2>
<A NAME="indexterm-2961"></A><p>This section contains tasks for maintaining existing IPMP groups and
the interfaces that compose those groups. The tasks presume that you have
already configured an IPMP group, as explained in <A HREF="p160.html#deploynetmult-57">Configuring IPMP Groups</A>.</p>
<A NAME="deploynetmult-6"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Display the IPMP Group Membership
of an Interface</h3>
<A NAME="indexterm-2962"></A><ol><A NAME="enfpj"></A><li><p><b>On the system with the IPMP group configuration, become
superuser or assume an equivalent role.</b></p><p>Roles contain authorizations
and privileged commands. For more information about roles, see "Configuring RBAC (Task Map)" in <i>System Administration Guide: Security Services</i>.</p>
</li>
<A NAME="deploynetmult-step-20"></A><li><p><b><A NAME="indexterm-2963"></A>Display information about the interface, including the group to
which the interface belongs.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig</b></tt> <i>interface</i></pre>
</td></table><br></li>
<li><p><b>If applicable, display IPv6 information for the interface.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig</b></tt> <i>interface</i> <tt><b>inet6</b></tt></pre>
</td></table><br></li>
</ol><A NAME="eojcd"></A><h5>Example 31-5 &nbsp;&nbsp;Displaying Physical Interface Groups</h5>
<p>To display the group name for <tt>hme0</tt>, you would type
the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig hme0</b></tt>
	hme0: flags=9000843&lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 
      index 2 inet 192.168.85.19 netmask ffffff00 broadcast 192.168.85.255
      groupname testgroup1</pre>
</td></table><br><p>To display the group name for only the IPv6 information, you would type
the following:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig hme0 inet6</b></tt>
	hme0: flags=a000841&lt;UP,RUNNING,MULTICAST,IPv6> mtu 1500 index 2
        	inet6 fe80::a00:20ff:feb9:19fa/10 
        	groupname testgroup1</pre>
</td></table><br><A NAME="deploynetmult-103"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Add an Interface to an IPMP Group</h3>
<A NAME="indexterm-2964"></A><ol><li><p><b>On the system with the IPMP group configuration, assume the Primary
Administrator role or become superuser.</b></p><p>The Primary Administrator
role includes the Primary Administrator profile. To create the role and assign
the role to a user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<A NAME="deploynetmult-step-106"></A><li><p><b>Add the interface to the IPMP group.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># ifconfig <i>interface</i> group <i>group-name</i></pre>
</td></table><br><p>The interface specified in <i>interface</i> becomes
a member of IPMP group <i>group-name</i>.</p>
</li>
</ol><A NAME="esqao"></A><h5>Example 31-6 &nbsp;&nbsp;Adding an Interface to an IPMP Group</h5>
<p>To add <tt>hme0</tt> to the IPMP group <tt>testgroup2</tt>,
you would type the following command:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig hme0 group testgroup2</b></tt>
  hme0: flags=9000843&lt;UP ,BROADCAST,RUNNING,MULTICAST,IPv4,NOFAILOVER> mtu 1500 index 2
  inet 192.168.85.19 netmask ff000000 broadcast 10.255.255.255
  groupname testgroup2
  ether 8:0:20:c1:8b:c3 </pre>
</td></table><br><A NAME="deploynetmult-7"></A><h3><IMG border="0" alt="Procedure" src="graphics/procedure.gif">How to Remove an Interface From an IPMP
Group</h3>
<A NAME="indexterm-2965"></A><p>When you execute the <tt>ifconfig</tt> command's <tt>group</tt> parameter
with a null string, the interface is removed from its current IPMP group.
Be careful when removing interfaces from a group. If some other interface
in the IPMP group has failed, a failover could have happened earlier. For
example, if <tt>hme0</tt> failed previously, all addresses are failed
over to <tt>hme1</tt>, if <tt>hme1</tt> is part of the
same group. The removal of <tt>hme1</tt> from the group causes the <tt>in.mpathd</tt> daemon to return all the failover addresses to some other
interface in the group. If no other interfaces are functioning in the group,
failover might not restore all the network accesses.</p>
<p>Similarly, when an interface in a group needs to be unplumbed, you should
first remove the interface from the group. Then, ensure that the interface
has all the original IP addresses configured. The <tt>in.mpathd</tt> daemon
tries to restore the original configuration of an interface that is removed
from the group. You need to ensure that the configuration is restored before
unplumbing the interface. Refer to <A HREF="p158.html#eoqse">What Happens During Interface Failover</A> to see how interfaces look before and after a failover.</p>
<ol><li><p><b>On the system with the IPMP group configuration, assume the Primary
Administrator role or become superuser.</b></p><p>The Primary Administrator
role includes the Primary Administrator profile. To create the role and assign
the role to a user, see Chapter 2, "Working With the Solaris Management Console (Tasks)," in <i>System Administration Guide: Basic Administration</i>.</p>
</li>
<A NAME="deploynetmult-step-23"></A><li><p><b>Remove the interface from the IPMP
group.</b></p><table cellpadding="4" border="1" cols="1" width="100%"><td><pre># ifconfig <i>interface</i> group ""</pre>
</td></table><br><p>The quotation marks indicate a null string.</p>
</li>
</ol><A NAME="eojcj"></A><h5>Example 31-7 &nbsp;&nbsp;Removing an Interface From a Group</h5>
<p>To remove <tt>hme0</tt> from the IPMP group <tt>test</tt>,
you would type the following command:</p>
<table cellpadding="4" border="1" cols="1" width="100%"><td><pre># <tt><b>ifconfig hme0 group ""</b></tt>
	# <tt><b>ifconfig hme0</b></tt>
	hme0: flags=9000843&lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500
    index 2 inet 192.168.85.19 netmask ffffff00 broadcast 192.168.85.255
	# ifconfig hme0 inet6
	hme0: flags=a000841&lt;UP,RUNNING,MULTICAST,IPv6> mtu 1500 index 2
    inet6 fe80::a00:20ff:feb9:19fa/10 </pre>
</td></table><br>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="suntab"><td></td><td align="right"><A HREF="p162.html"><IMG BORDER="0" ALT="Previous" SRC="graphics/prev.gif"> Previous</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="toc.html">Contents</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="idx.html">Index</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="p164.html">Next <IMG BORDER="0" ALT="Next" SRC="graphics/next.gif"></A></td></tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2007 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

