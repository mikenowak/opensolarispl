<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Logging <tt>ypxfr</tt> Activity - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p21.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a> > <a href="p24.html#anis2-1010">Updating and Modifying Existing Maps</a> > <a href="p24.html#indexterm-375">Maintaining Updated Maps</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p24.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p26.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<h5>Logging <tt>ypxfr</tt> Activity</h5>
<p>The transfer attempts and results of <tt>ypxfr</tt> can be
captured in a log file. If a file called <tt>/var/yp/ypxfr.log</tt> exists,
results are appended to it. No attempt to limit the size of the log file is
made. To prevent it from growing indefinitely, empty it from time to time
by typing the following.</p>
<pre># <tt><b>cd /var/yp</b></tt>
# <tt><b>cp ypxfr.log ypxfr.log.old</b></tt>
# <tt><b>cat /dev/null > /var/yp/ypxfr.log</b></tt></pre><p>You can have <tt>crontab</tt> execute these commands once
a week. To turn off logging, remove the log file.</p>
<a name="anis2-1003"></a><h4>Modifying Default Maps</h4>
<p>To update a nondefault map, you must do the following.</p>
<ol><li><p>Create or edit its corresponding text file.</p>
</li>
<li><p>Build (or rebuild) the new or updated map. There are two ways
to build a map.</p>
<ul><li><p><a name="indexterm-380"></a>Use the Makefile. Using the Makefile is the preferred method of
building a non-default map. If the map has an entry in the <tt>Makefile</tt>,
run <tt>make</tt> <i>name</i> where <i>name</i> is the name of map you want to build. If the map does not have
a <tt>Makefile</tt> entry, try to create one following the instructions
in <a href="p23.html#anis2-20638">Modifying and Using the <tt>Makefile</tt></a>.</p>
</li>
<li><p>Use the <tt>/usr/sbin/makedbm</tt> program. <tt>makedbm</tt>(1M) fully describes this command.</p>
</li>
</ul>
</li>
</ol>
<a name="anis2-1004"></a><h4>Using <tt>makedbm</tt> to Modify
a Non-Default Map</h4>
<a name="indexterm-381"></a><p><a name="indexterm-382"></a>There are two different methods for using <tt>makedbm</tt> to
modify maps if you do not have an input file:</p>
<ul><li><p>Redirect the <tt>makedbm</tt> <tt>-u</tt> output
to a temporary file, modify the file, then use the modified file as input
to <tt>makedbm</tt>.</p>
</li>
<li><p><a name="indexterm-383"></a><a name="indexterm-384"></a>Have the output of <tt>makedbm</tt> <tt>-u</tt> operated
on within a pipeline that feeds into <tt>makedbm</tt>. This is appropriate
if you can update the disassembled map with either <tt>awk</tt>, <tt>sed</tt>, or a <tt>cat</tt> append.</p>
</li>
</ul>
<a name="anis2-1005"></a><h4>Creating New Maps from Text Files</h4>
<a name="indexterm-385"></a><p>Assume that a text file <tt>/var/yp/mymap.asc</tt> was created
with an editor or a shell script on the master. You want to create an NIS
map from this file and locate it in the <i>homedomain</i> subdirectory.
To do this, type the following on the master server.</p>
<pre># <tt><b>cd /var/yp</b></tt>
# <tt><b>makedbm </tt><i>mymap</i><tt>.asc </tt><i>homedomain</i><tt>/</tt><i>mymap</i><tt></b></tt></pre><p><a name="indexterm-386"></a>The <i>mymap</i> map now exists on the master
server in the directory <i>homedomain</i>. To distribute
the new map to slave servers run <tt>ypxfr</tt>.</p>
<a name="anis2-1006"></a><h4>Adding Entries to a File-Based Map</h4>
<p><a name="indexterm-387"></a><a name="indexterm-388"></a><a name="indexterm-389"></a>Adding entries to <tt>mymap</tt> is simple. First, you
must modify the text file <tt>/var/yp/</tt><i>mymap</i>.<tt>asc</tt>. If you modify the actual <tt>dbm</tt> files without
modifying the corresponding text file, the modifications are lost. Then run <tt>makedbm</tt> as shown above. </p>
<a name="anis2-1007"></a><h4>Creating Maps From Standard Input</h4>
<a name="indexterm-390"></a><p><a name="indexterm-391"></a>When no original text file exists, create the NIS map from the
keyboard by typing input to <tt>makedbm</tt>, as shown below (end
with Control-D).</p>
<pre>ypmaster# <tt><b>cd /var/yp</b></tt>
ypmaster# <tt><b>makedbm</b></tt> <tt>-</tt><i>homedomain</i><tt>-</tt><tt><b>/mymap</tt><i>key1 value1</i><tt> </tt><i>key2 value2</i><tt> </tt><i>key3 value3</i><tt></b></tt></pre><a name="anis2-1008"></a><h4>Modifying Maps Made From Standard Input</h4>
<p><a name="indexterm-392"></a>If you later need to modify the map, you can use <tt>makedbm</tt> to
disassemble the map and create a temporary text intermediate file. To disassemble
the map and create a temporary file, type the following.</p>
<pre>% <tt><b>cd /var/yp</b></tt>
% <tt><b>makedbm</b></tt> <tt>-u</tt> <tt><b></tt><i>homedomain</i><tt>/</tt><i>mymap</i><tt> > </tt><i>mymap</i><tt>.temp</b></tt></pre><p>The resulting temporary file <i>mymap</i><tt>.temp</tt> has one entry per line. You can edit this file as needed, using
any text editor.</p>
<p>To update the map, give the name of the modified temporary file to <tt>makedbm</tt> by typing the following.</p>
<pre>% <tt><b>makedbm </tt><i>mymap</i><tt>.temp </tt><i>homedomain</i><tt>/</tt><i>mymap</i><tt></b></tt>
% <tt><b>rm </tt><i>mymap</i><tt>.temp</b></tt></pre><p>Then propagate the map to the slave servers, by becoming root and typing
the following.</p>
<pre># <tt><b>yppush </tt><i>mymap</i><tt></b></tt></pre><p>The preceding paragraphs explained how to use <tt>makedbm</tt> to
create maps; however, almost everything you actually have to do can be done
by <tt>ypinit</tt> and <tt>Makefile</tt> unless you
add nondefault maps to the database or change the set of NIS servers after
the system is already up and running.</p>
<p><a name="indexterm-393"></a>Whether you use the <tt>Makefile</tt> in <tt>/var/yp</tt> or some other procedure the goal is the same. Anew pair of well-formed <tt>dbm</tt> files must end up in the maps directory on the master server.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p24.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p26.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

