<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Administering NIS (Tasks) - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p20.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p22.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="anis2-22217"></a>Chapter&nbsp;6<h3>Administering NIS (Tasks)</h3><p>This chapter describes how to administer NIS. The following topics are
covered.</p>
<ul><li><p><a href="p21.html#anis2-32914">Password Files and Namespace Security</a></p>
</li>
<li><p><a href="p21.html#anis2-38485">Administering NIS Users</a></p>
</li>
<li><p><a href="p22.html#anis2-11278">Working With NIS Maps</a></p>
</li>
<li><p><a href="p24.html#anis2-1010">Updating and Modifying Existing Maps</a></p>
</li>
<li><p><a href="p26.html">Adding a Slave Server</a></p>
</li>
<li><p><a href="p26.html#anis2-25789">Using NIS With C2 Security</a></p>
</li>
<li><p><a href="p27.html">Changing a Machine's NIS Domain</a></p>
</li>
<li><p><a href="p27.html#anis2-21536">Using NIS in Conjunction With DNS</a></p>
</li>
<li><p><a href="p28.html">Turning Off NIS Services</a></p>
</li>
</ul>
<hr>
<p><b>Note - </b>The NIS service is managed by the Service Management Facility.
Administrative actions on this service, such as enabling, disabling, or restarting,
can be performed by using the <tt>svcadm</tt> command. See <a href="p16.html#cnis1-55">NIS and the Service Management Facility</a> for more
information about using SMF with NIS. For an overview of SMF, refer to Chapter 14, Managing Services (Overview), in <i>System Administration Guide: Basic Administration</i>.
Also refer to the<tt>svcadm</tt>(1M) and <tt>svcs</tt>(1) man pages for more details.</p>
<p>NIS services can also be started and stopped by using the <tt>ypstart</tt> and <tt>ypstop</tt> commands. See the <tt>ypstart</tt>(1M) and <tt>ypstop</tt>(1M) man pages for more information.</p>
<hr>
<a name="anis2-32914"></a><h3>Password Files and Namespace Security</h3>
<a name="indexterm-292"></a><a name="indexterm-293"></a><a name="indexterm-294"></a><p>For security reasons, follow these guidelines.</p>
<ul><li><p>It is best to limit access to the NIS maps on the master server.</p>
</li>
<li><p><a name="indexterm-295"></a><a name="indexterm-296"></a><a name="indexterm-297"></a>The files used to build the NIS password maps should not contain
an entry for <tt>root</tt> to protect against unauthorized access.
To accomplish this, the password files used to build the password maps should
have the <tt>root</tt> entry removed from them and be located in
a directory other than the master server's <tt>/etc</tt> directory.
This directory should be secured against unauthorized access.</p>
</li>
</ul>
<p><a name="indexterm-298"></a><a name="indexterm-299"></a>For example, the master server password input files could be stored
in a directory such as <tt>/var/yp</tt>, or any directory of your
choice, as long as the file itself is not a link to another file and is specified
in the Makefile. When you use either the Service Management Facility or the <tt>ypstart</tt> script to start the NIS service, the correct directory option
is set according to the configuration specified in your <tt>Makefile</tt>.</p>
<hr>
<p><b>Note - </b><a name="indexterm-300"></a><a name="indexterm-301"></a>In addition to the older Solaris 1 version <tt>passwd</tt> file
format, this implementation of NIS accepts the Solaris 2 <tt>passwd</tt> and <tt>shadow</tt> file formats as input for building the NIS password maps.</p>
<hr>
<a name="anis2-38485"></a><h3>Administering NIS Users</h3>
<a name="indexterm-302"></a><a name="indexterm-303"></a><p>This section includes information about setting user passwords, adding
new users to an NIS domain, and assigning users to <tt>netgroups</tt>.</p>
<a name="anis2-1"></a><h4><img src="graphics/procedure.gif"> How to Add a New NIS User to an NIS Domain</h4>
<ol><li><a name="anis2-step-33"></a><b>On the master NIS server, become superuser
or assume an equivalent role.</b><p>Roles contain authorizations and
privileged commands. For more information about roles, see Chapter 8, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i>.</p></li><li><a name="anis2-step-4"></a><b><a name="indexterm-304"></a><a name="indexterm-305"></a><a name="indexterm-306"></a>Create the new user's login ID with the <tt>useradd</tt> command.</b><pre># <tt><b>useradd </tt><i>userID</i><tt></b></tt></pre><p><i>userID</i> is the login ID of the new user. This
command creates entries in the <tt>/etc/passwd</tt> and <tt>/etc/shadow</tt> files on the master NIS server.</p></li><li><a name="anis2-step-5"></a><b>Create the new user's initial password.</b><p>To create an initial password that the new user can use to log in, run
the <tt>passwd</tt> command.</p><pre># <tt><b>passwd </tt><i>userID</i><tt></b></tt></pre><p>Where <i>userID</i> is the login ID of the new user.
You will be prompted for the password to assign to this user.</p><p><a name="indexterm-307"></a><a name="indexterm-308"></a>This step is necessary because the password entry created by the <tt>useradd</tt> command is locked, which means that the new user cannot
log in. By specifying an initial password, you unlock the entry.</p></li><li><a name="anis2-step-6"></a><b><a name="indexterm-309"></a>If necessary, copy the new entry into the server's <tt>passwd</tt> map
input files.</b><p>The map source files on your master server should
be in a directory other than <tt>/etc</tt>. Copy and paste the
new lines from the <tt>/etc/passwd</tt> and <tt>/etc/shadow</tt> files
into the <tt>passwd</tt> map input files on the server. See <a href="p21.html#anis2-32914">Password Files and Namespace Security</a> for
additional information.</p><p>For example, if you added the new user <tt>brown</tt>, the line from <tt>/etc/passwd</tt> that you would
copy to your <tt>passwd</tt> input file would look like the following.</p><pre>brown:x:123:10:User brown:/home/brown:/bin/csh:</pre><p>The line for <tt>brown</tt> that you would copy from <tt>/etc/shadow</tt> would look like:</p><pre>brown:W12345GkHic:6445::::::</pre></li><li><a name="anis2-step-7"></a><b>Make sure that the <tt>Makefile</tt> correctly
specifies the directory where the password input file resides.</b></li><li><a name="anis2-step-88"></a><b>If appropriate, delete the new user's entries
from <tt>/etc/passwd</tt> and <tt>/etc/shadow</tt> input
files.</b><p><a name="indexterm-310"></a><a name="indexterm-311"></a><a name="indexterm-312"></a>For security reasons, do not keep user entries in the NIS master
server <tt>/etc/passwd</tt> and <tt>/etc/shadow</tt> files.
After copying the entries for the new user to the NIS map source files that
are stored in some other directory, use the <tt>userdel</tt> command
on the master server to delete the new user.</p><p>For example, to delete
the new user <tt>brown</tt> from the master server's <tt>/etc</tt> files,
you would enter the following.</p><pre># <tt><b>userdel brown</b></tt></pre><p><a name="indexterm-313"></a>For more information about <tt>userdel</tt>, see the <tt>userdel</tt> man page.</p></li><li><a name="anis2-step-999"></a><b><a name="indexterm-314"></a><a name="indexterm-315"></a>Update the NIS <tt>passwd</tt> maps.</b><p>After
you have updated the <tt>passwd</tt> input file on the master
server, update the <tt>passwd</tt> maps by running <tt>make</tt> in
the directory containing the source file.</p><pre># <tt><b>userdel brown</b></tt>
# <tt><b>cd /var/yp</b></tt>
# <tt><b>/usr/ccs/bin/make passwd</b></tt></pre></li><li><a name="anis2-step-1000"></a><b>Tell the new user the initial password you
have assigned to his or her login ID.</b><p>After logging in, the new
user can run <tt>passwd</tt> at any time to establish a different
password.</p></li></ol><a name="anis2-11"></a><h4>Setting User Passwords</h4>
<a name="indexterm-316"></a><a name="indexterm-317"></a><a name="indexterm-318"></a><p><a name="indexterm-319"></a>Users run <tt>passwd</tt> to change their passwords.</p>
<p>% <tt><b>passwd </tt><i>username</i><tt></b></tt></p>
<p><a name="indexterm-320"></a><a name="indexterm-321"></a><a name="indexterm-322"></a>Before users can change their passwords, you must start the <tt>rpc.yppasswdd</tt> daemon on the master server to update the password
file.</p>
<p>The <tt>rpc.yppasswdd</tt> daemon starts automatically on
the master server. Notice that when the <tt>-m</tt> option is given
to <tt>rpc.yppasswdd</tt>, a <tt>make</tt> is forced in <tt>/var/yp</tt> immediately following a modification of the file. If you
want to avoid having this <tt>make</tt> take place each time the <tt>passwd</tt> file is changed, remove the <tt>-m</tt> option from
the <tt>rpc.yppasswd</tt> command in the <tt>ypstart</tt> script
and control the pushing of the <tt>passwd</tt> maps through the <tt>crontab</tt> file.</p>
<hr>
<p><b>Note - </b><a name="indexterm-323"></a><a name="indexterm-324"></a><a name="indexterm-325"></a>No arguments should follow the <tt>rpc.yppasswd</tt> <tt>-m</tt> command. Although you can edit the <tt>ypstart</tt> script
file to achieve a different action, it is not recommended that you modify
this file other than optionally removing the <tt>-m</tt> option. All
commands and daemons invoked by this file with the proper set of command line
parameters. If you choose to edit this file, be especially careful when editing
the <tt>rpc.yppasswdd</tt> command. If you add an explicit call
to the <tt>passwd.adjunct</tt> file, the exact <tt>$PWDIR/security/passwd.adjunct</tt> path must be used; otherwise, incorrect processing results.</p>
<hr>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p20.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p22.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

