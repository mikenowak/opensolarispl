<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>What if the Syntax is Wrong? - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p6.html">2.&nbsp;&nbsp;The Name Service Switch (Overview)</a> > <a href="p6.html#a12swit-89620">About the Name Service Switch</a> > <a href="p6.html#a12swit-84565">Format of the <tt>nsswitch.conf</tt> File</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p6.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p8.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="a12swit-4a"></a><h5>What if the Syntax is Wrong?</h5>
<a name="indexterm-38"></a><a name="indexterm-39"></a><p>Client library routines contain compiled-in default entries that are used if an entry in the <tt>nsswitch.conf</tt> file is either missing or syntactically incorrect. These entries are the same as the switch file's defaults.</p>
<p>The name service switch assumes that the table and source names are spelled correctly. If you misspell a table or source name, the switch uses default values.</p>
<a name="a12swit-5"></a><h5><tt>Auto_home</tt> and <tt>Auto_master</tt></h5>
<a name="indexterm-40"></a><a name="indexterm-41"></a><a name="indexterm-42"></a><a name="indexterm-43"></a><p>The switch search criteria for the <tt>auto_home</tt> and <tt>auto_master</tt> tables and maps is combined into one category, which is called <tt>automount</tt>.</p>
<a name="a12swit-6"></a><h5>Timezone and the Switch File</h5>
<a name="indexterm-44"></a><p><a name="indexterm-45"></a>The <tt>timezone</tt> table does not use the switch, so the table is not included in the switch file's list. </p>
<a name="a12swit-8"></a><h4>Comments in <tt>nsswitch.conf</tt> Files</h4>
<a name="indexterm-46"></a><p><a name="indexterm-47"></a>Any <tt>nsswitch.conf</tt> file line beginning with a comment character (<tt>#</tt>) is interpreted as a comment line. A comment line is ignored by routines that search the file.</p>
<p>Characters preceding a comment mark <b>are</b> interpreted by routines that search the <tt>nsswitch.conf</tt> file. Characters to the right of the comment mark are interpreted as comments and ignored.</p>
<a name="a12swit-tbl-9"></a>Table 2-4 Switch File Comment Examples<table><tr><th><p>Type of Line</p>
</th><th><p>Example</p>
</th></tr>
<tr><td><p>Comment line.</p>
</td><td><p># hosts: nisplus [NOTFOUND=return] files</p>
</td></tr>
<tr><td><p>Interpreted line.</p>
</td><td><p>hosts: nisplus [NOTFOUND=return] file</p>
</td></tr>
<tr><td valign="top"><p>Partially interpreted line. The <tt>files</tt> element is not interpreted.</p>
</td><td valign="top"><p>hosts: nisplus [NOTFOUND=return] # files</p>
</td></tr>
</table><a name="a12swit-10"></a><h4>Keyserver and <tt>publickey</tt> Entry in the Switch File</h4>
<hr>
<p><b>Caution - </b><a name="indexterm-48"></a><a name="indexterm-49"></a><a name="indexterm-50"></a>You must restart the keyserver after you make a change to <tt>nsswitch.conf</tt>.</p>
<hr>
<p>The keyserver reads the <tt>publickey</tt> entry in the name service switch configuration file only when the keyserver is started. If you change the switch configuration file, the keyserver does not register the changes until the keyserver is restarted.<tt></tt> </p>
<a name="a12swit-22067"></a><h3>The <tt>nsswitch.conf</tt> Template Files</h3>
<a name="indexterm-51"></a><p>Four switch template files are provided with the Solaris system to accommodate different naming services. Each file provides a different default set of information sources.</p>
<p>The four template files are the following.</p>
<ul><li><p><a name="indexterm-52"></a><b>LDAP template file</b>. The <tt>nsswitch.ldap</tt> configuration file specifies the LDAP directory as the primary source of information for the machine.</p>
<hr>
<p><b>Note - </b>In order to use LDAP naming services, you must also properly configure all LDAP client machines, in addition to modifying the <tt>nsswitch.conf</tt>. See <a href="p45.html">Chapter&nbsp;12, Setting Up LDAP Clients (Tasks)</a> for more information.</p>
<hr>
</li>
<li><p><a name="indexterm-53"></a><b>NIS+ template file</b>. The <tt>nsswitch.nisplus</tt> configuration file specifies NIS+ as the primary source for all information except <tt>passwd</tt>, <tt>group</tt>, <tt>automount</tt>, and <tt>aliases</tt>. For those four files, the primary source is local 
<tt>/etc</tt> files. The secondary source is an NIS+ table. The <tt>[NOTFOUND=return]</tt> search criterion instructs the switch to stop searching the NIS+ tables if the switch gets  a &ldquo;No such entry&rdquo; message. The switch searches through local files only if the NIS+ server is unavailable.</p>
</li>
<li><p><a name="indexterm-54"></a><b>NIS template file</b>. The <tt>nsswitch.nis</tt> configuration file is almost identical to the NIS+ configuration file, except that NIS file specifies NIS maps in place of NIS+ tables. Because the search order for passwd and group is <tt>files nis</tt>, you don't need to place the + entry in the 
<tt>/etc/passwd</tt> and <tt>/etc/group</tt> files.</p>
</li>
<li><p><a name="indexterm-55"></a><b>Files template file</b>. The <tt>nsswitch.files</tt> configuration file specifies local <tt>/etc</tt> files as the only source of information for the machine. There is no &ldquo;files&rdquo; source for <tt>netgroup</tt>, so the client does not use that entry in the switch file.</p>
</li>
</ul>
<p>Copy the template file that most closely meets your requirements to the <tt>nsswitch.conf</tt> configuration file and then modify the file as needed.</p>
<p>For example, to use the LDAP template file, you would type the following command.</p>
<pre>mymachine# <tt><b>cp /etc/nsswitch.ldap /etc/nsswitch.conf</b></tt></pre><a name="a12swit-11"></a><h4>The Default Switch Template Files</h4>
<a name="indexterm-56"></a><p>The following four switch files are supplied with the Solaris product.</p>
<a name="a12swit-ex-7"></a>Example 2-1 NIS+ Switch File Template: <tt>nsswitch.nisplus</tt><pre>#
#
# /etc/nsswitch.nisplus:
#
#
# An example file that could be copied over to /etc/nsswitch.conf;
# it uses NIS+ (NIS Version 3) in conjunction with files.
#
# "hosts:" and "services:" in this file are used only if the
# /etc/netconfig file has a "-" for nametoaddr_libs of "inet"
# transports.
 
# the following two lines obviate the "+" entry in /etc/passwd 
# and /etc/group.
passwd: files nisplus
group: files nisplus
# consult /etc "files" only if nisplus is down. 
hosts: nisplus [NOTFOUND=return] files
# Uncomment the following line, and comment out the above, to use 
# both DNS and NIS+. You must also set up the /etc/resolv.conf 
# file for DNS name server lookup. See resolv.conf(4).
# hosts: nisplus dns [NOTFOUND=return] files
services: nisplus [NOTFOUND=return] files
networks: nisplus [NOTFOUND=return] files
protocols: nisplus [NOTFOUND=return] files
rpc: nisplus [NOTFOUND=return] files
ethers: nisplus [NOTFOUND=return] files
netmasks: nisplus [NOTFOUND=return] files	
bootparams: nisplus [NOTFOUND=return] files
publickey: nisplus
netgroup: nisplus
automount: files nisplus
aliases: files nisplus
sendmailvars: files nisplus</pre><a name="a12swit-ex-8"></a>Example 2-2 NIS Switch File Template<pre>#
# /etc/nsswitch.nis:
#
# An example file that could be copied over to /etc/nsswitch.conf;
# it uses NIS (YP) in conjunction with files.
#
# "hosts:" and "services:" in this file are used only if the
# /etc/netconfig file has a "-" for nametoaddr_libs of "inet"
# transports.
#
# the following two lines obviate the "+" entry in /etc/passwd
# and /etc/group.
passwd: files nis
group: files nis
# consult /etc "files" only if nis is down. 
hosts: nis [NOTFOUND=return] files
networks: nis [NOTFOUND=return] files
protocols: nis [NOTFOUND=return] files
rpc: nis [NOTFOUND=return] files
ethers: nis [NOTFOUND=return] files
netmasks: nis [NOTFOUND=return] files	
bootparams: nis [NOTFOUND=return] files
publickey: nis [NOTFOUND=return] files
netgroup: nis
automount: files nis
aliases: files nis
# for efficient getservbyname() avoid nis
services: files nis
sendmailvars: files</pre><a name="a12swit-ex-2"></a>Example 2-3 Files Switch File Template<pre>#
# /etc/nsswitch.files:
#
# An example file that could be copied over to /etc/nsswitch.conf;
# it does not use any naming service.
#
# "hosts:" and "services:" in this file are used only if the
# /etc/netconfig file has a "-" for nametoaddr_libs of "inet"
# transports.
passwd: files
group: files
hosts: files
networks: files
protocols: files
rpc: files
ethers: files
netmasks: files	
bootparams: files
publickey: files
# At present there isn't a 'files' backend for netgroup;
# the system will figure it out pretty quickly, and will notuse
# netgroups at all.
netgroup: files
automount: files
aliases: files
services: files
sendmailvars: files</pre><a name="a12swit-ex-10"></a>Example 2-4 LDAP Switch File Template<pre>#
# /etc/nsswitch.ldap:
#
# An example file that could be copied over to /etc/nsswitch.conf; it
# uses LDAP in conjunction with files.
#
# "hosts:" and "services:" in this file are used only if the
# /etc/netconfig file has a "-" for nametoaddr_libs of "inet" transports.

# the following two lines obviate the "+" entry in /etc/passwd 
and /etc/group.
passwd:     files ldap
group:      files ldap

hosts:      ldap [NOTFOUND=return] files

networks:   ldap [NOTFOUND=return] files
protocols:  ldap [NOTFOUND=return] files
rpc:        ldap [NOTFOUND=return] files
ethers:     ldap [NOTFOUND=return] files
netmasks:   ldap [NOTFOUND=return] files
bootparams: ldap [NOTFOUND=return] files
publickey:  ldap [NOTFOUND=return] files

netgroup:   ldap

automount:  files ldap
aliases:    files ldap

# for efficient getservbyname() avoid ldap
services:   files ldap
sendmailvars:   files</pre><a name="a12swit-12"></a><h4>The <tt>nsswitch.conf</tt> File</h4>
<a name="indexterm-57"></a><p>The default <tt>nsswitch.conf</tt> file that is installed with the Solaris software is determined by which naming service you select during the installation process. Each line identifies a particular type of network information, such as host, password, and group, along with the information source, such as NIS+ tables, NIS maps, the DNS hosts table, or local 
<tt>/etc</tt>. When you chose a naming service, the switch template file for that service is copied to create the new <tt>nsswitch.conf</tt> file. For example, if you choose NIS+, the <tt>nsswitch.nisplus</tt> file is copied to create a new <tt>nsswitch.conf</tt> file.</p>
<p><a name="indexterm-58"></a><a name="indexterm-59"></a>An <tt>nsswitch.conf</tt> file is automatically loaded into every machine's <tt>/etc</tt> directory by the Solaris 9 release software, along with the following alternate (template) versions.</p>
<ul><li><p><a name="indexterm-60"></a><a name="indexterm-61"></a><tt>/etc/nsswitch.nisplus</tt></p>
</li>
<li><p><a name="indexterm-62"></a><a name="indexterm-63"></a><tt>/etc/nsswitch.nis</tt></p>
</li>
<li><p><a name="indexterm-64"></a><a name="indexterm-65"></a><tt>/etc/nsswitch.files</tt></p>
</li>
<li><p><a name="indexterm-66"></a><a name="indexterm-67"></a><tt>/etc/nsswitch.ldap</tt></p>
</li>
</ul>
<p><a name="indexterm-68"></a>These alternate template files contain the default switch configurations used by the NIS+ and NIS services, local files, and LDAP. No default file is provided for DNS, but you can edit any of these files to use DNS. When the Solaris software is first installed on a machine, the installer selects the machine's default naming service. During installation, the corresponding template file is copied to <tt>/etc/nsswitch.conf</tt>
. For example, for a machine client using  NIS+, the installation process copies <tt>nsswitch.nisplus</tt>  to <tt>nsswitch.conf</tt>.</p>
<p>If your network is connected to the Internet and users must access Internet hosts using DNS, you must enable DNS forwarding.</p>
<p>Unless you have an unusual namespace, the default template file as copied to <tt>nsswitch.conf</tt> should be sufficient for normal operation.</p>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p6.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p8.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

