<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>NIS-to-LDAP Restrictions - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p55.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p58.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p60.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="nis2ldap-24"></a><h3>NIS-to-LDAP Restrictions</h3>
<a name="indexterm-562"></a><p>When the N2L server has been set up, the NIS source files are no longer used. Therefore, do not run <tt>ypmake</tt> on an N2L server. If <tt>ypmake</tt> is accidentally run, such as for an existing <tt>cron</tt> job, the N2L service is unaffected. However, a warning is logged suggesting that <tt>yppush</tt> should be called explicitly.</p>
<a name="nis2ldap-58"></a><h3>NIS-to-LDAP Troubleshooting</h3>
<a name="indexterm-563"></a><p>This section covers two areas of troubleshooting:</p>
<ul><li><p><a href="p59.html#nis2ldap-10">Common LDAP Error Messages</a></p>
</li>
<li><p><a href="p59.html#nis2ldap-59">NIS-to-LDAP Issues</a></p>
</li>
</ul>
<a name="nis2ldap-10"></a><h4>Common LDAP Error Messages</h4>
<a name="indexterm-564"></a><p>Sometimes the N2L server logs errors that relate to internal LDAP problems, resulting in LDAP-related error messages. Although the errors are nonfatal, they indicate problems to investigate. For example, the N2L server might continue to operate, but provide out-of-date or incomplete results.</p>
<p>The following list includes some of the common LDAP error messages that you might encounter when implementing the N2L service. Error descriptions, and possible causes and solutions for the errors, are included.</p>
<p><tt>Administrative limit exceeded</tt></p>
<ul><li><p><b>Error Number</b>: 11</p>
</li>
<li><p><b>Cause</b>: An LDAP search was made that was larger than allowed by the directory server's <tt>nsslapd-sizelimit</tt> attribute. Only partial information will be returned.</p>
</li>
<li><p><b>Solution</b>: Increase the value of the <tt>nsslapd-sizelimit</tt> attribute, or implement a VLV index for the failing search.</p>
</li>
</ul>
<p><tt>Invalid DN Syntax</tt></p>
<ul><li><p><b>Error Number</b>: 34</p>
</li>
<li><p><b>Cause</b>: An attempt has been made to write an LDAP entry with a DN that contains illegal characters. The N2L server attempts to escape illegal characters, such as the + symbol, that are generated in DNs.</p>
</li>
<li><p><b>Solution</b>: Check the LDAP server error log to find out which illegal DNs were written, then modify the <tt>NISLDAPmapping</tt> file that generated the illegal DNs.</p>
</li>
</ul>
<p><tt>Object class violation</tt></p>
<ul><li><p><b>Error Number</b>: 65</p>
</li>
<li><p><b>Cause</b>: An attempt has been made to write an LDAP entry that is invalid. Generally, this error is due to missing <tt>MUST</tt> attributes that can be caused by either of the following circumstances.</p>
<ul><li><p>Bugs in the <tt>NISLDAPmapping</tt> file that create entries with missing attributes</p>
</li>
<li><p>Attempts to add an <tt>AUXILIARY</tt> attribute to an object that does not exist</p>
<p>For example, if a user name has not yet been created from the <tt>passwd.byxxx</tt> map, an attempt to add auxiliary information to that user will fail.</p>
</li>
</ul>
</li>
<li><p><b>Solution</b>: For bugs in the <tt>NISLDAPmapping</tt> file, check what was written in the server error log to determine the nature of the problem.</p>
</li>
</ul>
<p><tt>Can't contact LDAP server</tt></p>
<ul><li><p><b>Error Number</b>: 81</p>
</li>
<li><p><b>Cause</b>: The <tt>ypserv</tt> file might be incorrectly configured to point to the wrong LDAP directory server. Alternatively, the directory server might not be running.</p>
</li>
<li><p><b>Solution</b>:</p>
<ul><li><p>Reconfigure the <tt>ypserv</tt> file to point to the correct LDAP directory server.</p>
</li>
<li><p>To confirm that the LDAP server is running, become superuser, or assume an equivalent role, on the directory server and type:</p>
<pre># <tt><b>pgrep</b></tt> <tt>-l</tt> <tt><b>slapd</b></tt></pre></li>
</ul>
</li>
</ul>
<p><tt>Timeout</tt></p>
<ul><li><p><b>Error Number</b>: 85</p>
</li>
<li><p><b>Cause</b>: An LDAP operation timed out, typically while updating a  map from the DIT. The map might now contain out-of-date information.</p>
</li>
<li><p><b>Solution</b>: Increase the <tt>nisLDAPxxxTimeout</tt> attributes in the <tt>ypserv</tt> configuration file.</p>
</li>
</ul>
<a name="nis2ldap-59"></a><h4>NIS-to-LDAP Issues</h4>
<a name="indexterm-565"></a><p>The following problems could occur while running the N2L server. Possible causes and solutions are provided.</p>
<a name="nis2ldap-9"></a><h5>Debugging the <tt>NISLDAPmapping</tt> File</h5>
<a name="indexterm-566"></a><p>The mapping file, <tt>NISLDAPmapping</tt>, is complex. Many  potential errors might cause the mapping to behave in unexpected ways. Use the following techniques to resolve such problems.</p>
<p><b>Console Message Displays When</b> <tt>ypserv</tt> <tt>-ir</tt> <b>(or</b> <tt>-Ir</tt><b>) Runs</b></p>
<ul><li><p><b>Problem</b>: A simple message is displayed on the console and the server exits (a detailed description is written to <tt>syslog</tt>).</p>
</li>
<li><p><b>Cause</b>: The syntax of the mapping file might be incorrect.</p>
</li>
<li><p><b>Solution</b>: Check and correct the syntax in the <tt>NISLDAPmapping</tt> file.</p>
</li>
</ul>
<p><b>NIS Daemon Exits at Startup</b></p>
<ul><li><p><b>Problem</b>:  When <tt>ypserv</tt> or other NIS daemons run, an LDAP-related error message is logged and the daemon exits.</p>
</li>
<li><p><b>Cause</b>:  The cause might be one of the following:</p>
<ul><li><p>The LDAP server cannot be contacted.</p>
</li>
<li><p>An entry found in an NIS map or in the DIT is incompatible with the mapping specified.</p>
</li>
<li><p>An attempt to read or write to the LDAP server returns an error.</p>
</li>
</ul>
</li>
<li><p><b>Solution</b>: Examine the error log on the LDAP server. See the LDAP errors that are listed in <a href="p59.html#nis2ldap-10">Common LDAP Error Messages</a>.</p>
</li>
</ul>
<p><b>Unexpected Results From NIS Operations</b></p>
<ul><li><p><b>Problem</b>: NIS operations do not return the expected results, but no errors are logged.</p>
</li>
<li><p><b>Cause</b>: Incorrect entries might exist in the LDAP or NIS maps, which results in mappings not completing as intended.</p>
</li>
<li><p><b>Solution</b>: Check and correct entries in the LDAP DIT and in the N2L versions of the NIS maps.</p>
<ol><li><p>Check that the correct entries exist in the LDAP DIT, and correct the entries as needed.</p>
<p>If you are using the Sun Java System Directory Server, start the management console by running <tt>directoryserver startconsole</tt>.</p>
</li>
<li><p>Check that the N2L versions of the NIS maps in the <tt>/var/yp</tt> directory contain the expected entries by comparing the newly generated map to the  original map. Correct entries as needed.</p>
<pre># <tt><b>cd /var/yp/</tt><i>domainname</i><tt></b></tt>
# <tt><b>makedbm</b></tt> <tt>-u</tt> <tt><b></tt><i>test.byname</i><tt></b></tt>
# <tt><b>makedbm</b></tt> <tt>-u</tt> <tt><b>LDAP_</tt><i>test.byname</i><tt></b></tt></pre><p>Be aware of the following when checking the output for the maps:</p>
<ul><li><p>The order of entries might not be the same in both files.</p>
<p>Use the <tt>sort</tt> command before comparing output.</p>
</li>
<li><p>The use of white space might not be the same in both files.</p>
<p>Use the <tt>diff</tt> <tt>-b</tt> command when comparing output.</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<p><b>Processing Order of NIS Maps</b></p>
<ul><li><p><b>Problem</b>: Object class violations occur.</p>
</li>
<li><p><b>Cause</b>: When the <tt>ypserv</tt> <tt>-i</tt> command is run, each NIS map is read and its contents are written into the DIT. Several maps might contribute attributes to the same DIT object. Generally, one map creates most of the object, including all the object's <tt>MUST</tt> attributes. Other maps contribute additional <tt>MAY</tt> attributes.</p>
<p>Maps are processed in the same order that <tt>nisLDAPobjectDN</tt> attributes appear in the <tt>NISLDAPmapping</tt> file. If maps containing <tt>MAY</tt> attributes get processed before maps containing <tt>MUST</tt> attributes, then object class violations occur. See Error 65 in <a href="p59.html#nis2ldap-10">Common LDAP Error Messages</a> for more information about this error.</p>
</li>
<li><p><b>Solution</b>: Reorder the <tt>nisLDAPobjectDN</tt> attributes so that maps are processed in the correct order.</p>
<p>As a temporary fix, rerun the <tt>ypserv</tt> <tt>-i</tt> command several times. Each time the command is executed, more of the LDAP entry is built up.</p>
</li>
</ul>
<hr>
<p><b>Note - </b>Mapping in such a way that all of an object's <tt>MUST</tt> attributes cannot be created from at least one map is <b>not</b> supported.</p>
<hr>

</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p58.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p60.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

