<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- GenHTML@17046-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>How to Set Up the N2L Service With Standard Mappings - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-09-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
</head>

<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff"  class="a0v0">
<!--stopindex-->

<a name="top"></a>

<!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1">
<div class="a1v0">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com">sun.com</a>
<a href="http://docs.sun.com/" class="dividelink">docs.sun.com</a>
</span>
</td><td align="right" nowrap="nowrap">
<span class="toolbarlinks">
<a href="http://www.sun.com/MySun/">My Sun</a>
<a href="http://www.sun.com/worldwide/" class="dividelink">Worldwide Sites</a>
</span>
</td></tr>
</table>
</div>
</div>
<!-- END A1 COMPONENT V.0 -->

<!-- BEGIN A2 COMPONENT V.0 -->
<div class="a2" id="a2v0">
<div class="cornerTL">
<div class="cornerTR">
<div class="cornerBL">
<div class="cornerBR">
<div class="a2topiclinks">
<table cellpadding="1" cellspacing="0" border="0">
<tr valign="bottom">
<td><a href="http://www.sun.com/" title="Home Page"><img src="css/a.gif" alt="Home Page" width="104" height="58" border="0" class="sunlogo"></a></td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip1"></td>
<td class="navlinks" id="navlink1">
<div>
<a id="glink1" href="http://www.sun.com/products/">Products</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip2"></td>
<td class="navlinks" id="navlink2">
<div>
<a id="glink2" href="http://www.sun.com/downloads/">Downloads</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip3"></td><td class="navlinks" id="navlink3">
<div>
<a id="glink3" href="http://www.sun.com/service/">Service &amp; Solutions</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip4"></td><td class="navlinks" id="navlink4">
<div>
<a id="glink4" href="http://www.sun.com/support/">Support</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip5"></td><td class="navlinks" id="navlink5">
<div>
<a id="glink5" href="http://www.sun.com/training/">Training</a>
</div>
</td><td><img src="css/a.gif" alt="" width="1" height="1" border="0" id="ip6"></td><td class="navlinks" id="navlink6">
<div>
<a id="glink6" href="http://research.sun.com/">Research</a>
</div>
</td>
</tr>
</table>
</div>

</div></div></div></div>
</div>
<!-- END A2 COMPONENT V.0 -->

<!-- BEGIN BREADCRUMB -->
<div id="breadcrumb">
<?GenHTML ReferencePage >System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)<?GenHTML /ReferencePage> > <a href="p55.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a> > <a href="p56.html#nis2ldap-2">Setting Up the NIS-to-LDAP Service</a>
</div><br />
<!-- END BREADCRUMB -->

<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr valign="bottom"><td width="100%" valign="top">
<!-- BEGIN CENTRAL COLUMN COMPONENTS -->

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&nbsp;</td>
<td><a href="p56.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p58.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->

</td></tr>
<tr><td width="100%" valign="top">
<a name="skip2content"> </a>

<!--startindex-->
<div class="maincontent">
<a name="nis2ldap-proc-3"></a><h4><img src="graphics/procedure.gif"> How to Set Up the N2L Service With Standard Mappings</h4>
<p>Use this procedure if you are transitioning the maps listed in <a href="p56.html#nis2ldap-5">Supported Standard Mappings</a>. If you are using custom or nonstandard maps, see <a href="p57.html#nis2ldap-proc-18">How to Set Up the N2L Service With Custom or Nonstandard Mappings</a>.</p>
<p>When the LDAP server has been set up, run the <tt>inityp2l</tt> script and supply configuration information when prompted. <tt>inityp2l</tt> sets up the configuration and mapping files for standard and <tt>auto.*</tt> maps.</p>
<ol><li><a name="nis2ldap-step-34"></a><b>Complete the prerequisite steps that are listed in <a href="p56.html#nis2ldap-15">Prerequisites for the NIS-to-LDAP Transition</a>.</b></li><li><a name="nis2ldap-step-4"></a><b>On the NIS master server, become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see Chapter 8, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i>.</p></li><li><a name="nis2ldap-step-5"></a><b>Convert the NIS master server into an N2L server.</b><pre># <tt><b>inityp2l</b></tt></pre><p>Run the <tt>inityp2l</tt> script on the NIS master server and follow the prompts. See <a href="p56.html#nis2ldap-2">Setting Up the NIS-to-LDAP Service</a> for a list of the information you need to provide.</p><p>See the <tt>inityp2l</tt>(1M) man page for more details.</p></li><li><a name="nis2ldap-step-19"></a><b>Determine if the LDAP Directory Information Tree (DIT) is fully initialized.</b><p>The DIT is fully initialized if it already contains the information necessary to populate all the maps that are listed in the <tt>NISLDAPmapping</tt> file.</p><ul><li><p>If no, continue with <a href="p57.html#nis2ldap-step-11">Step&nbsp;5</a> and skip Step 6.</p>
</li>
<li><p>If yes, skip Step 5 and go to <a href="p57.html#nis2ldap-step-6">Step&nbsp;6</a>.</p>
</li>
</ul>
</li><li><a name="nis2ldap-step-11"></a><b>Initialize the DIT for the transition from the NIS source files.</b><p>Perform these steps only if the DIT has <b>not</b> been fully initialized.</p><ol><li><b>Make sure that the old NIS maps are up-to-date.</b><pre># <tt><b>cd /var/yp</b></tt>
# <tt><b>make</b></tt></pre><p>For more information, see the <tt>ypmake</tt>(1M) man page.</p></li><li><a name="nis2ldap-step-13"></a><b>Stop the NIS daemons.</b><pre># <tt><b>svcadm disable network/nis/server:default</b></tt></pre></li><li><a name="nis2ldap-step-14"></a><b>Copy the old maps to the DIT, then initialize N2L support for the maps.</b><pre># <tt><b>ypserv</b></tt> <tt>-Ir</tt><tt><b></b></tt></pre><p>Wait for <tt>ypserv</tt> to exit.</p><hr>
<p><b>Tip - </b>The original NIS <tt>dbm</tt> files are not overwritten. You can recover these files, if needed.</p>
<hr>
</li><li><a name="nis2ldap-step-16"></a><b>Start the NIS daemons to ensure that they use the new maps.</b><pre># <tt><b>svcadm enable network/nis/server:default</b></tt></pre><p>This completes the set up of the N2L service with standard maps. You do not need to complete Step 6.</p></li></ol></li><li><a name="nis2ldap-step-6"></a><b>Initialize the NIS maps.</b><p>Perform these steps only if the DIT is fully initialized and you skipped Step 5.</p><ol><li><b>Stop the NIS daemons.</b><pre># <tt><b>svcadm disable network/nis/server:default</b></tt></pre></li><li><a name="nis2ldap-step-8"></a><b>Initialize the NIS maps from information in the DIT.</b><pre># <tt><b>ypserv</b></tt> <tt>-r</tt><tt><b></b></tt></pre><p>Wait for <tt>ypserv</tt> to exit.</p><hr>
<p><b>Tip - </b>The original NIS <tt>dbm</tt> files are not overwritten. You can recover these files, if needed.</p>
<hr>
</li><li><a name="nis2ldap-step-10"></a><b>Start the NIS daemons to ensure that they use the new maps.</b><pre># <tt><b>svcadm enable network/nis/server:default</b></tt></pre></li></ol></li></ol><a name="nis2ldap-proc-18"></a><h4><img src="graphics/procedure.gif"> How to Set Up the N2L Service With Custom or Nonstandard Mappings</h4>
<p>Use this procedure if the following circumstances apply:</p>
<ul><li><p>You have maps that are not listed in <a href="p56.html#nis2ldap-5">Supported Standard Mappings</a>.</p>
</li>
<li><p>You have standard NIS maps that you want to map to non-RFC 2307 LDAP mappings.</p>
</li>
</ul>
<ol><li><a name="nis2ldap-step-35"></a><b>Complete the prerequisite steps that are listed in <a href="p56.html#nis2ldap-15">Prerequisites for the NIS-to-LDAP Transition</a>.</b></li><li><b>On the NIS master server, become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see Chapter 8, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i>.</p></li><li><b>Configure the NIS master server into the N2L server.</b><pre># <tt><b>inityp2l</b></tt></pre><p>Run the <tt>inityp2l</tt> script on the NIS master server and follow the prompts. See <a href="p56.html#nis2ldap-2">Setting Up the NIS-to-LDAP Service</a> for a list of the information you need to provide.</p><p>See the <tt>inityp2l</tt>(1M) man page for more details.</p></li><li><a name="nis2ldap-step-21"></a><b>Modify the <tt>/var/yp/NISLDAPmapping</tt> file.</b><p>See <a href="p58.html">Examples of Custom Maps</a> for examples of how to modify the mapping file.</p></li><li><a name="nis2ldap-step-20"></a><b>Determine if the LDAP Directory Information Tree (DIT) is fully initialized.</b><p>The DIT is fully initialized if it already contains the information necessary to populate all the maps that are listed in the <tt>NISLDAPmapping</tt> file.</p><ul><li><p>If no, complete Step 6, Step 8, and Step 9.</p>
</li>
<li><p>If yes, skip Step 6 and complete <a href="p57.html#nis2ldap-step-38">Step&nbsp;7</a>, Step 8, and Step 9.</p>
</li>
</ul>
</li><li><b>Initialize the DIT for the transition from the NIS source files.</b><ol><li><b>Make sure that the old NIS maps are up-to-date.</b><pre># <tt><b>cd /var/yp</b></tt>
# <tt><b>make</b></tt></pre><p>For more information, see the <tt>ypmake</tt>(1M) man page.</p></li><li><b>Stop the NIS daemons.</b><pre># <tt><b>svcadm disable network/nis/server:default</b></tt></pre></li><li><b>Copy the old maps to the DIT, then initialize N2L support for the maps.</b><pre># <tt><b>ypserv</b></tt> <tt>-Ir</tt><tt><b></b></tt></pre><p>Wait for <tt>ypserv</tt> to exit.</p><hr>
<p><b>Tip - </b>The original NIS <tt>dbm</tt> files are not overwritten. You can recover these files, if needed.</p>
<hr>
</li><li><b>Start the NIS daemons to ensure that they use the new maps.</b><pre># <tt><b>svcadm enable network/nis/server:default</b></tt></pre></li><li><a name="nis2ldap-step-36"></a><b>Skip Step 7 and continue with <a href="p57.html#nis2ldap-step-37">Step&nbsp;8</a>.</b></li></ol></li><li><a name="nis2ldap-step-38"></a><b>Initialize the NIS maps.</b><p>Perform this step only if the DIT is fully initialized.</p><ol><li><b>Stop the NIS daemons.</b><pre># <tt><b>svcadm disable network/nis/server:default</b></tt></pre></li><li><b>Initialize the NIS maps from information in the DIT.</b><pre># <tt><b>ypserv</b></tt> <tt>-r</tt><tt><b></b></tt></pre><p>Wait for <tt>ypserv</tt> to exit.</p><hr>
<p><b>Tip - </b>The original NIS <tt>dbm</tt> files are not overwritten. You can recover these files, if needed.</p>
<hr>
</li><li><b>Start the NIS daemons to ensure that they use the new maps.</b><pre># <tt><b>svcadm enable network/nis/server:default</b></tt></pre></li></ol></li><li><a name="nis2ldap-step-37"></a><b>Verify that the LDAP entries are correct.</b><p>If the entries are not correct, then the entries can not be found by LDAP naming services clients.</p><pre># <tt><b>ldapsearch</b></tt> <tt>-h</tt> <tt><b>server</b></tt> <tt>-s</tt> <tt><b>sub</b></tt> <tt>-b</tt> <tt><b>"ou=servdates, dc=..." \</b></tt>
<tt><b>"objectclass=servDates"</b></tt></pre></li><li><a name="nis2ldap-step-23"></a><b>Verify the contents of the <tt>LDAP_</tt> maps.</b><p>The following sample output shows how to use <tt>makedm</tt> to verify the contents of the <tt>hosts.byaddr</tt> map.</p><pre># <tt><b>makedbm</b></tt> <tt>-u</tt> <tt><b>LDAP_servdate.bynumber</b></tt>
plato: 1/3/2001
johnson: 2/4/2003,1/3/2001
yeats: 4/4/2002
poe: 3/3/2002,3/4/2000</pre><p>If the contents are as expected, the transition from NIS to LDAP was successful.</p><p>Note that the original NIS <tt>dbm</tt> files are not overwritten, so you can always recover those files. See <a href="p60.html#nis2ldap-42">Reverting to NIS</a> for more information.</p></li></ol>
</div>
<!--stopindex-->

<!-- END CENTRAL COLUMN COMPONENTS -->
</td></tr>

<!-- BEGIN SPACER ROW -->
<tr><td><img src="css/a.gif" width="780" height="1" border="0" alt="" /></td></tr>
<!-- END SPACER ROW -->

<tr><td>

<!-- BEGIN PAGE CONTROL ROW -->
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p56.html"><img style="padding-right: 3px" src="graphics/prev.gif" border="0">Previous</a></td>
<td><a href="toc.html">Contents</a></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p58.html">Next<img style="padding-left: 3px" src="graphics/next.gif" border="0"></a></td>
</tr>
</table>
<!-- END PAGE CONTROL ROW -->
</td></tr>

</table>
<!-- END WRAPPER TABLE, 1 COLUMN, MAIN -->


<!-- BEGIN A5 COMPONENT V.0 -->
<div class="a5" id="a5v0">
<span class="footerlinks">
<a href="http://www.sun.com/company/">Company Info</a>
<a href="http://www.sun.com/contact/">Contact</a>
<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>
<a href="http://www.sun.com/privacy/">Privacy</a>

<span class="footercopy">Copyright 1994-2006 Sun Microsystems, Inc.</span>
</span>
</div>
<!-- END A5 COMPONENT V.0 -->

</body>
</html>

